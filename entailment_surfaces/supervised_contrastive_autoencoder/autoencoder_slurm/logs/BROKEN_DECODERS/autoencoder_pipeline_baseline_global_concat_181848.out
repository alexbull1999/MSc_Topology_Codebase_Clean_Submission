Starting Surface Distance Metric Analysis job...
Job ID: 181848
Node: gpuvm17
Time: Sat 12 Jul 12:08:15 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Sat Jul 12 12:08:17 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:06.0 Off |                    0 |
| N/A   34C    P8             13W /   70W |       0MiB /  15360MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: Tesla T4
GPU memory: 15.6 GB
PyTorch setup verified!

Starting AutoEncoder Pipeline...

GLOBAL DATASET CONTRASTIVE AUTOENCODER PIPELINE
============================================================
Start time: 2025-07-12 12:08:43.390771
Using device: cuda

Configuration:
  Embedding type: concat
  Batch size: 1020
  Global update frequency: 3 epochs
  Training epochs: 20
Experiment setup completed:
  Experiment directory: experiments/global_concat_test_20250712_120843
  Config saved to: experiments/global_concat_test_20250712_120843/config.json
Loading data...
========================================
FlexibleEmbedder initialized with type: 'concat'
Output dimension will be: 1536
GlobalDataLoader initialized:
  Embedding type: concat
  Output dimension: 1536
  Sample size: All
Starting data loading pipeline...
============================================================
Loading training data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 training samples
Loading validation data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 validation samples
Loading test data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 test samples
Generating embeddings for training...
Generating concat embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated concat embeddings: torch.Size([549367, 1536])
Generating embeddings for validation...
Generating concat embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated concat embeddings: torch.Size([549367, 1536])
Generating embeddings for test...
Generating concat embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated concat embeddings: torch.Size([549367, 1536])
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 1536])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 1536])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 1536])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}

Data loading pipeline completed!
Output embedding dimension: 1536
Updated model input_dim to: 1536
BalancedBatchSampler initialized:
  Classes: [2, 0, 1]
  Samples per class per batch: 340
  Effective batch size: 1020
  Number of batches: 537
  Class 2: 183187 samples
  Class 0: 183416 samples
  Class 1: 182764 samples
BalancedBatchSampler initialized:
  Classes: [2, 0, 1]
  Samples per class per batch: 340
  Effective batch size: 1020
  Number of batches: 537
  Class 2: 183187 samples
  Class 0: 183416 samples
  Class 1: 182764 samples
DataLoaders created:
  Batch size: 1020
  Balanced sampling: True
  Train batches: 537
  Val batches: 537
  Test batches: 539
Data loading completed!
  Train: 549367 samples, 537 batches
  Val: 549367 samples, 537 batches
  Test: 549367 samples, 539 batches
Creating model and trainer...
========================================
ContrastiveAutoencoder initialized:
  Input dim: 1536
  Latent dim: 75
  Hidden dims: [512, 256]
  Dropout rate: 0.2
  Total parameters: 1,876,555
Model created with 1,876,555 parameters
FullDatasetContrastiveLoss initialized:
  Margin: 2.0
  Update frequency: 3 epochs
  Max global samples: 5000
FullDatasetCombinedLoss initialized:
  Contrastive weight: 1.0
  Reconstruction weight: 0.0
Optimizer created (lr=0.0001)
GlobalDatasetTrainer initialized on device: cuda
Model parameters: 1,876,555
Starting training...
========================================
Starting Global Dataset Training...
============================================================

üåç Updating global dataset at epoch 1
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.090 ¬± 0.011
    Neg distances: 0.091 ¬± 0.010
    Separation ratio: 1.00x
    Gap: -0.123
    ‚ùå Poor global separation

Epoch 1 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.112, Neg=0.112, Ratio=1.00x, Gap=-0.180
Batch   0/537: Loss=1.9998 (C:1.9998, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.111, Neg=0.112, Ratio=1.00x, Gap=-0.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.111, Neg=0.112, Ratio=1.00x, Gap=-0.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.112, Neg=0.112, Ratio=1.00x, Gap=-0.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.112, Neg=0.112, Ratio=1.00x, Gap=-0.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.113, Neg=0.113, Ratio=1.00x, Gap=-0.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.113, Neg=0.114, Ratio=1.00x, Gap=-0.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.114, Neg=0.114, Ratio=1.00x, Gap=-0.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.114, Neg=0.115, Ratio=1.01x, Gap=-0.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.115, Neg=0.115, Ratio=1.01x, Gap=-0.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.116, Neg=0.117, Ratio=1.01x, Gap=-0.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.116, Neg=0.117, Ratio=1.01x, Gap=-0.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.117, Neg=0.119, Ratio=1.01x, Gap=-0.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.119, Neg=0.121, Ratio=1.01x, Gap=-0.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.120, Neg=0.121, Ratio=1.01x, Gap=-0.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.121, Neg=0.123, Ratio=1.01x, Gap=-0.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.123, Neg=0.125, Ratio=1.02x, Gap=-0.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.126, Neg=0.128, Ratio=1.02x, Gap=-0.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.126, Neg=0.128, Ratio=1.01x, Gap=-0.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.130, Neg=0.133, Ratio=1.02x, Gap=-0.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.132, Neg=0.135, Ratio=1.02x, Gap=-0.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.135, Neg=0.138, Ratio=1.02x, Gap=-0.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.139, Neg=0.142, Ratio=1.02x, Gap=-0.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.142, Neg=0.145, Ratio=1.02x, Gap=-0.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.148, Neg=0.152, Ratio=1.03x, Gap=-0.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.150, Neg=0.154, Ratio=1.03x, Gap=-0.726
Batch  25/537: Loss=1.9955 (C:1.9955, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.156, Neg=0.161, Ratio=1.03x, Gap=-0.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.160, Neg=0.165, Ratio=1.03x, Gap=-0.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.165, Neg=0.170, Ratio=1.03x, Gap=-0.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.170, Neg=0.177, Ratio=1.04x, Gap=-1.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.176, Neg=0.182, Ratio=1.04x, Gap=-1.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.183, Neg=0.190, Ratio=1.04x, Gap=-1.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.195, Neg=0.203, Ratio=1.04x, Gap=-1.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.201, Neg=0.209, Ratio=1.04x, Gap=-1.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.209, Neg=0.221, Ratio=1.06x, Gap=-1.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.217, Neg=0.228, Ratio=1.05x, Gap=-1.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.225, Neg=0.235, Ratio=1.04x, Gap=-1.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.234, Neg=0.242, Ratio=1.03x, Gap=-1.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.242, Neg=0.254, Ratio=1.05x, Gap=-1.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.254, Neg=0.266, Ratio=1.05x, Gap=-2.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.270, Neg=0.285, Ratio=1.06x, Gap=-1.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.281, Neg=0.298, Ratio=1.06x, Gap=-2.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.302, Neg=0.318, Ratio=1.05x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.310, Neg=0.328, Ratio=1.06x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.320, Neg=0.339, Ratio=1.06x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.351, Neg=0.371, Ratio=1.06x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.365, Neg=0.383, Ratio=1.05x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.379, Neg=0.399, Ratio=1.05x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=0.432, Ratio=1.06x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=0.433, Ratio=1.05x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=0.466, Ratio=1.07x, Gap=-4.207
Batch  50/537: Loss=1.9766 (C:1.9766, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=0.471, Ratio=1.06x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=0.465, Ratio=1.06x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=0.506, Ratio=1.07x, Gap=-4.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=0.497, Ratio=1.07x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=0.494, Ratio=1.06x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=0.496, Ratio=1.07x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=0.504, Ratio=1.08x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=0.493, Ratio=1.07x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=0.500, Ratio=1.06x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=0.486, Ratio=1.06x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=0.501, Ratio=1.07x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=0.499, Ratio=1.07x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=0.501, Ratio=1.06x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=0.489, Ratio=1.05x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=0.505, Ratio=1.07x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=0.505, Ratio=1.07x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=0.503, Ratio=1.05x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=0.509, Ratio=1.07x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=0.503, Ratio=1.06x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=0.518, Ratio=1.06x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=0.509, Ratio=1.07x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=0.509, Ratio=1.07x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=0.527, Ratio=1.07x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=0.512, Ratio=1.06x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.524, Ratio=1.07x, Gap=-3.413
Batch  75/537: Loss=1.9687 (C:1.9687, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=0.510, Ratio=1.07x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=0.506, Ratio=1.07x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=0.514, Ratio=1.08x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=0.522, Ratio=1.08x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=0.508, Ratio=1.06x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=0.517, Ratio=1.06x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=0.525, Ratio=1.07x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=0.513, Ratio=1.07x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.519, Ratio=1.06x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=0.529, Ratio=1.09x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.535, Ratio=1.08x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.533, Ratio=1.06x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.524, Ratio=1.06x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=0.519, Ratio=1.08x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.538, Ratio=1.07x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.539, Ratio=1.07x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.529, Ratio=1.08x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=0.524, Ratio=1.07x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=0.516, Ratio=1.08x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.532, Ratio=1.07x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.533, Ratio=1.08x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.536, Ratio=1.07x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.534, Ratio=1.07x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=0.515, Ratio=1.06x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.526, Ratio=1.07x, Gap=-3.534
Batch 100/537: Loss=1.9699 (C:1.9699, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=0.524, Ratio=1.08x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=0.515, Ratio=1.07x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.535, Ratio=1.09x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.526, Ratio=1.07x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.545, Ratio=1.08x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.538, Ratio=1.08x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.540, Ratio=1.08x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.538, Ratio=1.07x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.546, Ratio=1.09x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.558, Ratio=1.09x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.538, Ratio=1.07x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.565, Ratio=1.09x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.549, Ratio=1.08x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.555, Ratio=1.09x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=0.524, Ratio=1.08x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.546, Ratio=1.08x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.544, Ratio=1.09x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.559, Ratio=1.10x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.546, Ratio=1.08x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.563, Ratio=1.09x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.551, Ratio=1.09x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.540, Ratio=1.08x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.561, Ratio=1.10x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.550, Ratio=1.09x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.561, Ratio=1.09x, Gap=-4.217
Batch 125/537: Loss=1.9625 (C:1.9625, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.552, Ratio=1.09x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.555, Ratio=1.08x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.555, Ratio=1.09x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.557, Ratio=1.10x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.556, Ratio=1.09x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.563, Ratio=1.09x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.562, Ratio=1.11x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.553, Ratio=1.09x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.563, Ratio=1.09x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.571, Ratio=1.09x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.584, Ratio=1.09x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.587, Ratio=1.10x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.599, Ratio=1.10x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.609, Ratio=1.10x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.594, Ratio=1.08x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.593, Ratio=1.09x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.592, Ratio=1.10x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.586, Ratio=1.10x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.574, Ratio=1.09x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.581, Ratio=1.10x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.576, Ratio=1.10x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.608, Ratio=1.13x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.577, Ratio=1.08x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.594, Ratio=1.10x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.600, Ratio=1.09x, Gap=-3.293
Batch 150/537: Loss=1.9573 (C:1.9573, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.582, Ratio=1.09x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.589, Ratio=1.10x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.564, Ratio=1.09x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.578, Ratio=1.11x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.574, Ratio=1.11x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.574, Ratio=1.11x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.579, Ratio=1.11x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.574, Ratio=1.10x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.573, Ratio=1.10x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.581, Ratio=1.11x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.589, Ratio=1.11x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.599, Ratio=1.12x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.610, Ratio=1.12x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.619, Ratio=1.13x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.611, Ratio=1.12x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.605, Ratio=1.11x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.623, Ratio=1.12x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.599, Ratio=1.11x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.604, Ratio=1.13x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.587, Ratio=1.12x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.580, Ratio=1.13x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.575, Ratio=1.12x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.569, Ratio=1.12x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.566, Ratio=1.12x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.570, Ratio=1.12x, Gap=-3.294
Batch 175/537: Loss=1.9456 (C:1.9456, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.574, Ratio=1.11x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.573, Ratio=1.13x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.590, Ratio=1.13x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.583, Ratio=1.15x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.582, Ratio=1.11x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.600, Ratio=1.15x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.588, Ratio=1.13x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.614, Ratio=1.13x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.581, Ratio=1.13x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.619, Ratio=1.15x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.616, Ratio=1.14x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.608, Ratio=1.14x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.585, Ratio=1.13x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.578, Ratio=1.10x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.594, Ratio=1.14x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.597, Ratio=1.16x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.599, Ratio=1.14x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.593, Ratio=1.15x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.591, Ratio=1.14x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.596, Ratio=1.13x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.593, Ratio=1.14x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.589, Ratio=1.13x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.578, Ratio=1.11x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.607, Ratio=1.13x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.616, Ratio=1.13x, Gap=-3.456
Batch 200/537: Loss=1.9380 (C:1.9380, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.619, Ratio=1.13x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.637, Ratio=1.15x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.621, Ratio=1.13x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.615, Ratio=1.13x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.615, Ratio=1.13x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.640, Ratio=1.15x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.641, Ratio=1.15x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.628, Ratio=1.14x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.629, Ratio=1.14x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.640, Ratio=1.16x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.632, Ratio=1.15x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.639, Ratio=1.16x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.629, Ratio=1.14x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.613, Ratio=1.13x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.624, Ratio=1.15x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.618, Ratio=1.14x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.608, Ratio=1.13x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.615, Ratio=1.14x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.614, Ratio=1.14x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.622, Ratio=1.14x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.612, Ratio=1.14x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.619, Ratio=1.16x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.609, Ratio=1.14x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.605, Ratio=1.14x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.624, Ratio=1.14x, Gap=-3.330
Batch 225/537: Loss=1.9337 (C:1.9337, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.616, Ratio=1.16x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.604, Ratio=1.14x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.629, Ratio=1.14x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.632, Ratio=1.16x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.631, Ratio=1.16x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.671, Ratio=1.16x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.668, Ratio=1.15x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.664, Ratio=1.16x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.663, Ratio=1.15x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.654, Ratio=1.14x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.670, Ratio=1.14x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.664, Ratio=1.15x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.654, Ratio=1.15x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.637, Ratio=1.14x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.652, Ratio=1.16x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.644, Ratio=1.16x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.637, Ratio=1.15x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.648, Ratio=1.16x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.634, Ratio=1.14x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.624, Ratio=1.15x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.647, Ratio=1.16x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.629, Ratio=1.15x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.653, Ratio=1.17x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.646, Ratio=1.15x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.648, Ratio=1.15x, Gap=-3.470
Batch 250/537: Loss=1.9261 (C:1.9261, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.660, Ratio=1.16x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.672, Ratio=1.14x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.648, Ratio=1.15x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.675, Ratio=1.17x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.635, Ratio=1.15x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.644, Ratio=1.14x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.633, Ratio=1.14x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.643, Ratio=1.17x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.615, Ratio=1.14x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.651, Ratio=1.18x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.626, Ratio=1.15x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.642, Ratio=1.16x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.638, Ratio=1.16x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.649, Ratio=1.17x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.655, Ratio=1.17x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.659, Ratio=1.16x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.653, Ratio=1.17x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.655, Ratio=1.16x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.668, Ratio=1.16x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.667, Ratio=1.17x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.665, Ratio=1.15x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.663, Ratio=1.16x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.660, Ratio=1.16x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.656, Ratio=1.14x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.666, Ratio=1.16x, Gap=-4.069
Batch 275/537: Loss=1.9250 (C:1.9250, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.653, Ratio=1.16x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.633, Ratio=1.16x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.628, Ratio=1.16x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.643, Ratio=1.18x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.625, Ratio=1.17x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.633, Ratio=1.17x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.626, Ratio=1.16x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.629, Ratio=1.17x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.655, Ratio=1.18x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.636, Ratio=1.17x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.643, Ratio=1.17x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.667, Ratio=1.19x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.682, Ratio=1.20x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.666, Ratio=1.17x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.673, Ratio=1.18x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.650, Ratio=1.17x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.666, Ratio=1.18x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.642, Ratio=1.16x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.647, Ratio=1.17x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.655, Ratio=1.18x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.667, Ratio=1.16x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.659, Ratio=1.16x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.669, Ratio=1.17x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.665, Ratio=1.18x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.670, Ratio=1.17x, Gap=-3.504
Batch 300/537: Loss=1.9189 (C:1.9189, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.640, Ratio=1.16x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.672, Ratio=1.19x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.663, Ratio=1.19x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.670, Ratio=1.17x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.672, Ratio=1.17x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.666, Ratio=1.15x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.663, Ratio=1.17x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.666, Ratio=1.17x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.664, Ratio=1.18x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.666, Ratio=1.16x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.685, Ratio=1.18x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.685, Ratio=1.18x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.680, Ratio=1.18x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.665, Ratio=1.18x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.680, Ratio=1.18x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.666, Ratio=1.18x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.651, Ratio=1.17x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.645, Ratio=1.18x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.647, Ratio=1.17x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.640, Ratio=1.17x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.644, Ratio=1.17x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.646, Ratio=1.18x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.640, Ratio=1.18x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.645, Ratio=1.20x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.654, Ratio=1.19x, Gap=-3.190
Batch 325/537: Loss=1.9097 (C:1.9097, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.653, Ratio=1.18x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.661, Ratio=1.17x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.676, Ratio=1.19x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.667, Ratio=1.17x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.676, Ratio=1.18x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.664, Ratio=1.18x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.670, Ratio=1.16x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.681, Ratio=1.18x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.675, Ratio=1.18x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.670, Ratio=1.18x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.682, Ratio=1.19x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.682, Ratio=1.19x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.668, Ratio=1.17x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.667, Ratio=1.18x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.695, Ratio=1.19x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.709, Ratio=1.20x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.676, Ratio=1.18x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.688, Ratio=1.19x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.675, Ratio=1.19x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.671, Ratio=1.18x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.657, Ratio=1.18x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.655, Ratio=1.19x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.630, Ratio=1.18x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.655, Ratio=1.18x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.658, Ratio=1.18x, Gap=-3.596
Batch 350/537: Loss=1.9143 (C:1.9143, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.665, Ratio=1.18x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.671, Ratio=1.17x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.681, Ratio=1.19x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.675, Ratio=1.18x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.695, Ratio=1.20x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.680, Ratio=1.18x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.677, Ratio=1.17x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.686, Ratio=1.18x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.675, Ratio=1.18x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.682, Ratio=1.19x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.677, Ratio=1.18x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.668, Ratio=1.17x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.673, Ratio=1.19x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.678, Ratio=1.19x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.669, Ratio=1.17x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.681, Ratio=1.19x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.681, Ratio=1.18x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.670, Ratio=1.18x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.675, Ratio=1.19x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.691, Ratio=1.20x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.685, Ratio=1.19x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.660, Ratio=1.19x, Gap=-3.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.680, Ratio=1.18x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.683, Ratio=1.20x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.684, Ratio=1.18x, Gap=-3.586
Batch 375/537: Loss=1.9152 (C:1.9152, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.690, Ratio=1.19x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.683, Ratio=1.18x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.703, Ratio=1.19x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.692, Ratio=1.20x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.682, Ratio=1.18x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.708, Ratio=1.18x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.702, Ratio=1.19x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.674, Ratio=1.18x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.694, Ratio=1.20x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.700, Ratio=1.20x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.702, Ratio=1.19x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.686, Ratio=1.19x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.688, Ratio=1.20x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.689, Ratio=1.20x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.670, Ratio=1.20x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.668, Ratio=1.18x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.665, Ratio=1.19x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.655, Ratio=1.18x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.678, Ratio=1.18x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.676, Ratio=1.19x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.683, Ratio=1.20x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.680, Ratio=1.18x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.676, Ratio=1.18x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.685, Ratio=1.20x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.675, Ratio=1.17x, Gap=-3.414
Batch 400/537: Loss=1.9223 (C:1.9223, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.679, Ratio=1.17x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.688, Ratio=1.20x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.706, Ratio=1.22x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.673, Ratio=1.19x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.698, Ratio=1.22x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.697, Ratio=1.20x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.703, Ratio=1.20x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.703, Ratio=1.19x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.711, Ratio=1.21x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.709, Ratio=1.19x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.720, Ratio=1.19x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.709, Ratio=1.19x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.719, Ratio=1.20x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.697, Ratio=1.20x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.671, Ratio=1.16x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.686, Ratio=1.20x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.680, Ratio=1.19x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.673, Ratio=1.17x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.686, Ratio=1.19x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.680, Ratio=1.19x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.672, Ratio=1.19x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.675, Ratio=1.21x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.679, Ratio=1.18x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.686, Ratio=1.21x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.669, Ratio=1.18x, Gap=-3.539
Batch 425/537: Loss=1.9166 (C:1.9166, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.660, Ratio=1.19x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.674, Ratio=1.18x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.677, Ratio=1.19x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.663, Ratio=1.17x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.677, Ratio=1.21x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.678, Ratio=1.20x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.675, Ratio=1.19x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.711, Ratio=1.20x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.706, Ratio=1.18x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.711, Ratio=1.20x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.722, Ratio=1.19x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.703, Ratio=1.19x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.702, Ratio=1.19x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.700, Ratio=1.21x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.694, Ratio=1.18x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.707, Ratio=1.19x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.669, Ratio=1.18x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.690, Ratio=1.18x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.698, Ratio=1.19x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.679, Ratio=1.17x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.663, Ratio=1.18x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.689, Ratio=1.18x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.685, Ratio=1.20x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.668, Ratio=1.19x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.673, Ratio=1.20x, Gap=-3.033
Batch 450/537: Loss=1.9020 (C:1.9020, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.686, Ratio=1.19x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.666, Ratio=1.19x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.685, Ratio=1.21x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.677, Ratio=1.20x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.671, Ratio=1.19x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.686, Ratio=1.20x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.673, Ratio=1.19x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.697, Ratio=1.19x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.686, Ratio=1.19x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.691, Ratio=1.19x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.691, Ratio=1.22x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.704, Ratio=1.19x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.682, Ratio=1.19x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.692, Ratio=1.19x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.695, Ratio=1.20x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.701, Ratio=1.20x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.711, Ratio=1.18x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.707, Ratio=1.19x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.696, Ratio=1.18x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.716, Ratio=1.19x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.712, Ratio=1.20x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.740, Ratio=1.20x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.705, Ratio=1.19x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.731, Ratio=1.20x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.711, Ratio=1.17x, Gap=-3.453
Batch 475/537: Loss=1.9175 (C:1.9175, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.710, Ratio=1.19x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.705, Ratio=1.19x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.702, Ratio=1.21x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.713, Ratio=1.21x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.676, Ratio=1.19x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.687, Ratio=1.18x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.698, Ratio=1.19x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.682, Ratio=1.19x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.675, Ratio=1.21x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.681, Ratio=1.19x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.694, Ratio=1.20x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.701, Ratio=1.20x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.691, Ratio=1.19x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.707, Ratio=1.19x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.700, Ratio=1.20x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.704, Ratio=1.20x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.706, Ratio=1.20x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.698, Ratio=1.19x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.678, Ratio=1.17x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.697, Ratio=1.21x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.702, Ratio=1.19x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.695, Ratio=1.19x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.686, Ratio=1.19x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.681, Ratio=1.19x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.684, Ratio=1.19x, Gap=-3.394
Batch 500/537: Loss=1.9092 (C:1.9092, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.673, Ratio=1.19x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.675, Ratio=1.19x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.683, Ratio=1.19x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.670, Ratio=1.19x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.687, Ratio=1.19x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.699, Ratio=1.20x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.706, Ratio=1.19x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.695, Ratio=1.19x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.694, Ratio=1.20x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.716, Ratio=1.19x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.702, Ratio=1.20x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.700, Ratio=1.21x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.700, Ratio=1.20x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.691, Ratio=1.19x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.684, Ratio=1.19x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.701, Ratio=1.23x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.687, Ratio=1.21x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.691, Ratio=1.19x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.698, Ratio=1.22x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.708, Ratio=1.20x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.713, Ratio=1.22x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.698, Ratio=1.20x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.723, Ratio=1.20x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.734, Ratio=1.20x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.743, Ratio=1.18x, Gap=-3.541
Batch 525/537: Loss=1.9167 (C:1.9167, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.732, Ratio=1.20x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.728, Ratio=1.21x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.725, Ratio=1.20x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.728, Ratio=1.21x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.718, Ratio=1.21x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.716, Ratio=1.19x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.701, Ratio=1.20x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.704, Ratio=1.21x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.709, Ratio=1.20x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.691, Ratio=1.19x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.689, Ratio=1.20x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.696, Ratio=1.23x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.699, Ratio=1.22x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.672, Ratio=1.20x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.700, Ratio=1.22x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.691, Ratio=1.23x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.685, Ratio=1.21x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.695, Ratio=1.21x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.690, Ratio=1.21x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.697, Ratio=1.21x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.704, Ratio=1.21x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.696, Ratio=1.21x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.694, Ratio=1.23x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.700, Ratio=1.24x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.692, Ratio=1.22x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.695, Ratio=1.23x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.690, Ratio=1.24x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.690, Ratio=1.22x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.695, Ratio=1.23x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.693, Ratio=1.22x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.695, Ratio=1.24x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.695, Ratio=1.23x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.698, Ratio=1.22x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.694, Ratio=1.23x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.699, Ratio=1.23x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.667, Ratio=1.22x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.702, Ratio=1.21x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.703, Ratio=1.23x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.700, Ratio=1.22x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.699, Ratio=1.23x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.699, Ratio=1.23x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.695, Ratio=1.23x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.688, Ratio=1.21x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.688, Ratio=1.20x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.702, Ratio=1.22x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.692, Ratio=1.22x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.682, Ratio=1.21x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.690, Ratio=1.21x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.695, Ratio=1.21x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.683, Ratio=1.21x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.686, Ratio=1.23x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.697, Ratio=1.21x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.709, Ratio=1.22x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.710, Ratio=1.23x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.681, Ratio=1.22x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.697, Ratio=1.25x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.709, Ratio=1.22x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.702, Ratio=1.21x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.685, Ratio=1.22x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.691, Ratio=1.21x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.697, Ratio=1.21x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.711, Ratio=1.23x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.687, Ratio=1.22x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.699, Ratio=1.22x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.696, Ratio=1.21x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.708, Ratio=1.22x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.706, Ratio=1.24x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.686, Ratio=1.22x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.696, Ratio=1.22x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.674, Ratio=1.21x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.687, Ratio=1.23x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.696, Ratio=1.23x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.679, Ratio=1.21x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.703, Ratio=1.24x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.691, Ratio=1.20x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.684, Ratio=1.23x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.705, Ratio=1.21x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.695, Ratio=1.23x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.689, Ratio=1.22x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.692, Ratio=1.22x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.721, Ratio=1.23x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.688, Ratio=1.21x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.701, Ratio=1.23x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.700, Ratio=1.23x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.701, Ratio=1.22x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.697, Ratio=1.22x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.694, Ratio=1.22x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.685, Ratio=1.21x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.697, Ratio=1.23x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.694, Ratio=1.21x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.700, Ratio=1.20x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.677, Ratio=1.19x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.696, Ratio=1.24x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.702, Ratio=1.22x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.690, Ratio=1.23x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.689, Ratio=1.21x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.689, Ratio=1.24x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.708, Ratio=1.23x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.681, Ratio=1.19x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.677, Ratio=1.22x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.694, Ratio=1.22x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.697, Ratio=1.22x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.688, Ratio=1.21x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.696, Ratio=1.21x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.690, Ratio=1.22x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.692, Ratio=1.22x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.704, Ratio=1.23x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.693, Ratio=1.23x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.684, Ratio=1.22x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.705, Ratio=1.24x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.686, Ratio=1.23x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.686, Ratio=1.22x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.699, Ratio=1.24x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.683, Ratio=1.21x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.683, Ratio=1.23x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.693, Ratio=1.23x, Gap=-3.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.693, Ratio=1.24x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.680, Ratio=1.22x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.688, Ratio=1.21x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.703, Ratio=1.22x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.689, Ratio=1.21x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.708, Ratio=1.24x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.676, Ratio=1.19x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.698, Ratio=1.23x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.690, Ratio=1.21x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.717, Ratio=1.24x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.702, Ratio=1.25x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.709, Ratio=1.24x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.717, Ratio=1.27x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.675, Ratio=1.21x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.686, Ratio=1.21x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.697, Ratio=1.21x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.680, Ratio=1.23x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.703, Ratio=1.23x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.697, Ratio=1.20x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.688, Ratio=1.20x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.694, Ratio=1.21x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.700, Ratio=1.23x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.682, Ratio=1.22x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.713, Ratio=1.22x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.692, Ratio=1.22x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.678, Ratio=1.22x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.683, Ratio=1.21x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.686, Ratio=1.23x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.701, Ratio=1.25x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.687, Ratio=1.22x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.688, Ratio=1.20x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.692, Ratio=1.22x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.681, Ratio=1.23x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.680, Ratio=1.20x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.689, Ratio=1.22x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.699, Ratio=1.24x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.682, Ratio=1.22x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.700, Ratio=1.22x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.690, Ratio=1.21x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.690, Ratio=1.21x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.680, Ratio=1.21x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.687, Ratio=1.22x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.694, Ratio=1.25x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.694, Ratio=1.23x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.700, Ratio=1.23x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.682, Ratio=1.23x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.693, Ratio=1.23x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.707, Ratio=1.22x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.693, Ratio=1.22x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.703, Ratio=1.22x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.695, Ratio=1.23x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.694, Ratio=1.23x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.696, Ratio=1.21x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.713, Ratio=1.23x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.687, Ratio=1.21x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.709, Ratio=1.24x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.698, Ratio=1.23x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.695, Ratio=1.22x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.691, Ratio=1.20x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.687, Ratio=1.20x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.690, Ratio=1.20x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.702, Ratio=1.20x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.679, Ratio=1.22x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.706, Ratio=1.23x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.684, Ratio=1.22x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.695, Ratio=1.22x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.704, Ratio=1.23x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.704, Ratio=1.23x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.698, Ratio=1.24x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.706, Ratio=1.24x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.689, Ratio=1.21x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.692, Ratio=1.23x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.691, Ratio=1.21x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.698, Ratio=1.24x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.697, Ratio=1.25x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.698, Ratio=1.23x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.675, Ratio=1.21x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.690, Ratio=1.24x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.683, Ratio=1.21x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.686, Ratio=1.19x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.711, Ratio=1.23x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.697, Ratio=1.22x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.698, Ratio=1.22x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.713, Ratio=1.23x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.693, Ratio=1.22x, Gap=-3.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.697, Ratio=1.21x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.698, Ratio=1.22x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.693, Ratio=1.21x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.691, Ratio=1.22x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.694, Ratio=1.22x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.670, Ratio=1.22x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.691, Ratio=1.23x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.706, Ratio=1.22x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.697, Ratio=1.23x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.688, Ratio=1.23x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.692, Ratio=1.21x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.685, Ratio=1.22x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.694, Ratio=1.21x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.697, Ratio=1.24x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.697, Ratio=1.21x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.690, Ratio=1.22x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.693, Ratio=1.21x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.679, Ratio=1.21x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.695, Ratio=1.23x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.686, Ratio=1.23x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.695, Ratio=1.23x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.687, Ratio=1.21x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.682, Ratio=1.22x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.693, Ratio=1.21x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.702, Ratio=1.23x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.701, Ratio=1.23x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.693, Ratio=1.22x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.668, Ratio=1.20x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.694, Ratio=1.21x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.702, Ratio=1.22x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.699, Ratio=1.21x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.691, Ratio=1.22x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.706, Ratio=1.23x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.696, Ratio=1.23x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.693, Ratio=1.22x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.683, Ratio=1.22x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.694, Ratio=1.24x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.689, Ratio=1.23x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.686, Ratio=1.23x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.694, Ratio=1.22x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.707, Ratio=1.24x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.693, Ratio=1.23x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.705, Ratio=1.22x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.692, Ratio=1.23x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.686, Ratio=1.22x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.691, Ratio=1.21x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.695, Ratio=1.23x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.714, Ratio=1.23x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.684, Ratio=1.20x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.693, Ratio=1.24x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.693, Ratio=1.25x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.696, Ratio=1.24x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.698, Ratio=1.23x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.700, Ratio=1.25x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.684, Ratio=1.21x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.685, Ratio=1.21x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.685, Ratio=1.22x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.699, Ratio=1.21x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.692, Ratio=1.22x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.689, Ratio=1.23x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.701, Ratio=1.23x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.668, Ratio=1.22x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.690, Ratio=1.23x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.699, Ratio=1.22x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.700, Ratio=1.21x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.690, Ratio=1.23x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.695, Ratio=1.22x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.694, Ratio=1.24x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.682, Ratio=1.22x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.700, Ratio=1.21x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.717, Ratio=1.25x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.705, Ratio=1.23x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.690, Ratio=1.23x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.702, Ratio=1.24x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.697, Ratio=1.23x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.693, Ratio=1.22x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.693, Ratio=1.23x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.693, Ratio=1.23x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.695, Ratio=1.22x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.690, Ratio=1.24x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.697, Ratio=1.21x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.683, Ratio=1.23x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.699, Ratio=1.22x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.695, Ratio=1.22x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.700, Ratio=1.22x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.708, Ratio=1.22x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.699, Ratio=1.21x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.685, Ratio=1.20x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.703, Ratio=1.22x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.696, Ratio=1.21x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.704, Ratio=1.23x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.690, Ratio=1.24x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.709, Ratio=1.23x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.697, Ratio=1.24x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.695, Ratio=1.23x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.698, Ratio=1.23x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.695, Ratio=1.23x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.686, Ratio=1.21x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.687, Ratio=1.22x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.690, Ratio=1.21x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.686, Ratio=1.21x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.680, Ratio=1.19x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.696, Ratio=1.24x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.683, Ratio=1.23x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.708, Ratio=1.23x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.696, Ratio=1.23x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.685, Ratio=1.22x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.695, Ratio=1.22x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.698, Ratio=1.21x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.695, Ratio=1.22x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.690, Ratio=1.22x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.705, Ratio=1.22x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.701, Ratio=1.24x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.686, Ratio=1.22x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.680, Ratio=1.22x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.685, Ratio=1.22x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.697, Ratio=1.22x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.694, Ratio=1.21x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.700, Ratio=1.25x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.684, Ratio=1.21x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.686, Ratio=1.22x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.692, Ratio=1.22x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.694, Ratio=1.23x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.680, Ratio=1.21x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.701, Ratio=1.25x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.686, Ratio=1.23x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.688, Ratio=1.23x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.713, Ratio=1.24x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.689, Ratio=1.23x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.699, Ratio=1.22x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.680, Ratio=1.22x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.685, Ratio=1.24x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.679, Ratio=1.21x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.684, Ratio=1.24x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.693, Ratio=1.23x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.691, Ratio=1.21x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.702, Ratio=1.23x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.689, Ratio=1.23x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.690, Ratio=1.21x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.704, Ratio=1.25x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.710, Ratio=1.22x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.694, Ratio=1.24x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.683, Ratio=1.21x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.695, Ratio=1.22x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.692, Ratio=1.23x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.697, Ratio=1.23x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.688, Ratio=1.21x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.683, Ratio=1.23x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.684, Ratio=1.22x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.688, Ratio=1.21x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.714, Ratio=1.24x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.680, Ratio=1.20x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.681, Ratio=1.22x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.702, Ratio=1.23x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.701, Ratio=1.22x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.695, Ratio=1.25x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.692, Ratio=1.23x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.694, Ratio=1.23x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.678, Ratio=1.22x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.685, Ratio=1.22x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.695, Ratio=1.23x, Gap=-3.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.679, Ratio=1.21x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.698, Ratio=1.24x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.702, Ratio=1.24x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.705, Ratio=1.23x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.703, Ratio=1.22x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.697, Ratio=1.21x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.694, Ratio=1.22x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.691, Ratio=1.23x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.694, Ratio=1.24x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.701, Ratio=1.23x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.714, Ratio=1.24x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.706, Ratio=1.22x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.702, Ratio=1.22x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.696, Ratio=1.23x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.690, Ratio=1.22x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.698, Ratio=1.24x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.704, Ratio=1.23x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.695, Ratio=1.22x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.692, Ratio=1.23x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.699, Ratio=1.23x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.694, Ratio=1.23x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.684, Ratio=1.21x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.697, Ratio=1.23x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.694, Ratio=1.22x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.685, Ratio=1.23x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.712, Ratio=1.24x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.701, Ratio=1.22x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.707, Ratio=1.23x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.695, Ratio=1.21x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.700, Ratio=1.21x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.702, Ratio=1.24x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.699, Ratio=1.21x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.686, Ratio=1.21x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.697, Ratio=1.24x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.681, Ratio=1.19x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.684, Ratio=1.21x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.677, Ratio=1.21x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.698, Ratio=1.24x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.694, Ratio=1.24x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.691, Ratio=1.22x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.687, Ratio=1.22x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.680, Ratio=1.20x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.698, Ratio=1.22x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.707, Ratio=1.25x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.690, Ratio=1.22x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.684, Ratio=1.22x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.701, Ratio=1.22x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.693, Ratio=1.22x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.696, Ratio=1.24x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.699, Ratio=1.23x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.687, Ratio=1.23x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.711, Ratio=1.23x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.709, Ratio=1.23x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.686, Ratio=1.21x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.683, Ratio=1.21x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.696, Ratio=1.23x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.696, Ratio=1.23x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.703, Ratio=1.23x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.693, Ratio=1.23x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.692, Ratio=1.22x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.691, Ratio=1.23x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.710, Ratio=1.23x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.689, Ratio=1.24x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.684, Ratio=1.22x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.705, Ratio=1.24x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.697, Ratio=1.20x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.700, Ratio=1.23x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.690, Ratio=1.22x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.686, Ratio=1.21x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.705, Ratio=1.22x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.697, Ratio=1.23x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.680, Ratio=1.21x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.697, Ratio=1.22x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.699, Ratio=1.20x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.696, Ratio=1.22x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.686, Ratio=1.22x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.697, Ratio=1.23x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.699, Ratio=1.23x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.701, Ratio=1.24x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.693, Ratio=1.23x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.696, Ratio=1.22x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.711, Ratio=1.21x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.701, Ratio=1.23x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.701, Ratio=1.22x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.695, Ratio=1.23x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.704, Ratio=1.24x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.689, Ratio=1.21x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.705, Ratio=1.26x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.691, Ratio=1.23x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.707, Ratio=1.23x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.691, Ratio=1.22x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.689, Ratio=1.24x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.698, Ratio=1.22x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.698, Ratio=1.21x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.693, Ratio=1.24x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.698, Ratio=1.22x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.708, Ratio=1.22x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.699, Ratio=1.24x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.711, Ratio=1.23x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.681, Ratio=1.20x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.685, Ratio=1.21x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.687, Ratio=1.21x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.667, Ratio=1.21x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.700, Ratio=1.22x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.708, Ratio=1.22x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.709, Ratio=1.22x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.706, Ratio=1.24x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.687, Ratio=1.22x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.692, Ratio=1.22x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.696, Ratio=1.22x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.696, Ratio=1.23x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.697, Ratio=1.23x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.710, Ratio=1.22x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.702, Ratio=1.23x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.699, Ratio=1.24x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.691, Ratio=1.22x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.700, Ratio=1.24x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.696, Ratio=1.22x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.686, Ratio=1.19x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.698, Ratio=1.24x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.680, Ratio=1.20x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.712, Ratio=1.25x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.704, Ratio=1.24x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.689, Ratio=1.20x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.689, Ratio=1.22x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.689, Ratio=1.22x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.694, Ratio=1.22x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.704, Ratio=1.22x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.695, Ratio=1.22x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.685, Ratio=1.21x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.691, Ratio=1.24x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.695, Ratio=1.22x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.706, Ratio=1.22x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.684, Ratio=1.22x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.683, Ratio=1.23x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.679, Ratio=1.21x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.710, Ratio=1.22x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.702, Ratio=1.23x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.703, Ratio=1.23x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.700, Ratio=1.22x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.691, Ratio=1.20x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.704, Ratio=1.21x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.692, Ratio=1.21x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.682, Ratio=1.21x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.695, Ratio=1.23x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.697, Ratio=1.22x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.691, Ratio=1.23x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.684, Ratio=1.24x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.680, Ratio=1.21x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.703, Ratio=1.22x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.699, Ratio=1.22x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.683, Ratio=1.20x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.696, Ratio=1.24x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.691, Ratio=1.21x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.692, Ratio=1.22x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.686, Ratio=1.23x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.691, Ratio=1.24x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.711, Ratio=1.23x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.700, Ratio=1.23x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.686, Ratio=1.22x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.714, Ratio=1.24x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.689, Ratio=1.22x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.694, Ratio=1.22x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.685, Ratio=1.20x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.701, Ratio=1.24x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.681, Ratio=1.21x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.702, Ratio=1.21x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.706, Ratio=1.24x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.701, Ratio=1.23x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.688, Ratio=1.21x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.701, Ratio=1.22x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.698, Ratio=1.22x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.704, Ratio=1.24x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.687, Ratio=1.23x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.696, Ratio=1.22x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.689, Ratio=1.23x, Gap=-3.114

============================================================
Epoch 1/20 completed in 39.1s
Train: Loss=1.9346 (C:1.9346, R:0.0000) Ratio=1.62x
Val:   Loss=1.8926 (C:1.8926, R:0.0000) Ratio=2.20x
‚úÖ New best model saved (Val Loss: 1.8926)
============================================================

Epoch 2 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.711, Ratio=1.22x, Gap=-3.553
Batch   0/537: Loss=1.8951 (C:1.8951, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.696, Ratio=1.19x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.687, Ratio=1.20x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.686, Ratio=1.21x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.701, Ratio=1.21x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.686, Ratio=1.21x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.693, Ratio=1.21x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.728, Ratio=1.22x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.718, Ratio=1.21x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.725, Ratio=1.23x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.722, Ratio=1.21x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.758, Ratio=1.21x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.737, Ratio=1.21x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.735, Ratio=1.22x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.741, Ratio=1.21x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.722, Ratio=1.21x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.732, Ratio=1.23x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.730, Ratio=1.22x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.713, Ratio=1.20x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.703, Ratio=1.19x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.713, Ratio=1.22x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.711, Ratio=1.20x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.693, Ratio=1.20x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.690, Ratio=1.21x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.693, Ratio=1.20x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.692, Ratio=1.21x, Gap=-3.370
Batch  25/537: Loss=1.8986 (C:1.8986, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.694, Ratio=1.21x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.705, Ratio=1.21x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.681, Ratio=1.20x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.703, Ratio=1.21x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.689, Ratio=1.21x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.689, Ratio=1.21x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.716, Ratio=1.22x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.703, Ratio=1.21x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.719, Ratio=1.25x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.725, Ratio=1.22x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.716, Ratio=1.22x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.718, Ratio=1.20x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.728, Ratio=1.21x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.719, Ratio=1.21x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.725, Ratio=1.21x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.703, Ratio=1.21x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.714, Ratio=1.20x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.699, Ratio=1.19x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.709, Ratio=1.20x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.722, Ratio=1.22x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.709, Ratio=1.21x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.716, Ratio=1.23x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.714, Ratio=1.22x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.697, Ratio=1.21x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.716, Ratio=1.20x, Gap=-3.298
Batch  50/537: Loss=1.9061 (C:1.9061, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.726, Ratio=1.20x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.701, Ratio=1.20x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.714, Ratio=1.21x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.737, Ratio=1.23x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.731, Ratio=1.21x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.712, Ratio=1.21x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.716, Ratio=1.20x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.731, Ratio=1.21x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.712, Ratio=1.21x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.708, Ratio=1.21x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.707, Ratio=1.21x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.721, Ratio=1.22x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.711, Ratio=1.21x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.709, Ratio=1.23x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.692, Ratio=1.22x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.694, Ratio=1.22x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.702, Ratio=1.22x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.710, Ratio=1.23x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.715, Ratio=1.22x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.714, Ratio=1.21x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.718, Ratio=1.23x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.716, Ratio=1.22x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.710, Ratio=1.22x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.703, Ratio=1.22x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.709, Ratio=1.19x, Gap=-3.703
Batch  75/537: Loss=1.9094 (C:1.9094, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.733, Ratio=1.22x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.722, Ratio=1.22x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.706, Ratio=1.20x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.712, Ratio=1.21x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.722, Ratio=1.22x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.716, Ratio=1.22x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.705, Ratio=1.19x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.727, Ratio=1.21x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.727, Ratio=1.22x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.719, Ratio=1.20x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.743, Ratio=1.21x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.719, Ratio=1.22x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.712, Ratio=1.21x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.745, Ratio=1.23x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.739, Ratio=1.22x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.717, Ratio=1.21x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.729, Ratio=1.25x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.729, Ratio=1.21x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.714, Ratio=1.19x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.719, Ratio=1.21x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.721, Ratio=1.23x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.691, Ratio=1.21x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.698, Ratio=1.21x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.705, Ratio=1.20x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.713, Ratio=1.23x, Gap=-3.283
Batch 100/537: Loss=1.8897 (C:1.8897, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.698, Ratio=1.22x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.702, Ratio=1.23x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.722, Ratio=1.21x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.704, Ratio=1.21x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.721, Ratio=1.20x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.705, Ratio=1.21x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.712, Ratio=1.22x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.719, Ratio=1.21x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.725, Ratio=1.22x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.717, Ratio=1.21x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.716, Ratio=1.22x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.720, Ratio=1.20x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.719, Ratio=1.22x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.706, Ratio=1.21x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.736, Ratio=1.21x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.710, Ratio=1.22x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.710, Ratio=1.21x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.727, Ratio=1.21x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.739, Ratio=1.23x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.745, Ratio=1.23x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.737, Ratio=1.22x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.745, Ratio=1.24x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.755, Ratio=1.22x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.744, Ratio=1.22x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.753, Ratio=1.21x, Gap=-3.604
Batch 125/537: Loss=1.8952 (C:1.8952, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.733, Ratio=1.20x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.731, Ratio=1.21x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.713, Ratio=1.21x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.723, Ratio=1.22x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.720, Ratio=1.21x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.712, Ratio=1.20x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.720, Ratio=1.23x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.704, Ratio=1.20x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.705, Ratio=1.21x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.687, Ratio=1.22x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.731, Ratio=1.22x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.727, Ratio=1.22x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.712, Ratio=1.20x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.732, Ratio=1.22x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.739, Ratio=1.21x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.735, Ratio=1.21x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.732, Ratio=1.21x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.721, Ratio=1.21x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.730, Ratio=1.23x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.739, Ratio=1.24x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.722, Ratio=1.21x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.730, Ratio=1.21x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.723, Ratio=1.22x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.728, Ratio=1.21x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.742, Ratio=1.23x, Gap=-3.462
Batch 150/537: Loss=1.8895 (C:1.8895, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.714, Ratio=1.21x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.705, Ratio=1.21x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.720, Ratio=1.21x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.730, Ratio=1.22x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.708, Ratio=1.20x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.715, Ratio=1.22x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.715, Ratio=1.21x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.703, Ratio=1.21x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.723, Ratio=1.23x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.696, Ratio=1.21x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.732, Ratio=1.22x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.717, Ratio=1.21x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.701, Ratio=1.22x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.717, Ratio=1.22x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.706, Ratio=1.21x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.711, Ratio=1.22x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.724, Ratio=1.23x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.737, Ratio=1.22x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.724, Ratio=1.22x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.741, Ratio=1.22x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.725, Ratio=1.21x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.738, Ratio=1.22x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.734, Ratio=1.21x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.747, Ratio=1.21x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.748, Ratio=1.22x, Gap=-3.434
Batch 175/537: Loss=1.8941 (C:1.8941, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.731, Ratio=1.23x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.737, Ratio=1.22x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.724, Ratio=1.20x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.726, Ratio=1.22x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.725, Ratio=1.23x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.716, Ratio=1.23x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.714, Ratio=1.21x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.716, Ratio=1.23x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.718, Ratio=1.23x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.731, Ratio=1.22x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.716, Ratio=1.20x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.702, Ratio=1.20x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.734, Ratio=1.23x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.725, Ratio=1.22x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.726, Ratio=1.20x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.720, Ratio=1.20x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.737, Ratio=1.24x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.729, Ratio=1.21x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.738, Ratio=1.21x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.743, Ratio=1.23x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.726, Ratio=1.20x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.740, Ratio=1.23x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.719, Ratio=1.23x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.718, Ratio=1.24x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.715, Ratio=1.22x, Gap=-3.194
Batch 200/537: Loss=1.8927 (C:1.8927, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.715, Ratio=1.20x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.736, Ratio=1.24x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.715, Ratio=1.23x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.712, Ratio=1.23x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.727, Ratio=1.22x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.737, Ratio=1.24x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.723, Ratio=1.20x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.734, Ratio=1.23x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.717, Ratio=1.21x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.733, Ratio=1.22x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.730, Ratio=1.25x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.728, Ratio=1.21x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.749, Ratio=1.20x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.751, Ratio=1.20x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.744, Ratio=1.19x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.730, Ratio=1.21x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.734, Ratio=1.21x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.741, Ratio=1.20x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.737, Ratio=1.24x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.721, Ratio=1.22x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.695, Ratio=1.20x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.724, Ratio=1.23x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.712, Ratio=1.22x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.726, Ratio=1.22x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.706, Ratio=1.21x, Gap=-3.588
Batch 225/537: Loss=1.8989 (C:1.8989, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.726, Ratio=1.23x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.708, Ratio=1.21x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.705, Ratio=1.20x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.714, Ratio=1.22x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.723, Ratio=1.24x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.727, Ratio=1.22x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.725, Ratio=1.22x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.727, Ratio=1.22x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.717, Ratio=1.22x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.712, Ratio=1.25x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.727, Ratio=1.24x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.757, Ratio=1.24x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.730, Ratio=1.21x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.721, Ratio=1.20x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.732, Ratio=1.22x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.738, Ratio=1.21x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.734, Ratio=1.22x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.745, Ratio=1.24x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.737, Ratio=1.24x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.772, Ratio=1.25x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.755, Ratio=1.24x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.765, Ratio=1.24x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.756, Ratio=1.23x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.751, Ratio=1.21x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.763, Ratio=1.23x, Gap=-3.179
Batch 250/537: Loss=1.8868 (C:1.8868, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.761, Ratio=1.24x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.771, Ratio=1.22x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.767, Ratio=1.24x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.749, Ratio=1.20x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.753, Ratio=1.20x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.758, Ratio=1.24x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.734, Ratio=1.21x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.746, Ratio=1.23x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.751, Ratio=1.23x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.714, Ratio=1.22x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.726, Ratio=1.21x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.715, Ratio=1.22x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.702, Ratio=1.21x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.704, Ratio=1.21x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.695, Ratio=1.22x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.707, Ratio=1.23x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.711, Ratio=1.22x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.703, Ratio=1.20x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.700, Ratio=1.20x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.696, Ratio=1.20x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.713, Ratio=1.24x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.737, Ratio=1.22x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.729, Ratio=1.22x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.752, Ratio=1.23x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.741, Ratio=1.23x, Gap=-3.478
Batch 275/537: Loss=1.8902 (C:1.8902, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.733, Ratio=1.19x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.766, Ratio=1.23x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.761, Ratio=1.23x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.740, Ratio=1.22x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.746, Ratio=1.21x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.751, Ratio=1.23x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.734, Ratio=1.22x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.742, Ratio=1.23x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.725, Ratio=1.24x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.697, Ratio=1.21x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.730, Ratio=1.21x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.728, Ratio=1.21x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.699, Ratio=1.22x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.722, Ratio=1.21x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.708, Ratio=1.21x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.715, Ratio=1.24x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.731, Ratio=1.22x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.730, Ratio=1.23x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.734, Ratio=1.22x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.736, Ratio=1.24x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.742, Ratio=1.23x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.746, Ratio=1.23x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.739, Ratio=1.23x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.735, Ratio=1.22x, Gap=-3.527
Batch 300/537: Loss=1.8951 (C:1.8951, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.738, Ratio=1.20x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.734, Ratio=1.21x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.757, Ratio=1.25x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.735, Ratio=1.20x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.729, Ratio=1.22x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.740, Ratio=1.22x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.764, Ratio=1.23x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.741, Ratio=1.23x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.724, Ratio=1.22x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.732, Ratio=1.23x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.718, Ratio=1.22x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.708, Ratio=1.22x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.733, Ratio=1.22x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.724, Ratio=1.21x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.724, Ratio=1.23x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.726, Ratio=1.24x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.708, Ratio=1.21x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.721, Ratio=1.23x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.718, Ratio=1.22x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.734, Ratio=1.25x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.727, Ratio=1.21x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.732, Ratio=1.22x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.701, Ratio=1.21x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.736, Ratio=1.22x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.732, Ratio=1.24x, Gap=-3.333
Batch 325/537: Loss=1.8840 (C:1.8840, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.730, Ratio=1.21x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.750, Ratio=1.24x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.757, Ratio=1.23x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.725, Ratio=1.22x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.736, Ratio=1.20x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.735, Ratio=1.23x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.731, Ratio=1.22x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.729, Ratio=1.22x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.742, Ratio=1.23x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.743, Ratio=1.23x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.733, Ratio=1.21x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.751, Ratio=1.24x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.746, Ratio=1.22x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.723, Ratio=1.20x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.730, Ratio=1.24x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.723, Ratio=1.24x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.743, Ratio=1.24x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.734, Ratio=1.21x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.717, Ratio=1.20x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.737, Ratio=1.23x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.737, Ratio=1.22x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.735, Ratio=1.21x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.770, Ratio=1.27x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.730, Ratio=1.21x, Gap=-3.646
Batch 350/537: Loss=1.8996 (C:1.8996, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.739, Ratio=1.21x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.749, Ratio=1.22x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.744, Ratio=1.20x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.729, Ratio=1.22x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.751, Ratio=1.22x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.752, Ratio=1.23x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.730, Ratio=1.22x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.743, Ratio=1.23x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.738, Ratio=1.23x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.755, Ratio=1.25x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.716, Ratio=1.22x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.736, Ratio=1.23x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.737, Ratio=1.21x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.731, Ratio=1.22x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.735, Ratio=1.24x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.744, Ratio=1.21x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.728, Ratio=1.22x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.739, Ratio=1.21x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.754, Ratio=1.23x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.732, Ratio=1.22x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.739, Ratio=1.23x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.736, Ratio=1.22x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.748, Ratio=1.24x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.734, Ratio=1.22x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.756, Ratio=1.23x, Gap=-3.421
Batch 375/537: Loss=1.8899 (C:1.8899, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.729, Ratio=1.21x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.735, Ratio=1.22x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.746, Ratio=1.23x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.740, Ratio=1.22x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.736, Ratio=1.22x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.730, Ratio=1.22x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.718, Ratio=1.22x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.742, Ratio=1.26x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.712, Ratio=1.23x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.733, Ratio=1.22x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.729, Ratio=1.24x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.732, Ratio=1.22x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.735, Ratio=1.24x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.759, Ratio=1.22x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.755, Ratio=1.22x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.768, Ratio=1.22x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.747, Ratio=1.22x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.747, Ratio=1.23x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.746, Ratio=1.23x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.740, Ratio=1.23x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.746, Ratio=1.23x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.724, Ratio=1.22x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.736, Ratio=1.23x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.734, Ratio=1.24x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.721, Ratio=1.23x, Gap=-3.116
Batch 400/537: Loss=1.8898 (C:1.8898, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.724, Ratio=1.23x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.728, Ratio=1.23x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.713, Ratio=1.23x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.726, Ratio=1.21x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.713, Ratio=1.23x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.727, Ratio=1.22x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.736, Ratio=1.22x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.741, Ratio=1.24x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.724, Ratio=1.23x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.726, Ratio=1.22x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.758, Ratio=1.22x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.762, Ratio=1.26x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.737, Ratio=1.22x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.756, Ratio=1.22x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.754, Ratio=1.24x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.739, Ratio=1.21x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.734, Ratio=1.22x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.727, Ratio=1.21x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.750, Ratio=1.23x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.739, Ratio=1.24x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.725, Ratio=1.22x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.724, Ratio=1.23x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.736, Ratio=1.24x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.738, Ratio=1.23x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.733, Ratio=1.22x, Gap=-3.368
Batch 425/537: Loss=1.8933 (C:1.8933, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.723, Ratio=1.23x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.730, Ratio=1.23x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.749, Ratio=1.23x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.738, Ratio=1.23x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.741, Ratio=1.23x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.738, Ratio=1.24x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.745, Ratio=1.24x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.765, Ratio=1.25x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.753, Ratio=1.24x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.739, Ratio=1.22x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.722, Ratio=1.23x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.745, Ratio=1.24x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.727, Ratio=1.21x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.734, Ratio=1.22x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.731, Ratio=1.22x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.717, Ratio=1.20x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.746, Ratio=1.22x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.754, Ratio=1.25x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.729, Ratio=1.23x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.727, Ratio=1.21x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.756, Ratio=1.22x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.750, Ratio=1.23x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.755, Ratio=1.23x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.764, Ratio=1.23x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.756, Ratio=1.21x, Gap=-3.297
Batch 450/537: Loss=1.8964 (C:1.8964, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.742, Ratio=1.24x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.26x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.740, Ratio=1.22x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.754, Ratio=1.24x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.746, Ratio=1.22x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.747, Ratio=1.24x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.745, Ratio=1.25x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.736, Ratio=1.26x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.727, Ratio=1.20x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.737, Ratio=1.23x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.745, Ratio=1.23x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.751, Ratio=1.24x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.746, Ratio=1.23x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.744, Ratio=1.24x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.741, Ratio=1.22x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.716, Ratio=1.23x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.732, Ratio=1.24x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.735, Ratio=1.23x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.725, Ratio=1.23x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.721, Ratio=1.24x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.727, Ratio=1.22x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.744, Ratio=1.24x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.738, Ratio=1.23x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.724, Ratio=1.21x, Gap=-3.492
Batch 475/537: Loss=1.8981 (C:1.8981, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.738, Ratio=1.23x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.737, Ratio=1.23x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.754, Ratio=1.25x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.741, Ratio=1.22x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.750, Ratio=1.25x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.751, Ratio=1.24x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.735, Ratio=1.21x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.745, Ratio=1.24x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.748, Ratio=1.24x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.745, Ratio=1.23x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.731, Ratio=1.22x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.753, Ratio=1.24x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.751, Ratio=1.23x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.747, Ratio=1.22x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.750, Ratio=1.22x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.763, Ratio=1.22x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.759, Ratio=1.22x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.750, Ratio=1.22x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.740, Ratio=1.23x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.760, Ratio=1.25x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.734, Ratio=1.23x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.726, Ratio=1.22x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.736, Ratio=1.22x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.723, Ratio=1.25x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.712, Ratio=1.21x, Gap=-3.224
Batch 500/537: Loss=1.9000 (C:1.9000, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.723, Ratio=1.21x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.738, Ratio=1.25x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.711, Ratio=1.23x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.729, Ratio=1.23x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.722, Ratio=1.24x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.716, Ratio=1.24x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.723, Ratio=1.23x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.728, Ratio=1.25x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.725, Ratio=1.23x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.725, Ratio=1.25x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.739, Ratio=1.26x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.744, Ratio=1.24x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.730, Ratio=1.23x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.726, Ratio=1.24x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.752, Ratio=1.21x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.754, Ratio=1.23x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.765, Ratio=1.23x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.753, Ratio=1.23x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.750, Ratio=1.21x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.734, Ratio=1.23x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.742, Ratio=1.22x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.737, Ratio=1.22x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.758, Ratio=1.25x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.735, Ratio=1.22x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.741, Ratio=1.23x, Gap=-3.472
Batch 525/537: Loss=1.8898 (C:1.8898, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.742, Ratio=1.22x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.740, Ratio=1.22x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.733, Ratio=1.22x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.735, Ratio=1.24x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.741, Ratio=1.25x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.726, Ratio=1.21x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.735, Ratio=1.23x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.733, Ratio=1.24x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.734, Ratio=1.23x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.719, Ratio=1.21x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.741, Ratio=1.25x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.746, Ratio=1.25x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.740, Ratio=1.24x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.736, Ratio=1.24x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.745, Ratio=1.26x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.746, Ratio=1.26x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.741, Ratio=1.26x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.743, Ratio=1.26x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.736, Ratio=1.27x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.744, Ratio=1.25x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.751, Ratio=1.27x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.754, Ratio=1.24x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.743, Ratio=1.26x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.737, Ratio=1.24x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.754, Ratio=1.26x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.753, Ratio=1.26x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.759, Ratio=1.28x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.730, Ratio=1.23x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.741, Ratio=1.26x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.732, Ratio=1.25x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.733, Ratio=1.24x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.741, Ratio=1.26x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.732, Ratio=1.25x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.739, Ratio=1.24x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.735, Ratio=1.25x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.734, Ratio=1.24x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.731, Ratio=1.27x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.754, Ratio=1.26x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.727, Ratio=1.24x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.744, Ratio=1.27x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.731, Ratio=1.26x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.740, Ratio=1.26x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.735, Ratio=1.24x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.756, Ratio=1.26x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.736, Ratio=1.24x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.742, Ratio=1.26x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.754, Ratio=1.27x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.730, Ratio=1.24x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.756, Ratio=1.27x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.736, Ratio=1.25x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.746, Ratio=1.25x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.732, Ratio=1.23x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.742, Ratio=1.27x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.751, Ratio=1.25x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.726, Ratio=1.25x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.730, Ratio=1.24x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.753, Ratio=1.27x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.742, Ratio=1.25x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.749, Ratio=1.26x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.750, Ratio=1.26x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.736, Ratio=1.26x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.717, Ratio=1.23x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.757, Ratio=1.29x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.742, Ratio=1.26x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.735, Ratio=1.25x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.750, Ratio=1.25x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.741, Ratio=1.24x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.736, Ratio=1.25x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.738, Ratio=1.27x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.743, Ratio=1.24x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.734, Ratio=1.24x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.729, Ratio=1.24x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.724, Ratio=1.25x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.752, Ratio=1.26x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.730, Ratio=1.23x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.739, Ratio=1.23x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.738, Ratio=1.27x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.752, Ratio=1.26x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.763, Ratio=1.27x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.734, Ratio=1.25x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.736, Ratio=1.27x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.756, Ratio=1.28x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.732, Ratio=1.25x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.739, Ratio=1.23x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.740, Ratio=1.23x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.748, Ratio=1.26x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.750, Ratio=1.27x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.729, Ratio=1.24x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.746, Ratio=1.27x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.736, Ratio=1.23x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.723, Ratio=1.23x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.738, Ratio=1.25x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.740, Ratio=1.27x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.729, Ratio=1.24x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.753, Ratio=1.27x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.736, Ratio=1.24x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.736, Ratio=1.26x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.742, Ratio=1.25x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.730, Ratio=1.26x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.740, Ratio=1.26x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.741, Ratio=1.25x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.752, Ratio=1.26x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.742, Ratio=1.24x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.752, Ratio=1.26x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.743, Ratio=1.25x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.749, Ratio=1.26x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.751, Ratio=1.27x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.756, Ratio=1.25x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.726, Ratio=1.25x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.737, Ratio=1.26x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.734, Ratio=1.25x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.743, Ratio=1.25x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.729, Ratio=1.24x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.749, Ratio=1.27x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.735, Ratio=1.22x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.757, Ratio=1.28x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.738, Ratio=1.26x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.723, Ratio=1.25x, Gap=-3.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.734, Ratio=1.24x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.729, Ratio=1.24x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.746, Ratio=1.25x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.748, Ratio=1.25x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.750, Ratio=1.26x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.747, Ratio=1.24x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.748, Ratio=1.26x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.719, Ratio=1.24x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.744, Ratio=1.26x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.738, Ratio=1.27x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.737, Ratio=1.26x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.735, Ratio=1.24x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.749, Ratio=1.26x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.740, Ratio=1.26x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.747, Ratio=1.26x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.750, Ratio=1.26x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.740, Ratio=1.25x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.732, Ratio=1.25x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.745, Ratio=1.28x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.726, Ratio=1.24x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.743, Ratio=1.25x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.745, Ratio=1.28x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.738, Ratio=1.24x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.743, Ratio=1.27x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.752, Ratio=1.26x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.749, Ratio=1.26x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.750, Ratio=1.26x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.746, Ratio=1.26x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.725, Ratio=1.24x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.738, Ratio=1.24x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.742, Ratio=1.25x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.731, Ratio=1.25x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.735, Ratio=1.27x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.739, Ratio=1.26x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.747, Ratio=1.26x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.738, Ratio=1.24x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.730, Ratio=1.24x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.741, Ratio=1.27x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.734, Ratio=1.25x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.730, Ratio=1.24x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.747, Ratio=1.28x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.737, Ratio=1.24x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.760, Ratio=1.27x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.735, Ratio=1.24x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.734, Ratio=1.26x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.741, Ratio=1.24x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.751, Ratio=1.25x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.739, Ratio=1.25x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.741, Ratio=1.27x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.732, Ratio=1.24x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.731, Ratio=1.24x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.743, Ratio=1.27x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.740, Ratio=1.27x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.745, Ratio=1.25x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.735, Ratio=1.25x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.742, Ratio=1.26x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.746, Ratio=1.26x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.745, Ratio=1.27x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.753, Ratio=1.28x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.734, Ratio=1.24x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.745, Ratio=1.26x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.743, Ratio=1.27x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.739, Ratio=1.26x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.737, Ratio=1.25x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.738, Ratio=1.28x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.754, Ratio=1.28x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.742, Ratio=1.26x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.740, Ratio=1.25x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.730, Ratio=1.26x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.751, Ratio=1.26x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.739, Ratio=1.26x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.749, Ratio=1.25x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.744, Ratio=1.26x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.719, Ratio=1.25x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.729, Ratio=1.24x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.738, Ratio=1.24x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.747, Ratio=1.27x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.736, Ratio=1.26x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.747, Ratio=1.26x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.748, Ratio=1.26x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.741, Ratio=1.29x, Gap=-3.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.723, Ratio=1.24x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.756, Ratio=1.26x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.742, Ratio=1.25x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.753, Ratio=1.26x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.748, Ratio=1.25x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.737, Ratio=1.24x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.741, Ratio=1.25x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.767, Ratio=1.29x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.739, Ratio=1.25x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.737, Ratio=1.26x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.742, Ratio=1.26x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.725, Ratio=1.24x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.751, Ratio=1.26x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.733, Ratio=1.24x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.738, Ratio=1.25x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.746, Ratio=1.27x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.730, Ratio=1.24x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.735, Ratio=1.27x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.742, Ratio=1.27x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.762, Ratio=1.26x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.738, Ratio=1.25x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.733, Ratio=1.26x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.743, Ratio=1.25x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.742, Ratio=1.25x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.752, Ratio=1.25x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.739, Ratio=1.27x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.743, Ratio=1.24x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.763, Ratio=1.28x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.745, Ratio=1.27x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.723, Ratio=1.25x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.748, Ratio=1.25x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.733, Ratio=1.25x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.729, Ratio=1.26x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.734, Ratio=1.25x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.754, Ratio=1.27x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.732, Ratio=1.24x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.748, Ratio=1.27x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.724, Ratio=1.22x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.737, Ratio=1.25x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.733, Ratio=1.26x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.729, Ratio=1.25x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.736, Ratio=1.25x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.728, Ratio=1.25x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.736, Ratio=1.27x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.729, Ratio=1.25x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.743, Ratio=1.26x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.744, Ratio=1.26x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.749, Ratio=1.25x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.744, Ratio=1.24x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.735, Ratio=1.22x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.729, Ratio=1.25x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.734, Ratio=1.26x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.741, Ratio=1.26x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.731, Ratio=1.27x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.721, Ratio=1.25x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.750, Ratio=1.27x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.724, Ratio=1.25x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.738, Ratio=1.25x, Gap=-3.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.755, Ratio=1.27x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.725, Ratio=1.24x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.736, Ratio=1.24x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.739, Ratio=1.24x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.744, Ratio=1.25x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.736, Ratio=1.24x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.743, Ratio=1.26x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.754, Ratio=1.25x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.748, Ratio=1.26x, Gap=-3.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.747, Ratio=1.26x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.736, Ratio=1.25x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.730, Ratio=1.24x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.736, Ratio=1.26x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.744, Ratio=1.25x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.754, Ratio=1.25x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.748, Ratio=1.28x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.733, Ratio=1.23x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.748, Ratio=1.25x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.743, Ratio=1.25x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.729, Ratio=1.25x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.729, Ratio=1.24x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.742, Ratio=1.26x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.746, Ratio=1.26x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.742, Ratio=1.27x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.729, Ratio=1.25x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.749, Ratio=1.27x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.734, Ratio=1.25x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.735, Ratio=1.23x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.746, Ratio=1.25x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.739, Ratio=1.24x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.744, Ratio=1.24x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.719, Ratio=1.24x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.731, Ratio=1.25x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.754, Ratio=1.27x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.729, Ratio=1.24x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.758, Ratio=1.26x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.736, Ratio=1.25x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.748, Ratio=1.25x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.730, Ratio=1.25x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.738, Ratio=1.25x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.726, Ratio=1.26x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.748, Ratio=1.26x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.732, Ratio=1.27x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.746, Ratio=1.23x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.733, Ratio=1.25x, Gap=-3.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.736, Ratio=1.23x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.744, Ratio=1.26x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.742, Ratio=1.24x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.736, Ratio=1.25x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.739, Ratio=1.26x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.739, Ratio=1.25x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.745, Ratio=1.25x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.750, Ratio=1.24x, Gap=-3.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.741, Ratio=1.26x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.738, Ratio=1.25x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.746, Ratio=1.25x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.745, Ratio=1.26x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.754, Ratio=1.26x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.744, Ratio=1.26x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.746, Ratio=1.26x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.731, Ratio=1.23x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.736, Ratio=1.24x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.741, Ratio=1.25x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.729, Ratio=1.24x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.746, Ratio=1.27x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.751, Ratio=1.30x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.739, Ratio=1.27x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.739, Ratio=1.26x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.743, Ratio=1.25x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.740, Ratio=1.27x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.738, Ratio=1.25x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.757, Ratio=1.27x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.734, Ratio=1.24x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.733, Ratio=1.25x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.740, Ratio=1.25x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.748, Ratio=1.26x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.744, Ratio=1.25x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.740, Ratio=1.27x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.724, Ratio=1.25x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.737, Ratio=1.25x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.735, Ratio=1.24x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.733, Ratio=1.24x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.742, Ratio=1.27x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.734, Ratio=1.25x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.742, Ratio=1.26x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.731, Ratio=1.26x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.734, Ratio=1.26x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.745, Ratio=1.26x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.726, Ratio=1.24x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.743, Ratio=1.25x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.747, Ratio=1.26x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.751, Ratio=1.24x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.758, Ratio=1.27x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.738, Ratio=1.25x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.732, Ratio=1.25x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.741, Ratio=1.24x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.744, Ratio=1.26x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.733, Ratio=1.24x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.730, Ratio=1.24x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.723, Ratio=1.24x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.739, Ratio=1.25x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.756, Ratio=1.25x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.746, Ratio=1.26x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.736, Ratio=1.25x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.728, Ratio=1.25x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.723, Ratio=1.24x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.740, Ratio=1.26x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.755, Ratio=1.26x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.742, Ratio=1.25x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.735, Ratio=1.26x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.743, Ratio=1.24x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.735, Ratio=1.24x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.735, Ratio=1.25x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.721, Ratio=1.22x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.750, Ratio=1.26x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.728, Ratio=1.25x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.747, Ratio=1.24x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.748, Ratio=1.28x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.744, Ratio=1.27x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.734, Ratio=1.25x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.738, Ratio=1.25x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.754, Ratio=1.26x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.732, Ratio=1.26x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.750, Ratio=1.26x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.755, Ratio=1.27x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.741, Ratio=1.27x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.740, Ratio=1.25x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.746, Ratio=1.26x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.739, Ratio=1.25x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.743, Ratio=1.25x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.736, Ratio=1.26x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.747, Ratio=1.26x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.719, Ratio=1.23x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.756, Ratio=1.27x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.741, Ratio=1.25x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.738, Ratio=1.26x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.737, Ratio=1.26x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.740, Ratio=1.27x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.734, Ratio=1.25x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.731, Ratio=1.24x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.743, Ratio=1.26x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.737, Ratio=1.24x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.733, Ratio=1.25x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.730, Ratio=1.25x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.726, Ratio=1.25x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.739, Ratio=1.26x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.732, Ratio=1.24x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.750, Ratio=1.26x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.750, Ratio=1.26x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.756, Ratio=1.26x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.746, Ratio=1.25x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.746, Ratio=1.26x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.735, Ratio=1.25x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.752, Ratio=1.25x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.742, Ratio=1.25x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.747, Ratio=1.28x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.751, Ratio=1.27x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.740, Ratio=1.25x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.736, Ratio=1.24x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.729, Ratio=1.26x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.748, Ratio=1.28x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.736, Ratio=1.25x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.739, Ratio=1.25x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.740, Ratio=1.27x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.740, Ratio=1.26x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.735, Ratio=1.25x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.734, Ratio=1.25x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.757, Ratio=1.26x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.733, Ratio=1.25x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.733, Ratio=1.25x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.742, Ratio=1.24x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.745, Ratio=1.26x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.742, Ratio=1.25x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.737, Ratio=1.24x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.730, Ratio=1.24x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.736, Ratio=1.27x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.758, Ratio=1.25x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.744, Ratio=1.26x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.739, Ratio=1.25x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.740, Ratio=1.23x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.748, Ratio=1.25x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.733, Ratio=1.29x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.752, Ratio=1.25x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.746, Ratio=1.25x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.724, Ratio=1.24x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.734, Ratio=1.24x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.736, Ratio=1.28x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.748, Ratio=1.26x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.732, Ratio=1.24x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.731, Ratio=1.24x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.735, Ratio=1.25x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.745, Ratio=1.25x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.750, Ratio=1.26x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.745, Ratio=1.26x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.734, Ratio=1.26x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.739, Ratio=1.26x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.738, Ratio=1.26x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.743, Ratio=1.25x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.732, Ratio=1.24x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.744, Ratio=1.24x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.730, Ratio=1.24x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.755, Ratio=1.26x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.744, Ratio=1.24x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.743, Ratio=1.22x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.746, Ratio=1.24x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.746, Ratio=1.27x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.736, Ratio=1.24x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.742, Ratio=1.26x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.744, Ratio=1.26x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.734, Ratio=1.27x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.730, Ratio=1.25x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.748, Ratio=1.25x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.762, Ratio=1.28x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.746, Ratio=1.24x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.746, Ratio=1.24x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.744, Ratio=1.26x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.728, Ratio=1.25x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.750, Ratio=1.28x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.725, Ratio=1.25x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.749, Ratio=1.23x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.734, Ratio=1.25x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.742, Ratio=1.24x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.742, Ratio=1.25x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.741, Ratio=1.27x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.748, Ratio=1.27x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.734, Ratio=1.25x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.723, Ratio=1.23x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.741, Ratio=1.25x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.749, Ratio=1.24x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.743, Ratio=1.26x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.752, Ratio=1.26x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.734, Ratio=1.26x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.747, Ratio=1.27x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.740, Ratio=1.25x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.724, Ratio=1.24x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.750, Ratio=1.27x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.746, Ratio=1.25x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.752, Ratio=1.26x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.749, Ratio=1.27x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.717, Ratio=1.24x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.729, Ratio=1.25x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.752, Ratio=1.27x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.738, Ratio=1.23x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.738, Ratio=1.27x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.747, Ratio=1.25x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.729, Ratio=1.25x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.738, Ratio=1.24x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.733, Ratio=1.27x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.733, Ratio=1.25x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.735, Ratio=1.25x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.742, Ratio=1.28x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.730, Ratio=1.24x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.744, Ratio=1.26x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.732, Ratio=1.25x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.741, Ratio=1.25x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.739, Ratio=1.24x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.739, Ratio=1.28x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.737, Ratio=1.25x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.749, Ratio=1.27x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.730, Ratio=1.24x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.742, Ratio=1.25x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.733, Ratio=1.25x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.761, Ratio=1.26x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.737, Ratio=1.25x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.722, Ratio=1.23x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.741, Ratio=1.26x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.735, Ratio=1.23x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.739, Ratio=1.25x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.739, Ratio=1.25x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.743, Ratio=1.26x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.745, Ratio=1.26x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.727, Ratio=1.25x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.750, Ratio=1.25x, Gap=-3.148

============================================================
Epoch 2/20 completed in 32.1s
Train: Loss=1.8929 (C:1.8929, R:0.0000) Ratio=2.18x
Val:   Loss=1.8757 (C:1.8757, R:0.0000) Ratio=2.53x
‚úÖ New best model saved (Val Loss: 1.8757)
============================================================

Epoch 3 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.747, Ratio=1.24x, Gap=-3.523
Batch   0/537: Loss=1.8846 (C:1.8846, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.740, Ratio=1.25x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.749, Ratio=1.26x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.735, Ratio=1.23x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.743, Ratio=1.24x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.755, Ratio=1.26x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.751, Ratio=1.25x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.755, Ratio=1.23x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.754, Ratio=1.24x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.769, Ratio=1.25x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.769, Ratio=1.23x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.750, Ratio=1.24x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.755, Ratio=1.23x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.750, Ratio=1.26x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.740, Ratio=1.23x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.754, Ratio=1.26x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.761, Ratio=1.25x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.751, Ratio=1.25x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.753, Ratio=1.26x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.739, Ratio=1.25x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.735, Ratio=1.23x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.744, Ratio=1.24x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.730, Ratio=1.22x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.751, Ratio=1.22x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.764, Ratio=1.23x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.760, Ratio=1.23x, Gap=-3.313
Batch  25/537: Loss=1.8869 (C:1.8869, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.766, Ratio=1.24x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.751, Ratio=1.22x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.747, Ratio=1.23x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.757, Ratio=1.24x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.730, Ratio=1.24x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.744, Ratio=1.23x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.714, Ratio=1.22x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.735, Ratio=1.23x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.725, Ratio=1.24x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.737, Ratio=1.22x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.746, Ratio=1.22x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.740, Ratio=1.24x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.760, Ratio=1.25x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.762, Ratio=1.24x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.751, Ratio=1.26x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.756, Ratio=1.23x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.737, Ratio=1.24x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.753, Ratio=1.23x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.741, Ratio=1.22x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.771, Ratio=1.27x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.786, Ratio=1.27x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.776, Ratio=1.25x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.768, Ratio=1.24x, Gap=-3.725
Batch  50/537: Loss=1.8847 (C:1.8847, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.763, Ratio=1.24x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.751, Ratio=1.23x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.765, Ratio=1.23x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.773, Ratio=1.24x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.765, Ratio=1.24x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.760, Ratio=1.23x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.776, Ratio=1.25x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.767, Ratio=1.23x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.755, Ratio=1.23x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.758, Ratio=1.24x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.748, Ratio=1.26x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.766, Ratio=1.22x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.778, Ratio=1.26x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.747, Ratio=1.24x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.744, Ratio=1.22x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.768, Ratio=1.26x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.740, Ratio=1.25x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.751, Ratio=1.26x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.755, Ratio=1.25x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.760, Ratio=1.25x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.762, Ratio=1.24x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.772, Ratio=1.25x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.758, Ratio=1.24x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.751, Ratio=1.25x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.773, Ratio=1.24x, Gap=-3.301
Batch  75/537: Loss=1.8824 (C:1.8824, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.766, Ratio=1.24x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.770, Ratio=1.25x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.747, Ratio=1.22x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.767, Ratio=1.23x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.761, Ratio=1.24x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.762, Ratio=1.24x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.767, Ratio=1.25x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.750, Ratio=1.23x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.744, Ratio=1.24x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.758, Ratio=1.23x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.756, Ratio=1.23x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.751, Ratio=1.24x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.742, Ratio=1.24x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.755, Ratio=1.24x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.756, Ratio=1.22x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.759, Ratio=1.24x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.747, Ratio=1.24x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.769, Ratio=1.23x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.763, Ratio=1.22x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.741, Ratio=1.25x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.754, Ratio=1.25x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.763, Ratio=1.26x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.761, Ratio=1.25x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.739, Ratio=1.21x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.751, Ratio=1.23x, Gap=-3.573
Batch 100/537: Loss=1.8864 (C:1.8864, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.768, Ratio=1.25x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.762, Ratio=1.24x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.750, Ratio=1.23x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.762, Ratio=1.24x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.766, Ratio=1.24x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.771, Ratio=1.24x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.769, Ratio=1.25x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.773, Ratio=1.25x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.763, Ratio=1.23x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.753, Ratio=1.23x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.770, Ratio=1.26x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.756, Ratio=1.25x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.739, Ratio=1.25x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.733, Ratio=1.24x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.730, Ratio=1.24x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.747, Ratio=1.24x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.746, Ratio=1.26x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.736, Ratio=1.23x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.723, Ratio=1.23x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.746, Ratio=1.23x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.753, Ratio=1.24x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.761, Ratio=1.25x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.744, Ratio=1.23x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.759, Ratio=1.24x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.763, Ratio=1.24x, Gap=-3.249
Batch 125/537: Loss=1.8813 (C:1.8813, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.769, Ratio=1.24x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.766, Ratio=1.26x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.768, Ratio=1.25x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.26x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.766, Ratio=1.25x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.778, Ratio=1.26x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.775, Ratio=1.24x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.763, Ratio=1.25x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.771, Ratio=1.26x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.767, Ratio=1.25x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.787, Ratio=1.27x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.760, Ratio=1.25x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.756, Ratio=1.24x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.762, Ratio=1.23x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.759, Ratio=1.27x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.766, Ratio=1.27x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.771, Ratio=1.25x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.749, Ratio=1.23x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.749, Ratio=1.23x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.757, Ratio=1.24x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.774, Ratio=1.24x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.757, Ratio=1.25x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.746, Ratio=1.23x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.769, Ratio=1.26x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.789, Ratio=1.27x, Gap=-3.331
Batch 150/537: Loss=1.8681 (C:1.8681, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.773, Ratio=1.25x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.761, Ratio=1.25x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.773, Ratio=1.24x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.762, Ratio=1.24x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.752, Ratio=1.25x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.753, Ratio=1.24x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.766, Ratio=1.24x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.754, Ratio=1.23x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.741, Ratio=1.24x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.750, Ratio=1.24x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.720, Ratio=1.23x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.728, Ratio=1.22x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.720, Ratio=1.23x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.731, Ratio=1.24x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.731, Ratio=1.23x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.728, Ratio=1.24x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.751, Ratio=1.26x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.746, Ratio=1.24x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.753, Ratio=1.26x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.765, Ratio=1.25x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.763, Ratio=1.23x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.774, Ratio=1.26x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.775, Ratio=1.25x, Gap=-3.929
Batch 175/537: Loss=1.8784 (C:1.8784, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=0.776, Ratio=1.23x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.786, Ratio=1.25x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.772, Ratio=1.24x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.777, Ratio=1.25x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.767, Ratio=1.24x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.764, Ratio=1.26x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.774, Ratio=1.24x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.764, Ratio=1.23x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.743, Ratio=1.22x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.751, Ratio=1.24x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.752, Ratio=1.25x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.750, Ratio=1.25x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.735, Ratio=1.22x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.746, Ratio=1.24x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.733, Ratio=1.23x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.748, Ratio=1.23x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.738, Ratio=1.25x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.739, Ratio=1.24x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.744, Ratio=1.24x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.752, Ratio=1.25x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.747, Ratio=1.24x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.769, Ratio=1.25x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.765, Ratio=1.24x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.775, Ratio=1.25x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.790, Ratio=1.25x, Gap=-3.384
Batch 200/537: Loss=1.8774 (C:1.8774, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.781, Ratio=1.24x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=0.795, Ratio=1.24x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.764, Ratio=1.24x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.782, Ratio=1.25x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.761, Ratio=1.26x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.764, Ratio=1.23x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.761, Ratio=1.23x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.763, Ratio=1.25x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.782, Ratio=1.24x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.749, Ratio=1.23x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.730, Ratio=1.25x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.743, Ratio=1.23x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.736, Ratio=1.25x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.736, Ratio=1.24x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.720, Ratio=1.22x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.743, Ratio=1.24x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.747, Ratio=1.25x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.752, Ratio=1.26x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.730, Ratio=1.24x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.731, Ratio=1.24x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.752, Ratio=1.24x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.747, Ratio=1.23x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.746, Ratio=1.22x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.762, Ratio=1.27x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.745, Ratio=1.23x, Gap=-3.532
Batch 225/537: Loss=1.8920 (C:1.8920, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.782, Ratio=1.25x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.772, Ratio=1.24x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=0.779, Ratio=1.24x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.777, Ratio=1.28x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.785, Ratio=1.26x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=0.787, Ratio=1.24x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=0.792, Ratio=1.24x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.770, Ratio=1.23x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.786, Ratio=1.25x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.779, Ratio=1.26x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.759, Ratio=1.23x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.761, Ratio=1.23x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.768, Ratio=1.26x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.773, Ratio=1.25x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.743, Ratio=1.25x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.766, Ratio=1.25x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.775, Ratio=1.25x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.741, Ratio=1.22x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.775, Ratio=1.26x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.767, Ratio=1.24x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.764, Ratio=1.22x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.775, Ratio=1.26x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.751, Ratio=1.24x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.765, Ratio=1.23x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.765, Ratio=1.24x, Gap=-3.654
Batch 250/537: Loss=1.8852 (C:1.8852, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.770, Ratio=1.22x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.749, Ratio=1.25x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.769, Ratio=1.24x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.774, Ratio=1.22x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.758, Ratio=1.24x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.773, Ratio=1.24x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.772, Ratio=1.24x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.768, Ratio=1.26x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.745, Ratio=1.24x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.760, Ratio=1.25x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.761, Ratio=1.24x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.754, Ratio=1.25x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.745, Ratio=1.23x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.754, Ratio=1.27x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.764, Ratio=1.27x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.746, Ratio=1.24x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.758, Ratio=1.24x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.755, Ratio=1.24x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.747, Ratio=1.23x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.749, Ratio=1.24x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.746, Ratio=1.22x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.746, Ratio=1.24x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.757, Ratio=1.25x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.764, Ratio=1.25x, Gap=-3.333
Batch 275/537: Loss=1.8798 (C:1.8798, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.761, Ratio=1.24x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.759, Ratio=1.25x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.779, Ratio=1.23x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.769, Ratio=1.25x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.764, Ratio=1.24x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.762, Ratio=1.25x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.773, Ratio=1.26x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.772, Ratio=1.26x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.764, Ratio=1.25x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.776, Ratio=1.27x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.753, Ratio=1.24x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.770, Ratio=1.27x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.769, Ratio=1.26x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.761, Ratio=1.24x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.741, Ratio=1.24x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.760, Ratio=1.23x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.749, Ratio=1.22x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.755, Ratio=1.24x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.770, Ratio=1.26x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.757, Ratio=1.24x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.769, Ratio=1.24x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.769, Ratio=1.24x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.758, Ratio=1.25x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.774, Ratio=1.23x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.760, Ratio=1.25x, Gap=-3.519
Batch 300/537: Loss=1.8771 (C:1.8771, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.762, Ratio=1.24x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.759, Ratio=1.24x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.767, Ratio=1.25x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.768, Ratio=1.25x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.768, Ratio=1.24x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.773, Ratio=1.27x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.790, Ratio=1.27x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.772, Ratio=1.24x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.772, Ratio=1.25x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.771, Ratio=1.24x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.781, Ratio=1.24x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.779, Ratio=1.23x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.774, Ratio=1.26x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.753, Ratio=1.22x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.760, Ratio=1.25x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.752, Ratio=1.24x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.752, Ratio=1.24x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.750, Ratio=1.25x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.762, Ratio=1.28x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.743, Ratio=1.27x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.743, Ratio=1.23x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.744, Ratio=1.24x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.746, Ratio=1.26x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.733, Ratio=1.24x, Gap=-3.571
Batch 325/537: Loss=1.8865 (C:1.8865, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.745, Ratio=1.25x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.749, Ratio=1.25x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.741, Ratio=1.23x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.744, Ratio=1.25x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.755, Ratio=1.24x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.757, Ratio=1.24x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.762, Ratio=1.25x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.767, Ratio=1.22x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.738, Ratio=1.25x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.755, Ratio=1.25x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.754, Ratio=1.25x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.764, Ratio=1.24x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.778, Ratio=1.26x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.766, Ratio=1.26x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.758, Ratio=1.23x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.782, Ratio=1.25x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=0.804, Ratio=1.26x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=0.790, Ratio=1.23x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=0.786, Ratio=1.23x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.773, Ratio=1.23x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.783, Ratio=1.24x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=0.788, Ratio=1.23x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=0.777, Ratio=1.24x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.779, Ratio=1.25x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.766, Ratio=1.24x, Gap=-3.777
Batch 350/537: Loss=1.8819 (C:1.8819, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.776, Ratio=1.25x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.768, Ratio=1.23x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.769, Ratio=1.25x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.752, Ratio=1.22x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.746, Ratio=1.22x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.743, Ratio=1.24x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.744, Ratio=1.25x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.746, Ratio=1.26x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.723, Ratio=1.24x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.742, Ratio=1.24x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.731, Ratio=1.23x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.729, Ratio=1.24x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.728, Ratio=1.25x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.755, Ratio=1.24x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.737, Ratio=1.23x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.748, Ratio=1.27x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.25x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.777, Ratio=1.27x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.776, Ratio=1.26x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.768, Ratio=1.25x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.759, Ratio=1.24x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.781, Ratio=1.27x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=0.783, Ratio=1.23x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.778, Ratio=1.24x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.764, Ratio=1.24x, Gap=-3.674
Batch 375/537: Loss=1.8811 (C:1.8811, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.770, Ratio=1.25x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.758, Ratio=1.24x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.765, Ratio=1.25x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.766, Ratio=1.25x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.25x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.759, Ratio=1.25x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.761, Ratio=1.24x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.749, Ratio=1.23x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.775, Ratio=1.27x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.748, Ratio=1.23x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.747, Ratio=1.22x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.751, Ratio=1.25x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.749, Ratio=1.25x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.755, Ratio=1.24x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.750, Ratio=1.26x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.752, Ratio=1.24x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.756, Ratio=1.24x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.774, Ratio=1.23x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.765, Ratio=1.26x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.771, Ratio=1.25x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.756, Ratio=1.26x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.770, Ratio=1.26x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.766, Ratio=1.25x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.757, Ratio=1.22x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.771, Ratio=1.26x, Gap=-3.440
Batch 400/537: Loss=1.8749 (C:1.8749, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.764, Ratio=1.24x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=0.782, Ratio=1.24x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.770, Ratio=1.23x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.747, Ratio=1.24x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.768, Ratio=1.24x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.756, Ratio=1.24x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.766, Ratio=1.25x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.767, Ratio=1.24x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.762, Ratio=1.27x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.773, Ratio=1.25x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.774, Ratio=1.26x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.743, Ratio=1.23x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.751, Ratio=1.24x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.753, Ratio=1.24x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.762, Ratio=1.25x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.744, Ratio=1.25x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.762, Ratio=1.24x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.755, Ratio=1.25x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.765, Ratio=1.25x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.744, Ratio=1.23x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.762, Ratio=1.24x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.757, Ratio=1.26x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.331
Batch 425/537: Loss=1.8770 (C:1.8770, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.753, Ratio=1.23x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.761, Ratio=1.25x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.735, Ratio=1.24x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.759, Ratio=1.25x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.783, Ratio=1.28x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.780, Ratio=1.25x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.760, Ratio=1.24x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.739, Ratio=1.23x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.759, Ratio=1.23x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.769, Ratio=1.26x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.764, Ratio=1.24x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.763, Ratio=1.24x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.754, Ratio=1.24x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.760, Ratio=1.24x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.764, Ratio=1.24x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.778, Ratio=1.26x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.769, Ratio=1.24x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.770, Ratio=1.25x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.759, Ratio=1.25x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.764, Ratio=1.24x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.739, Ratio=1.24x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.762, Ratio=1.26x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.751, Ratio=1.24x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.744, Ratio=1.24x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.321
Batch 450/537: Loss=1.8764 (C:1.8764, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.753, Ratio=1.24x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.752, Ratio=1.23x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.770, Ratio=1.26x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.778, Ratio=1.24x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.766, Ratio=1.26x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.779, Ratio=1.25x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.785, Ratio=1.28x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.770, Ratio=1.25x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.780, Ratio=1.25x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.768, Ratio=1.25x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.759, Ratio=1.24x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.761, Ratio=1.24x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.744, Ratio=1.24x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.757, Ratio=1.26x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=0.787, Ratio=1.24x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.739, Ratio=1.23x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.757, Ratio=1.28x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.749, Ratio=1.23x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.738, Ratio=1.24x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.754, Ratio=1.28x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.746, Ratio=1.25x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.771, Ratio=1.26x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.753, Ratio=1.24x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.767, Ratio=1.26x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.773, Ratio=1.26x, Gap=-3.644
Batch 475/537: Loss=1.8711 (C:1.8711, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.763, Ratio=1.23x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.750, Ratio=1.22x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.764, Ratio=1.25x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.767, Ratio=1.25x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.761, Ratio=1.26x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.762, Ratio=1.25x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.761, Ratio=1.24x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.792, Ratio=1.27x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.778, Ratio=1.27x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.786, Ratio=1.26x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.770, Ratio=1.26x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.788, Ratio=1.25x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.775, Ratio=1.25x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.763, Ratio=1.23x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.772, Ratio=1.24x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.783, Ratio=1.26x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.777, Ratio=1.25x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=0.787, Ratio=1.22x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=0.771, Ratio=1.21x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.773, Ratio=1.26x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.771, Ratio=1.23x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.774, Ratio=1.25x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.767, Ratio=1.25x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.759, Ratio=1.25x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.773, Ratio=1.26x, Gap=-3.461
Batch 500/537: Loss=1.8707 (C:1.8707, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.757, Ratio=1.25x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.751, Ratio=1.24x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.750, Ratio=1.23x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.741, Ratio=1.24x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.764, Ratio=1.25x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.768, Ratio=1.24x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.759, Ratio=1.26x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.748, Ratio=1.24x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.749, Ratio=1.24x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.737, Ratio=1.23x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.743, Ratio=1.27x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.749, Ratio=1.25x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.748, Ratio=1.25x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.754, Ratio=1.30x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.761, Ratio=1.26x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.785, Ratio=1.26x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.762, Ratio=1.25x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.773, Ratio=1.26x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.776, Ratio=1.24x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.773, Ratio=1.23x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.782, Ratio=1.25x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.766, Ratio=1.24x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.780, Ratio=1.25x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.769, Ratio=1.23x, Gap=-3.980
Batch 525/537: Loss=1.8894 (C:1.8894, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=0.784, Ratio=1.24x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.766, Ratio=1.26x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.791, Ratio=1.28x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.782, Ratio=1.24x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.770, Ratio=1.24x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.769, Ratio=1.26x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.26x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.761, Ratio=1.23x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.765, Ratio=1.26x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.754, Ratio=1.25x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.761, Ratio=1.26x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.767, Ratio=1.27x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.760, Ratio=1.27x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.775, Ratio=1.27x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.760, Ratio=1.27x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.767, Ratio=1.27x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.768, Ratio=1.28x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.780, Ratio=1.28x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.756, Ratio=1.26x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.784, Ratio=1.29x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.759, Ratio=1.26x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.759, Ratio=1.28x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.767, Ratio=1.30x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.765, Ratio=1.27x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.767, Ratio=1.27x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.754, Ratio=1.26x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.768, Ratio=1.27x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.763, Ratio=1.27x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.777, Ratio=1.27x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.770, Ratio=1.26x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.763, Ratio=1.25x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.764, Ratio=1.27x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.761, Ratio=1.27x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.761, Ratio=1.27x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.780, Ratio=1.28x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.762, Ratio=1.25x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.774, Ratio=1.27x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.763, Ratio=1.29x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.778, Ratio=1.28x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.767, Ratio=1.30x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.771, Ratio=1.27x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.769, Ratio=1.29x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.751, Ratio=1.27x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.773, Ratio=1.29x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.781, Ratio=1.27x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.775, Ratio=1.27x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.767, Ratio=1.29x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.766, Ratio=1.28x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.761, Ratio=1.29x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.772, Ratio=1.27x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.767, Ratio=1.25x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.751, Ratio=1.26x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.759, Ratio=1.27x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.785, Ratio=1.28x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.767, Ratio=1.27x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.768, Ratio=1.25x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.757, Ratio=1.27x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.780, Ratio=1.30x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.760, Ratio=1.26x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.769, Ratio=1.28x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.759, Ratio=1.27x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.758, Ratio=1.26x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.766, Ratio=1.27x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.753, Ratio=1.28x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.766, Ratio=1.27x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.767, Ratio=1.26x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.777, Ratio=1.28x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.777, Ratio=1.27x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.756, Ratio=1.26x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.778, Ratio=1.28x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.778, Ratio=1.28x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.764, Ratio=1.27x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.766, Ratio=1.27x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.773, Ratio=1.29x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.771, Ratio=1.29x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.751, Ratio=1.27x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.761, Ratio=1.28x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.789, Ratio=1.29x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.769, Ratio=1.27x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.768, Ratio=1.28x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.763, Ratio=1.28x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.768, Ratio=1.28x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.754, Ratio=1.28x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.778, Ratio=1.29x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.765, Ratio=1.27x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.763, Ratio=1.27x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.784, Ratio=1.29x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.755, Ratio=1.29x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.765, Ratio=1.29x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.784, Ratio=1.28x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.763, Ratio=1.26x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.767, Ratio=1.26x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.773, Ratio=1.29x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.768, Ratio=1.29x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.784, Ratio=1.28x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.773, Ratio=1.28x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.752, Ratio=1.27x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.775, Ratio=1.28x, Gap=-3.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.769, Ratio=1.28x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.768, Ratio=1.29x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.774, Ratio=1.29x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.761, Ratio=1.26x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.779, Ratio=1.28x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.758, Ratio=1.27x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.761, Ratio=1.29x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.770, Ratio=1.27x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.770, Ratio=1.29x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.765, Ratio=1.26x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.764, Ratio=1.27x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.778, Ratio=1.27x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.769, Ratio=1.28x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.777, Ratio=1.28x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.768, Ratio=1.27x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.763, Ratio=1.26x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.760, Ratio=1.28x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.768, Ratio=1.27x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.767, Ratio=1.28x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.750, Ratio=1.25x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.743, Ratio=1.26x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.759, Ratio=1.27x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.756, Ratio=1.27x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.772, Ratio=1.27x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.760, Ratio=1.26x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.776, Ratio=1.28x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.778, Ratio=1.29x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.757, Ratio=1.25x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.768, Ratio=1.27x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.760, Ratio=1.28x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.747, Ratio=1.28x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.756, Ratio=1.28x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.771, Ratio=1.28x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.770, Ratio=1.26x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.759, Ratio=1.28x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.772, Ratio=1.27x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.778, Ratio=1.28x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.778, Ratio=1.30x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.763, Ratio=1.28x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.752, Ratio=1.26x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.763, Ratio=1.28x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.750, Ratio=1.25x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.767, Ratio=1.27x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.764, Ratio=1.27x, Gap=-3.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.756, Ratio=1.24x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.773, Ratio=1.29x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.769, Ratio=1.29x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.765, Ratio=1.29x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.768, Ratio=1.27x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.766, Ratio=1.28x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.771, Ratio=1.27x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.777, Ratio=1.27x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.782, Ratio=1.29x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.770, Ratio=1.26x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.778, Ratio=1.29x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.775, Ratio=1.26x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.777, Ratio=1.29x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.779, Ratio=1.30x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.770, Ratio=1.28x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.766, Ratio=1.28x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.777, Ratio=1.28x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.761, Ratio=1.28x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.766, Ratio=1.28x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.739, Ratio=1.26x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.765, Ratio=1.28x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.760, Ratio=1.28x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.770, Ratio=1.28x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.774, Ratio=1.29x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.766, Ratio=1.28x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.774, Ratio=1.25x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.764, Ratio=1.28x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.751, Ratio=1.26x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.766, Ratio=1.28x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.762, Ratio=1.27x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.778, Ratio=1.30x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.763, Ratio=1.26x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.750, Ratio=1.27x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.755, Ratio=1.27x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.756, Ratio=1.29x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.756, Ratio=1.28x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.779, Ratio=1.26x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.758, Ratio=1.27x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.763, Ratio=1.28x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.759, Ratio=1.27x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.776, Ratio=1.28x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.777, Ratio=1.28x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.777, Ratio=1.28x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.767, Ratio=1.27x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.771, Ratio=1.28x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.754, Ratio=1.27x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.763, Ratio=1.27x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.766, Ratio=1.26x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.755, Ratio=1.28x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.766, Ratio=1.27x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.776, Ratio=1.28x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.764, Ratio=1.28x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.765, Ratio=1.27x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.768, Ratio=1.28x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.754, Ratio=1.27x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.781, Ratio=1.31x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.777, Ratio=1.28x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.761, Ratio=1.26x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.757, Ratio=1.26x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.767, Ratio=1.28x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.774, Ratio=1.28x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.771, Ratio=1.26x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.768, Ratio=1.28x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.772, Ratio=1.26x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.788, Ratio=1.27x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.758, Ratio=1.27x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.754, Ratio=1.28x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.774, Ratio=1.26x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.772, Ratio=1.26x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.771, Ratio=1.30x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.752, Ratio=1.26x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.765, Ratio=1.26x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.758, Ratio=1.27x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.769, Ratio=1.29x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.765, Ratio=1.28x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.770, Ratio=1.29x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.765, Ratio=1.28x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.753, Ratio=1.27x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.761, Ratio=1.26x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.758, Ratio=1.27x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.773, Ratio=1.27x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.766, Ratio=1.28x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.763, Ratio=1.27x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.763, Ratio=1.29x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.771, Ratio=1.28x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.760, Ratio=1.27x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.753, Ratio=1.28x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.770, Ratio=1.29x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.787, Ratio=1.28x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.762, Ratio=1.27x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.774, Ratio=1.26x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.782, Ratio=1.27x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.783, Ratio=1.31x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.754, Ratio=1.26x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.767, Ratio=1.27x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.742, Ratio=1.25x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.773, Ratio=1.28x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.778, Ratio=1.29x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.775, Ratio=1.27x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.755, Ratio=1.26x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.781, Ratio=1.25x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.761, Ratio=1.28x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.771, Ratio=1.28x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.788, Ratio=1.28x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.777, Ratio=1.29x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.769, Ratio=1.30x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.775, Ratio=1.27x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.759, Ratio=1.28x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.760, Ratio=1.28x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.766, Ratio=1.27x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.746, Ratio=1.27x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.765, Ratio=1.29x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.774, Ratio=1.27x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.773, Ratio=1.26x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.768, Ratio=1.26x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.771, Ratio=1.27x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.762, Ratio=1.30x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.762, Ratio=1.27x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.779, Ratio=1.30x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.772, Ratio=1.28x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.774, Ratio=1.28x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.764, Ratio=1.29x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.755, Ratio=1.29x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.770, Ratio=1.28x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.769, Ratio=1.29x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.773, Ratio=1.28x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.765, Ratio=1.26x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.785, Ratio=1.30x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.758, Ratio=1.26x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.756, Ratio=1.28x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.762, Ratio=1.27x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.766, Ratio=1.27x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.775, Ratio=1.28x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.785, Ratio=1.28x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.767, Ratio=1.28x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.770, Ratio=1.27x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.771, Ratio=1.28x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.765, Ratio=1.27x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.771, Ratio=1.25x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.770, Ratio=1.27x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.768, Ratio=1.26x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.749, Ratio=1.28x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.776, Ratio=1.29x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.763, Ratio=1.26x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.770, Ratio=1.29x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.774, Ratio=1.29x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.764, Ratio=1.26x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.767, Ratio=1.27x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.757, Ratio=1.26x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.769, Ratio=1.29x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.763, Ratio=1.27x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.764, Ratio=1.27x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.769, Ratio=1.28x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.764, Ratio=1.27x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.762, Ratio=1.28x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.765, Ratio=1.26x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.748, Ratio=1.27x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.766, Ratio=1.28x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.771, Ratio=1.28x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.768, Ratio=1.26x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.757, Ratio=1.28x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.766, Ratio=1.27x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.740, Ratio=1.26x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.773, Ratio=1.28x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.770, Ratio=1.30x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.763, Ratio=1.28x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.748, Ratio=1.26x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.783, Ratio=1.30x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.748, Ratio=1.26x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.765, Ratio=1.27x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.750, Ratio=1.27x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.773, Ratio=1.28x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.763, Ratio=1.27x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.766, Ratio=1.26x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.766, Ratio=1.28x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.756, Ratio=1.27x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.770, Ratio=1.26x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.755, Ratio=1.29x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.758, Ratio=1.26x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.762, Ratio=1.28x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.761, Ratio=1.27x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.774, Ratio=1.30x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.769, Ratio=1.28x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.757, Ratio=1.27x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.753, Ratio=1.27x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.773, Ratio=1.26x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.776, Ratio=1.27x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.773, Ratio=1.28x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.760, Ratio=1.30x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.783, Ratio=1.28x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.780, Ratio=1.27x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.757, Ratio=1.25x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.768, Ratio=1.28x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.757, Ratio=1.26x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.740, Ratio=1.25x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.755, Ratio=1.28x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.752, Ratio=1.26x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.766, Ratio=1.27x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.764, Ratio=1.29x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.766, Ratio=1.28x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.744, Ratio=1.27x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.770, Ratio=1.29x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.769, Ratio=1.28x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.769, Ratio=1.27x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.791, Ratio=1.32x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.765, Ratio=1.25x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.769, Ratio=1.26x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.777, Ratio=1.28x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.767, Ratio=1.28x, Gap=-3.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.769, Ratio=1.26x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.764, Ratio=1.27x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.770, Ratio=1.28x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.761, Ratio=1.27x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.779, Ratio=1.28x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.771, Ratio=1.29x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.754, Ratio=1.26x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.755, Ratio=1.26x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.757, Ratio=1.26x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.770, Ratio=1.27x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.763, Ratio=1.27x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.770, Ratio=1.29x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.765, Ratio=1.27x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.757, Ratio=1.29x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.770, Ratio=1.26x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.757, Ratio=1.28x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.760, Ratio=1.26x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.765, Ratio=1.28x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.754, Ratio=1.27x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.770, Ratio=1.27x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.769, Ratio=1.29x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.766, Ratio=1.29x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.770, Ratio=1.30x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.759, Ratio=1.28x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.752, Ratio=1.27x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.771, Ratio=1.27x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.755, Ratio=1.27x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.754, Ratio=1.27x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.763, Ratio=1.26x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.771, Ratio=1.28x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.768, Ratio=1.27x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.766, Ratio=1.28x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.761, Ratio=1.28x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.779, Ratio=1.27x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.776, Ratio=1.29x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.759, Ratio=1.28x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.771, Ratio=1.28x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.759, Ratio=1.28x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.776, Ratio=1.28x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.755, Ratio=1.29x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.778, Ratio=1.27x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.761, Ratio=1.26x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.768, Ratio=1.27x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.763, Ratio=1.26x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.760, Ratio=1.26x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.752, Ratio=1.26x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.764, Ratio=1.29x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.762, Ratio=1.29x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.773, Ratio=1.28x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.758, Ratio=1.26x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.764, Ratio=1.28x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.764, Ratio=1.27x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.767, Ratio=1.30x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.757, Ratio=1.28x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.772, Ratio=1.28x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.767, Ratio=1.27x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.759, Ratio=1.27x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.765, Ratio=1.28x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.753, Ratio=1.27x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.751, Ratio=1.28x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.762, Ratio=1.26x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.769, Ratio=1.28x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.762, Ratio=1.27x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.765, Ratio=1.27x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.776, Ratio=1.25x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.766, Ratio=1.26x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.759, Ratio=1.28x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.760, Ratio=1.26x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.763, Ratio=1.27x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.770, Ratio=1.31x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.775, Ratio=1.28x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.760, Ratio=1.26x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.754, Ratio=1.29x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.762, Ratio=1.28x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.767, Ratio=1.27x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.771, Ratio=1.28x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.768, Ratio=1.28x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.773, Ratio=1.30x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.760, Ratio=1.26x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.779, Ratio=1.28x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.775, Ratio=1.27x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.769, Ratio=1.27x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.772, Ratio=1.28x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.765, Ratio=1.26x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.765, Ratio=1.29x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.761, Ratio=1.25x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.764, Ratio=1.27x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.773, Ratio=1.30x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.767, Ratio=1.29x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.769, Ratio=1.28x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.769, Ratio=1.28x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.762, Ratio=1.28x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.775, Ratio=1.29x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.753, Ratio=1.28x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.763, Ratio=1.28x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.781, Ratio=1.29x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.779, Ratio=1.30x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.769, Ratio=1.30x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.770, Ratio=1.27x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.782, Ratio=1.27x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.777, Ratio=1.29x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.771, Ratio=1.27x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.769, Ratio=1.28x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.771, Ratio=1.29x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.770, Ratio=1.28x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.767, Ratio=1.26x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.764, Ratio=1.28x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.770, Ratio=1.27x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.752, Ratio=1.28x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.772, Ratio=1.27x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.779, Ratio=1.28x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.787, Ratio=1.29x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.750, Ratio=1.27x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.769, Ratio=1.28x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.774, Ratio=1.30x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.766, Ratio=1.26x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.761, Ratio=1.30x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.756, Ratio=1.29x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.754, Ratio=1.25x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.779, Ratio=1.27x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.778, Ratio=1.29x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.751, Ratio=1.26x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.769, Ratio=1.25x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.775, Ratio=1.26x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.769, Ratio=1.29x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.776, Ratio=1.28x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.771, Ratio=1.29x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.762, Ratio=1.25x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.758, Ratio=1.26x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.788, Ratio=1.31x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.773, Ratio=1.27x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.771, Ratio=1.28x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.762, Ratio=1.26x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.775, Ratio=1.30x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.774, Ratio=1.28x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.766, Ratio=1.27x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.754, Ratio=1.25x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.767, Ratio=1.29x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.751, Ratio=1.27x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.765, Ratio=1.28x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.784, Ratio=1.30x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.769, Ratio=1.28x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.773, Ratio=1.26x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.774, Ratio=1.28x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.753, Ratio=1.25x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.771, Ratio=1.29x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.758, Ratio=1.27x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.761, Ratio=1.25x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.767, Ratio=1.26x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.760, Ratio=1.25x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.757, Ratio=1.29x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.774, Ratio=1.27x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.766, Ratio=1.27x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.760, Ratio=1.27x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.764, Ratio=1.26x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.762, Ratio=1.27x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.763, Ratio=1.27x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.771, Ratio=1.28x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.757, Ratio=1.27x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.772, Ratio=1.26x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.758, Ratio=1.26x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.767, Ratio=1.26x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.765, Ratio=1.27x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.771, Ratio=1.28x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.772, Ratio=1.29x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.752, Ratio=1.28x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.767, Ratio=1.27x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.744, Ratio=1.28x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.767, Ratio=1.27x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.773, Ratio=1.28x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.754, Ratio=1.26x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.771, Ratio=1.27x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.765, Ratio=1.29x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.759, Ratio=1.26x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.756, Ratio=1.28x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.758, Ratio=1.27x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.774, Ratio=1.28x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.770, Ratio=1.27x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.775, Ratio=1.28x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.772, Ratio=1.28x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.773, Ratio=1.27x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.778, Ratio=1.27x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.762, Ratio=1.28x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.776, Ratio=1.28x, Gap=-3.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.762, Ratio=1.27x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.768, Ratio=1.27x, Gap=-2.888

============================================================
Epoch 3/20 completed in 32.6s
Train: Loss=1.8813 (C:1.8813, R:0.0000) Ratio=2.40x
Val:   Loss=1.8657 (C:1.8657, R:0.0000) Ratio=2.74x
‚úÖ New best model saved (Val Loss: 1.8657)
============================================================

üåç Updating global dataset at epoch 4
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.570 ¬± 0.564
    Neg distances: 1.572 ¬± 0.862
    Separation ratio: 2.76x
    Gap: -3.559
    ‚úÖ Good global separation

Epoch 4 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.559, Ratio=2.58x, Gap=-3.534
Batch   0/537: Loss=1.2293 (C:1.2293, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.556, Ratio=2.56x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.587, Ratio=2.74x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.572, Ratio=2.60x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.573, Ratio=2.65x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.577, Ratio=2.56x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.575, Ratio=2.60x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.579, Ratio=2.66x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.595, Ratio=2.65x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.596, Ratio=2.68x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.596, Ratio=2.71x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.582, Ratio=2.57x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.588, Ratio=2.63x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.566, Ratio=2.55x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.591, Ratio=2.70x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.582, Ratio=2.68x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.593, Ratio=2.71x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.572, Ratio=2.62x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.576, Ratio=2.58x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.584, Ratio=2.72x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.589, Ratio=2.72x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.590, Ratio=2.74x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.598, Ratio=2.64x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.583, Ratio=2.70x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.588, Ratio=2.60x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.607, Ratio=2.74x, Gap=-3.726
Batch  25/537: Loss=1.1870 (C:1.1870, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.580, Ratio=2.61x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.609, Ratio=2.65x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.587, Ratio=2.71x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.613, Ratio=2.90x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.586, Ratio=2.68x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.573, Ratio=2.67x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.577, Ratio=2.61x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.575, Ratio=2.65x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.580, Ratio=2.52x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.604, Ratio=2.71x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.572, Ratio=2.55x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.563, Ratio=2.57x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.593, Ratio=2.69x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.613, Ratio=2.74x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.594, Ratio=2.68x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.624, Ratio=2.81x, Gap=-4.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.559, Ratio=2.60x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.564, Ratio=2.63x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.582, Ratio=2.68x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.581, Ratio=2.62x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.580, Ratio=2.58x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.597, Ratio=2.67x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.591, Ratio=2.63x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.581, Ratio=2.55x, Gap=-4.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.583, Ratio=2.63x, Gap=-3.532
Batch  50/537: Loss=1.2170 (C:1.2170, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.572, Ratio=2.61x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.569, Ratio=2.65x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.516, Ratio=2.37x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.580, Ratio=2.74x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.550, Ratio=2.54x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.596, Ratio=2.71x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.579, Ratio=2.60x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.586, Ratio=2.70x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.599, Ratio=2.67x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.597, Ratio=2.66x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.616, Ratio=2.75x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.574, Ratio=2.63x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.598, Ratio=2.71x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.577, Ratio=2.68x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.539, Ratio=2.48x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.573, Ratio=2.66x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.563, Ratio=2.60x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.586, Ratio=2.68x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.566, Ratio=2.58x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.602, Ratio=2.68x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.591, Ratio=2.64x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.601, Ratio=2.71x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.598, Ratio=2.60x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.588, Ratio=2.57x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.553, Ratio=2.52x, Gap=-3.748
Batch  75/537: Loss=1.2522 (C:1.2522, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.578, Ratio=2.61x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.581, Ratio=2.63x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.585, Ratio=2.69x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.586, Ratio=2.66x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.569, Ratio=2.57x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.590, Ratio=2.65x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.556, Ratio=2.50x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.582, Ratio=2.56x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.570, Ratio=2.60x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.556, Ratio=2.61x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.567, Ratio=2.61x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.577, Ratio=2.65x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.569, Ratio=2.50x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.575, Ratio=2.69x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.564, Ratio=2.63x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.594, Ratio=2.68x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.573, Ratio=2.56x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.564, Ratio=2.56x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.533, Ratio=2.49x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.579, Ratio=2.64x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.593, Ratio=2.69x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.568, Ratio=2.57x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.606, Ratio=2.72x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.605, Ratio=2.68x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.576, Ratio=2.61x, Gap=-3.607
Batch 100/537: Loss=1.2227 (C:1.2227, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.588, Ratio=2.65x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.560, Ratio=2.57x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.581, Ratio=2.60x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.599, Ratio=2.69x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.573, Ratio=2.58x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.569, Ratio=2.60x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.554, Ratio=2.41x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.592, Ratio=2.73x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.576, Ratio=2.53x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.599, Ratio=2.65x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.570, Ratio=2.55x, Gap=-4.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.613, Ratio=2.79x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.578, Ratio=2.60x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.566, Ratio=2.60x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.561, Ratio=2.56x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.567, Ratio=2.61x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.571, Ratio=2.61x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.584, Ratio=2.67x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.563, Ratio=2.50x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.575, Ratio=2.62x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.613, Ratio=2.77x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.592, Ratio=2.68x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.594, Ratio=2.65x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.574, Ratio=2.53x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.584, Ratio=2.66x, Gap=-3.576
Batch 125/537: Loss=1.2068 (C:1.2068, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.607, Ratio=2.62x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.573, Ratio=2.57x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.557, Ratio=2.52x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.569, Ratio=2.65x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.577, Ratio=2.59x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.581, Ratio=2.66x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.610, Ratio=2.77x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.588, Ratio=2.68x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.581, Ratio=2.63x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.582, Ratio=2.63x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.588, Ratio=2.66x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.581, Ratio=2.61x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.578, Ratio=2.65x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.591, Ratio=2.70x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.570, Ratio=2.59x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.577, Ratio=2.58x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.573, Ratio=2.66x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.591, Ratio=2.63x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.568, Ratio=2.60x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.578, Ratio=2.66x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.565, Ratio=2.58x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.562, Ratio=2.62x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.591, Ratio=2.72x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.588, Ratio=2.73x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.575, Ratio=2.68x, Gap=-3.739
Batch 150/537: Loss=1.2039 (C:1.2039, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.549, Ratio=2.61x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.563, Ratio=2.65x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.563, Ratio=2.57x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.587, Ratio=2.59x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.568, Ratio=2.62x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.590, Ratio=2.55x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.561, Ratio=2.57x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.595, Ratio=2.63x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.585, Ratio=2.63x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.581, Ratio=2.63x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.602, Ratio=2.78x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.566, Ratio=2.54x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.597, Ratio=2.70x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.572, Ratio=2.60x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.588, Ratio=2.66x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.591, Ratio=2.68x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.588, Ratio=2.64x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.580, Ratio=2.71x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.577, Ratio=2.61x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.592, Ratio=2.72x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.581, Ratio=2.68x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.586, Ratio=2.64x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.588, Ratio=2.61x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.604, Ratio=2.70x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.584, Ratio=2.63x, Gap=-3.638
Batch 175/537: Loss=1.2188 (C:1.2188, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.587, Ratio=2.59x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.597, Ratio=2.61x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.591, Ratio=2.72x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.604, Ratio=2.75x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.566, Ratio=2.58x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.591, Ratio=2.69x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.563, Ratio=2.68x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.570, Ratio=2.61x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.546, Ratio=2.48x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.560, Ratio=2.49x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.566, Ratio=2.63x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.570, Ratio=2.48x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.563, Ratio=2.58x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.578, Ratio=2.63x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.578, Ratio=2.58x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.578, Ratio=2.72x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.582, Ratio=2.66x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.567, Ratio=2.58x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.573, Ratio=2.59x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.575, Ratio=2.64x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.611, Ratio=2.66x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.596, Ratio=2.73x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.597, Ratio=2.62x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.602, Ratio=2.75x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.600, Ratio=2.70x, Gap=-3.694
Batch 200/537: Loss=1.1997 (C:1.1997, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.580, Ratio=2.69x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.560, Ratio=2.58x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.587, Ratio=2.71x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.588, Ratio=2.66x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.580, Ratio=2.63x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.561, Ratio=2.53x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.586, Ratio=2.62x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.583, Ratio=2.59x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.565, Ratio=2.58x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.608, Ratio=2.74x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.592, Ratio=2.69x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.629, Ratio=2.78x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.591, Ratio=2.74x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.588, Ratio=2.55x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.588, Ratio=2.63x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.568, Ratio=2.65x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.563, Ratio=2.53x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.579, Ratio=2.67x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.575, Ratio=2.61x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.576, Ratio=2.58x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.565, Ratio=2.65x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.579, Ratio=2.73x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.581, Ratio=2.70x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.572, Ratio=2.61x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.579, Ratio=2.69x, Gap=-3.351
Batch 225/537: Loss=1.2004 (C:1.2004, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.586, Ratio=2.69x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.572, Ratio=2.61x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.598, Ratio=2.70x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.582, Ratio=2.62x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.600, Ratio=2.65x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.591, Ratio=2.56x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.575, Ratio=2.57x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.561, Ratio=2.54x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.596, Ratio=2.65x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.581, Ratio=2.71x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.559, Ratio=2.60x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.601, Ratio=2.79x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.614, Ratio=2.89x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.589, Ratio=2.70x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.577, Ratio=2.64x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.559, Ratio=2.53x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.585, Ratio=2.71x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.599, Ratio=2.68x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.587, Ratio=2.64x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.555, Ratio=2.59x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.614, Ratio=2.78x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.580, Ratio=2.57x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.606, Ratio=2.75x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.583, Ratio=2.63x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.581, Ratio=2.70x, Gap=-3.631
Batch 250/537: Loss=1.2010 (C:1.2010, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.606, Ratio=2.76x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.586, Ratio=2.66x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.583, Ratio=2.69x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.557, Ratio=2.53x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.586, Ratio=2.72x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.597, Ratio=2.82x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.581, Ratio=2.64x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.588, Ratio=2.63x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.592, Ratio=2.68x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.608, Ratio=2.71x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.585, Ratio=2.63x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.588, Ratio=2.63x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.554, Ratio=2.53x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.570, Ratio=2.55x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.568, Ratio=2.59x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.578, Ratio=2.61x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.568, Ratio=2.56x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.589, Ratio=2.76x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.576, Ratio=2.61x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.563, Ratio=2.47x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.590, Ratio=2.60x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.589, Ratio=2.66x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.573, Ratio=2.57x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.570, Ratio=2.59x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.554, Ratio=2.49x, Gap=-4.159
Batch 275/537: Loss=1.2583 (C:1.2583, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.573, Ratio=2.61x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.569, Ratio=2.57x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.590, Ratio=2.69x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.553, Ratio=2.55x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.569, Ratio=2.60x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.550, Ratio=2.52x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.576, Ratio=2.72x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.576, Ratio=2.68x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.608, Ratio=2.78x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.596, Ratio=2.69x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.605, Ratio=2.62x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.570, Ratio=2.63x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.608, Ratio=2.73x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.610, Ratio=2.67x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.608, Ratio=2.62x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.624, Ratio=2.78x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.592, Ratio=2.65x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.574, Ratio=2.63x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.585, Ratio=2.64x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.570, Ratio=2.59x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.596, Ratio=2.75x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.552, Ratio=2.57x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.568, Ratio=2.68x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.579, Ratio=2.76x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.563, Ratio=2.55x, Gap=-3.573
Batch 300/537: Loss=1.2408 (C:1.2408, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.570, Ratio=2.71x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.564, Ratio=2.67x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.556, Ratio=2.53x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.580, Ratio=2.62x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.631, Ratio=2.83x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.591, Ratio=2.61x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.613, Ratio=2.81x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.601, Ratio=2.72x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.610, Ratio=2.81x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.606, Ratio=2.62x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.599, Ratio=2.66x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.573, Ratio=2.69x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.604, Ratio=2.71x, Gap=-4.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.579, Ratio=2.63x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.593, Ratio=2.67x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.581, Ratio=2.72x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.559, Ratio=2.65x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.563, Ratio=2.61x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.579, Ratio=2.64x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.569, Ratio=2.63x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.589, Ratio=2.65x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.605, Ratio=2.71x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.601, Ratio=2.75x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.575, Ratio=2.67x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.611, Ratio=2.73x, Gap=-3.762
Batch 325/537: Loss=1.1899 (C:1.1899, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.562, Ratio=2.56x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.561, Ratio=2.55x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.604, Ratio=2.61x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.574, Ratio=2.52x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.590, Ratio=2.56x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.601, Ratio=2.75x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.600, Ratio=2.73x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.575, Ratio=2.63x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.593, Ratio=2.72x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.580, Ratio=2.74x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.585, Ratio=2.70x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.569, Ratio=2.66x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.581, Ratio=2.72x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.573, Ratio=2.61x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.606, Ratio=2.67x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.594, Ratio=2.63x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.606, Ratio=2.59x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.577, Ratio=2.63x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.584, Ratio=2.60x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.593, Ratio=2.66x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.583, Ratio=2.74x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.571, Ratio=2.59x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.592, Ratio=2.81x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.586, Ratio=2.73x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.590, Ratio=2.69x, Gap=-3.391
Batch 350/537: Loss=1.1967 (C:1.1967, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.575, Ratio=2.58x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.592, Ratio=2.73x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.572, Ratio=2.65x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.587, Ratio=2.64x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.578, Ratio=2.63x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.595, Ratio=2.70x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.603, Ratio=2.78x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.578, Ratio=2.66x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.605, Ratio=2.74x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.593, Ratio=2.69x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.572, Ratio=2.59x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.594, Ratio=2.73x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.581, Ratio=2.66x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.573, Ratio=2.62x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.566, Ratio=2.55x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.595, Ratio=2.71x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.574, Ratio=2.65x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.577, Ratio=2.59x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.592, Ratio=2.65x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.569, Ratio=2.67x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.599, Ratio=2.76x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.599, Ratio=2.69x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.557, Ratio=2.60x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.579, Ratio=2.66x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.572, Ratio=2.65x, Gap=-3.693
Batch 375/537: Loss=1.2128 (C:1.2128, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.569, Ratio=2.59x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.591, Ratio=2.68x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.599, Ratio=2.64x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.584, Ratio=2.63x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.577, Ratio=2.56x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.586, Ratio=2.66x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.583, Ratio=2.62x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.602, Ratio=2.71x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.578, Ratio=2.73x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.613, Ratio=2.79x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.585, Ratio=2.76x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.586, Ratio=2.65x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.551, Ratio=2.59x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.592, Ratio=2.72x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.546, Ratio=2.56x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.577, Ratio=2.63x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.583, Ratio=2.70x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.608, Ratio=2.80x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.594, Ratio=2.73x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.591, Ratio=2.63x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.611, Ratio=2.74x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.593, Ratio=2.70x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.618, Ratio=2.82x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.590, Ratio=2.60x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.575, Ratio=2.55x, Gap=-3.521
Batch 400/537: Loss=1.2409 (C:1.2409, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.578, Ratio=2.59x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.602, Ratio=2.67x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.589, Ratio=2.67x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.606, Ratio=2.72x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.554, Ratio=2.51x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.561, Ratio=2.60x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.567, Ratio=2.69x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.594, Ratio=2.84x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.553, Ratio=2.65x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.561, Ratio=2.61x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.600, Ratio=2.77x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.582, Ratio=2.70x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.570, Ratio=2.60x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.588, Ratio=2.74x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.584, Ratio=2.67x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.621, Ratio=2.80x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.579, Ratio=2.62x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.603, Ratio=2.73x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.613, Ratio=2.80x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.573, Ratio=2.57x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.588, Ratio=2.60x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.580, Ratio=2.71x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.597, Ratio=2.71x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.580, Ratio=2.67x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.569, Ratio=2.61x, Gap=-3.455
Batch 425/537: Loss=1.2219 (C:1.2219, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.592, Ratio=2.67x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.576, Ratio=2.68x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.599, Ratio=2.67x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.606, Ratio=2.79x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.617, Ratio=2.75x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.590, Ratio=2.62x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.597, Ratio=2.75x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.583, Ratio=2.62x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.588, Ratio=2.76x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.588, Ratio=2.65x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.578, Ratio=2.66x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.586, Ratio=2.61x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.583, Ratio=2.66x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.562, Ratio=2.56x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.597, Ratio=2.87x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.581, Ratio=2.67x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.590, Ratio=2.73x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.580, Ratio=2.65x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.588, Ratio=2.63x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.570, Ratio=2.62x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.579, Ratio=2.66x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.592, Ratio=2.61x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.599, Ratio=2.69x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.598, Ratio=2.71x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.611, Ratio=2.72x, Gap=-3.511
Batch 450/537: Loss=1.1930 (C:1.1930, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.586, Ratio=2.68x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.547, Ratio=2.49x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.595, Ratio=2.74x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.579, Ratio=2.62x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.592, Ratio=2.68x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.583, Ratio=2.66x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.566, Ratio=2.52x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.606, Ratio=2.78x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.562, Ratio=2.61x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.560, Ratio=2.65x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.568, Ratio=2.66x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.569, Ratio=2.65x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.584, Ratio=2.69x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.596, Ratio=2.74x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.575, Ratio=2.58x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.575, Ratio=2.62x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.591, Ratio=2.69x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.593, Ratio=2.70x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.591, Ratio=2.68x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.587, Ratio=2.68x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.565, Ratio=2.60x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.578, Ratio=2.65x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.578, Ratio=2.66x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.577, Ratio=2.69x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.572, Ratio=2.60x, Gap=-3.699
Batch 475/537: Loss=1.2273 (C:1.2273, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.581, Ratio=2.66x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.582, Ratio=2.63x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.591, Ratio=2.75x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.602, Ratio=2.78x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.592, Ratio=2.68x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.625, Ratio=2.80x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.587, Ratio=2.64x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.577, Ratio=2.62x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.608, Ratio=2.67x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.562, Ratio=2.56x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.586, Ratio=2.64x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.576, Ratio=2.60x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.563, Ratio=2.59x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.574, Ratio=2.61x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.578, Ratio=2.65x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.561, Ratio=2.66x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.564, Ratio=2.57x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.575, Ratio=2.62x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.565, Ratio=2.64x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.594, Ratio=2.68x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.591, Ratio=2.76x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.573, Ratio=2.71x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.581, Ratio=2.63x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.586, Ratio=2.64x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.596, Ratio=2.65x, Gap=-3.674
Batch 500/537: Loss=1.2085 (C:1.2085, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.568, Ratio=2.62x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.577, Ratio=2.61x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.572, Ratio=2.54x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.583, Ratio=2.67x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.573, Ratio=2.67x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.593, Ratio=2.66x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.569, Ratio=2.56x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.574, Ratio=2.61x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.585, Ratio=2.66x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.580, Ratio=2.66x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.603, Ratio=2.74x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.551, Ratio=2.59x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.582, Ratio=2.62x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.599, Ratio=2.75x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.574, Ratio=2.55x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.591, Ratio=2.71x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.600, Ratio=2.70x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.591, Ratio=2.67x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.572, Ratio=2.57x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.597, Ratio=2.73x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.581, Ratio=2.71x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.570, Ratio=2.67x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.584, Ratio=2.72x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.603, Ratio=2.76x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.565, Ratio=2.57x, Gap=-3.747
Batch 525/537: Loss=1.2373 (C:1.2373, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.618, Ratio=2.84x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.603, Ratio=2.69x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.569, Ratio=2.59x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.607, Ratio=2.82x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.575, Ratio=2.67x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.599, Ratio=2.74x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.586, Ratio=2.56x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.600, Ratio=2.75x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.599, Ratio=2.70x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.577, Ratio=2.63x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.584, Ratio=2.76x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.579, Ratio=2.72x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.607, Ratio=2.83x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.597, Ratio=2.86x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.573, Ratio=2.78x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.617, Ratio=2.91x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.625, Ratio=2.95x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.620, Ratio=2.97x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.580, Ratio=2.72x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.605, Ratio=2.88x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.580, Ratio=2.84x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.598, Ratio=2.92x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.605, Ratio=2.94x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.582, Ratio=2.76x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.594, Ratio=2.89x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.600, Ratio=2.74x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.595, Ratio=2.79x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.594, Ratio=2.79x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.593, Ratio=2.85x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.577, Ratio=2.73x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.590, Ratio=2.83x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.580, Ratio=2.78x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.574, Ratio=2.74x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.587, Ratio=2.74x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.608, Ratio=2.79x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.576, Ratio=2.69x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.618, Ratio=2.97x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.585, Ratio=2.75x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.597, Ratio=2.84x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.593, Ratio=2.86x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.597, Ratio=2.86x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.585, Ratio=2.77x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.594, Ratio=2.82x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.618, Ratio=2.92x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.575, Ratio=2.71x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.581, Ratio=2.74x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.595, Ratio=2.80x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.600, Ratio=2.95x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.599, Ratio=2.85x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.599, Ratio=2.80x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.615, Ratio=2.89x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.607, Ratio=2.84x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.605, Ratio=2.83x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.565, Ratio=2.66x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.619, Ratio=2.93x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.592, Ratio=2.79x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.579, Ratio=2.76x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.599, Ratio=2.81x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.580, Ratio=2.78x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.578, Ratio=2.75x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.596, Ratio=2.85x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.609, Ratio=3.03x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.602, Ratio=2.84x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.569, Ratio=2.69x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.611, Ratio=2.92x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.593, Ratio=2.83x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.591, Ratio=2.81x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.583, Ratio=2.79x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.602, Ratio=2.83x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.594, Ratio=2.77x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.612, Ratio=2.87x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.587, Ratio=2.81x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.599, Ratio=2.85x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.594, Ratio=2.80x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.592, Ratio=2.81x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.582, Ratio=2.82x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.593, Ratio=2.90x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.603, Ratio=2.85x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.605, Ratio=2.88x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.576, Ratio=2.70x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.601, Ratio=2.87x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.595, Ratio=2.77x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.585, Ratio=2.77x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.607, Ratio=2.91x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.619, Ratio=2.90x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.597, Ratio=2.81x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.585, Ratio=2.89x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.600, Ratio=2.83x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.596, Ratio=2.87x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.598, Ratio=2.87x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.583, Ratio=2.82x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.578, Ratio=2.82x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.595, Ratio=2.80x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.570, Ratio=2.75x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.612, Ratio=2.79x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.612, Ratio=3.04x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.585, Ratio=2.73x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.591, Ratio=2.85x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.602, Ratio=2.76x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.604, Ratio=2.89x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.590, Ratio=2.78x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.614, Ratio=2.85x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.585, Ratio=2.80x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.588, Ratio=2.76x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.576, Ratio=2.74x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.596, Ratio=2.86x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.605, Ratio=2.90x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.581, Ratio=2.74x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.615, Ratio=3.00x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.593, Ratio=2.81x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.599, Ratio=2.80x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.586, Ratio=2.80x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.596, Ratio=2.86x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.611, Ratio=2.82x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.598, Ratio=2.87x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.597, Ratio=2.87x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.597, Ratio=2.78x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.590, Ratio=2.80x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.588, Ratio=2.73x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.595, Ratio=2.80x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.594, Ratio=2.80x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.620, Ratio=2.92x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.592, Ratio=2.87x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.557, Ratio=2.64x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.588, Ratio=2.76x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.556, Ratio=2.71x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.605, Ratio=2.91x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.593, Ratio=2.82x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.604, Ratio=2.80x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.593, Ratio=2.85x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.584, Ratio=2.72x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.602, Ratio=2.81x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.608, Ratio=2.94x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.593, Ratio=2.92x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.604, Ratio=2.87x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.610, Ratio=2.91x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.588, Ratio=2.75x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.602, Ratio=2.74x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.565, Ratio=2.68x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.615, Ratio=2.88x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.608, Ratio=2.80x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.581, Ratio=2.78x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.596, Ratio=2.93x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.594, Ratio=2.83x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.594, Ratio=2.76x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.604, Ratio=2.89x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.604, Ratio=2.97x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.618, Ratio=2.92x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.604, Ratio=2.90x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.592, Ratio=2.74x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.605, Ratio=2.98x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.597, Ratio=2.90x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.598, Ratio=2.97x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.604, Ratio=2.89x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.596, Ratio=2.78x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.598, Ratio=2.88x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.619, Ratio=2.86x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.579, Ratio=2.79x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.606, Ratio=2.90x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.573, Ratio=2.72x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.590, Ratio=2.72x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.585, Ratio=2.76x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.610, Ratio=2.91x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.586, Ratio=2.76x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.631, Ratio=3.02x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.586, Ratio=2.74x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.591, Ratio=2.80x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.622, Ratio=2.92x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.599, Ratio=2.84x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.586, Ratio=2.74x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.607, Ratio=2.95x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.581, Ratio=2.81x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.571, Ratio=2.67x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.609, Ratio=2.90x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.603, Ratio=2.86x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.597, Ratio=2.85x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.624, Ratio=2.92x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.596, Ratio=2.81x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.594, Ratio=2.85x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.598, Ratio=2.87x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.595, Ratio=2.76x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.617, Ratio=3.02x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.582, Ratio=2.79x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.611, Ratio=2.93x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.605, Ratio=2.88x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.618, Ratio=2.95x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.586, Ratio=2.77x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.619, Ratio=2.99x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.613, Ratio=2.93x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.585, Ratio=2.71x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.568, Ratio=2.77x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.598, Ratio=2.90x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.581, Ratio=2.77x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.602, Ratio=2.89x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.594, Ratio=2.81x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.617, Ratio=2.93x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.611, Ratio=3.01x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.600, Ratio=2.83x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.589, Ratio=2.82x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.618, Ratio=2.93x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.613, Ratio=2.87x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.615, Ratio=2.97x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.585, Ratio=2.80x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.600, Ratio=2.77x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.601, Ratio=2.86x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.601, Ratio=2.84x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.583, Ratio=2.72x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.592, Ratio=2.81x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.591, Ratio=2.76x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.605, Ratio=2.82x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.602, Ratio=2.89x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.585, Ratio=2.77x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.583, Ratio=2.70x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.592, Ratio=2.82x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.603, Ratio=2.88x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.597, Ratio=2.82x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.590, Ratio=2.82x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.582, Ratio=2.76x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.583, Ratio=2.86x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.609, Ratio=2.88x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.603, Ratio=2.92x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.606, Ratio=2.95x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.590, Ratio=2.82x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.621, Ratio=2.96x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.605, Ratio=2.91x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.604, Ratio=2.86x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.597, Ratio=2.90x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.601, Ratio=2.88x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.608, Ratio=2.87x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.602, Ratio=2.92x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.580, Ratio=2.72x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.579, Ratio=2.76x, Gap=-3.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.586, Ratio=2.73x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.592, Ratio=2.78x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.604, Ratio=2.86x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.613, Ratio=2.91x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.600, Ratio=2.89x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.585, Ratio=2.71x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.611, Ratio=2.98x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.592, Ratio=2.79x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.606, Ratio=2.86x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.594, Ratio=2.87x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.597, Ratio=2.78x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.610, Ratio=2.87x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.596, Ratio=2.80x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.619, Ratio=2.98x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.600, Ratio=2.84x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.601, Ratio=2.87x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.611, Ratio=2.95x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.595, Ratio=2.81x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.602, Ratio=2.87x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.613, Ratio=2.88x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.599, Ratio=2.86x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.577, Ratio=2.72x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.594, Ratio=2.77x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.591, Ratio=2.87x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.574, Ratio=2.78x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.584, Ratio=2.76x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.601, Ratio=2.82x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.590, Ratio=2.85x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.593, Ratio=2.77x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.605, Ratio=2.82x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.621, Ratio=2.99x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.581, Ratio=2.80x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.603, Ratio=2.83x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.589, Ratio=2.76x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.613, Ratio=2.91x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.607, Ratio=2.90x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.614, Ratio=2.87x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.603, Ratio=2.82x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.617, Ratio=2.90x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.590, Ratio=2.76x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.616, Ratio=2.91x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.573, Ratio=2.76x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.603, Ratio=2.93x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.620, Ratio=2.95x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.601, Ratio=2.79x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.618, Ratio=2.94x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.586, Ratio=2.76x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.605, Ratio=2.82x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.566, Ratio=2.81x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.617, Ratio=2.94x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.608, Ratio=2.93x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.609, Ratio=2.89x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.590, Ratio=2.83x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.592, Ratio=2.77x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.595, Ratio=2.85x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.601, Ratio=2.92x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.608, Ratio=2.86x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.594, Ratio=2.77x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.605, Ratio=2.85x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.601, Ratio=2.85x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.596, Ratio=2.87x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.601, Ratio=2.92x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.580, Ratio=2.80x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.606, Ratio=2.92x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.613, Ratio=2.90x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.617, Ratio=2.83x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.585, Ratio=2.82x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.603, Ratio=2.89x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.611, Ratio=2.85x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.581, Ratio=2.69x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.596, Ratio=2.89x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.607, Ratio=2.94x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.597, Ratio=2.83x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.588, Ratio=2.72x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.597, Ratio=2.89x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.604, Ratio=2.83x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.608, Ratio=2.94x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.578, Ratio=2.75x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.603, Ratio=2.94x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.607, Ratio=2.84x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.589, Ratio=2.87x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.596, Ratio=2.87x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.599, Ratio=2.83x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.614, Ratio=2.96x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.606, Ratio=2.84x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.605, Ratio=2.87x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.606, Ratio=2.89x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.581, Ratio=2.74x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.589, Ratio=2.76x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.609, Ratio=2.96x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.595, Ratio=2.80x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.602, Ratio=2.86x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.611, Ratio=2.91x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.589, Ratio=2.83x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.594, Ratio=2.87x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.594, Ratio=2.86x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.590, Ratio=2.83x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.604, Ratio=2.87x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.593, Ratio=2.85x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.619, Ratio=2.94x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.583, Ratio=2.67x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.589, Ratio=2.82x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.600, Ratio=2.87x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.623, Ratio=2.92x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.575, Ratio=2.69x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.572, Ratio=2.77x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.591, Ratio=2.74x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.605, Ratio=2.95x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.616, Ratio=2.98x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.597, Ratio=2.84x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.607, Ratio=2.92x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.587, Ratio=2.78x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.591, Ratio=2.80x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.602, Ratio=2.85x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.590, Ratio=2.84x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.605, Ratio=2.87x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.605, Ratio=2.79x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.607, Ratio=2.92x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.606, Ratio=2.80x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.628, Ratio=3.01x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.622, Ratio=2.88x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.600, Ratio=2.87x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.612, Ratio=2.85x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.590, Ratio=2.78x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.604, Ratio=2.87x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.586, Ratio=2.78x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.605, Ratio=2.92x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.585, Ratio=2.78x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.621, Ratio=3.00x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.598, Ratio=2.94x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.600, Ratio=2.80x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.598, Ratio=2.80x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.592, Ratio=2.87x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.559, Ratio=2.78x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.604, Ratio=2.91x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.572, Ratio=2.73x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.579, Ratio=2.76x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.597, Ratio=2.80x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.600, Ratio=2.89x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.588, Ratio=2.79x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.595, Ratio=2.91x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.582, Ratio=2.73x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.579, Ratio=2.73x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.602, Ratio=2.88x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.583, Ratio=2.77x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.607, Ratio=2.82x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.606, Ratio=2.85x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.587, Ratio=2.84x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.577, Ratio=2.76x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.580, Ratio=2.68x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.599, Ratio=2.81x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.608, Ratio=2.88x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.596, Ratio=2.83x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.609, Ratio=2.89x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.601, Ratio=2.91x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.591, Ratio=2.80x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.594, Ratio=2.82x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.571, Ratio=2.76x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.586, Ratio=2.77x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.607, Ratio=2.92x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.601, Ratio=2.86x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.578, Ratio=2.76x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.597, Ratio=2.79x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.600, Ratio=2.78x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.620, Ratio=2.95x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.586, Ratio=2.74x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.606, Ratio=2.93x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.618, Ratio=3.07x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.600, Ratio=2.82x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.601, Ratio=2.91x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.610, Ratio=2.81x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.601, Ratio=2.88x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.603, Ratio=2.87x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.579, Ratio=2.76x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.583, Ratio=2.79x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.594, Ratio=2.81x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.573, Ratio=2.64x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.571, Ratio=2.72x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.575, Ratio=2.75x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.585, Ratio=2.85x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.580, Ratio=2.66x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.594, Ratio=2.81x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.573, Ratio=2.66x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.608, Ratio=2.89x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.571, Ratio=2.68x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.587, Ratio=2.74x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.609, Ratio=2.87x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.584, Ratio=2.84x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.605, Ratio=2.91x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.619, Ratio=3.02x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.602, Ratio=2.92x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.604, Ratio=2.82x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.612, Ratio=2.80x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.596, Ratio=2.80x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.593, Ratio=2.84x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.593, Ratio=2.75x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.592, Ratio=2.84x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.609, Ratio=2.86x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.607, Ratio=2.92x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.589, Ratio=2.76x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.606, Ratio=2.85x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.595, Ratio=2.79x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.587, Ratio=2.85x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.586, Ratio=2.73x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.607, Ratio=2.91x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.610, Ratio=2.94x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.594, Ratio=2.81x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.597, Ratio=2.82x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.591, Ratio=2.78x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.602, Ratio=2.85x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.614, Ratio=2.93x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.601, Ratio=2.85x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.612, Ratio=2.93x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.628, Ratio=2.99x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.610, Ratio=2.92x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.604, Ratio=2.91x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.592, Ratio=2.78x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.603, Ratio=2.82x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.603, Ratio=2.84x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.601, Ratio=2.86x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.603, Ratio=2.80x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.588, Ratio=2.80x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.594, Ratio=2.90x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.612, Ratio=2.98x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.589, Ratio=2.74x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.594, Ratio=2.82x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.604, Ratio=2.79x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.572, Ratio=2.76x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.583, Ratio=2.82x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.606, Ratio=2.86x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.598, Ratio=2.79x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.595, Ratio=2.86x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.624, Ratio=2.96x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.608, Ratio=2.79x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.588, Ratio=2.75x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.611, Ratio=2.97x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.596, Ratio=2.79x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.619, Ratio=2.94x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.606, Ratio=2.94x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.600, Ratio=2.92x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.583, Ratio=2.76x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.603, Ratio=2.85x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.598, Ratio=2.81x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.612, Ratio=2.98x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.590, Ratio=2.84x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.588, Ratio=2.81x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.598, Ratio=2.83x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.608, Ratio=2.82x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.606, Ratio=2.90x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.603, Ratio=2.84x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.593, Ratio=2.80x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.589, Ratio=2.82x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.603, Ratio=2.79x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.599, Ratio=2.91x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.589, Ratio=2.79x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.608, Ratio=2.88x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.607, Ratio=2.90x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.589, Ratio=2.73x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.592, Ratio=2.79x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.588, Ratio=2.81x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.561, Ratio=2.69x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.579, Ratio=2.80x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.587, Ratio=2.80x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.605, Ratio=2.93x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.626, Ratio=2.99x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.595, Ratio=2.78x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.585, Ratio=2.72x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.632, Ratio=3.03x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.610, Ratio=2.90x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.579, Ratio=2.69x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.603, Ratio=2.82x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.608, Ratio=2.85x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.596, Ratio=2.89x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.588, Ratio=2.86x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.620, Ratio=2.99x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.590, Ratio=2.91x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.572, Ratio=2.79x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.568, Ratio=2.74x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.587, Ratio=2.79x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.598, Ratio=2.86x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.616, Ratio=2.90x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.597, Ratio=2.91x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.601, Ratio=2.80x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.607, Ratio=2.89x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.602, Ratio=2.82x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.586, Ratio=2.84x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.616, Ratio=2.92x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.594, Ratio=2.82x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.622, Ratio=3.01x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.574, Ratio=2.67x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.615, Ratio=2.90x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.584, Ratio=2.81x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.600, Ratio=2.86x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.605, Ratio=2.89x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.599, Ratio=2.92x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.580, Ratio=2.75x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.600, Ratio=2.84x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.596, Ratio=2.80x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.591, Ratio=2.78x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.599, Ratio=2.86x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.584, Ratio=2.77x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.590, Ratio=2.78x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.594, Ratio=2.82x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.605, Ratio=2.88x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.599, Ratio=2.85x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.596, Ratio=2.85x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.592, Ratio=2.83x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.591, Ratio=2.75x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.586, Ratio=2.76x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.563, Ratio=2.73x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.579, Ratio=2.81x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.596, Ratio=2.73x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.597, Ratio=2.82x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.599, Ratio=2.81x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.583, Ratio=2.75x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.573, Ratio=2.73x, Gap=-3.169

============================================================
Epoch 4/20 completed in 38.8s
Train: Loss=1.2123 (C:1.2123, R:0.0000) Ratio=2.53x
Val:   Loss=1.1670 (C:1.1670, R:0.0000) Ratio=2.97x
‚úÖ New best model saved (Val Loss: 1.1670)
============================================================

Epoch 5 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.588, Ratio=2.78x, Gap=-3.370
Batch   0/537: Loss=1.1796 (C:1.1796, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.600, Ratio=2.71x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.608, Ratio=2.84x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.577, Ratio=2.66x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.590, Ratio=2.73x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.614, Ratio=2.87x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.555, Ratio=2.65x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.595, Ratio=2.67x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.618, Ratio=2.89x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.597, Ratio=2.72x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.617, Ratio=2.81x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.599, Ratio=2.77x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.571, Ratio=2.66x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.563, Ratio=2.63x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.609, Ratio=2.84x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.567, Ratio=2.64x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.619, Ratio=2.90x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.590, Ratio=2.69x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.602, Ratio=2.77x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.607, Ratio=2.78x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.586, Ratio=2.65x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.584, Ratio=2.73x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.623, Ratio=2.93x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.612, Ratio=2.78x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.598, Ratio=2.77x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.604, Ratio=2.74x, Gap=-3.639
Batch  25/537: Loss=1.1877 (C:1.1877, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.580, Ratio=2.63x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.592, Ratio=2.77x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.620, Ratio=2.78x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.600, Ratio=2.75x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.592, Ratio=2.72x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.592, Ratio=2.75x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.597, Ratio=2.74x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.607, Ratio=2.74x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.621, Ratio=2.93x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.589, Ratio=2.76x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.602, Ratio=2.76x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.598, Ratio=2.84x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.596, Ratio=2.72x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.606, Ratio=2.81x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.595, Ratio=2.71x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.594, Ratio=2.83x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.597, Ratio=2.78x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.609, Ratio=2.88x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.598, Ratio=2.68x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.602, Ratio=2.73x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.619, Ratio=2.87x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.603, Ratio=2.78x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.600, Ratio=2.73x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.588, Ratio=2.75x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.610, Ratio=2.79x, Gap=-3.560
Batch  50/537: Loss=1.1749 (C:1.1749, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.578, Ratio=2.73x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.630, Ratio=2.86x, Gap=-4.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.580, Ratio=2.62x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.635, Ratio=2.92x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.622, Ratio=2.80x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.626, Ratio=2.81x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.614, Ratio=2.76x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.581, Ratio=2.67x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.599, Ratio=2.75x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.598, Ratio=2.80x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.586, Ratio=2.76x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.591, Ratio=2.74x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.578, Ratio=2.75x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.589, Ratio=2.70x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.582, Ratio=2.69x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.593, Ratio=2.73x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.592, Ratio=2.68x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.611, Ratio=2.70x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.587, Ratio=2.68x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.591, Ratio=2.66x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.592, Ratio=2.69x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.595, Ratio=2.70x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.608, Ratio=2.82x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.598, Ratio=2.75x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.599, Ratio=2.70x, Gap=-3.672
Batch  75/537: Loss=1.1994 (C:1.1994, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.597, Ratio=2.79x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.596, Ratio=2.65x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.603, Ratio=2.77x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.591, Ratio=2.69x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.572, Ratio=2.62x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.597, Ratio=2.76x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.611, Ratio=2.88x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.585, Ratio=2.67x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.558, Ratio=2.67x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.589, Ratio=2.68x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.610, Ratio=2.82x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.579, Ratio=2.73x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.601, Ratio=2.82x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.596, Ratio=2.71x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.597, Ratio=2.71x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.622, Ratio=2.80x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.583, Ratio=2.67x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.593, Ratio=2.66x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.609, Ratio=2.78x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.619, Ratio=2.77x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.611, Ratio=2.70x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.575, Ratio=2.62x, Gap=-4.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.599, Ratio=2.67x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.581, Ratio=2.77x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.592, Ratio=2.79x, Gap=-3.218
Batch 100/537: Loss=1.1780 (C:1.1780, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.608, Ratio=2.72x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.609, Ratio=2.80x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.568, Ratio=2.59x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.567, Ratio=2.67x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.579, Ratio=2.65x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.630, Ratio=2.90x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.578, Ratio=2.59x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.591, Ratio=2.73x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.596, Ratio=2.75x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.585, Ratio=2.63x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.601, Ratio=2.77x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.597, Ratio=2.74x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.595, Ratio=2.74x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.612, Ratio=2.85x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.585, Ratio=2.69x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.605, Ratio=2.76x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.595, Ratio=2.71x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.607, Ratio=2.76x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.593, Ratio=2.80x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.611, Ratio=2.81x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.623, Ratio=2.88x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.585, Ratio=2.67x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.588, Ratio=2.78x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.615, Ratio=2.82x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.598, Ratio=2.75x, Gap=-3.910
Batch 125/537: Loss=1.1835 (C:1.1835, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.599, Ratio=2.76x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.584, Ratio=2.68x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.621, Ratio=2.89x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.593, Ratio=2.76x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.588, Ratio=2.73x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.601, Ratio=2.82x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.590, Ratio=2.65x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.586, Ratio=2.68x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.608, Ratio=2.75x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.596, Ratio=2.81x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.605, Ratio=2.84x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.592, Ratio=2.72x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.591, Ratio=2.71x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.608, Ratio=2.81x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.600, Ratio=2.76x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.594, Ratio=2.73x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.598, Ratio=2.76x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.607, Ratio=2.76x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.613, Ratio=2.74x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.596, Ratio=2.71x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.597, Ratio=2.70x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.619, Ratio=2.74x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.603, Ratio=2.68x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.604, Ratio=2.66x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.596, Ratio=2.65x, Gap=-3.587
Batch 150/537: Loss=1.2120 (C:1.2120, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.613, Ratio=2.87x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.602, Ratio=2.78x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.583, Ratio=2.69x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.603, Ratio=2.73x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.598, Ratio=2.70x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.582, Ratio=2.72x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.586, Ratio=2.78x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.590, Ratio=2.76x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.611, Ratio=2.82x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.577, Ratio=2.74x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.624, Ratio=2.91x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.601, Ratio=2.77x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.598, Ratio=2.70x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.600, Ratio=2.81x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.584, Ratio=2.65x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.599, Ratio=2.73x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.599, Ratio=2.70x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.593, Ratio=2.65x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.576, Ratio=2.66x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.597, Ratio=2.76x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.590, Ratio=2.74x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.611, Ratio=2.83x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.607, Ratio=2.82x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.604, Ratio=2.79x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.622, Ratio=2.86x, Gap=-3.459
Batch 175/537: Loss=1.1557 (C:1.1557, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.618, Ratio=2.87x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.586, Ratio=2.60x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.604, Ratio=2.71x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.612, Ratio=2.73x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.650, Ratio=2.85x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.615, Ratio=2.83x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.605, Ratio=2.83x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.589, Ratio=2.63x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.604, Ratio=2.91x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.581, Ratio=2.66x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.592, Ratio=2.70x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.610, Ratio=2.76x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.566, Ratio=2.60x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.592, Ratio=2.70x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.596, Ratio=2.71x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.595, Ratio=2.65x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.605, Ratio=2.87x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.592, Ratio=2.76x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.598, Ratio=2.73x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.587, Ratio=2.72x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.578, Ratio=2.72x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.603, Ratio=2.75x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.601, Ratio=2.77x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.593, Ratio=2.69x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.608, Ratio=2.84x, Gap=-3.590
Batch 200/537: Loss=1.1626 (C:1.1626, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.602, Ratio=2.77x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.615, Ratio=2.87x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.608, Ratio=2.82x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.604, Ratio=2.76x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.602, Ratio=2.71x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.571, Ratio=2.72x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.589, Ratio=2.71x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.602, Ratio=2.76x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.580, Ratio=2.61x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.592, Ratio=2.66x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.586, Ratio=2.71x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.606, Ratio=2.73x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.592, Ratio=2.78x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.587, Ratio=2.79x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.620, Ratio=2.88x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.582, Ratio=2.69x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.592, Ratio=2.75x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.610, Ratio=2.81x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.594, Ratio=2.68x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.588, Ratio=2.68x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.612, Ratio=2.69x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.608, Ratio=2.74x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.605, Ratio=2.74x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.596, Ratio=2.66x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.582, Ratio=2.62x, Gap=-3.813
Batch 225/537: Loss=1.2227 (C:1.2227, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.611, Ratio=2.80x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.645, Ratio=2.95x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.579, Ratio=2.69x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.608, Ratio=2.79x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.608, Ratio=2.75x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.578, Ratio=2.61x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.614, Ratio=2.74x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.586, Ratio=2.67x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.619, Ratio=2.79x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.604, Ratio=2.76x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.591, Ratio=2.64x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.634, Ratio=2.88x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.605, Ratio=2.68x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.605, Ratio=2.73x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.577, Ratio=2.68x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.592, Ratio=2.74x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.568, Ratio=2.65x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.597, Ratio=2.80x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.569, Ratio=2.62x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.610, Ratio=2.80x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.605, Ratio=2.77x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.594, Ratio=2.75x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.603, Ratio=2.74x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.590, Ratio=2.65x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.609, Ratio=2.74x, Gap=-3.459
Batch 250/537: Loss=1.1906 (C:1.1906, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.619, Ratio=2.78x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.617, Ratio=2.85x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.608, Ratio=2.78x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.620, Ratio=2.82x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.589, Ratio=2.68x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.621, Ratio=2.93x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.589, Ratio=2.76x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.591, Ratio=2.69x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.583, Ratio=2.75x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.583, Ratio=2.74x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.598, Ratio=2.77x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.603, Ratio=2.77x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.620, Ratio=2.85x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.583, Ratio=2.70x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.607, Ratio=2.77x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.600, Ratio=2.70x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.616, Ratio=2.78x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.600, Ratio=2.71x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.605, Ratio=2.69x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.590, Ratio=2.56x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.608, Ratio=2.76x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.583, Ratio=2.65x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.611, Ratio=2.75x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.600, Ratio=2.71x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.558, Ratio=2.52x, Gap=-3.714
Batch 275/537: Loss=1.2480 (C:1.2480, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.594, Ratio=2.80x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.587, Ratio=2.80x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.597, Ratio=2.78x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.614, Ratio=2.87x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.608, Ratio=2.77x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.595, Ratio=2.75x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.602, Ratio=2.70x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.593, Ratio=2.67x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.608, Ratio=2.77x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.579, Ratio=2.73x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.560, Ratio=2.53x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.602, Ratio=2.67x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.591, Ratio=2.75x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.615, Ratio=2.85x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.576, Ratio=2.61x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.606, Ratio=2.77x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.612, Ratio=2.85x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.610, Ratio=2.67x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.599, Ratio=2.76x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.581, Ratio=2.72x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.591, Ratio=2.76x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.580, Ratio=2.65x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.597, Ratio=2.74x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.609, Ratio=2.87x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.576, Ratio=2.68x, Gap=-3.668
Batch 300/537: Loss=1.2039 (C:1.2039, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.607, Ratio=2.76x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.563, Ratio=2.57x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.600, Ratio=2.67x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.596, Ratio=2.74x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.601, Ratio=2.73x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.607, Ratio=2.73x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.604, Ratio=2.69x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.596, Ratio=2.68x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.596, Ratio=2.79x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.600, Ratio=2.73x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.589, Ratio=2.67x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.586, Ratio=2.70x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.594, Ratio=2.72x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.571, Ratio=2.60x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.561, Ratio=2.64x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.581, Ratio=2.64x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.573, Ratio=2.70x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.596, Ratio=2.78x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.566, Ratio=2.73x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.586, Ratio=2.77x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.583, Ratio=2.69x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.602, Ratio=2.75x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.597, Ratio=2.71x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.617, Ratio=2.73x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.599, Ratio=2.77x, Gap=-3.539
Batch 325/537: Loss=1.1825 (C:1.1825, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.598, Ratio=2.72x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.585, Ratio=2.66x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.606, Ratio=2.76x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.584, Ratio=2.57x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.595, Ratio=2.71x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.612, Ratio=2.86x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.592, Ratio=2.73x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.580, Ratio=2.70x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.587, Ratio=2.76x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.601, Ratio=2.75x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.591, Ratio=2.74x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.588, Ratio=2.65x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.609, Ratio=2.73x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.608, Ratio=2.75x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.619, Ratio=2.88x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.599, Ratio=2.76x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.604, Ratio=2.79x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.597, Ratio=2.78x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.606, Ratio=2.69x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.571, Ratio=2.65x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.596, Ratio=2.79x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.595, Ratio=2.71x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.585, Ratio=2.76x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.584, Ratio=2.76x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.607, Ratio=2.76x, Gap=-3.524
Batch 350/537: Loss=1.1818 (C:1.1818, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.584, Ratio=2.72x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.598, Ratio=2.77x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.608, Ratio=2.81x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.583, Ratio=2.72x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.605, Ratio=2.73x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.585, Ratio=2.73x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.592, Ratio=2.69x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.605, Ratio=2.80x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.597, Ratio=2.74x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.588, Ratio=2.68x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.597, Ratio=2.73x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.617, Ratio=2.75x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.604, Ratio=2.80x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.616, Ratio=2.83x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.592, Ratio=2.72x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.617, Ratio=2.82x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.614, Ratio=2.85x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.612, Ratio=2.77x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.573, Ratio=2.57x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.589, Ratio=2.62x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.617, Ratio=2.78x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.621, Ratio=2.86x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.591, Ratio=2.70x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.603, Ratio=2.72x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.615, Ratio=2.76x, Gap=-3.642
Batch 375/537: Loss=1.1840 (C:1.1840, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.594, Ratio=2.78x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.610, Ratio=2.74x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.588, Ratio=2.71x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.588, Ratio=2.79x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.612, Ratio=2.78x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.585, Ratio=2.74x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.606, Ratio=2.87x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.592, Ratio=2.82x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.598, Ratio=2.74x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.574, Ratio=2.58x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.609, Ratio=2.85x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.610, Ratio=2.73x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.599, Ratio=2.73x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.588, Ratio=2.67x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.619, Ratio=2.83x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.584, Ratio=2.69x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.626, Ratio=2.89x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.604, Ratio=2.77x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.592, Ratio=2.66x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.589, Ratio=2.69x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.593, Ratio=2.67x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.589, Ratio=2.74x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.584, Ratio=2.65x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.579, Ratio=2.63x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.599, Ratio=2.68x, Gap=-3.972
Batch 400/537: Loss=1.2036 (C:1.2036, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.599, Ratio=2.84x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.569, Ratio=2.62x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.595, Ratio=2.75x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.572, Ratio=2.73x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.588, Ratio=2.71x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.585, Ratio=2.70x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.599, Ratio=2.78x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.593, Ratio=2.74x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.599, Ratio=2.75x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.628, Ratio=2.92x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.611, Ratio=2.78x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.605, Ratio=2.82x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.613, Ratio=2.79x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.585, Ratio=2.56x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.594, Ratio=2.66x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.600, Ratio=2.77x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.590, Ratio=2.59x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.595, Ratio=2.74x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.584, Ratio=2.76x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.604, Ratio=2.80x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.604, Ratio=2.83x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.610, Ratio=2.76x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.587, Ratio=2.74x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.581, Ratio=2.61x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.579, Ratio=2.66x, Gap=-3.490
Batch 425/537: Loss=1.2101 (C:1.2101, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.574, Ratio=2.72x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.587, Ratio=2.70x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.586, Ratio=2.67x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.565, Ratio=2.54x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.582, Ratio=2.68x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.605, Ratio=2.79x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.597, Ratio=2.78x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.604, Ratio=2.82x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.592, Ratio=2.71x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.621, Ratio=2.87x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.593, Ratio=2.72x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.567, Ratio=2.63x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.606, Ratio=2.80x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.608, Ratio=2.85x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.589, Ratio=2.69x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.614, Ratio=2.78x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.632, Ratio=2.91x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.605, Ratio=2.73x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.590, Ratio=2.63x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.616, Ratio=2.70x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.617, Ratio=2.90x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.609, Ratio=2.73x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.576, Ratio=2.68x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.584, Ratio=2.71x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.577, Ratio=2.72x, Gap=-3.562
Batch 450/537: Loss=1.1959 (C:1.1959, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.606, Ratio=2.71x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.592, Ratio=2.72x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.589, Ratio=2.74x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.625, Ratio=2.89x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.610, Ratio=2.84x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.587, Ratio=2.73x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.605, Ratio=2.80x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.615, Ratio=2.86x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.587, Ratio=2.73x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.602, Ratio=2.77x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.614, Ratio=2.78x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.579, Ratio=2.62x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.612, Ratio=2.79x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.627, Ratio=2.84x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.613, Ratio=2.79x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.605, Ratio=2.70x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.602, Ratio=2.80x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.597, Ratio=2.70x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.605, Ratio=2.79x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.604, Ratio=2.77x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.599, Ratio=2.72x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.586, Ratio=2.69x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.615, Ratio=2.88x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.594, Ratio=2.75x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.580, Ratio=2.62x, Gap=-3.575
Batch 475/537: Loss=1.2211 (C:1.2211, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.592, Ratio=2.78x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.613, Ratio=2.81x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.607, Ratio=2.66x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.591, Ratio=2.73x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.593, Ratio=2.67x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.597, Ratio=2.75x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.600, Ratio=2.79x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.590, Ratio=2.78x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.602, Ratio=2.79x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.591, Ratio=2.69x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.608, Ratio=2.78x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.599, Ratio=2.78x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.628, Ratio=2.87x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.586, Ratio=2.68x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.617, Ratio=2.81x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.595, Ratio=2.70x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.582, Ratio=2.66x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.598, Ratio=2.71x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.599, Ratio=2.76x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.590, Ratio=2.72x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.585, Ratio=2.71x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.585, Ratio=2.65x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.605, Ratio=2.70x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.588, Ratio=2.68x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.599, Ratio=2.67x, Gap=-3.700
Batch 500/537: Loss=1.2053 (C:1.2053, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.578, Ratio=2.67x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.594, Ratio=2.68x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.596, Ratio=2.67x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.594, Ratio=2.75x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.604, Ratio=2.83x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.571, Ratio=2.62x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.576, Ratio=2.67x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.609, Ratio=2.80x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.602, Ratio=2.86x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.598, Ratio=2.71x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.619, Ratio=2.79x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.612, Ratio=2.81x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.600, Ratio=2.72x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.590, Ratio=2.63x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.599, Ratio=2.72x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.612, Ratio=2.75x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.603, Ratio=2.72x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.608, Ratio=2.72x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.582, Ratio=2.70x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.569, Ratio=2.65x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.595, Ratio=2.75x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.568, Ratio=2.63x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.592, Ratio=2.74x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.567, Ratio=2.68x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.608, Ratio=2.75x, Gap=-3.555
Batch 525/537: Loss=1.1861 (C:1.1861, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.579, Ratio=2.73x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.595, Ratio=2.70x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.586, Ratio=2.64x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.604, Ratio=2.79x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.567, Ratio=2.62x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.582, Ratio=2.61x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.585, Ratio=2.62x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.606, Ratio=2.76x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.616, Ratio=2.82x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.596, Ratio=2.75x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.605, Ratio=2.80x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.596, Ratio=2.88x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.617, Ratio=3.00x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.609, Ratio=2.88x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.594, Ratio=2.80x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.608, Ratio=2.87x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.589, Ratio=2.84x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.634, Ratio=3.07x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.608, Ratio=2.82x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.614, Ratio=2.91x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.601, Ratio=2.94x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.642, Ratio=3.06x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.609, Ratio=2.88x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.589, Ratio=2.81x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.596, Ratio=2.80x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.636, Ratio=3.06x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.599, Ratio=2.93x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.614, Ratio=2.95x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.634, Ratio=3.10x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.615, Ratio=2.92x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.581, Ratio=2.74x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.635, Ratio=3.06x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.616, Ratio=2.94x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.628, Ratio=2.98x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.618, Ratio=2.96x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.613, Ratio=2.88x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.622, Ratio=2.98x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.612, Ratio=2.94x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.602, Ratio=2.79x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.611, Ratio=2.93x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.611, Ratio=2.84x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.592, Ratio=2.79x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.626, Ratio=3.01x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.626, Ratio=2.92x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.601, Ratio=2.88x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.618, Ratio=2.90x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.619, Ratio=2.89x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.610, Ratio=2.84x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.636, Ratio=3.03x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.610, Ratio=2.87x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.577, Ratio=2.74x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.613, Ratio=2.98x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.588, Ratio=2.81x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.611, Ratio=2.87x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.622, Ratio=2.92x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.592, Ratio=2.75x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.605, Ratio=2.81x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.621, Ratio=2.97x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.613, Ratio=2.83x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.604, Ratio=2.91x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.607, Ratio=2.88x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.611, Ratio=2.87x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.610, Ratio=2.95x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.603, Ratio=2.94x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.624, Ratio=2.98x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.614, Ratio=2.96x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.613, Ratio=2.89x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.599, Ratio=2.84x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.595, Ratio=2.81x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.618, Ratio=3.00x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.607, Ratio=2.84x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.600, Ratio=2.92x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.588, Ratio=2.78x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.607, Ratio=2.92x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.619, Ratio=2.91x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.625, Ratio=2.99x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.596, Ratio=2.79x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.582, Ratio=2.73x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.612, Ratio=2.94x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.605, Ratio=2.83x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.582, Ratio=2.87x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.634, Ratio=3.07x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.625, Ratio=2.95x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.639, Ratio=3.14x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.631, Ratio=2.99x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.592, Ratio=2.79x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.625, Ratio=2.92x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.608, Ratio=2.86x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.604, Ratio=2.93x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.586, Ratio=2.79x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.636, Ratio=3.02x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.610, Ratio=2.97x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.632, Ratio=3.01x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.594, Ratio=2.76x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.625, Ratio=3.00x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.609, Ratio=2.94x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.613, Ratio=2.85x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.606, Ratio=2.90x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.625, Ratio=2.99x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.627, Ratio=2.94x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.614, Ratio=3.01x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.608, Ratio=2.93x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.618, Ratio=2.93x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.633, Ratio=3.01x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.625, Ratio=3.04x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.629, Ratio=2.92x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.605, Ratio=2.92x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.591, Ratio=2.84x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.615, Ratio=2.99x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.624, Ratio=2.96x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.617, Ratio=2.96x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.606, Ratio=2.85x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.614, Ratio=2.97x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.618, Ratio=2.99x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.616, Ratio=2.91x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.616, Ratio=2.94x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.587, Ratio=2.86x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.599, Ratio=2.86x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.620, Ratio=2.84x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.608, Ratio=2.86x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.590, Ratio=2.75x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.602, Ratio=2.93x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.591, Ratio=2.76x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.622, Ratio=2.93x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.608, Ratio=2.81x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.613, Ratio=2.97x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.590, Ratio=2.77x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.590, Ratio=2.76x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.604, Ratio=2.90x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.616, Ratio=2.99x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.618, Ratio=2.94x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.613, Ratio=2.85x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.617, Ratio=2.96x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.598, Ratio=2.84x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.623, Ratio=2.98x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.620, Ratio=2.88x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.614, Ratio=2.92x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.606, Ratio=2.87x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.643, Ratio=3.02x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.604, Ratio=2.96x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.607, Ratio=2.81x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.622, Ratio=2.98x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.611, Ratio=2.90x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.610, Ratio=2.91x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.616, Ratio=2.92x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.605, Ratio=2.87x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.574, Ratio=2.63x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.621, Ratio=2.96x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.635, Ratio=3.00x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.609, Ratio=2.93x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.601, Ratio=2.88x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.607, Ratio=2.91x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.631, Ratio=3.01x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.626, Ratio=3.00x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.622, Ratio=2.89x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.612, Ratio=2.94x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.629, Ratio=3.00x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.593, Ratio=2.78x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.613, Ratio=2.89x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.602, Ratio=2.83x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.616, Ratio=3.01x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.614, Ratio=2.91x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.630, Ratio=2.99x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.620, Ratio=2.88x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.597, Ratio=2.82x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.590, Ratio=2.86x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.595, Ratio=2.81x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.615, Ratio=2.94x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.609, Ratio=2.89x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.638, Ratio=3.02x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.620, Ratio=2.98x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.610, Ratio=2.88x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.584, Ratio=2.79x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.613, Ratio=2.89x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.619, Ratio=2.93x, Gap=-3.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.635, Ratio=3.10x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.615, Ratio=3.01x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.634, Ratio=3.02x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.625, Ratio=3.00x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.615, Ratio=2.91x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.607, Ratio=3.00x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.616, Ratio=2.88x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.597, Ratio=2.80x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.614, Ratio=2.94x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.623, Ratio=2.94x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.611, Ratio=2.88x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.608, Ratio=2.89x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.618, Ratio=2.99x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.603, Ratio=2.93x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.610, Ratio=2.95x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.599, Ratio=2.81x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.615, Ratio=2.89x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.622, Ratio=3.01x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.635, Ratio=3.05x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.603, Ratio=2.82x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.593, Ratio=2.80x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.605, Ratio=2.83x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.608, Ratio=2.89x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.610, Ratio=2.87x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.593, Ratio=2.75x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.607, Ratio=2.86x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.627, Ratio=3.02x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.604, Ratio=2.84x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.606, Ratio=2.85x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.617, Ratio=2.87x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.606, Ratio=2.82x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.603, Ratio=2.84x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.587, Ratio=2.83x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.609, Ratio=2.87x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.614, Ratio=2.92x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.626, Ratio=2.91x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.583, Ratio=2.87x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.629, Ratio=2.94x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.598, Ratio=2.83x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.590, Ratio=2.74x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.614, Ratio=2.88x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.622, Ratio=3.01x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.622, Ratio=3.05x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.609, Ratio=2.92x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.592, Ratio=2.83x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.614, Ratio=2.91x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.605, Ratio=2.81x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.617, Ratio=3.00x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.601, Ratio=2.83x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.599, Ratio=2.84x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.618, Ratio=2.90x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.629, Ratio=3.04x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.609, Ratio=2.91x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.607, Ratio=2.87x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.607, Ratio=2.85x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.629, Ratio=3.02x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.608, Ratio=2.84x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.600, Ratio=2.86x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.613, Ratio=2.93x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.623, Ratio=3.01x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.613, Ratio=2.86x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.621, Ratio=2.96x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.610, Ratio=2.98x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.601, Ratio=2.83x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.600, Ratio=2.80x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.602, Ratio=2.88x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.644, Ratio=3.04x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.623, Ratio=3.03x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.584, Ratio=2.82x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.609, Ratio=2.84x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.620, Ratio=2.87x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.606, Ratio=2.83x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.593, Ratio=2.75x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.610, Ratio=2.94x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.607, Ratio=2.86x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.596, Ratio=2.83x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.608, Ratio=2.84x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.630, Ratio=3.04x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.599, Ratio=2.86x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.629, Ratio=3.02x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.596, Ratio=2.81x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.631, Ratio=3.01x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.614, Ratio=2.96x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.605, Ratio=2.86x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.582, Ratio=2.77x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.608, Ratio=2.94x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.621, Ratio=2.90x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.590, Ratio=2.80x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.627, Ratio=2.94x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.626, Ratio=2.99x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.588, Ratio=2.75x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.593, Ratio=2.80x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.623, Ratio=2.97x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.616, Ratio=2.90x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.592, Ratio=2.78x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.609, Ratio=2.88x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.638, Ratio=3.00x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.626, Ratio=2.96x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.615, Ratio=2.93x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.631, Ratio=2.98x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.631, Ratio=3.02x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.648, Ratio=3.08x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.604, Ratio=2.85x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.616, Ratio=2.94x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.626, Ratio=3.00x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.617, Ratio=2.89x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.616, Ratio=2.87x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.599, Ratio=2.90x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.627, Ratio=2.91x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.616, Ratio=2.97x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.625, Ratio=2.94x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.639, Ratio=3.11x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.590, Ratio=2.76x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.617, Ratio=3.01x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.612, Ratio=2.98x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.590, Ratio=2.82x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.602, Ratio=2.92x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.627, Ratio=2.95x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.603, Ratio=2.77x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.605, Ratio=2.86x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.616, Ratio=2.90x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.598, Ratio=2.86x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.630, Ratio=3.04x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.607, Ratio=2.85x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.617, Ratio=2.89x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.611, Ratio=2.90x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.600, Ratio=2.87x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.609, Ratio=2.94x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.615, Ratio=2.98x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.630, Ratio=2.95x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.597, Ratio=2.75x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.629, Ratio=2.92x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.610, Ratio=2.90x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.590, Ratio=2.74x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.620, Ratio=2.92x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.591, Ratio=2.88x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.611, Ratio=2.89x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.637, Ratio=3.04x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.633, Ratio=3.00x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.637, Ratio=3.09x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.619, Ratio=2.98x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.620, Ratio=2.84x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.595, Ratio=2.89x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.620, Ratio=2.92x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.601, Ratio=2.83x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.605, Ratio=2.79x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.603, Ratio=2.84x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.602, Ratio=2.83x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.604, Ratio=2.81x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.610, Ratio=2.86x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.618, Ratio=2.98x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.603, Ratio=2.82x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.590, Ratio=2.78x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.605, Ratio=2.88x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.609, Ratio=2.93x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.617, Ratio=2.93x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.624, Ratio=2.89x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.601, Ratio=2.78x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.604, Ratio=2.82x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.622, Ratio=2.97x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.594, Ratio=2.81x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.609, Ratio=2.80x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.627, Ratio=3.04x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.609, Ratio=2.85x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.594, Ratio=2.75x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.619, Ratio=3.00x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.598, Ratio=2.84x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.601, Ratio=2.84x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.626, Ratio=3.01x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.610, Ratio=2.93x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.594, Ratio=2.86x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.611, Ratio=2.90x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.621, Ratio=2.98x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.622, Ratio=2.91x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.632, Ratio=2.97x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.606, Ratio=2.92x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.611, Ratio=2.92x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.595, Ratio=2.84x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.602, Ratio=2.90x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.607, Ratio=2.86x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.610, Ratio=2.90x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.628, Ratio=2.97x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.607, Ratio=2.88x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.623, Ratio=2.92x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.604, Ratio=2.81x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.619, Ratio=2.98x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.620, Ratio=2.93x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.608, Ratio=2.84x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.603, Ratio=2.87x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.627, Ratio=2.93x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.615, Ratio=2.83x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.625, Ratio=3.01x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.606, Ratio=2.95x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.628, Ratio=2.95x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.615, Ratio=2.94x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.629, Ratio=3.00x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.654, Ratio=3.01x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.618, Ratio=2.99x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.607, Ratio=2.88x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.601, Ratio=2.77x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.586, Ratio=2.85x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.621, Ratio=3.03x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.628, Ratio=2.95x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.641, Ratio=3.01x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.621, Ratio=3.01x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.619, Ratio=2.89x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.589, Ratio=2.80x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.630, Ratio=2.94x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.630, Ratio=2.97x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.608, Ratio=2.90x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.626, Ratio=3.09x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.616, Ratio=2.94x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.625, Ratio=2.96x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.573, Ratio=2.80x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.623, Ratio=3.00x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.645, Ratio=3.10x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.607, Ratio=2.84x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.603, Ratio=2.87x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.610, Ratio=2.93x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.626, Ratio=2.92x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.629, Ratio=3.01x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.597, Ratio=2.85x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.608, Ratio=2.95x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.612, Ratio=2.90x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.618, Ratio=2.87x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.622, Ratio=3.01x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.609, Ratio=2.88x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.618, Ratio=2.92x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.600, Ratio=2.82x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.609, Ratio=2.90x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.616, Ratio=2.99x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.618, Ratio=2.93x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.609, Ratio=2.78x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.611, Ratio=2.99x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.603, Ratio=2.90x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.626, Ratio=2.97x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.605, Ratio=2.90x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.612, Ratio=2.88x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.607, Ratio=2.96x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.587, Ratio=2.79x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.617, Ratio=2.97x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.615, Ratio=2.92x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.605, Ratio=2.92x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.636, Ratio=3.08x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.625, Ratio=3.02x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.621, Ratio=2.94x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.611, Ratio=2.86x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.612, Ratio=2.85x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.600, Ratio=2.81x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.627, Ratio=2.91x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.633, Ratio=2.95x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.614, Ratio=2.87x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.600, Ratio=2.89x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.603, Ratio=2.83x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.582, Ratio=2.80x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.577, Ratio=2.73x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.591, Ratio=2.77x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.622, Ratio=2.90x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.604, Ratio=2.86x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.610, Ratio=2.93x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.598, Ratio=2.81x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.588, Ratio=2.77x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.613, Ratio=2.97x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.587, Ratio=2.79x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.603, Ratio=2.88x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.590, Ratio=2.87x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.634, Ratio=3.03x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.635, Ratio=3.09x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.609, Ratio=2.81x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.633, Ratio=3.06x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.613, Ratio=2.93x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.639, Ratio=3.05x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.622, Ratio=2.99x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.597, Ratio=2.81x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.607, Ratio=2.92x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.598, Ratio=2.88x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.607, Ratio=2.84x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.602, Ratio=2.84x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.625, Ratio=2.96x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.578, Ratio=2.77x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.600, Ratio=2.80x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.606, Ratio=2.83x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.600, Ratio=2.83x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.610, Ratio=2.87x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.605, Ratio=2.88x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.615, Ratio=2.88x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.600, Ratio=2.82x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.597, Ratio=2.79x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.605, Ratio=2.83x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.594, Ratio=2.76x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.607, Ratio=2.83x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.610, Ratio=2.83x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.595, Ratio=2.76x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.623, Ratio=2.89x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.598, Ratio=2.85x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.598, Ratio=2.82x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.619, Ratio=2.98x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.626, Ratio=3.00x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.622, Ratio=2.90x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.582, Ratio=2.76x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.613, Ratio=2.91x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.612, Ratio=2.93x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.635, Ratio=3.02x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.596, Ratio=2.78x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.624, Ratio=3.03x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.631, Ratio=3.00x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.615, Ratio=2.88x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.601, Ratio=2.97x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.623, Ratio=2.94x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.619, Ratio=2.91x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.627, Ratio=2.96x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.616, Ratio=2.91x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.597, Ratio=2.81x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.603, Ratio=2.82x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.624, Ratio=3.04x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.630, Ratio=2.84x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.626, Ratio=2.94x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.607, Ratio=2.87x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.625, Ratio=2.98x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.633, Ratio=2.92x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.619, Ratio=2.88x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.607, Ratio=2.88x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.602, Ratio=2.91x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.622, Ratio=2.92x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.614, Ratio=3.03x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.617, Ratio=2.95x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.607, Ratio=2.86x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.618, Ratio=2.86x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.598, Ratio=2.81x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.614, Ratio=2.96x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.623, Ratio=2.93x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.620, Ratio=2.93x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.623, Ratio=2.96x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.607, Ratio=3.00x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.614, Ratio=2.86x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.612, Ratio=2.96x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.624, Ratio=3.02x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.599, Ratio=2.89x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.614, Ratio=2.93x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.599, Ratio=2.93x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.580, Ratio=2.77x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.614, Ratio=2.92x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.607, Ratio=2.84x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.623, Ratio=2.89x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.617, Ratio=2.89x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.633, Ratio=2.92x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.625, Ratio=2.96x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.634, Ratio=3.02x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.616, Ratio=2.94x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.605, Ratio=2.86x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.617, Ratio=2.91x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.603, Ratio=2.80x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.599, Ratio=2.85x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.640, Ratio=3.00x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.627, Ratio=2.92x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.639, Ratio=3.03x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.614, Ratio=2.90x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.627, Ratio=2.95x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.631, Ratio=2.97x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.595, Ratio=2.86x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.609, Ratio=2.84x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.619, Ratio=2.82x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.625, Ratio=2.98x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.619, Ratio=2.90x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.605, Ratio=2.84x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.597, Ratio=2.78x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.602, Ratio=2.90x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.616, Ratio=2.93x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.604, Ratio=2.91x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.598, Ratio=2.82x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.616, Ratio=2.91x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.587, Ratio=2.91x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.605, Ratio=2.87x, Gap=-3.449

============================================================
Epoch 5/20 completed in 32.9s
Train: Loss=1.1890 (C:1.1890, R:0.0000) Ratio=2.72x
Val:   Loss=1.1500 (C:1.1500, R:0.0000) Ratio=3.16x
‚úÖ New best model saved (Val Loss: 1.1500)
Checkpoint saved at epoch 5
============================================================

Epoch 6 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.608, Ratio=2.85x, Gap=-3.512
Batch   0/537: Loss=1.1630 (C:1.1630, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.606, Ratio=2.81x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.636, Ratio=2.88x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.616, Ratio=2.87x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.595, Ratio=2.71x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.602, Ratio=2.77x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.614, Ratio=2.75x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.590, Ratio=2.66x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.588, Ratio=2.70x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.622, Ratio=2.89x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.608, Ratio=2.82x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.598, Ratio=2.74x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.621, Ratio=2.81x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.633, Ratio=2.88x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.615, Ratio=2.85x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.624, Ratio=2.90x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.604, Ratio=2.79x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.607, Ratio=2.77x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.606, Ratio=2.75x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.616, Ratio=2.80x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.612, Ratio=2.87x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.598, Ratio=2.74x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.591, Ratio=2.77x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.592, Ratio=2.73x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.593, Ratio=2.66x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.617, Ratio=2.82x, Gap=-4.025
Batch  25/537: Loss=1.1666 (C:1.1666, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.606, Ratio=2.82x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.617, Ratio=2.85x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.613, Ratio=2.84x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.604, Ratio=2.80x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.601, Ratio=2.72x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.599, Ratio=2.85x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.593, Ratio=2.83x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.633, Ratio=2.92x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.614, Ratio=2.87x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.622, Ratio=2.81x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.628, Ratio=2.96x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.609, Ratio=2.76x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.572, Ratio=2.65x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.602, Ratio=2.78x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.612, Ratio=2.83x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.598, Ratio=2.74x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.594, Ratio=2.74x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.592, Ratio=2.69x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.607, Ratio=2.79x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.599, Ratio=2.79x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.606, Ratio=2.74x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.603, Ratio=2.81x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.612, Ratio=2.77x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.609, Ratio=2.85x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.619, Ratio=2.79x, Gap=-3.576
Batch  50/537: Loss=1.1749 (C:1.1749, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.616, Ratio=2.82x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.619, Ratio=2.94x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.599, Ratio=2.77x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.619, Ratio=2.90x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.588, Ratio=2.79x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.614, Ratio=2.85x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.608, Ratio=2.82x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.620, Ratio=2.91x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.614, Ratio=2.78x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.618, Ratio=2.89x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.610, Ratio=2.78x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.593, Ratio=2.74x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.588, Ratio=2.78x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.603, Ratio=2.71x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.588, Ratio=2.70x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.613, Ratio=2.81x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.595, Ratio=2.67x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.598, Ratio=2.69x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.620, Ratio=2.85x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.606, Ratio=2.81x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.617, Ratio=2.84x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.623, Ratio=2.98x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.619, Ratio=2.86x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.625, Ratio=2.81x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.626, Ratio=2.90x, Gap=-3.596
Batch  75/537: Loss=1.1478 (C:1.1478, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.630, Ratio=2.84x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.604, Ratio=2.84x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.615, Ratio=2.85x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.608, Ratio=2.75x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.586, Ratio=2.70x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.610, Ratio=2.87x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.592, Ratio=2.70x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.588, Ratio=2.74x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.602, Ratio=2.85x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.597, Ratio=2.85x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.596, Ratio=2.76x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.599, Ratio=2.72x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.594, Ratio=2.76x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.610, Ratio=2.86x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.599, Ratio=2.74x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.606, Ratio=2.78x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.621, Ratio=2.89x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.597, Ratio=2.69x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.620, Ratio=2.80x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.591, Ratio=2.65x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.617, Ratio=2.84x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.613, Ratio=2.83x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.620, Ratio=2.84x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.604, Ratio=2.80x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.624, Ratio=2.84x, Gap=-3.547
Batch 100/537: Loss=1.1611 (C:1.1611, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.592, Ratio=2.83x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.593, Ratio=2.79x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.607, Ratio=2.76x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.614, Ratio=2.88x, Gap=-4.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.608, Ratio=2.78x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.621, Ratio=2.86x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.602, Ratio=2.69x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.612, Ratio=2.83x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.599, Ratio=2.76x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.612, Ratio=2.82x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.607, Ratio=2.75x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.598, Ratio=2.77x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.604, Ratio=2.85x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.611, Ratio=2.89x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.631, Ratio=2.87x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.615, Ratio=2.87x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.619, Ratio=2.75x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.596, Ratio=2.81x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.631, Ratio=2.91x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.623, Ratio=2.89x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.586, Ratio=2.69x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.616, Ratio=2.78x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.597, Ratio=2.74x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.599, Ratio=2.83x, Gap=-4.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.588, Ratio=2.79x, Gap=-3.911
Batch 125/537: Loss=1.1764 (C:1.1764, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.609, Ratio=2.80x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.622, Ratio=2.93x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.624, Ratio=2.91x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.609, Ratio=2.78x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.594, Ratio=2.72x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.600, Ratio=2.82x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.613, Ratio=2.86x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.586, Ratio=2.69x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.618, Ratio=2.87x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.595, Ratio=2.71x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.607, Ratio=2.80x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.618, Ratio=2.85x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.599, Ratio=2.67x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.595, Ratio=2.65x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.586, Ratio=2.67x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.597, Ratio=2.74x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.640, Ratio=2.87x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.623, Ratio=2.90x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.620, Ratio=2.80x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.608, Ratio=2.77x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.622, Ratio=2.86x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.598, Ratio=2.72x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.597, Ratio=2.82x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.594, Ratio=2.78x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.595, Ratio=2.73x, Gap=-3.530
Batch 150/537: Loss=1.1920 (C:1.1920, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.609, Ratio=2.75x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.619, Ratio=2.92x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.582, Ratio=2.71x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.593, Ratio=2.80x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.620, Ratio=2.91x, Gap=-4.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.620, Ratio=3.01x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.608, Ratio=2.80x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.614, Ratio=2.85x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.607, Ratio=2.68x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.612, Ratio=2.74x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.624, Ratio=2.83x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.625, Ratio=2.87x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.641, Ratio=2.92x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.610, Ratio=2.86x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.622, Ratio=2.90x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.601, Ratio=2.76x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.594, Ratio=2.72x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.594, Ratio=2.69x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.618, Ratio=2.77x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.619, Ratio=2.82x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.615, Ratio=2.75x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.599, Ratio=2.75x, Gap=-4.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.605, Ratio=2.76x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.601, Ratio=2.79x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.572, Ratio=2.61x, Gap=-3.748
Batch 175/537: Loss=1.2252 (C:1.2252, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.597, Ratio=2.72x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.601, Ratio=2.81x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.612, Ratio=2.81x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.609, Ratio=2.80x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.595, Ratio=2.75x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.616, Ratio=2.96x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.595, Ratio=2.78x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.592, Ratio=2.82x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.583, Ratio=2.75x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.608, Ratio=2.78x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.597, Ratio=2.79x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.597, Ratio=2.69x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.617, Ratio=2.84x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.592, Ratio=2.75x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.610, Ratio=2.74x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.624, Ratio=2.74x, Gap=-4.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.598, Ratio=2.86x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.640, Ratio=2.93x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.589, Ratio=2.74x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.600, Ratio=2.74x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.618, Ratio=2.81x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.599, Ratio=2.68x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.590, Ratio=2.69x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.601, Ratio=2.85x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.593, Ratio=2.68x, Gap=-3.650
Batch 200/537: Loss=1.2056 (C:1.2056, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.601, Ratio=2.71x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.596, Ratio=2.74x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.604, Ratio=2.79x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.596, Ratio=2.77x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.613, Ratio=2.91x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.633, Ratio=2.93x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.593, Ratio=2.74x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.590, Ratio=2.77x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.596, Ratio=2.75x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.597, Ratio=2.70x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.607, Ratio=2.82x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.592, Ratio=2.75x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.608, Ratio=2.76x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.609, Ratio=2.69x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.614, Ratio=2.82x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.589, Ratio=2.80x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.593, Ratio=2.66x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.615, Ratio=2.94x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.601, Ratio=2.84x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.610, Ratio=2.82x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.592, Ratio=2.71x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.597, Ratio=2.73x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.595, Ratio=2.79x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.608, Ratio=2.85x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.624, Ratio=2.84x, Gap=-3.505
Batch 225/537: Loss=1.1610 (C:1.1610, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.591, Ratio=2.74x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.601, Ratio=2.73x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.619, Ratio=2.85x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.598, Ratio=2.92x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.624, Ratio=2.94x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.619, Ratio=2.82x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.600, Ratio=2.76x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.572, Ratio=2.60x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.592, Ratio=2.72x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.595, Ratio=2.77x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.619, Ratio=2.84x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.610, Ratio=2.76x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.626, Ratio=2.80x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.602, Ratio=2.70x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.609, Ratio=2.82x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.588, Ratio=2.71x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.598, Ratio=2.76x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.610, Ratio=2.83x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.586, Ratio=2.73x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.620, Ratio=2.81x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.600, Ratio=2.73x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.597, Ratio=2.65x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.578, Ratio=2.68x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.581, Ratio=2.60x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.613, Ratio=2.80x, Gap=-4.474
Batch 250/537: Loss=1.1709 (C:1.1709, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.583, Ratio=2.80x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.587, Ratio=2.73x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.585, Ratio=2.70x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.592, Ratio=2.76x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.606, Ratio=2.89x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.612, Ratio=2.87x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.583, Ratio=2.75x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.586, Ratio=2.75x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.615, Ratio=2.83x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.603, Ratio=2.73x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.606, Ratio=2.76x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.614, Ratio=2.79x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.597, Ratio=2.83x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.593, Ratio=2.69x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.619, Ratio=2.78x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.608, Ratio=2.82x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.616, Ratio=2.85x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.603, Ratio=2.72x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.587, Ratio=2.63x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.611, Ratio=2.80x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.634, Ratio=2.79x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.620, Ratio=2.74x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.621, Ratio=2.75x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.607, Ratio=2.76x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.629, Ratio=2.85x, Gap=-4.513
Batch 275/537: Loss=1.1596 (C:1.1596, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.594, Ratio=2.73x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.605, Ratio=2.77x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.606, Ratio=2.83x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.606, Ratio=2.77x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.618, Ratio=2.91x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.599, Ratio=2.79x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.589, Ratio=2.74x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.631, Ratio=2.86x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.602, Ratio=2.79x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.619, Ratio=2.81x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.617, Ratio=2.87x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.622, Ratio=2.91x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.597, Ratio=2.80x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.610, Ratio=2.77x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.613, Ratio=2.82x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.585, Ratio=2.68x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.595, Ratio=2.72x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.609, Ratio=2.85x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.596, Ratio=2.74x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.616, Ratio=2.84x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.616, Ratio=2.90x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.591, Ratio=2.72x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.626, Ratio=2.89x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.608, Ratio=2.85x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.577, Ratio=2.63x, Gap=-3.626
Batch 300/537: Loss=1.2179 (C:1.2179, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.606, Ratio=2.78x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.600, Ratio=2.80x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.615, Ratio=2.74x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.617, Ratio=2.83x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.577, Ratio=2.65x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.583, Ratio=2.68x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.618, Ratio=2.93x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.630, Ratio=2.87x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.595, Ratio=2.70x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.601, Ratio=2.72x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.607, Ratio=2.75x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.629, Ratio=2.84x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.619, Ratio=2.84x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.639, Ratio=2.99x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.609, Ratio=2.86x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.608, Ratio=2.80x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.625, Ratio=2.91x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.605, Ratio=2.82x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.612, Ratio=2.81x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.591, Ratio=2.71x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.616, Ratio=2.84x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.589, Ratio=2.70x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.624, Ratio=2.82x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.609, Ratio=2.79x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.622, Ratio=2.92x, Gap=-3.665
Batch 325/537: Loss=1.1420 (C:1.1420, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.610, Ratio=2.85x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.604, Ratio=2.82x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.613, Ratio=2.95x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.586, Ratio=2.73x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.592, Ratio=2.78x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.635, Ratio=2.95x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.612, Ratio=2.86x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.573, Ratio=2.76x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.612, Ratio=2.76x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.617, Ratio=2.81x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.603, Ratio=2.67x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.641, Ratio=2.94x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.624, Ratio=2.85x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.609, Ratio=2.70x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.578, Ratio=2.65x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.631, Ratio=2.89x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.613, Ratio=2.82x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.607, Ratio=2.77x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.622, Ratio=2.85x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.612, Ratio=2.79x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.608, Ratio=2.81x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.604, Ratio=2.79x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.604, Ratio=2.85x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.574, Ratio=2.63x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.604, Ratio=2.72x, Gap=-3.805
Batch 350/537: Loss=1.1945 (C:1.1945, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.604, Ratio=2.83x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.594, Ratio=2.73x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.598, Ratio=2.83x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.596, Ratio=2.75x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.610, Ratio=2.87x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.619, Ratio=2.83x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.595, Ratio=2.72x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.607, Ratio=2.76x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.615, Ratio=2.90x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.599, Ratio=2.81x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.607, Ratio=2.84x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.601, Ratio=2.75x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.588, Ratio=2.69x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.645, Ratio=2.87x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.613, Ratio=2.79x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.597, Ratio=2.67x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.619, Ratio=2.89x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.602, Ratio=2.71x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.607, Ratio=2.74x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.616, Ratio=2.82x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.609, Ratio=2.79x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.596, Ratio=2.70x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.593, Ratio=2.76x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.615, Ratio=2.91x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.611, Ratio=2.82x, Gap=-3.542
Batch 375/537: Loss=1.1692 (C:1.1692, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.609, Ratio=2.82x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.634, Ratio=3.03x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.614, Ratio=2.89x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.612, Ratio=2.79x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.622, Ratio=2.89x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.583, Ratio=2.69x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.600, Ratio=2.74x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.619, Ratio=2.79x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.640, Ratio=2.90x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.595, Ratio=2.72x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.616, Ratio=2.79x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.612, Ratio=2.81x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.607, Ratio=2.74x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.604, Ratio=2.78x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.613, Ratio=2.81x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.607, Ratio=2.81x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.603, Ratio=2.76x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.584, Ratio=2.72x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.606, Ratio=2.82x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.608, Ratio=2.73x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.612, Ratio=2.80x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.585, Ratio=2.74x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.598, Ratio=2.74x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.620, Ratio=2.91x, Gap=-4.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.597, Ratio=2.75x, Gap=-3.520
Batch 400/537: Loss=1.1878 (C:1.1878, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.607, Ratio=2.74x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.606, Ratio=2.78x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.610, Ratio=2.87x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.596, Ratio=2.69x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.609, Ratio=2.79x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.586, Ratio=2.74x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.606, Ratio=2.85x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.621, Ratio=2.90x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.590, Ratio=2.70x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.614, Ratio=2.88x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.605, Ratio=2.92x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.600, Ratio=2.74x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.616, Ratio=2.89x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.600, Ratio=2.76x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.603, Ratio=2.79x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.601, Ratio=2.73x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.617, Ratio=2.90x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.614, Ratio=2.82x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.597, Ratio=2.75x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.615, Ratio=2.84x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.623, Ratio=2.78x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.606, Ratio=2.71x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.636, Ratio=2.83x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.639, Ratio=3.01x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.622, Ratio=2.74x, Gap=-3.927
Batch 425/537: Loss=1.1880 (C:1.1880, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.601, Ratio=2.74x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.624, Ratio=2.84x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.622, Ratio=2.85x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.592, Ratio=2.73x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.596, Ratio=2.78x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.618, Ratio=2.97x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.607, Ratio=2.82x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.587, Ratio=2.76x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.578, Ratio=2.74x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.623, Ratio=2.86x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.607, Ratio=2.90x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.616, Ratio=2.83x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.604, Ratio=2.75x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.633, Ratio=2.93x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.601, Ratio=2.78x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.585, Ratio=2.72x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.589, Ratio=2.76x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.599, Ratio=2.72x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.613, Ratio=2.80x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.618, Ratio=2.85x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.609, Ratio=2.77x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.586, Ratio=2.70x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.619, Ratio=2.82x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.593, Ratio=2.73x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.619, Ratio=2.96x, Gap=-3.441
Batch 450/537: Loss=1.1351 (C:1.1351, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.610, Ratio=2.88x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.597, Ratio=2.71x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.611, Ratio=2.82x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.609, Ratio=2.80x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.631, Ratio=2.89x, Gap=-4.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.584, Ratio=2.67x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.589, Ratio=2.74x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.608, Ratio=2.78x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.584, Ratio=2.69x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.627, Ratio=2.89x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.623, Ratio=2.90x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.571, Ratio=2.70x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.596, Ratio=2.73x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.573, Ratio=2.67x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.631, Ratio=2.96x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.611, Ratio=2.84x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.605, Ratio=2.85x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.639, Ratio=3.04x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.605, Ratio=2.74x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.627, Ratio=2.88x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.602, Ratio=2.73x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.607, Ratio=2.74x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.622, Ratio=2.82x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.621, Ratio=2.81x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.593, Ratio=2.69x, Gap=-3.579
Batch 475/537: Loss=1.2007 (C:1.2007, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.581, Ratio=2.69x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.619, Ratio=2.75x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.612, Ratio=2.83x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.598, Ratio=2.79x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.603, Ratio=2.79x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.608, Ratio=2.78x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.613, Ratio=2.88x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.614, Ratio=2.79x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.604, Ratio=2.92x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.616, Ratio=2.84x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.623, Ratio=2.86x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.619, Ratio=2.80x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.597, Ratio=2.71x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.607, Ratio=2.78x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.588, Ratio=2.77x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.635, Ratio=2.88x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.598, Ratio=2.70x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.599, Ratio=2.76x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.608, Ratio=2.80x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.622, Ratio=2.81x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.609, Ratio=2.76x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.613, Ratio=2.72x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.616, Ratio=2.76x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.631, Ratio=2.92x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.597, Ratio=2.82x, Gap=-3.475
Batch 500/537: Loss=1.1746 (C:1.1746, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.615, Ratio=2.86x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.615, Ratio=2.84x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.581, Ratio=2.65x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.610, Ratio=2.79x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.596, Ratio=2.72x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.561, Ratio=2.68x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.597, Ratio=2.72x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.604, Ratio=2.87x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.600, Ratio=2.85x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.627, Ratio=2.86x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.601, Ratio=2.73x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.605, Ratio=2.71x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.604, Ratio=2.68x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.604, Ratio=2.76x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.619, Ratio=2.78x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.584, Ratio=2.67x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.588, Ratio=2.70x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.602, Ratio=2.76x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.627, Ratio=2.91x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.597, Ratio=2.83x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.594, Ratio=2.80x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.589, Ratio=2.72x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.607, Ratio=2.73x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.613, Ratio=2.81x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.616, Ratio=2.81x, Gap=-3.434
Batch 525/537: Loss=1.1726 (C:1.1726, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.618, Ratio=2.86x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.605, Ratio=2.80x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.616, Ratio=2.87x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.613, Ratio=2.79x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.583, Ratio=2.71x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.606, Ratio=2.73x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.602, Ratio=2.71x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.606, Ratio=2.85x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.621, Ratio=2.84x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.581, Ratio=2.67x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.612, Ratio=2.75x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.592, Ratio=2.89x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.621, Ratio=2.93x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.639, Ratio=3.09x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.603, Ratio=2.85x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.625, Ratio=2.92x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.621, Ratio=2.96x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.614, Ratio=2.99x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.591, Ratio=2.89x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.631, Ratio=3.06x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.611, Ratio=2.93x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.625, Ratio=3.03x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.615, Ratio=2.89x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.596, Ratio=2.83x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.607, Ratio=2.80x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.608, Ratio=2.86x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.598, Ratio=2.88x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.632, Ratio=3.00x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.628, Ratio=2.95x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.611, Ratio=2.89x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.602, Ratio=2.78x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.613, Ratio=2.99x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.619, Ratio=2.85x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.641, Ratio=3.07x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.625, Ratio=2.98x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.625, Ratio=2.96x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.619, Ratio=2.95x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.619, Ratio=2.93x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.620, Ratio=3.01x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.607, Ratio=2.92x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.617, Ratio=3.04x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.637, Ratio=3.04x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.626, Ratio=3.02x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.602, Ratio=2.86x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.622, Ratio=2.94x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.643, Ratio=3.05x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.623, Ratio=2.96x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.610, Ratio=2.86x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.621, Ratio=2.96x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.631, Ratio=3.03x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.639, Ratio=3.04x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.624, Ratio=2.93x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.621, Ratio=3.00x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.606, Ratio=2.93x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.594, Ratio=2.85x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.646, Ratio=3.16x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.623, Ratio=2.96x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.632, Ratio=3.02x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.616, Ratio=2.96x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.607, Ratio=2.92x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.634, Ratio=3.01x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.619, Ratio=2.92x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.636, Ratio=3.01x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.638, Ratio=3.00x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.613, Ratio=2.91x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.632, Ratio=2.95x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.624, Ratio=2.96x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.596, Ratio=2.87x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.635, Ratio=3.08x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.610, Ratio=2.97x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.635, Ratio=2.99x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.641, Ratio=3.02x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.628, Ratio=2.98x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.637, Ratio=3.02x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.615, Ratio=2.97x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.600, Ratio=2.90x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.619, Ratio=3.02x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.631, Ratio=3.04x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.626, Ratio=2.94x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.623, Ratio=2.95x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.624, Ratio=3.00x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.609, Ratio=2.85x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.616, Ratio=2.97x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.619, Ratio=2.99x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.610, Ratio=2.87x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.615, Ratio=2.84x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.605, Ratio=2.89x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.641, Ratio=3.17x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.612, Ratio=2.91x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.613, Ratio=2.98x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.625, Ratio=2.91x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.621, Ratio=3.00x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.637, Ratio=3.02x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.632, Ratio=3.03x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.630, Ratio=3.02x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.631, Ratio=3.02x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.611, Ratio=2.86x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.623, Ratio=2.96x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.611, Ratio=2.79x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.622, Ratio=3.02x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.621, Ratio=2.98x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.639, Ratio=3.02x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.618, Ratio=2.92x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.612, Ratio=2.94x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.628, Ratio=3.00x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.618, Ratio=2.90x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.631, Ratio=2.92x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.629, Ratio=2.99x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.629, Ratio=3.11x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.607, Ratio=2.88x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.638, Ratio=3.01x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.609, Ratio=2.91x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.598, Ratio=2.93x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.644, Ratio=3.05x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.619, Ratio=3.00x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.641, Ratio=3.11x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.620, Ratio=2.90x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.631, Ratio=3.05x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.629, Ratio=3.00x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.621, Ratio=2.96x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.617, Ratio=2.98x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.626, Ratio=2.97x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.622, Ratio=2.99x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.611, Ratio=2.90x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.608, Ratio=2.87x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.609, Ratio=2.95x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.640, Ratio=3.00x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.630, Ratio=3.06x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.618, Ratio=2.89x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.632, Ratio=3.07x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.634, Ratio=3.05x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.607, Ratio=2.81x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.627, Ratio=2.88x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.620, Ratio=3.04x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.606, Ratio=2.81x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.623, Ratio=2.99x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.623, Ratio=2.93x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.614, Ratio=2.91x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.629, Ratio=2.98x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.618, Ratio=2.94x, Gap=-3.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.633, Ratio=3.06x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.609, Ratio=2.89x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.609, Ratio=2.91x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.610, Ratio=2.95x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.633, Ratio=3.00x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.615, Ratio=2.88x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.582, Ratio=2.75x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.621, Ratio=2.95x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.618, Ratio=2.99x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.629, Ratio=3.10x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.622, Ratio=2.88x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.611, Ratio=2.86x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.601, Ratio=2.87x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.609, Ratio=2.98x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.617, Ratio=3.04x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.643, Ratio=3.13x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.656, Ratio=3.07x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.619, Ratio=2.92x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.616, Ratio=2.97x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.644, Ratio=3.05x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.631, Ratio=2.96x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.616, Ratio=2.96x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.620, Ratio=3.06x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.638, Ratio=3.03x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.614, Ratio=2.79x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.624, Ratio=2.96x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.632, Ratio=2.98x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.623, Ratio=2.99x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.626, Ratio=3.03x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.629, Ratio=2.98x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.606, Ratio=2.90x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.598, Ratio=2.85x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.624, Ratio=2.94x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.621, Ratio=2.91x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.628, Ratio=3.02x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.634, Ratio=2.95x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.619, Ratio=2.95x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.640, Ratio=3.06x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.617, Ratio=2.96x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.635, Ratio=2.99x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.605, Ratio=2.89x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.624, Ratio=3.01x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.621, Ratio=2.93x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.619, Ratio=2.96x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.622, Ratio=3.01x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.642, Ratio=3.04x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.614, Ratio=2.88x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.642, Ratio=3.02x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.625, Ratio=2.99x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.625, Ratio=3.01x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.612, Ratio=2.94x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.610, Ratio=2.95x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.615, Ratio=2.92x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.627, Ratio=2.89x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.614, Ratio=2.98x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.596, Ratio=2.79x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.621, Ratio=3.04x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.619, Ratio=3.02x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.642, Ratio=3.07x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.619, Ratio=2.98x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.628, Ratio=3.05x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.619, Ratio=2.95x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.630, Ratio=3.02x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.624, Ratio=2.94x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.612, Ratio=2.89x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.618, Ratio=2.91x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.623, Ratio=2.91x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.643, Ratio=3.12x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.620, Ratio=2.95x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.624, Ratio=2.97x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.620, Ratio=2.93x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.625, Ratio=3.00x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.605, Ratio=2.87x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.626, Ratio=3.02x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.609, Ratio=2.92x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.616, Ratio=2.95x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.616, Ratio=2.93x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.609, Ratio=2.90x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.591, Ratio=2.81x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.623, Ratio=2.90x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.615, Ratio=2.96x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.606, Ratio=2.81x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.622, Ratio=3.00x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.633, Ratio=2.95x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.601, Ratio=2.87x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.636, Ratio=3.02x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.630, Ratio=2.98x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.613, Ratio=2.91x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.632, Ratio=3.05x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.620, Ratio=2.92x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.619, Ratio=2.95x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.627, Ratio=3.00x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.600, Ratio=2.86x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.624, Ratio=2.87x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.634, Ratio=3.02x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.631, Ratio=2.98x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.636, Ratio=3.04x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.613, Ratio=2.92x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.620, Ratio=2.85x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.631, Ratio=3.13x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.619, Ratio=2.89x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.614, Ratio=2.88x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.615, Ratio=2.86x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.609, Ratio=2.93x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.625, Ratio=3.00x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.589, Ratio=2.83x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.605, Ratio=2.81x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.601, Ratio=2.84x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.643, Ratio=3.09x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.610, Ratio=2.90x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.630, Ratio=3.02x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.607, Ratio=2.99x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.635, Ratio=3.00x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.637, Ratio=3.08x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.611, Ratio=2.92x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.630, Ratio=2.97x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.607, Ratio=2.81x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.623, Ratio=2.92x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.636, Ratio=3.03x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.611, Ratio=2.95x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.613, Ratio=2.93x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.643, Ratio=3.09x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.620, Ratio=2.96x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.609, Ratio=2.94x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.623, Ratio=3.00x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.609, Ratio=2.97x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.642, Ratio=3.06x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.627, Ratio=3.00x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.624, Ratio=3.00x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.588, Ratio=2.86x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.604, Ratio=2.84x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.630, Ratio=2.96x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.627, Ratio=2.96x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.622, Ratio=3.04x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.623, Ratio=2.98x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.605, Ratio=2.92x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.601, Ratio=2.91x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.624, Ratio=2.88x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.604, Ratio=2.89x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.601, Ratio=2.79x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.600, Ratio=2.88x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.624, Ratio=2.97x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.602, Ratio=2.84x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.624, Ratio=3.00x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.635, Ratio=3.02x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.592, Ratio=2.86x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.608, Ratio=2.94x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.650, Ratio=3.12x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.636, Ratio=3.00x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.636, Ratio=3.04x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.634, Ratio=3.10x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.640, Ratio=3.07x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.627, Ratio=3.04x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.602, Ratio=2.88x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.609, Ratio=2.91x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.614, Ratio=3.04x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.612, Ratio=2.91x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.630, Ratio=2.94x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.600, Ratio=2.90x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.591, Ratio=2.84x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.629, Ratio=2.93x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.616, Ratio=2.88x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.634, Ratio=3.00x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.635, Ratio=3.09x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.616, Ratio=2.96x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.606, Ratio=2.92x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.605, Ratio=2.82x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.630, Ratio=2.92x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.637, Ratio=2.99x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.609, Ratio=2.90x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.613, Ratio=2.83x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.636, Ratio=3.09x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.652, Ratio=3.14x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.629, Ratio=2.98x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.615, Ratio=3.04x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.612, Ratio=2.92x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.629, Ratio=3.12x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.621, Ratio=2.96x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.621, Ratio=2.95x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.607, Ratio=2.85x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.634, Ratio=3.10x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.612, Ratio=2.91x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.633, Ratio=3.01x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.630, Ratio=3.04x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.617, Ratio=2.91x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.610, Ratio=2.96x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.644, Ratio=3.06x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.626, Ratio=2.97x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.628, Ratio=3.03x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.610, Ratio=2.93x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.619, Ratio=2.91x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.611, Ratio=2.95x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.606, Ratio=2.85x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.644, Ratio=3.11x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.620, Ratio=2.98x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.606, Ratio=2.94x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.630, Ratio=2.95x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.634, Ratio=3.06x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.634, Ratio=3.08x, Gap=-3.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.599, Ratio=2.85x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.622, Ratio=2.86x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.662, Ratio=3.29x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.629, Ratio=2.94x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.632, Ratio=3.06x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.638, Ratio=3.03x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.626, Ratio=2.92x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.617, Ratio=2.90x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.619, Ratio=2.96x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.611, Ratio=2.95x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.615, Ratio=2.92x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.617, Ratio=2.92x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.609, Ratio=2.92x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.623, Ratio=2.88x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.601, Ratio=2.79x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.638, Ratio=3.03x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.617, Ratio=2.94x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.624, Ratio=3.03x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.613, Ratio=2.96x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.623, Ratio=2.95x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.592, Ratio=2.89x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.621, Ratio=3.04x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.623, Ratio=2.97x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.586, Ratio=2.85x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.615, Ratio=2.91x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.623, Ratio=3.02x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.619, Ratio=2.90x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.620, Ratio=3.01x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.603, Ratio=2.88x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.607, Ratio=2.81x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.611, Ratio=2.96x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.626, Ratio=3.01x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.605, Ratio=2.91x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.606, Ratio=2.84x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.608, Ratio=2.91x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.632, Ratio=3.02x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.626, Ratio=2.94x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.614, Ratio=2.88x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.619, Ratio=2.96x, Gap=-3.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.646, Ratio=3.13x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.626, Ratio=2.93x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.614, Ratio=2.87x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.607, Ratio=2.90x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.618, Ratio=3.07x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.612, Ratio=2.87x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.617, Ratio=3.02x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.610, Ratio=2.97x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.607, Ratio=2.93x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.626, Ratio=3.04x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.615, Ratio=3.00x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.635, Ratio=3.00x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.627, Ratio=2.94x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.638, Ratio=3.13x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.610, Ratio=2.88x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.620, Ratio=2.95x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.632, Ratio=3.02x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.620, Ratio=2.98x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.613, Ratio=2.91x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.618, Ratio=2.96x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.623, Ratio=2.96x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.628, Ratio=2.97x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.628, Ratio=3.03x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.632, Ratio=3.10x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.635, Ratio=3.08x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.617, Ratio=2.97x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.640, Ratio=3.10x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.625, Ratio=3.01x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.607, Ratio=2.84x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.621, Ratio=2.95x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.608, Ratio=2.91x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.609, Ratio=2.94x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.603, Ratio=2.82x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.630, Ratio=2.94x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.632, Ratio=3.04x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.650, Ratio=3.03x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.626, Ratio=2.92x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.647, Ratio=3.10x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.629, Ratio=3.01x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.622, Ratio=2.98x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.615, Ratio=2.95x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.605, Ratio=2.86x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.625, Ratio=3.06x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.610, Ratio=2.96x, Gap=-3.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.606, Ratio=2.83x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.619, Ratio=2.86x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.633, Ratio=3.01x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.619, Ratio=3.00x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.640, Ratio=3.07x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.615, Ratio=2.98x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.625, Ratio=2.97x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.610, Ratio=2.87x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.617, Ratio=2.98x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.637, Ratio=3.06x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.607, Ratio=2.91x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.613, Ratio=2.95x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.604, Ratio=2.84x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.631, Ratio=2.96x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.595, Ratio=2.78x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.631, Ratio=3.00x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.589, Ratio=2.79x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.617, Ratio=2.92x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.628, Ratio=2.97x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.593, Ratio=2.79x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.623, Ratio=3.02x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.632, Ratio=3.01x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.606, Ratio=2.88x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.622, Ratio=2.94x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.613, Ratio=2.82x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.631, Ratio=2.94x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.632, Ratio=3.00x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.628, Ratio=2.91x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.615, Ratio=2.95x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.618, Ratio=2.92x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.627, Ratio=3.05x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.644, Ratio=3.00x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.635, Ratio=3.09x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.619, Ratio=2.97x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.619, Ratio=2.95x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.602, Ratio=2.84x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.624, Ratio=2.98x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.625, Ratio=3.04x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.615, Ratio=3.00x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.607, Ratio=2.86x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.613, Ratio=2.94x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.630, Ratio=3.01x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.622, Ratio=2.97x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.626, Ratio=2.97x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.632, Ratio=3.00x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.643, Ratio=3.01x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.638, Ratio=2.97x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.627, Ratio=2.94x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.637, Ratio=3.01x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.620, Ratio=2.94x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.615, Ratio=3.04x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.623, Ratio=3.00x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.606, Ratio=2.88x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.626, Ratio=2.92x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.604, Ratio=2.88x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.611, Ratio=2.89x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.623, Ratio=2.96x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.614, Ratio=2.93x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.642, Ratio=3.03x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.623, Ratio=2.84x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.617, Ratio=2.97x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.613, Ratio=2.91x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.622, Ratio=2.95x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.623, Ratio=2.94x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.643, Ratio=3.20x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.626, Ratio=3.03x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.625, Ratio=2.90x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.612, Ratio=2.94x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.615, Ratio=2.92x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.603, Ratio=2.92x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.621, Ratio=2.97x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.616, Ratio=2.93x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.613, Ratio=2.87x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.632, Ratio=2.96x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.621, Ratio=2.93x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.618, Ratio=3.01x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.637, Ratio=3.12x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.621, Ratio=2.95x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.619, Ratio=2.96x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.635, Ratio=3.09x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.620, Ratio=2.96x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.624, Ratio=2.97x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.621, Ratio=2.98x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.632, Ratio=3.06x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.626, Ratio=2.97x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.609, Ratio=2.95x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.632, Ratio=3.08x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.617, Ratio=3.03x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.615, Ratio=2.92x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.640, Ratio=3.08x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.622, Ratio=2.99x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.581, Ratio=2.78x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.631, Ratio=3.03x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.617, Ratio=2.89x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.619, Ratio=2.92x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.633, Ratio=2.94x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.640, Ratio=3.07x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.660, Ratio=3.16x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.624, Ratio=3.06x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.619, Ratio=3.04x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.620, Ratio=2.97x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.597, Ratio=2.87x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.627, Ratio=3.03x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.608, Ratio=2.78x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.610, Ratio=2.93x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.610, Ratio=2.82x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.609, Ratio=2.90x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.620, Ratio=2.98x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.617, Ratio=3.03x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.632, Ratio=3.07x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.604, Ratio=2.83x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.614, Ratio=2.97x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.639, Ratio=3.08x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.615, Ratio=2.96x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.621, Ratio=2.96x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.630, Ratio=3.02x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.623, Ratio=2.93x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.607, Ratio=2.80x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.622, Ratio=2.99x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.630, Ratio=3.01x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.613, Ratio=2.89x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.602, Ratio=2.86x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.632, Ratio=3.03x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.649, Ratio=3.15x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.610, Ratio=2.83x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.600, Ratio=2.85x, Gap=-3.325

============================================================
Epoch 6/20 completed in 33.6s
Train: Loss=1.1752 (C:1.1752, R:0.0000) Ratio=2.82x
Val:   Loss=1.1369 (C:1.1369, R:0.0000) Ratio=3.33x
‚úÖ New best model saved (Val Loss: 1.1369)
============================================================

üåç Updating global dataset at epoch 7
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.486 ¬± 0.548
    Neg distances: 1.700 ¬± 0.864
    Separation ratio: 3.49x
    Gap: -3.305
    ‚úÖ Excellent global separation!

Epoch 7 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.679, Ratio=3.29x, Gap=-3.607
Batch   0/537: Loss=1.0652 (C:1.0652, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.693, Ratio=3.33x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.699, Ratio=3.32x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.690, Ratio=3.22x, Gap=-4.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.671, Ratio=3.07x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.707, Ratio=3.15x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.716, Ratio=3.23x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.726, Ratio=3.24x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.696, Ratio=3.22x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.704, Ratio=3.18x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.748, Ratio=3.39x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.700, Ratio=3.12x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.693, Ratio=3.27x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.708, Ratio=3.24x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.697, Ratio=3.27x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.703, Ratio=3.24x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.717, Ratio=3.31x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.667, Ratio=3.06x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.703, Ratio=3.25x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.706, Ratio=3.26x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.685, Ratio=3.12x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.738, Ratio=3.43x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.706, Ratio=3.20x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.727, Ratio=3.40x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.727, Ratio=3.29x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.721, Ratio=3.35x, Gap=-3.603
Batch  25/537: Loss=1.0485 (C:1.0485, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.688, Ratio=3.09x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.719, Ratio=3.30x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.691, Ratio=3.17x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.701, Ratio=3.21x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.723, Ratio=3.25x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.732, Ratio=3.43x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.680, Ratio=3.19x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.714, Ratio=3.24x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.701, Ratio=3.24x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.713, Ratio=3.30x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.695, Ratio=3.28x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.704, Ratio=3.26x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.701, Ratio=3.18x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.709, Ratio=3.19x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.690, Ratio=3.15x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.694, Ratio=3.16x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.696, Ratio=3.25x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.706, Ratio=3.38x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.711, Ratio=3.30x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.708, Ratio=3.25x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.720, Ratio=3.28x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.695, Ratio=3.10x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.712, Ratio=3.21x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.727, Ratio=3.31x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.697, Ratio=3.14x, Gap=-3.998
Batch  50/537: Loss=1.0875 (C:1.0875, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.732, Ratio=3.40x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.724, Ratio=3.31x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.704, Ratio=3.29x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.701, Ratio=3.15x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.729, Ratio=3.35x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.700, Ratio=3.20x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.733, Ratio=3.45x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.719, Ratio=3.16x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.690, Ratio=3.16x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.709, Ratio=3.26x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.707, Ratio=3.28x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.715, Ratio=3.29x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.708, Ratio=3.35x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.701, Ratio=3.26x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.703, Ratio=3.27x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.704, Ratio=3.41x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.701, Ratio=3.27x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.691, Ratio=3.28x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.693, Ratio=3.20x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.697, Ratio=3.08x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.694, Ratio=3.21x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.726, Ratio=3.39x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.685, Ratio=3.13x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.707, Ratio=3.37x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.697, Ratio=3.19x, Gap=-3.608
Batch  75/537: Loss=1.0806 (C:1.0806, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.722, Ratio=3.28x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.723, Ratio=3.33x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.698, Ratio=3.18x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.713, Ratio=3.30x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.715, Ratio=3.25x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.706, Ratio=3.16x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.703, Ratio=3.28x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.701, Ratio=3.14x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.718, Ratio=3.35x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.709, Ratio=3.21x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.709, Ratio=3.20x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.706, Ratio=3.18x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.692, Ratio=3.05x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.705, Ratio=3.25x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.720, Ratio=3.25x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.693, Ratio=3.13x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.700, Ratio=3.22x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.695, Ratio=3.18x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.718, Ratio=3.27x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.721, Ratio=3.30x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.718, Ratio=3.36x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.718, Ratio=3.28x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.712, Ratio=3.12x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.717, Ratio=3.31x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.715, Ratio=3.21x, Gap=-3.644
Batch 100/537: Loss=1.0774 (C:1.0774, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.686, Ratio=3.27x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.718, Ratio=3.36x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.698, Ratio=3.34x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.702, Ratio=3.26x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.689, Ratio=3.14x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.720, Ratio=3.44x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.706, Ratio=3.20x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.713, Ratio=3.24x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.703, Ratio=3.23x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.735, Ratio=3.43x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.703, Ratio=3.27x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.704, Ratio=3.21x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.717, Ratio=3.32x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.712, Ratio=3.15x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.729, Ratio=3.30x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.705, Ratio=3.28x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.725, Ratio=3.29x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.725, Ratio=3.40x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.685, Ratio=3.11x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.708, Ratio=3.22x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.705, Ratio=3.30x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.719, Ratio=3.38x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.707, Ratio=3.18x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.699, Ratio=3.23x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.678, Ratio=3.11x, Gap=-4.009
Batch 125/537: Loss=1.0969 (C:1.0969, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.694, Ratio=3.21x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.672, Ratio=3.11x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.694, Ratio=3.17x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.685, Ratio=3.16x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.707, Ratio=3.26x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.696, Ratio=3.25x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.724, Ratio=3.35x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.703, Ratio=3.17x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.721, Ratio=3.20x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.719, Ratio=3.19x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.705, Ratio=3.11x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.719, Ratio=3.20x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.709, Ratio=3.24x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.723, Ratio=3.47x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.692, Ratio=3.20x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.709, Ratio=3.26x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.710, Ratio=3.37x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.708, Ratio=3.28x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.709, Ratio=3.25x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.694, Ratio=3.20x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.720, Ratio=3.31x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.699, Ratio=3.21x, Gap=-4.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.697, Ratio=3.24x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.711, Ratio=3.31x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.703, Ratio=3.22x, Gap=-4.119
Batch 150/537: Loss=1.0720 (C:1.0720, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.697, Ratio=3.24x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.669, Ratio=3.07x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.723, Ratio=3.44x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.703, Ratio=3.27x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.701, Ratio=3.19x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.710, Ratio=3.08x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.689, Ratio=3.20x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.712, Ratio=3.23x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.724, Ratio=3.24x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.705, Ratio=3.35x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.736, Ratio=3.36x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.713, Ratio=3.19x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.701, Ratio=3.20x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.720, Ratio=3.35x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.680, Ratio=3.02x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.710, Ratio=3.23x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.730, Ratio=3.42x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.690, Ratio=3.13x, Gap=-4.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.689, Ratio=3.14x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.704, Ratio=3.17x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.687, Ratio=3.21x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.702, Ratio=3.20x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.676, Ratio=3.13x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.697, Ratio=3.14x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.679, Ratio=3.11x, Gap=-3.765
Batch 175/537: Loss=1.0969 (C:1.0969, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.692, Ratio=3.16x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.724, Ratio=3.44x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.701, Ratio=3.25x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.720, Ratio=3.31x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.715, Ratio=3.22x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.686, Ratio=3.18x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.717, Ratio=3.34x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.734, Ratio=3.42x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.695, Ratio=3.19x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.698, Ratio=3.11x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.713, Ratio=3.17x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.722, Ratio=3.31x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.690, Ratio=3.06x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.679, Ratio=3.07x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.717, Ratio=3.35x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.714, Ratio=3.27x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.688, Ratio=3.26x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.693, Ratio=3.12x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.695, Ratio=3.04x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.712, Ratio=3.18x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.714, Ratio=3.22x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.714, Ratio=3.31x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.705, Ratio=3.17x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.714, Ratio=3.24x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.716, Ratio=3.37x, Gap=-3.938
Batch 200/537: Loss=1.0509 (C:1.0509, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.717, Ratio=3.29x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.688, Ratio=3.26x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.723, Ratio=3.32x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.684, Ratio=3.18x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.717, Ratio=3.27x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.724, Ratio=3.39x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.684, Ratio=3.10x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.742, Ratio=3.52x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.711, Ratio=3.22x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.716, Ratio=3.28x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.704, Ratio=3.25x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.700, Ratio=3.16x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.741, Ratio=3.32x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.701, Ratio=3.26x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.740, Ratio=3.42x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.676, Ratio=3.02x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.718, Ratio=3.33x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.686, Ratio=3.18x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.711, Ratio=3.29x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.701, Ratio=3.19x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.707, Ratio=3.29x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.685, Ratio=3.17x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.705, Ratio=3.27x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.706, Ratio=3.28x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.714, Ratio=3.20x, Gap=-3.840
Batch 225/537: Loss=1.0786 (C:1.0786, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.700, Ratio=3.23x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.737, Ratio=3.43x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.709, Ratio=3.27x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.691, Ratio=3.12x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.705, Ratio=3.30x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.709, Ratio=3.36x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.738, Ratio=3.44x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.704, Ratio=3.20x, Gap=-4.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.714, Ratio=3.38x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.716, Ratio=3.26x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.706, Ratio=3.24x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.695, Ratio=3.23x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.722, Ratio=3.21x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.718, Ratio=3.20x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.712, Ratio=3.28x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.722, Ratio=3.38x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.702, Ratio=3.27x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.682, Ratio=3.07x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.719, Ratio=3.34x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.720, Ratio=3.31x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.725, Ratio=3.43x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.724, Ratio=3.32x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.695, Ratio=3.19x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.702, Ratio=3.27x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.706, Ratio=3.27x, Gap=-3.801
Batch 250/537: Loss=1.0666 (C:1.0666, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.654, Ratio=3.00x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.710, Ratio=3.31x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.712, Ratio=3.23x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.714, Ratio=3.26x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.708, Ratio=3.12x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.708, Ratio=3.19x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.718, Ratio=3.22x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.724, Ratio=3.29x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.692, Ratio=3.18x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.690, Ratio=3.12x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.706, Ratio=3.24x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.713, Ratio=3.25x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.711, Ratio=3.30x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.698, Ratio=3.10x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.703, Ratio=3.16x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.692, Ratio=3.17x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.716, Ratio=3.33x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.716, Ratio=3.45x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.686, Ratio=3.15x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.720, Ratio=3.38x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.718, Ratio=3.22x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.714, Ratio=3.25x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.709, Ratio=3.25x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.691, Ratio=3.13x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.692, Ratio=3.15x, Gap=-4.044
Batch 275/537: Loss=1.0890 (C:1.0890, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.712, Ratio=3.20x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.714, Ratio=3.33x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.730, Ratio=3.28x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.709, Ratio=3.30x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.721, Ratio=3.46x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.676, Ratio=3.20x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.677, Ratio=3.06x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.695, Ratio=3.24x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.716, Ratio=3.36x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.702, Ratio=3.06x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.680, Ratio=3.12x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.708, Ratio=3.16x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.728, Ratio=3.37x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.709, Ratio=3.26x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.716, Ratio=3.30x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.740, Ratio=3.39x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.691, Ratio=3.15x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.685, Ratio=3.07x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.711, Ratio=3.32x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.719, Ratio=3.33x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.730, Ratio=3.42x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.719, Ratio=3.43x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.689, Ratio=3.11x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.699, Ratio=3.20x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.698, Ratio=3.29x, Gap=-3.574
Batch 300/537: Loss=1.0604 (C:1.0604, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.721, Ratio=3.32x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.731, Ratio=3.46x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.691, Ratio=3.16x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.719, Ratio=3.37x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.716, Ratio=3.26x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.690, Ratio=3.02x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.685, Ratio=3.10x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.705, Ratio=3.30x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.730, Ratio=3.49x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.710, Ratio=3.27x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.692, Ratio=3.15x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.693, Ratio=3.13x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.684, Ratio=3.05x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.704, Ratio=3.23x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.700, Ratio=3.26x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.706, Ratio=3.23x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.704, Ratio=3.07x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.697, Ratio=3.17x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.718, Ratio=3.43x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.688, Ratio=3.10x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.699, Ratio=3.27x, Gap=-4.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.698, Ratio=3.22x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.730, Ratio=3.41x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.713, Ratio=3.27x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.741, Ratio=3.34x, Gap=-4.003
Batch 325/537: Loss=1.0479 (C:1.0479, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.691, Ratio=3.14x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.681, Ratio=3.16x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.705, Ratio=3.23x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.728, Ratio=3.38x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.715, Ratio=3.27x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.697, Ratio=3.23x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.732, Ratio=3.44x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.704, Ratio=3.19x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.690, Ratio=3.15x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.692, Ratio=3.17x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.687, Ratio=3.17x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.735, Ratio=3.30x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.675, Ratio=3.10x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.688, Ratio=3.22x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.712, Ratio=3.29x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.724, Ratio=3.20x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.734, Ratio=3.31x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.710, Ratio=3.15x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.735, Ratio=3.46x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.710, Ratio=3.30x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.719, Ratio=3.32x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.693, Ratio=3.26x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.691, Ratio=3.19x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.695, Ratio=3.29x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.685, Ratio=3.02x, Gap=-3.841
Batch 350/537: Loss=1.1184 (C:1.1184, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.719, Ratio=3.19x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.715, Ratio=3.29x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.689, Ratio=3.16x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.705, Ratio=3.26x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.696, Ratio=3.19x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.718, Ratio=3.32x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.675, Ratio=3.02x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.729, Ratio=3.33x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.723, Ratio=3.33x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.696, Ratio=3.18x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.701, Ratio=3.25x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.726, Ratio=3.30x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.710, Ratio=3.25x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.711, Ratio=3.24x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.696, Ratio=3.22x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.712, Ratio=3.34x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.708, Ratio=3.29x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.716, Ratio=3.41x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.708, Ratio=3.35x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.715, Ratio=3.31x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.715, Ratio=3.29x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.695, Ratio=3.14x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.722, Ratio=3.33x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.714, Ratio=3.24x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.711, Ratio=3.20x, Gap=-3.891
Batch 375/537: Loss=1.0781 (C:1.0781, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.714, Ratio=3.29x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.705, Ratio=3.10x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.735, Ratio=3.43x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.695, Ratio=3.30x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.705, Ratio=3.27x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.690, Ratio=3.04x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.739, Ratio=3.41x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.690, Ratio=3.19x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.705, Ratio=3.20x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.717, Ratio=3.37x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.695, Ratio=3.20x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.693, Ratio=3.25x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.680, Ratio=3.08x, Gap=-4.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.705, Ratio=3.22x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.704, Ratio=3.31x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.689, Ratio=3.19x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.726, Ratio=3.30x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.702, Ratio=3.22x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.696, Ratio=3.23x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.730, Ratio=3.44x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.707, Ratio=3.15x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.748, Ratio=3.52x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.703, Ratio=3.30x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.694, Ratio=3.10x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.711, Ratio=3.25x, Gap=-3.737
Batch 400/537: Loss=1.0690 (C:1.0690, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.704, Ratio=3.13x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.699, Ratio=3.15x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.725, Ratio=3.34x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.713, Ratio=3.23x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.718, Ratio=3.29x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.690, Ratio=3.14x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.699, Ratio=3.25x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.707, Ratio=3.22x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.701, Ratio=3.12x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.715, Ratio=3.25x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.663, Ratio=2.93x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.692, Ratio=3.13x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.689, Ratio=3.07x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.699, Ratio=3.24x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.717, Ratio=3.31x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.715, Ratio=3.28x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.731, Ratio=3.35x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.704, Ratio=3.20x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.702, Ratio=3.20x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.724, Ratio=3.32x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.694, Ratio=3.24x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.693, Ratio=3.19x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.716, Ratio=3.42x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.690, Ratio=3.19x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.708, Ratio=3.27x, Gap=-3.747
Batch 425/537: Loss=1.0618 (C:1.0618, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.719, Ratio=3.25x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.706, Ratio=3.29x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.720, Ratio=3.32x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.721, Ratio=3.25x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.702, Ratio=3.23x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.726, Ratio=3.38x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.735, Ratio=3.41x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.718, Ratio=3.25x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.716, Ratio=3.17x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.722, Ratio=3.30x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.728, Ratio=3.37x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.696, Ratio=3.19x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.735, Ratio=3.28x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.699, Ratio=3.18x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.704, Ratio=3.21x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.659, Ratio=3.06x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.727, Ratio=3.34x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.694, Ratio=3.11x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.695, Ratio=3.21x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.706, Ratio=3.31x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.711, Ratio=3.33x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.711, Ratio=3.27x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.682, Ratio=3.12x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.711, Ratio=3.20x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.704, Ratio=3.22x, Gap=-3.835
Batch 450/537: Loss=1.0741 (C:1.0741, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.704, Ratio=3.37x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.690, Ratio=3.18x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.716, Ratio=3.21x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.699, Ratio=3.19x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.707, Ratio=3.23x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.709, Ratio=3.24x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.703, Ratio=3.20x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.701, Ratio=3.19x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.719, Ratio=3.29x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.694, Ratio=3.13x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.691, Ratio=3.05x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.678, Ratio=3.19x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.698, Ratio=3.21x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.702, Ratio=3.25x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.713, Ratio=3.31x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.699, Ratio=3.29x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.718, Ratio=3.29x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.699, Ratio=3.17x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.734, Ratio=3.37x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.709, Ratio=3.23x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.709, Ratio=3.16x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.724, Ratio=3.29x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.720, Ratio=3.20x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.693, Ratio=3.14x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.714, Ratio=3.26x, Gap=-3.825
Batch 475/537: Loss=1.0666 (C:1.0666, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.715, Ratio=3.28x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.714, Ratio=3.25x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.681, Ratio=3.20x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.696, Ratio=3.17x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.696, Ratio=3.26x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.693, Ratio=3.20x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.705, Ratio=3.28x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.701, Ratio=3.30x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.695, Ratio=3.19x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.676, Ratio=2.99x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.732, Ratio=3.27x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.717, Ratio=3.33x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.747, Ratio=3.41x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.728, Ratio=3.24x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.706, Ratio=3.10x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.690, Ratio=3.21x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.712, Ratio=3.38x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.703, Ratio=3.28x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.701, Ratio=3.13x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.728, Ratio=3.48x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.703, Ratio=3.27x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.700, Ratio=3.20x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.713, Ratio=3.13x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.718, Ratio=3.26x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.725, Ratio=3.38x, Gap=-3.632
Batch 500/537: Loss=1.0431 (C:1.0431, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.706, Ratio=3.20x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.714, Ratio=3.31x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.695, Ratio=3.30x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.712, Ratio=3.32x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.713, Ratio=3.30x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.710, Ratio=3.19x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.690, Ratio=3.15x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.703, Ratio=3.24x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.703, Ratio=3.24x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.711, Ratio=3.26x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.729, Ratio=3.39x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.700, Ratio=3.15x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.736, Ratio=3.35x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.700, Ratio=3.17x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.706, Ratio=3.20x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.706, Ratio=3.34x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.702, Ratio=3.11x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.679, Ratio=3.13x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.718, Ratio=3.37x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.718, Ratio=3.41x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.688, Ratio=3.20x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.717, Ratio=3.30x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.690, Ratio=3.15x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.713, Ratio=3.23x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.685, Ratio=3.15x, Gap=-3.703
Batch 525/537: Loss=1.0932 (C:1.0932, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.709, Ratio=3.25x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.678, Ratio=3.12x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.717, Ratio=3.37x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.705, Ratio=3.22x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.716, Ratio=3.35x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.730, Ratio=3.34x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.679, Ratio=3.22x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.728, Ratio=3.40x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.708, Ratio=3.21x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.693, Ratio=3.23x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.722, Ratio=3.26x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.725, Ratio=3.47x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.709, Ratio=3.45x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.722, Ratio=3.57x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.727, Ratio=3.51x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.716, Ratio=3.44x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.724, Ratio=3.61x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.725, Ratio=3.43x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.707, Ratio=3.45x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.733, Ratio=3.58x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.720, Ratio=3.55x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.704, Ratio=3.31x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.734, Ratio=3.50x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.719, Ratio=3.45x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.732, Ratio=3.61x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.714, Ratio=3.44x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.711, Ratio=3.42x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.712, Ratio=3.33x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.711, Ratio=3.43x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.716, Ratio=3.40x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.707, Ratio=3.42x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.718, Ratio=3.45x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.736, Ratio=3.53x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.721, Ratio=3.48x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.733, Ratio=3.58x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.728, Ratio=3.50x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.710, Ratio=3.50x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.728, Ratio=3.64x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.715, Ratio=3.41x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.725, Ratio=3.58x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.719, Ratio=3.49x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.745, Ratio=3.66x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.702, Ratio=3.35x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.717, Ratio=3.47x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.711, Ratio=3.46x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.701, Ratio=3.32x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.703, Ratio=3.44x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.710, Ratio=3.37x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.743, Ratio=3.65x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.711, Ratio=3.47x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.724, Ratio=3.46x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.721, Ratio=3.50x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.713, Ratio=3.46x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.727, Ratio=3.48x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.727, Ratio=3.60x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.711, Ratio=3.47x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.719, Ratio=3.55x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.704, Ratio=3.38x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.739, Ratio=3.64x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.730, Ratio=3.59x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.727, Ratio=3.54x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.701, Ratio=3.37x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.715, Ratio=3.41x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.729, Ratio=3.40x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.717, Ratio=3.60x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.730, Ratio=3.56x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.731, Ratio=3.55x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.712, Ratio=3.40x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.750, Ratio=3.68x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.691, Ratio=3.37x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.725, Ratio=3.57x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.703, Ratio=3.38x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.697, Ratio=3.38x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.734, Ratio=3.58x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.717, Ratio=3.42x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.721, Ratio=3.46x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.712, Ratio=3.41x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.711, Ratio=3.42x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.718, Ratio=3.61x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.731, Ratio=3.56x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.721, Ratio=3.52x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.693, Ratio=3.25x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.737, Ratio=3.62x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.719, Ratio=3.54x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.733, Ratio=3.51x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.691, Ratio=3.34x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.720, Ratio=3.42x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.705, Ratio=3.46x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.725, Ratio=3.46x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.729, Ratio=3.51x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.731, Ratio=3.56x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.698, Ratio=3.38x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.710, Ratio=3.48x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.730, Ratio=3.60x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.753, Ratio=3.61x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.705, Ratio=3.35x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.722, Ratio=3.43x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.723, Ratio=3.45x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.693, Ratio=3.24x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.746, Ratio=3.66x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.721, Ratio=3.49x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.719, Ratio=3.44x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.718, Ratio=3.49x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.722, Ratio=3.53x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.732, Ratio=3.60x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.718, Ratio=3.39x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.710, Ratio=3.41x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.731, Ratio=3.67x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.702, Ratio=3.32x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.728, Ratio=3.63x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.714, Ratio=3.48x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.719, Ratio=3.50x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.731, Ratio=3.53x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.710, Ratio=3.31x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.711, Ratio=3.38x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.717, Ratio=3.46x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.705, Ratio=3.37x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.719, Ratio=3.48x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.730, Ratio=3.59x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.734, Ratio=3.51x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.709, Ratio=3.42x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.713, Ratio=3.34x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.699, Ratio=3.38x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.738, Ratio=3.57x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.723, Ratio=3.44x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.713, Ratio=3.38x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.721, Ratio=3.56x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.706, Ratio=3.35x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.746, Ratio=3.63x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.726, Ratio=3.61x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.717, Ratio=3.51x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.713, Ratio=3.58x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.717, Ratio=3.51x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.708, Ratio=3.39x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.744, Ratio=3.61x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.721, Ratio=3.55x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.718, Ratio=3.43x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.731, Ratio=3.65x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.729, Ratio=3.57x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.722, Ratio=3.47x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.715, Ratio=3.39x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.728, Ratio=3.47x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.726, Ratio=3.41x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.735, Ratio=3.46x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.722, Ratio=3.42x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.720, Ratio=3.46x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.717, Ratio=3.37x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.755, Ratio=3.79x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.725, Ratio=3.45x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.719, Ratio=3.46x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.696, Ratio=3.38x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.732, Ratio=3.59x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.716, Ratio=3.55x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.702, Ratio=3.43x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.716, Ratio=3.45x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.732, Ratio=3.59x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.740, Ratio=3.55x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.728, Ratio=3.51x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.723, Ratio=3.53x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.728, Ratio=3.45x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.727, Ratio=3.46x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.709, Ratio=3.47x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.717, Ratio=3.55x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.717, Ratio=3.45x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.735, Ratio=3.42x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.741, Ratio=3.65x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.713, Ratio=3.30x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.708, Ratio=3.39x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.745, Ratio=3.66x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.721, Ratio=3.43x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.739, Ratio=3.72x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.720, Ratio=3.41x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.718, Ratio=3.45x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.721, Ratio=3.42x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.716, Ratio=3.43x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.723, Ratio=3.47x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.730, Ratio=3.56x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.710, Ratio=3.49x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.725, Ratio=3.43x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.730, Ratio=3.59x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.719, Ratio=3.58x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.723, Ratio=3.54x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.723, Ratio=3.49x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.709, Ratio=3.38x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.708, Ratio=3.38x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.721, Ratio=3.62x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.723, Ratio=3.52x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.702, Ratio=3.28x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.723, Ratio=3.38x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.707, Ratio=3.34x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.709, Ratio=3.38x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.732, Ratio=3.66x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.726, Ratio=3.40x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.710, Ratio=3.39x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.724, Ratio=3.50x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.721, Ratio=3.52x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.711, Ratio=3.43x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.728, Ratio=3.57x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.746, Ratio=3.74x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.721, Ratio=3.58x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.717, Ratio=3.47x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.694, Ratio=3.25x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.705, Ratio=3.36x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.714, Ratio=3.42x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.752, Ratio=3.74x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.723, Ratio=3.43x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.740, Ratio=3.72x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.709, Ratio=3.45x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.707, Ratio=3.36x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.743, Ratio=3.57x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.702, Ratio=3.40x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.736, Ratio=3.54x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.712, Ratio=3.37x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.707, Ratio=3.45x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.723, Ratio=3.51x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.711, Ratio=3.43x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.738, Ratio=3.62x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.730, Ratio=3.56x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.712, Ratio=3.41x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.719, Ratio=3.49x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.705, Ratio=3.40x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.712, Ratio=3.40x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.731, Ratio=3.65x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.697, Ratio=3.27x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.711, Ratio=3.41x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.723, Ratio=3.63x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.718, Ratio=3.44x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.716, Ratio=3.51x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.719, Ratio=3.47x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.713, Ratio=3.33x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.725, Ratio=3.42x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.726, Ratio=3.43x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.721, Ratio=3.55x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.734, Ratio=3.58x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.706, Ratio=3.46x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.711, Ratio=3.41x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.696, Ratio=3.27x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.733, Ratio=3.61x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.721, Ratio=3.48x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.717, Ratio=3.45x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.709, Ratio=3.45x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.695, Ratio=3.30x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.739, Ratio=3.60x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.715, Ratio=3.52x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.717, Ratio=3.56x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.700, Ratio=3.36x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.752, Ratio=3.74x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.722, Ratio=3.46x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.732, Ratio=3.53x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.726, Ratio=3.46x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.691, Ratio=3.34x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.707, Ratio=3.45x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.716, Ratio=3.46x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.706, Ratio=3.45x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.741, Ratio=3.60x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.743, Ratio=3.77x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.726, Ratio=3.64x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.725, Ratio=3.42x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.722, Ratio=3.52x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.693, Ratio=3.34x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.705, Ratio=3.43x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.704, Ratio=3.44x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.719, Ratio=3.59x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.717, Ratio=3.41x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.719, Ratio=3.47x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.719, Ratio=3.51x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.722, Ratio=3.45x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.699, Ratio=3.29x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.716, Ratio=3.45x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.723, Ratio=3.65x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.707, Ratio=3.28x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.726, Ratio=3.55x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.718, Ratio=3.41x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.729, Ratio=3.54x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.733, Ratio=3.48x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.710, Ratio=3.35x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.722, Ratio=3.52x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.724, Ratio=3.57x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.715, Ratio=3.46x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.718, Ratio=3.50x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.722, Ratio=3.51x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.724, Ratio=3.62x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.705, Ratio=3.33x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.721, Ratio=3.55x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.750, Ratio=3.70x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.731, Ratio=3.64x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.725, Ratio=3.40x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.698, Ratio=3.41x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.706, Ratio=3.37x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.742, Ratio=3.47x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.714, Ratio=3.35x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.729, Ratio=3.54x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.743, Ratio=3.62x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.704, Ratio=3.33x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.710, Ratio=3.44x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.729, Ratio=3.44x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.723, Ratio=3.35x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.731, Ratio=3.64x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.693, Ratio=3.40x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.710, Ratio=3.44x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.738, Ratio=3.65x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.737, Ratio=3.59x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.715, Ratio=3.42x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.729, Ratio=3.51x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.705, Ratio=3.41x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.714, Ratio=3.44x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.698, Ratio=3.34x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.720, Ratio=3.45x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.722, Ratio=3.54x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.733, Ratio=3.65x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.730, Ratio=3.48x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.733, Ratio=3.54x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.716, Ratio=3.43x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.716, Ratio=3.51x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.702, Ratio=3.38x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.718, Ratio=3.41x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.755, Ratio=3.74x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.730, Ratio=3.49x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.704, Ratio=3.29x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.713, Ratio=3.40x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.720, Ratio=3.41x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.702, Ratio=3.27x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.723, Ratio=3.58x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.707, Ratio=3.35x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.724, Ratio=3.42x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.708, Ratio=3.43x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.728, Ratio=3.55x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.723, Ratio=3.48x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.713, Ratio=3.42x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.722, Ratio=3.62x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.707, Ratio=3.28x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.712, Ratio=3.50x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.738, Ratio=3.57x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.732, Ratio=3.54x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.744, Ratio=3.55x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.731, Ratio=3.62x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.713, Ratio=3.38x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.722, Ratio=3.49x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.731, Ratio=3.57x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.721, Ratio=3.48x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.728, Ratio=3.61x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.724, Ratio=3.46x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.718, Ratio=3.41x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.711, Ratio=3.42x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.698, Ratio=3.36x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.707, Ratio=3.31x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.700, Ratio=3.39x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.719, Ratio=3.51x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.713, Ratio=3.39x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.705, Ratio=3.48x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.742, Ratio=3.61x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.712, Ratio=3.40x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.733, Ratio=3.68x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.728, Ratio=3.56x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.710, Ratio=3.45x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.717, Ratio=3.43x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.725, Ratio=3.59x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.725, Ratio=3.47x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.714, Ratio=3.47x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.725, Ratio=3.52x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.739, Ratio=3.52x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.713, Ratio=3.50x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.728, Ratio=3.64x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.716, Ratio=3.44x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.704, Ratio=3.40x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.728, Ratio=3.52x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.704, Ratio=3.40x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.735, Ratio=3.57x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.734, Ratio=3.54x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.736, Ratio=3.58x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.715, Ratio=3.48x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.708, Ratio=3.52x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.711, Ratio=3.42x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.724, Ratio=3.49x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.719, Ratio=3.38x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.731, Ratio=3.52x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.719, Ratio=3.53x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.742, Ratio=3.62x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.730, Ratio=3.58x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.701, Ratio=3.30x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.733, Ratio=3.61x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.729, Ratio=3.48x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.725, Ratio=3.50x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.728, Ratio=3.58x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.719, Ratio=3.48x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.738, Ratio=3.57x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.695, Ratio=3.29x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.729, Ratio=3.45x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.722, Ratio=3.53x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.717, Ratio=3.35x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.714, Ratio=3.42x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.716, Ratio=3.55x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.704, Ratio=3.45x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.724, Ratio=3.50x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.718, Ratio=3.56x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.709, Ratio=3.44x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.738, Ratio=3.59x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.702, Ratio=3.38x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.733, Ratio=3.65x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.711, Ratio=3.44x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.715, Ratio=3.35x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.712, Ratio=3.47x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.715, Ratio=3.46x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.708, Ratio=3.35x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.711, Ratio=3.37x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.718, Ratio=3.50x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.724, Ratio=3.50x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.733, Ratio=3.66x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.706, Ratio=3.44x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.713, Ratio=3.26x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.710, Ratio=3.42x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.707, Ratio=3.39x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.738, Ratio=3.63x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.734, Ratio=3.59x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.722, Ratio=3.52x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.740, Ratio=3.65x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.722, Ratio=3.41x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.717, Ratio=3.49x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.717, Ratio=3.44x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.722, Ratio=3.52x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.744, Ratio=3.65x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.744, Ratio=3.70x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.701, Ratio=3.36x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.719, Ratio=3.47x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.706, Ratio=3.36x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.737, Ratio=3.54x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.737, Ratio=3.54x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.727, Ratio=3.63x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.730, Ratio=3.65x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.697, Ratio=3.34x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.725, Ratio=3.51x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.737, Ratio=3.62x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.710, Ratio=3.51x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.729, Ratio=3.57x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.742, Ratio=3.60x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.711, Ratio=3.41x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.721, Ratio=3.58x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.730, Ratio=3.50x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.723, Ratio=3.62x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.714, Ratio=3.40x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.715, Ratio=3.39x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.714, Ratio=3.44x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.741, Ratio=3.60x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.714, Ratio=3.38x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.709, Ratio=3.42x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.710, Ratio=3.33x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.711, Ratio=3.38x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.744, Ratio=3.65x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.713, Ratio=3.47x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.711, Ratio=3.38x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.729, Ratio=3.60x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.737, Ratio=3.67x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.730, Ratio=3.41x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.731, Ratio=3.58x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.705, Ratio=3.40x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.703, Ratio=3.31x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.701, Ratio=3.32x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.719, Ratio=3.50x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.707, Ratio=3.32x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.726, Ratio=3.49x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.712, Ratio=3.45x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.700, Ratio=3.23x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.720, Ratio=3.52x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.705, Ratio=3.39x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.722, Ratio=3.47x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.722, Ratio=3.48x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.724, Ratio=3.50x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.737, Ratio=3.60x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.701, Ratio=3.33x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.709, Ratio=3.50x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.718, Ratio=3.37x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.714, Ratio=3.39x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.703, Ratio=3.37x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.722, Ratio=3.48x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.719, Ratio=3.46x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.715, Ratio=3.48x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.716, Ratio=3.49x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.701, Ratio=3.37x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.729, Ratio=3.57x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.734, Ratio=3.60x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.726, Ratio=3.54x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.706, Ratio=3.45x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.734, Ratio=3.65x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.721, Ratio=3.44x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.726, Ratio=3.52x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.719, Ratio=3.51x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.719, Ratio=3.51x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.716, Ratio=3.44x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.729, Ratio=3.56x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.718, Ratio=3.44x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.703, Ratio=3.39x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.718, Ratio=3.47x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.736, Ratio=3.56x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.730, Ratio=3.58x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.731, Ratio=3.54x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.712, Ratio=3.50x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.707, Ratio=3.37x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.726, Ratio=3.49x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.733, Ratio=3.56x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.689, Ratio=3.24x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.724, Ratio=3.55x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.723, Ratio=3.51x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.722, Ratio=3.44x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.725, Ratio=3.47x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.720, Ratio=3.51x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.718, Ratio=3.43x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.705, Ratio=3.26x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.721, Ratio=3.53x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.709, Ratio=3.44x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.729, Ratio=3.46x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.710, Ratio=3.41x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.680, Ratio=3.29x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.729, Ratio=3.51x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.712, Ratio=3.40x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.729, Ratio=3.58x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.709, Ratio=3.44x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.735, Ratio=3.62x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.701, Ratio=3.32x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.709, Ratio=3.38x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.713, Ratio=3.37x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.720, Ratio=3.38x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.718, Ratio=3.45x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.723, Ratio=3.49x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.711, Ratio=3.48x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.728, Ratio=3.55x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.711, Ratio=3.44x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.721, Ratio=3.50x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.727, Ratio=3.51x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.716, Ratio=3.53x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.725, Ratio=3.54x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.726, Ratio=3.48x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.712, Ratio=3.47x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.707, Ratio=3.52x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.708, Ratio=3.44x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.700, Ratio=3.37x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.712, Ratio=3.34x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.713, Ratio=3.39x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.708, Ratio=3.49x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.703, Ratio=3.34x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.727, Ratio=3.54x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.704, Ratio=3.29x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.725, Ratio=3.54x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.705, Ratio=3.36x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.716, Ratio=3.50x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.717, Ratio=3.58x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.747, Ratio=3.74x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.717, Ratio=3.34x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.739, Ratio=3.70x, Gap=-3.199

============================================================
Epoch 7/20 completed in 40.9s
Train: Loss=1.0694 (C:1.0694, R:0.0000) Ratio=2.91x
Val:   Loss=1.0269 (C:1.0269, R:0.0000) Ratio=3.49x
‚úÖ New best model saved (Val Loss: 1.0269)
============================================================

Epoch 8 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.718, Ratio=3.25x, Gap=-3.494
Batch   0/537: Loss=1.0673 (C:1.0673, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.711, Ratio=3.34x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.708, Ratio=3.31x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.709, Ratio=3.25x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.704, Ratio=3.18x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.704, Ratio=3.22x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.712, Ratio=3.31x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.734, Ratio=3.45x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.722, Ratio=3.37x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.711, Ratio=3.27x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.696, Ratio=3.16x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.722, Ratio=3.31x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.695, Ratio=3.21x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.708, Ratio=3.18x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.722, Ratio=3.23x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.724, Ratio=3.36x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.714, Ratio=3.29x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.707, Ratio=3.33x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.737, Ratio=3.35x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.719, Ratio=3.34x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.708, Ratio=3.30x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.692, Ratio=3.12x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.731, Ratio=3.39x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.714, Ratio=3.29x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.715, Ratio=3.31x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.720, Ratio=3.48x, Gap=-3.962
Batch  25/537: Loss=1.0241 (C:1.0241, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.739, Ratio=3.54x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.716, Ratio=3.20x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.705, Ratio=3.20x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.713, Ratio=3.26x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.714, Ratio=3.32x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.742, Ratio=3.30x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.729, Ratio=3.38x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.719, Ratio=3.33x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.695, Ratio=3.27x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.708, Ratio=3.24x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.708, Ratio=3.27x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.708, Ratio=3.28x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.702, Ratio=3.23x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.695, Ratio=3.24x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.722, Ratio=3.28x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.723, Ratio=3.42x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.715, Ratio=3.33x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.728, Ratio=3.43x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.712, Ratio=3.31x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.687, Ratio=3.15x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.704, Ratio=3.20x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.707, Ratio=3.16x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.728, Ratio=3.53x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.726, Ratio=3.45x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.683, Ratio=3.16x, Gap=-3.624
Batch  50/537: Loss=1.0884 (C:1.0884, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.721, Ratio=3.29x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.695, Ratio=3.08x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.737, Ratio=3.45x, Gap=-4.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.725, Ratio=3.32x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.715, Ratio=3.29x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.725, Ratio=3.34x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.719, Ratio=3.42x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.724, Ratio=3.31x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.715, Ratio=3.15x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.712, Ratio=3.25x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.698, Ratio=3.22x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.712, Ratio=3.29x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.725, Ratio=3.30x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.700, Ratio=3.24x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.721, Ratio=3.38x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.696, Ratio=3.20x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.711, Ratio=3.26x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.701, Ratio=3.27x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.720, Ratio=3.29x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.720, Ratio=3.45x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.727, Ratio=3.27x, Gap=-4.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.684, Ratio=3.09x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.701, Ratio=3.20x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.708, Ratio=3.30x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.704, Ratio=3.36x, Gap=-3.692
Batch  75/537: Loss=1.0476 (C:1.0476, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.703, Ratio=3.27x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.696, Ratio=3.14x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.715, Ratio=3.24x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.719, Ratio=3.34x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.726, Ratio=3.38x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.728, Ratio=3.38x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.726, Ratio=3.30x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.714, Ratio=3.28x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.728, Ratio=3.38x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.705, Ratio=3.19x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.716, Ratio=3.29x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.730, Ratio=3.38x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.701, Ratio=3.10x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.716, Ratio=3.33x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.691, Ratio=3.15x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.710, Ratio=3.30x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.713, Ratio=3.22x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.718, Ratio=3.39x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.719, Ratio=3.32x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.704, Ratio=3.33x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.697, Ratio=3.18x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.698, Ratio=3.17x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.699, Ratio=3.17x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.718, Ratio=3.33x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.725, Ratio=3.38x, Gap=-3.728
Batch 100/537: Loss=1.0425 (C:1.0425, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.679, Ratio=2.98x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.698, Ratio=3.25x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.722, Ratio=3.41x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.709, Ratio=3.37x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.688, Ratio=3.15x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.730, Ratio=3.44x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.718, Ratio=3.37x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.710, Ratio=3.21x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.682, Ratio=3.15x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.736, Ratio=3.41x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.741, Ratio=3.44x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.730, Ratio=3.35x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.695, Ratio=3.11x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.719, Ratio=3.39x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.728, Ratio=3.35x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.750, Ratio=3.47x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.713, Ratio=3.31x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.725, Ratio=3.29x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.724, Ratio=3.38x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.723, Ratio=3.30x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.735, Ratio=3.45x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.706, Ratio=3.26x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.704, Ratio=3.18x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.681, Ratio=3.09x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.718, Ratio=3.37x, Gap=-3.588
Batch 125/537: Loss=1.0455 (C:1.0455, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.721, Ratio=3.44x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.718, Ratio=3.37x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.741, Ratio=3.47x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.728, Ratio=3.36x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.714, Ratio=3.21x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.720, Ratio=3.36x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.715, Ratio=3.39x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.710, Ratio=3.25x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.718, Ratio=3.33x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.718, Ratio=3.32x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.731, Ratio=3.29x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.730, Ratio=3.36x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.678, Ratio=3.07x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.722, Ratio=3.32x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.721, Ratio=3.23x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.689, Ratio=3.22x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.721, Ratio=3.48x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.713, Ratio=3.29x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.707, Ratio=3.24x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.727, Ratio=3.34x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.712, Ratio=3.26x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.707, Ratio=3.40x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.718, Ratio=3.22x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.694, Ratio=3.27x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.697, Ratio=3.29x, Gap=-4.114
Batch 150/537: Loss=1.0615 (C:1.0615, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.709, Ratio=3.24x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.712, Ratio=3.29x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.703, Ratio=3.25x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.696, Ratio=3.20x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.736, Ratio=3.36x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.696, Ratio=3.20x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.716, Ratio=3.31x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.693, Ratio=3.17x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.727, Ratio=3.35x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.741, Ratio=3.36x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.716, Ratio=3.30x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.740, Ratio=3.42x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.697, Ratio=3.19x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.718, Ratio=3.29x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.713, Ratio=3.31x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.716, Ratio=3.31x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.683, Ratio=3.25x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.722, Ratio=3.37x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.723, Ratio=3.22x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.697, Ratio=3.26x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.707, Ratio=3.21x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.701, Ratio=3.23x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.696, Ratio=3.30x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.704, Ratio=3.33x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.718, Ratio=3.32x, Gap=-3.721
Batch 175/537: Loss=1.0553 (C:1.0553, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.727, Ratio=3.26x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.708, Ratio=3.22x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.712, Ratio=3.36x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.717, Ratio=3.28x, Gap=-4.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.704, Ratio=3.19x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.721, Ratio=3.27x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.698, Ratio=3.13x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.714, Ratio=3.42x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.705, Ratio=3.20x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.713, Ratio=3.25x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.731, Ratio=3.37x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.704, Ratio=3.23x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.702, Ratio=3.23x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.722, Ratio=3.44x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.725, Ratio=3.39x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.723, Ratio=3.33x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.716, Ratio=3.39x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.715, Ratio=3.42x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.716, Ratio=3.39x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.741, Ratio=3.38x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.720, Ratio=3.40x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.726, Ratio=3.37x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.712, Ratio=3.31x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.718, Ratio=3.26x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.732, Ratio=3.38x, Gap=-3.709
Batch 200/537: Loss=1.0400 (C:1.0400, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.714, Ratio=3.17x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.720, Ratio=3.24x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.685, Ratio=3.06x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.687, Ratio=3.13x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.697, Ratio=3.16x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.719, Ratio=3.41x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.717, Ratio=3.30x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.714, Ratio=3.30x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.695, Ratio=3.23x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.709, Ratio=3.18x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.688, Ratio=3.24x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.699, Ratio=3.33x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.708, Ratio=3.33x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.724, Ratio=3.36x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.714, Ratio=3.34x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.684, Ratio=3.14x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.714, Ratio=3.26x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.719, Ratio=3.23x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.726, Ratio=3.29x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.736, Ratio=3.41x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.736, Ratio=3.35x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.699, Ratio=3.20x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.728, Ratio=3.23x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.719, Ratio=3.31x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.699, Ratio=3.22x, Gap=-3.829
Batch 225/537: Loss=1.0736 (C:1.0736, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.714, Ratio=3.28x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.717, Ratio=3.24x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.707, Ratio=3.35x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.711, Ratio=3.23x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.714, Ratio=3.36x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.723, Ratio=3.32x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.727, Ratio=3.40x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.727, Ratio=3.42x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.694, Ratio=3.18x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.727, Ratio=3.38x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.696, Ratio=3.14x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.722, Ratio=3.29x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.729, Ratio=3.31x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.730, Ratio=3.33x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.731, Ratio=3.42x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.735, Ratio=3.34x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.695, Ratio=3.15x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.727, Ratio=3.44x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.703, Ratio=3.15x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.691, Ratio=3.20x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.725, Ratio=3.28x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.721, Ratio=3.31x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.705, Ratio=3.18x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.727, Ratio=3.47x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.728, Ratio=3.25x, Gap=-3.608
Batch 250/537: Loss=1.0692 (C:1.0692, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.708, Ratio=3.22x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.721, Ratio=3.43x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.674, Ratio=3.12x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.718, Ratio=3.35x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.692, Ratio=3.20x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.722, Ratio=3.29x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.724, Ratio=3.40x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.716, Ratio=3.28x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.699, Ratio=3.20x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.723, Ratio=3.30x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.705, Ratio=3.25x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.727, Ratio=3.53x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.729, Ratio=3.24x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.707, Ratio=3.27x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.732, Ratio=3.38x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.721, Ratio=3.36x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.724, Ratio=3.32x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.704, Ratio=3.22x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.717, Ratio=3.25x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.715, Ratio=3.25x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.709, Ratio=3.26x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.717, Ratio=3.25x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.726, Ratio=3.29x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.717, Ratio=3.31x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.712, Ratio=3.40x, Gap=-3.751
Batch 275/537: Loss=1.0398 (C:1.0398, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.717, Ratio=3.27x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.687, Ratio=3.22x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.724, Ratio=3.36x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.711, Ratio=3.30x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.720, Ratio=3.28x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.719, Ratio=3.32x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.723, Ratio=3.30x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.703, Ratio=3.21x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.719, Ratio=3.36x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.691, Ratio=3.27x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.725, Ratio=3.39x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.715, Ratio=3.33x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.711, Ratio=3.28x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.713, Ratio=3.30x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.711, Ratio=3.27x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.710, Ratio=3.31x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.690, Ratio=3.07x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.704, Ratio=3.23x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.686, Ratio=2.99x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.730, Ratio=3.30x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.696, Ratio=3.26x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.710, Ratio=3.27x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.712, Ratio=3.24x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.716, Ratio=3.29x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.704, Ratio=3.26x, Gap=-4.017
Batch 300/537: Loss=1.0679 (C:1.0679, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.721, Ratio=3.31x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.688, Ratio=3.14x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.698, Ratio=3.25x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.692, Ratio=3.18x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.709, Ratio=3.43x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.708, Ratio=3.29x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.715, Ratio=3.36x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.702, Ratio=3.19x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.697, Ratio=3.14x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.688, Ratio=3.17x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.691, Ratio=3.24x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.710, Ratio=3.24x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.702, Ratio=3.28x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.732, Ratio=3.49x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.706, Ratio=3.10x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.713, Ratio=3.19x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.737, Ratio=3.35x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.720, Ratio=3.38x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.753, Ratio=3.43x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.727, Ratio=3.43x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.722, Ratio=3.30x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.714, Ratio=3.29x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.701, Ratio=3.22x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.704, Ratio=3.33x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.683, Ratio=3.21x, Gap=-3.832
Batch 325/537: Loss=1.0758 (C:1.0758, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.718, Ratio=3.36x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.712, Ratio=3.36x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.710, Ratio=3.26x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.680, Ratio=3.06x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.711, Ratio=3.38x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.718, Ratio=3.29x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.702, Ratio=3.32x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.702, Ratio=3.22x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.717, Ratio=3.40x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.691, Ratio=3.19x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.717, Ratio=3.23x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.748, Ratio=3.41x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.727, Ratio=3.33x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.730, Ratio=3.30x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.752, Ratio=3.47x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.733, Ratio=3.42x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.696, Ratio=3.28x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.740, Ratio=3.44x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.710, Ratio=3.21x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.734, Ratio=3.33x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.715, Ratio=3.29x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.692, Ratio=3.21x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.726, Ratio=3.49x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.705, Ratio=3.20x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.692, Ratio=3.19x, Gap=-3.723
Batch 350/537: Loss=1.0814 (C:1.0814, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.701, Ratio=3.29x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.703, Ratio=3.37x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.713, Ratio=3.35x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.706, Ratio=3.37x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.731, Ratio=3.47x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.692, Ratio=3.19x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.710, Ratio=3.23x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.709, Ratio=3.25x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.722, Ratio=3.29x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.729, Ratio=3.40x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.729, Ratio=3.31x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.736, Ratio=3.38x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.709, Ratio=3.24x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.751, Ratio=3.47x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.702, Ratio=3.28x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.732, Ratio=3.40x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.711, Ratio=3.34x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.723, Ratio=3.45x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.708, Ratio=3.12x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.707, Ratio=3.26x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.709, Ratio=3.30x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.683, Ratio=3.11x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.726, Ratio=3.32x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.680, Ratio=3.26x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.707, Ratio=3.18x, Gap=-3.682
Batch 375/537: Loss=1.0809 (C:1.0809, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.719, Ratio=3.30x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.697, Ratio=3.15x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.733, Ratio=3.46x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.736, Ratio=3.41x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.726, Ratio=3.32x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.724, Ratio=3.36x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.738, Ratio=3.36x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.728, Ratio=3.28x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.725, Ratio=3.36x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.739, Ratio=3.44x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.698, Ratio=3.17x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.718, Ratio=3.28x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.680, Ratio=3.01x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.678, Ratio=3.13x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.700, Ratio=3.21x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.721, Ratio=3.33x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.709, Ratio=3.36x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.711, Ratio=3.32x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.701, Ratio=3.17x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.712, Ratio=3.34x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.717, Ratio=3.38x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.730, Ratio=3.28x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.740, Ratio=3.39x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.725, Ratio=3.36x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.719, Ratio=3.17x, Gap=-4.039
Batch 400/537: Loss=1.0819 (C:1.0819, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.727, Ratio=3.30x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.720, Ratio=3.27x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.713, Ratio=3.25x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.733, Ratio=3.38x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.714, Ratio=3.36x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.707, Ratio=3.16x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.716, Ratio=3.24x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.705, Ratio=3.18x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.713, Ratio=3.30x, Gap=-4.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.689, Ratio=3.24x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.718, Ratio=3.27x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.699, Ratio=3.20x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.708, Ratio=3.29x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.701, Ratio=3.31x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.715, Ratio=3.29x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.696, Ratio=3.30x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.686, Ratio=3.15x, Gap=-4.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.714, Ratio=3.35x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.718, Ratio=3.25x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.693, Ratio=3.04x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.699, Ratio=3.16x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.714, Ratio=3.19x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.700, Ratio=3.26x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.706, Ratio=3.20x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.722, Ratio=3.36x, Gap=-3.712
Batch 425/537: Loss=1.0439 (C:1.0439, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.727, Ratio=3.43x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.709, Ratio=3.24x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.705, Ratio=3.23x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.713, Ratio=3.34x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.721, Ratio=3.40x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.720, Ratio=3.26x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.699, Ratio=3.20x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.709, Ratio=3.37x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.709, Ratio=3.32x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.729, Ratio=3.44x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.717, Ratio=3.27x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.702, Ratio=3.14x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.731, Ratio=3.43x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.710, Ratio=3.28x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.727, Ratio=3.32x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.720, Ratio=3.31x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.715, Ratio=3.25x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.725, Ratio=3.47x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.714, Ratio=3.28x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.703, Ratio=3.14x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.727, Ratio=3.44x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.728, Ratio=3.33x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.701, Ratio=3.28x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.701, Ratio=3.17x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.733, Ratio=3.31x, Gap=-3.834
Batch 450/537: Loss=1.0559 (C:1.0559, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.726, Ratio=3.34x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.688, Ratio=3.10x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.704, Ratio=3.20x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.715, Ratio=3.16x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.733, Ratio=3.33x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.700, Ratio=3.18x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.699, Ratio=3.24x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.703, Ratio=3.20x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.707, Ratio=3.40x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.705, Ratio=3.31x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.727, Ratio=3.39x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.697, Ratio=3.27x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.721, Ratio=3.43x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.713, Ratio=3.25x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.739, Ratio=3.39x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.723, Ratio=3.27x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.725, Ratio=3.42x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.715, Ratio=3.20x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.742, Ratio=3.36x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.732, Ratio=3.30x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.695, Ratio=3.12x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.715, Ratio=3.31x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.696, Ratio=3.24x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.681, Ratio=3.17x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.711, Ratio=3.37x, Gap=-3.740
Batch 475/537: Loss=1.0438 (C:1.0438, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.719, Ratio=3.36x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.723, Ratio=3.34x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.740, Ratio=3.44x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.710, Ratio=3.12x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.728, Ratio=3.33x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.711, Ratio=3.26x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.695, Ratio=3.11x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.701, Ratio=3.10x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.705, Ratio=3.22x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.716, Ratio=3.19x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.718, Ratio=3.32x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.711, Ratio=3.19x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.696, Ratio=3.19x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.727, Ratio=3.32x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.705, Ratio=3.28x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.680, Ratio=3.25x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.720, Ratio=3.20x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.723, Ratio=3.31x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.708, Ratio=3.16x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.708, Ratio=3.31x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.702, Ratio=3.27x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.707, Ratio=3.27x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.713, Ratio=3.23x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.718, Ratio=3.37x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.719, Ratio=3.27x, Gap=-4.182
Batch 500/537: Loss=1.0600 (C:1.0600, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.709, Ratio=3.32x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.714, Ratio=3.28x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.716, Ratio=3.39x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.720, Ratio=3.27x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.730, Ratio=3.49x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.728, Ratio=3.35x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.701, Ratio=3.16x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.713, Ratio=3.23x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.724, Ratio=3.38x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.722, Ratio=3.30x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.706, Ratio=3.31x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.713, Ratio=3.32x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.699, Ratio=3.20x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.700, Ratio=3.24x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.689, Ratio=3.29x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.716, Ratio=3.32x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.692, Ratio=3.12x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.714, Ratio=3.37x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.706, Ratio=3.27x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.731, Ratio=3.23x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.699, Ratio=3.14x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.706, Ratio=3.24x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.728, Ratio=3.32x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.716, Ratio=3.36x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.698, Ratio=3.17x, Gap=-3.671
Batch 525/537: Loss=1.0830 (C:1.0830, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.713, Ratio=3.30x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.709, Ratio=3.26x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.709, Ratio=3.18x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.724, Ratio=3.33x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.714, Ratio=3.22x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.705, Ratio=3.26x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.694, Ratio=3.24x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.717, Ratio=3.29x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.712, Ratio=3.34x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.733, Ratio=3.40x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.732, Ratio=3.37x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.704, Ratio=3.43x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.736, Ratio=3.56x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.731, Ratio=3.61x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.719, Ratio=3.52x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.729, Ratio=3.56x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.720, Ratio=3.51x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.704, Ratio=3.35x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.713, Ratio=3.52x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.707, Ratio=3.45x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.703, Ratio=3.39x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.722, Ratio=3.43x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.737, Ratio=3.68x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.711, Ratio=3.51x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.717, Ratio=3.46x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.735, Ratio=3.73x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.717, Ratio=3.40x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.705, Ratio=3.43x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.747, Ratio=3.76x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.699, Ratio=3.38x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.711, Ratio=3.48x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.713, Ratio=3.39x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.715, Ratio=3.53x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.733, Ratio=3.57x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.729, Ratio=3.62x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.747, Ratio=3.79x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.747, Ratio=3.64x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.730, Ratio=3.61x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.743, Ratio=3.59x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.720, Ratio=3.46x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.708, Ratio=3.36x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.725, Ratio=3.61x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.725, Ratio=3.45x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.709, Ratio=3.43x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.723, Ratio=3.50x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.722, Ratio=3.59x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.716, Ratio=3.45x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.726, Ratio=3.50x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.713, Ratio=3.41x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.722, Ratio=3.53x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.732, Ratio=3.59x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.723, Ratio=3.54x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.718, Ratio=3.45x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.722, Ratio=3.54x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.719, Ratio=3.52x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.733, Ratio=3.54x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.676, Ratio=3.25x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.711, Ratio=3.55x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.723, Ratio=3.50x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.724, Ratio=3.44x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.729, Ratio=3.55x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.737, Ratio=3.66x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.743, Ratio=3.61x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.722, Ratio=3.51x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.749, Ratio=3.64x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.707, Ratio=3.43x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.718, Ratio=3.47x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.728, Ratio=3.63x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.714, Ratio=3.56x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.722, Ratio=3.70x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.742, Ratio=3.69x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.729, Ratio=3.55x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.726, Ratio=3.50x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.731, Ratio=3.65x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.712, Ratio=3.41x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.726, Ratio=3.60x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.717, Ratio=3.63x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.723, Ratio=3.49x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.702, Ratio=3.39x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.731, Ratio=3.64x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.722, Ratio=3.51x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.711, Ratio=3.48x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.725, Ratio=3.52x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.727, Ratio=3.54x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.707, Ratio=3.43x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.704, Ratio=3.28x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.717, Ratio=3.48x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.705, Ratio=3.41x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.722, Ratio=3.36x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.732, Ratio=3.62x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.740, Ratio=3.79x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.701, Ratio=3.40x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.746, Ratio=3.74x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.730, Ratio=3.48x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.724, Ratio=3.54x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.714, Ratio=3.55x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.716, Ratio=3.45x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.722, Ratio=3.65x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.725, Ratio=3.56x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.744, Ratio=3.74x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.727, Ratio=3.65x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.742, Ratio=3.77x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.703, Ratio=3.46x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.719, Ratio=3.40x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.715, Ratio=3.52x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.739, Ratio=3.65x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.714, Ratio=3.54x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.727, Ratio=3.64x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.726, Ratio=3.54x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.726, Ratio=3.49x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.735, Ratio=3.71x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.718, Ratio=3.32x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.712, Ratio=3.42x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.702, Ratio=3.43x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.707, Ratio=3.42x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.703, Ratio=3.39x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.728, Ratio=3.54x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.730, Ratio=3.73x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.709, Ratio=3.42x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.701, Ratio=3.37x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.728, Ratio=3.63x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.723, Ratio=3.57x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.702, Ratio=3.33x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.723, Ratio=3.55x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.737, Ratio=3.70x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.713, Ratio=3.49x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.721, Ratio=3.45x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.718, Ratio=3.43x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.726, Ratio=3.66x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.723, Ratio=3.47x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.731, Ratio=3.63x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.704, Ratio=3.37x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.733, Ratio=3.69x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.714, Ratio=3.48x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.726, Ratio=3.50x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.731, Ratio=3.59x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.735, Ratio=3.69x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.705, Ratio=3.40x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.739, Ratio=3.56x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.723, Ratio=3.63x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.720, Ratio=3.46x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.725, Ratio=3.57x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.731, Ratio=3.69x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.708, Ratio=3.44x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.720, Ratio=3.55x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.698, Ratio=3.46x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.726, Ratio=3.54x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.709, Ratio=3.52x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.718, Ratio=3.40x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.716, Ratio=3.46x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.710, Ratio=3.39x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.742, Ratio=3.63x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.730, Ratio=3.60x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.717, Ratio=3.50x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.736, Ratio=3.52x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.713, Ratio=3.44x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.733, Ratio=3.64x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.740, Ratio=3.56x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.718, Ratio=3.59x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.737, Ratio=3.64x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.729, Ratio=3.49x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.728, Ratio=3.49x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.719, Ratio=3.41x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.724, Ratio=3.55x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.711, Ratio=3.38x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.724, Ratio=3.56x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.726, Ratio=3.57x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.727, Ratio=3.54x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.719, Ratio=3.62x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.717, Ratio=3.32x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.723, Ratio=3.55x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.710, Ratio=3.44x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.735, Ratio=3.64x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.729, Ratio=3.56x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.743, Ratio=3.76x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.700, Ratio=3.38x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.719, Ratio=3.52x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.732, Ratio=3.54x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.727, Ratio=3.66x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.718, Ratio=3.47x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.713, Ratio=3.43x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.738, Ratio=3.74x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.720, Ratio=3.48x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.725, Ratio=3.39x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.707, Ratio=3.36x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.749, Ratio=3.75x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.735, Ratio=3.67x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.717, Ratio=3.57x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.727, Ratio=3.53x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.723, Ratio=3.48x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.705, Ratio=3.56x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.712, Ratio=3.46x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.733, Ratio=3.58x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.731, Ratio=3.54x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.741, Ratio=3.67x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.720, Ratio=3.50x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.724, Ratio=3.55x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.718, Ratio=3.37x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.719, Ratio=3.47x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.736, Ratio=3.62x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.729, Ratio=3.51x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.738, Ratio=3.55x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.738, Ratio=3.71x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.716, Ratio=3.43x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.730, Ratio=3.49x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.720, Ratio=3.60x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.741, Ratio=3.61x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.733, Ratio=3.54x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.733, Ratio=3.65x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.704, Ratio=3.43x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.728, Ratio=3.47x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.727, Ratio=3.43x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.741, Ratio=3.68x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.714, Ratio=3.50x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.732, Ratio=3.63x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.740, Ratio=3.61x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.742, Ratio=3.63x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.744, Ratio=3.68x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.706, Ratio=3.40x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.725, Ratio=3.47x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.727, Ratio=3.59x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.709, Ratio=3.54x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.732, Ratio=3.61x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.734, Ratio=3.50x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.717, Ratio=3.41x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.718, Ratio=3.51x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.720, Ratio=3.43x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.721, Ratio=3.47x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.711, Ratio=3.50x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.708, Ratio=3.40x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.713, Ratio=3.36x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.742, Ratio=3.74x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.704, Ratio=3.49x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.733, Ratio=3.63x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.724, Ratio=3.51x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.733, Ratio=3.60x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.726, Ratio=3.53x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.707, Ratio=3.45x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.727, Ratio=3.55x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.725, Ratio=3.46x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.727, Ratio=3.59x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.728, Ratio=3.52x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.727, Ratio=3.52x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.717, Ratio=3.48x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.717, Ratio=3.40x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.726, Ratio=3.66x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.724, Ratio=3.51x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.731, Ratio=3.59x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.720, Ratio=3.43x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.695, Ratio=3.34x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.709, Ratio=3.59x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.740, Ratio=3.65x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.752, Ratio=3.70x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.731, Ratio=3.54x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.737, Ratio=3.62x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.749, Ratio=3.78x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.722, Ratio=3.53x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.733, Ratio=3.67x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.724, Ratio=3.48x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.733, Ratio=3.62x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.734, Ratio=3.50x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.708, Ratio=3.39x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.743, Ratio=3.66x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.718, Ratio=3.42x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.734, Ratio=3.67x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.723, Ratio=3.60x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.721, Ratio=3.54x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.738, Ratio=3.67x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.712, Ratio=3.48x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.718, Ratio=3.59x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.703, Ratio=3.42x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.726, Ratio=3.46x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.722, Ratio=3.57x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.743, Ratio=3.64x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.734, Ratio=3.55x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.705, Ratio=3.45x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.720, Ratio=3.55x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.709, Ratio=3.45x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.717, Ratio=3.58x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.715, Ratio=3.44x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.725, Ratio=3.50x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.698, Ratio=3.33x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.705, Ratio=3.41x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.718, Ratio=3.55x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.717, Ratio=3.43x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.744, Ratio=3.61x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.720, Ratio=3.41x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.726, Ratio=3.57x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.720, Ratio=3.54x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.724, Ratio=3.57x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.711, Ratio=3.31x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.741, Ratio=3.69x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.709, Ratio=3.43x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.716, Ratio=3.53x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.734, Ratio=3.51x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.724, Ratio=3.62x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.740, Ratio=3.61x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.748, Ratio=3.65x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.721, Ratio=3.58x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.708, Ratio=3.44x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.735, Ratio=3.62x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.729, Ratio=3.53x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.733, Ratio=3.50x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.702, Ratio=3.33x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.699, Ratio=3.47x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.726, Ratio=3.60x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.719, Ratio=3.55x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.711, Ratio=3.42x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.724, Ratio=3.51x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.734, Ratio=3.53x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.734, Ratio=3.53x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.731, Ratio=3.43x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.714, Ratio=3.43x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.710, Ratio=3.35x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.711, Ratio=3.46x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.737, Ratio=3.60x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.704, Ratio=3.36x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.722, Ratio=3.55x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.715, Ratio=3.36x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.743, Ratio=3.80x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.718, Ratio=3.53x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.743, Ratio=3.71x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.713, Ratio=3.49x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.732, Ratio=3.62x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.722, Ratio=3.46x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.717, Ratio=3.45x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.730, Ratio=3.63x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.722, Ratio=3.57x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.691, Ratio=3.30x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.712, Ratio=3.41x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.720, Ratio=3.42x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.735, Ratio=3.60x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.721, Ratio=3.53x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.719, Ratio=3.50x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.722, Ratio=3.56x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.713, Ratio=3.43x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.734, Ratio=3.66x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.721, Ratio=3.63x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.710, Ratio=3.48x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.736, Ratio=3.55x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.716, Ratio=3.41x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.731, Ratio=3.64x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.727, Ratio=3.57x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.714, Ratio=3.44x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.730, Ratio=3.60x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.735, Ratio=3.66x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.713, Ratio=3.35x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.705, Ratio=3.50x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.719, Ratio=3.55x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.711, Ratio=3.53x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.735, Ratio=3.59x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.718, Ratio=3.39x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.710, Ratio=3.47x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.720, Ratio=3.53x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.729, Ratio=3.51x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.727, Ratio=3.50x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.704, Ratio=3.40x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.723, Ratio=3.46x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.748, Ratio=3.69x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.723, Ratio=3.43x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.730, Ratio=3.54x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.728, Ratio=3.55x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.726, Ratio=3.58x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.720, Ratio=3.45x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.703, Ratio=3.49x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.716, Ratio=3.36x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.709, Ratio=3.44x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.734, Ratio=3.67x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.719, Ratio=3.41x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.727, Ratio=3.59x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.690, Ratio=3.38x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.736, Ratio=3.59x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.719, Ratio=3.53x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.718, Ratio=3.51x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.735, Ratio=3.73x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.714, Ratio=3.49x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.734, Ratio=3.59x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.743, Ratio=3.69x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.726, Ratio=3.51x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.724, Ratio=3.48x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.733, Ratio=3.39x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.750, Ratio=3.68x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.697, Ratio=3.45x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.755, Ratio=3.86x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.723, Ratio=3.48x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.726, Ratio=3.53x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.723, Ratio=3.58x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.734, Ratio=3.72x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.717, Ratio=3.45x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.714, Ratio=3.42x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.698, Ratio=3.34x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.749, Ratio=3.94x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.715, Ratio=3.41x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.741, Ratio=3.61x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.726, Ratio=3.67x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.720, Ratio=3.58x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.716, Ratio=3.45x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.735, Ratio=3.65x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.698, Ratio=3.37x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.717, Ratio=3.46x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.738, Ratio=3.68x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.704, Ratio=3.43x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.711, Ratio=3.36x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.723, Ratio=3.51x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.716, Ratio=3.45x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.744, Ratio=3.71x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.726, Ratio=3.48x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.736, Ratio=3.58x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.720, Ratio=3.40x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.725, Ratio=3.48x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.713, Ratio=3.51x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.746, Ratio=3.65x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.705, Ratio=3.39x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.724, Ratio=3.60x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.736, Ratio=3.63x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.717, Ratio=3.50x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.723, Ratio=3.54x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.720, Ratio=3.47x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.725, Ratio=3.54x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.701, Ratio=3.44x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.752, Ratio=3.70x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.701, Ratio=3.26x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.713, Ratio=3.34x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.729, Ratio=3.54x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.728, Ratio=3.61x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.733, Ratio=3.59x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.743, Ratio=3.65x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.742, Ratio=3.62x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.733, Ratio=3.52x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.717, Ratio=3.62x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.723, Ratio=3.60x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.740, Ratio=3.59x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.706, Ratio=3.53x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.731, Ratio=3.57x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.740, Ratio=3.57x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.720, Ratio=3.54x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.709, Ratio=3.48x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.722, Ratio=3.53x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.704, Ratio=3.36x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.714, Ratio=3.55x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.698, Ratio=3.28x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.710, Ratio=3.39x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.723, Ratio=3.63x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.719, Ratio=3.40x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.732, Ratio=3.55x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.745, Ratio=3.63x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.715, Ratio=3.53x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.716, Ratio=3.55x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.712, Ratio=3.46x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.711, Ratio=3.45x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.733, Ratio=3.52x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.712, Ratio=3.39x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.699, Ratio=3.39x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.742, Ratio=3.64x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.730, Ratio=3.54x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.713, Ratio=3.53x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.701, Ratio=3.46x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.730, Ratio=3.67x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.718, Ratio=3.44x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.716, Ratio=3.46x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.728, Ratio=3.54x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.719, Ratio=3.59x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.745, Ratio=3.73x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.718, Ratio=3.44x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.714, Ratio=3.51x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.735, Ratio=3.66x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.739, Ratio=3.67x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.730, Ratio=3.74x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.715, Ratio=3.49x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.711, Ratio=3.48x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.719, Ratio=3.62x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.725, Ratio=3.51x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.734, Ratio=3.62x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.716, Ratio=3.52x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.719, Ratio=3.56x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.725, Ratio=3.53x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.702, Ratio=3.31x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.708, Ratio=3.44x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.726, Ratio=3.54x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.725, Ratio=3.53x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.735, Ratio=3.54x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.717, Ratio=3.51x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.722, Ratio=3.64x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.728, Ratio=3.51x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.733, Ratio=3.56x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.720, Ratio=3.48x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.728, Ratio=3.54x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.721, Ratio=3.54x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.728, Ratio=3.53x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.716, Ratio=3.44x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.700, Ratio=3.35x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.714, Ratio=3.48x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.737, Ratio=3.64x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.710, Ratio=3.36x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.703, Ratio=3.36x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.701, Ratio=3.28x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.717, Ratio=3.53x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.710, Ratio=3.54x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.714, Ratio=3.55x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.717, Ratio=3.40x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.711, Ratio=3.36x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.721, Ratio=3.43x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.718, Ratio=3.40x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.716, Ratio=3.45x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.711, Ratio=3.39x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.722, Ratio=3.56x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.728, Ratio=3.52x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.710, Ratio=3.40x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.706, Ratio=3.51x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.720, Ratio=3.61x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.718, Ratio=3.66x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.716, Ratio=3.53x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.725, Ratio=3.61x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.706, Ratio=3.30x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.709, Ratio=3.36x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.738, Ratio=3.69x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.717, Ratio=3.40x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.700, Ratio=3.34x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.723, Ratio=3.49x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.730, Ratio=3.68x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.708, Ratio=3.46x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.742, Ratio=3.80x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.703, Ratio=3.38x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.746, Ratio=3.72x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.741, Ratio=3.70x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.714, Ratio=3.55x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.732, Ratio=3.60x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.720, Ratio=3.57x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.733, Ratio=3.51x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.722, Ratio=3.46x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.729, Ratio=3.60x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.731, Ratio=3.50x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.754, Ratio=3.75x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.710, Ratio=3.46x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.737, Ratio=3.65x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.719, Ratio=3.66x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.728, Ratio=3.49x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.723, Ratio=3.51x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.716, Ratio=3.52x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.700, Ratio=3.42x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.707, Ratio=3.53x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.716, Ratio=3.55x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.714, Ratio=3.34x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.715, Ratio=3.41x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.713, Ratio=3.52x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.693, Ratio=3.32x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.728, Ratio=3.51x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.725, Ratio=3.65x, Gap=-3.248

============================================================
Epoch 8/20 completed in 33.0s
Train: Loss=1.0605 (C:1.0605, R:0.0000) Ratio=3.07x
Val:   Loss=1.0195 (C:1.0195, R:0.0000) Ratio=3.64x
‚úÖ New best model saved (Val Loss: 1.0195)
============================================================

Epoch 9 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.741, Ratio=3.55x, Gap=-3.809
Batch   0/537: Loss=1.0096 (C:1.0096, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.718, Ratio=3.31x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.695, Ratio=3.20x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.716, Ratio=3.38x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.731, Ratio=3.44x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.719, Ratio=3.35x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.736, Ratio=3.47x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.705, Ratio=3.28x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.718, Ratio=3.21x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.733, Ratio=3.37x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.717, Ratio=3.34x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.721, Ratio=3.34x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.735, Ratio=3.45x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.716, Ratio=3.30x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.724, Ratio=3.30x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.743, Ratio=3.53x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.730, Ratio=3.39x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.719, Ratio=3.20x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.704, Ratio=3.30x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.718, Ratio=3.26x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.708, Ratio=3.26x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.714, Ratio=3.41x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.726, Ratio=3.32x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.718, Ratio=3.28x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.723, Ratio=3.35x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.731, Ratio=3.45x, Gap=-3.842
Batch  25/537: Loss=1.0256 (C:1.0256, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.747, Ratio=3.38x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.735, Ratio=3.46x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.736, Ratio=3.41x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.741, Ratio=3.49x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.720, Ratio=3.28x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.716, Ratio=3.41x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.727, Ratio=3.39x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.717, Ratio=3.40x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.718, Ratio=3.32x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.716, Ratio=3.28x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.686, Ratio=3.23x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.713, Ratio=3.39x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.711, Ratio=3.39x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.728, Ratio=3.39x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.706, Ratio=3.29x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.714, Ratio=3.38x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.713, Ratio=3.32x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.739, Ratio=3.38x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.738, Ratio=3.34x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.725, Ratio=3.37x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.735, Ratio=3.30x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.724, Ratio=3.29x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.717, Ratio=3.20x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.703, Ratio=3.24x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.747, Ratio=3.54x, Gap=-4.472
Batch  50/537: Loss=1.0123 (C:1.0123, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.715, Ratio=3.35x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.728, Ratio=3.39x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.721, Ratio=3.29x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.727, Ratio=3.36x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.714, Ratio=3.26x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.763, Ratio=3.55x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.707, Ratio=3.27x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.709, Ratio=3.18x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.739, Ratio=3.61x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.743, Ratio=3.48x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.703, Ratio=3.26x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.717, Ratio=3.32x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.721, Ratio=3.43x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.715, Ratio=3.32x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.731, Ratio=3.43x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.719, Ratio=3.31x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.731, Ratio=3.46x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.731, Ratio=3.34x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.741, Ratio=3.46x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.702, Ratio=3.18x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.732, Ratio=3.37x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.714, Ratio=3.29x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.701, Ratio=3.27x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.724, Ratio=3.29x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.727, Ratio=3.32x, Gap=-3.705
Batch  75/537: Loss=1.0495 (C:1.0495, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.708, Ratio=3.26x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.720, Ratio=3.28x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.722, Ratio=3.27x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.703, Ratio=3.24x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.708, Ratio=3.21x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.714, Ratio=3.40x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.711, Ratio=3.30x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.736, Ratio=3.46x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.722, Ratio=3.38x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.740, Ratio=3.59x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.716, Ratio=3.25x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.731, Ratio=3.41x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.742, Ratio=3.43x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.709, Ratio=3.23x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.717, Ratio=3.25x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.722, Ratio=3.45x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.722, Ratio=3.31x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.715, Ratio=3.28x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.718, Ratio=3.22x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.713, Ratio=3.34x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.703, Ratio=3.29x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.703, Ratio=3.19x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.716, Ratio=3.59x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.722, Ratio=3.42x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.701, Ratio=3.16x, Gap=-3.769
Batch 100/537: Loss=1.0837 (C:1.0837, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.721, Ratio=3.40x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.702, Ratio=3.27x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.727, Ratio=3.33x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.712, Ratio=3.30x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.748, Ratio=3.51x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.699, Ratio=3.19x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.730, Ratio=3.33x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.724, Ratio=3.31x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.742, Ratio=3.40x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.717, Ratio=3.24x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.713, Ratio=3.34x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.710, Ratio=3.17x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.717, Ratio=3.37x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.727, Ratio=3.46x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.733, Ratio=3.38x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.748, Ratio=3.49x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.712, Ratio=3.30x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.710, Ratio=3.36x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.710, Ratio=3.17x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.714, Ratio=3.29x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.729, Ratio=3.52x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.728, Ratio=3.36x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.721, Ratio=3.36x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.731, Ratio=3.41x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.733, Ratio=3.39x, Gap=-3.810
Batch 125/537: Loss=1.0406 (C:1.0406, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.732, Ratio=3.37x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.723, Ratio=3.27x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.712, Ratio=3.22x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.712, Ratio=3.34x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.732, Ratio=3.38x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.724, Ratio=3.34x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.719, Ratio=3.36x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.725, Ratio=3.42x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.700, Ratio=3.20x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.729, Ratio=3.41x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.701, Ratio=3.16x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.701, Ratio=3.37x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.725, Ratio=3.37x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.701, Ratio=3.22x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.727, Ratio=3.38x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.749, Ratio=3.49x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.727, Ratio=3.32x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.723, Ratio=3.21x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.722, Ratio=3.34x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.727, Ratio=3.39x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.728, Ratio=3.36x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.723, Ratio=3.31x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.728, Ratio=3.46x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.691, Ratio=3.30x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.727, Ratio=3.40x, Gap=-3.867
Batch 150/537: Loss=1.0390 (C:1.0390, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.701, Ratio=3.17x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.717, Ratio=3.22x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.722, Ratio=3.29x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.717, Ratio=3.35x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.709, Ratio=3.27x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.727, Ratio=3.37x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.715, Ratio=3.25x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.745, Ratio=3.55x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.714, Ratio=3.36x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.699, Ratio=3.28x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.716, Ratio=3.21x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.721, Ratio=3.37x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.718, Ratio=3.40x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.728, Ratio=3.44x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.706, Ratio=3.13x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.737, Ratio=3.49x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.735, Ratio=3.49x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.726, Ratio=3.26x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.711, Ratio=3.30x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.721, Ratio=3.36x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.708, Ratio=3.28x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.705, Ratio=3.28x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.723, Ratio=3.44x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.722, Ratio=3.37x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.697, Ratio=3.16x, Gap=-3.838
Batch 175/537: Loss=1.0873 (C:1.0873, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.711, Ratio=3.34x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.727, Ratio=3.35x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.735, Ratio=3.46x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.731, Ratio=3.27x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.717, Ratio=3.28x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.729, Ratio=3.40x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.704, Ratio=3.31x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.740, Ratio=3.54x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.722, Ratio=3.32x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.706, Ratio=3.22x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.725, Ratio=3.40x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.697, Ratio=3.30x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.723, Ratio=3.35x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.736, Ratio=3.45x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.691, Ratio=3.16x, Gap=-4.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.693, Ratio=3.20x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.712, Ratio=3.23x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.726, Ratio=3.37x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.684, Ratio=3.15x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.718, Ratio=3.32x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.727, Ratio=3.41x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.732, Ratio=3.42x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.735, Ratio=3.37x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.708, Ratio=3.31x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.698, Ratio=3.25x, Gap=-3.722
Batch 200/537: Loss=1.0700 (C:1.0700, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.734, Ratio=3.38x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.724, Ratio=3.29x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.696, Ratio=3.14x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.722, Ratio=3.29x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.751, Ratio=3.61x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.702, Ratio=3.27x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.730, Ratio=3.39x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.723, Ratio=3.35x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.740, Ratio=3.30x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.723, Ratio=3.26x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.707, Ratio=3.25x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.700, Ratio=3.31x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.722, Ratio=3.15x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.747, Ratio=3.42x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.716, Ratio=3.27x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.720, Ratio=3.29x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.728, Ratio=3.45x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.704, Ratio=3.30x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.710, Ratio=3.33x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.693, Ratio=3.17x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.698, Ratio=3.31x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.711, Ratio=3.29x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.720, Ratio=3.42x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.721, Ratio=3.37x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.698, Ratio=3.22x, Gap=-3.895
Batch 225/537: Loss=1.0732 (C:1.0732, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.718, Ratio=3.33x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.716, Ratio=3.29x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.713, Ratio=3.29x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.711, Ratio=3.31x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.723, Ratio=3.33x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.704, Ratio=3.30x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.726, Ratio=3.29x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.734, Ratio=3.40x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.715, Ratio=3.44x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.716, Ratio=3.27x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.714, Ratio=3.22x, Gap=-4.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.724, Ratio=3.42x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.725, Ratio=3.43x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.716, Ratio=3.39x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.739, Ratio=3.46x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.712, Ratio=3.30x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.735, Ratio=3.42x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.719, Ratio=3.29x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.710, Ratio=3.42x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.705, Ratio=3.25x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.707, Ratio=3.25x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.720, Ratio=3.36x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.712, Ratio=3.31x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.740, Ratio=3.45x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.706, Ratio=3.14x, Gap=-3.824
Batch 250/537: Loss=1.0876 (C:1.0876, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.721, Ratio=3.28x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.737, Ratio=3.55x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.722, Ratio=3.29x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.739, Ratio=3.45x, Gap=-4.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.705, Ratio=3.23x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.735, Ratio=3.47x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.711, Ratio=3.23x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.678, Ratio=3.13x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.721, Ratio=3.23x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.712, Ratio=3.34x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.694, Ratio=3.18x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.713, Ratio=3.33x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.731, Ratio=3.45x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.687, Ratio=3.14x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.715, Ratio=3.44x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.726, Ratio=3.34x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.719, Ratio=3.27x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.714, Ratio=3.37x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.710, Ratio=3.13x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.737, Ratio=3.49x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.715, Ratio=3.33x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.728, Ratio=3.39x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.728, Ratio=3.29x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.709, Ratio=3.30x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.715, Ratio=3.40x, Gap=-3.558
Batch 275/537: Loss=1.0413 (C:1.0413, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.713, Ratio=3.34x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.706, Ratio=3.23x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.702, Ratio=3.26x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.744, Ratio=3.39x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.733, Ratio=3.42x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.725, Ratio=3.41x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.716, Ratio=3.32x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.730, Ratio=3.58x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.719, Ratio=3.39x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.699, Ratio=3.20x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.720, Ratio=3.43x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.716, Ratio=3.38x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.709, Ratio=3.26x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.713, Ratio=3.30x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.746, Ratio=3.45x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.707, Ratio=3.29x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.721, Ratio=3.27x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.730, Ratio=3.35x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.725, Ratio=3.30x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.723, Ratio=3.35x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.719, Ratio=3.35x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.718, Ratio=3.44x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.700, Ratio=3.19x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.726, Ratio=3.33x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.728, Ratio=3.36x, Gap=-3.750
Batch 300/537: Loss=1.0434 (C:1.0434, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.722, Ratio=3.41x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.690, Ratio=3.23x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.705, Ratio=3.14x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.708, Ratio=3.21x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.725, Ratio=3.33x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.709, Ratio=3.19x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.727, Ratio=3.40x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.686, Ratio=3.21x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.724, Ratio=3.44x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.697, Ratio=3.27x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.713, Ratio=3.14x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.710, Ratio=3.25x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.715, Ratio=3.24x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.695, Ratio=3.20x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.730, Ratio=3.31x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.741, Ratio=3.47x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.714, Ratio=3.25x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.720, Ratio=3.34x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.739, Ratio=3.49x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.725, Ratio=3.35x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.721, Ratio=3.39x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.709, Ratio=3.32x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.738, Ratio=3.51x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.732, Ratio=3.40x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.707, Ratio=3.16x, Gap=-3.666
Batch 325/537: Loss=1.0882 (C:1.0882, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.697, Ratio=3.21x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.727, Ratio=3.33x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.711, Ratio=3.28x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.712, Ratio=3.33x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.715, Ratio=3.35x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.735, Ratio=3.40x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.716, Ratio=3.36x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.729, Ratio=3.26x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.726, Ratio=3.30x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.733, Ratio=3.34x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.726, Ratio=3.42x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.716, Ratio=3.19x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.717, Ratio=3.32x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.744, Ratio=3.48x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.716, Ratio=3.24x, Gap=-4.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.740, Ratio=3.62x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.750, Ratio=3.49x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.721, Ratio=3.36x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.730, Ratio=3.42x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.725, Ratio=3.32x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.725, Ratio=3.27x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.729, Ratio=3.45x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.731, Ratio=3.31x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.711, Ratio=3.14x, Gap=-4.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.734, Ratio=3.40x, Gap=-3.797
Batch 350/537: Loss=1.0408 (C:1.0408, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.725, Ratio=3.44x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.728, Ratio=3.30x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.695, Ratio=3.23x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.718, Ratio=3.42x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.714, Ratio=3.25x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.718, Ratio=3.29x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.729, Ratio=3.35x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.713, Ratio=3.14x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.706, Ratio=3.36x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.727, Ratio=3.38x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.711, Ratio=3.20x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.712, Ratio=3.33x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.734, Ratio=3.30x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.709, Ratio=3.11x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.715, Ratio=3.33x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.717, Ratio=3.28x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.710, Ratio=3.26x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.722, Ratio=3.32x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.713, Ratio=3.30x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.741, Ratio=3.40x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.721, Ratio=3.41x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.725, Ratio=3.34x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.709, Ratio=3.29x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.707, Ratio=3.36x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.732, Ratio=3.33x, Gap=-3.706
Batch 375/537: Loss=1.0477 (C:1.0477, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.703, Ratio=3.22x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.729, Ratio=3.34x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.697, Ratio=3.21x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.717, Ratio=3.26x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.743, Ratio=3.44x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.724, Ratio=3.27x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.706, Ratio=3.19x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.701, Ratio=3.18x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.695, Ratio=3.21x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.740, Ratio=3.42x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.717, Ratio=3.27x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.717, Ratio=3.33x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.713, Ratio=3.27x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.700, Ratio=3.29x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.690, Ratio=3.22x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.733, Ratio=3.34x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.725, Ratio=3.36x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.702, Ratio=3.17x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.732, Ratio=3.26x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.736, Ratio=3.37x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.712, Ratio=3.35x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.718, Ratio=3.39x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.699, Ratio=3.26x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.724, Ratio=3.35x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.715, Ratio=3.28x, Gap=-4.091
Batch 400/537: Loss=1.0657 (C:1.0657, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.729, Ratio=3.36x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.727, Ratio=3.33x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.720, Ratio=3.31x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.701, Ratio=3.31x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.706, Ratio=3.24x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.722, Ratio=3.44x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.703, Ratio=3.16x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.701, Ratio=3.12x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.724, Ratio=3.39x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.741, Ratio=3.53x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.730, Ratio=3.36x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.734, Ratio=3.54x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.711, Ratio=3.14x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.729, Ratio=3.29x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.730, Ratio=3.29x, Gap=-4.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.744, Ratio=3.38x, Gap=-4.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.747, Ratio=3.45x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.718, Ratio=3.18x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.742, Ratio=3.51x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.722, Ratio=3.37x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.705, Ratio=3.31x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.714, Ratio=3.23x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.715, Ratio=3.37x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.723, Ratio=3.30x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.730, Ratio=3.51x, Gap=-3.462
Batch 425/537: Loss=1.0193 (C:1.0193, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.719, Ratio=3.20x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.694, Ratio=3.19x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.737, Ratio=3.36x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.703, Ratio=3.25x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.748, Ratio=3.59x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.711, Ratio=3.27x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.708, Ratio=3.18x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.720, Ratio=3.43x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.722, Ratio=3.33x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.725, Ratio=3.38x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.732, Ratio=3.43x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.696, Ratio=3.14x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.715, Ratio=3.33x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.714, Ratio=3.34x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.721, Ratio=3.30x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.706, Ratio=3.28x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.713, Ratio=3.29x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.709, Ratio=3.20x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.704, Ratio=3.19x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.736, Ratio=3.42x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.729, Ratio=3.43x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.698, Ratio=3.35x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.695, Ratio=3.16x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.725, Ratio=3.39x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.758, Ratio=3.56x, Gap=-3.700
Batch 450/537: Loss=1.0076 (C:1.0076, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.729, Ratio=3.34x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.731, Ratio=3.46x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.727, Ratio=3.38x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.731, Ratio=3.48x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.720, Ratio=3.21x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.713, Ratio=3.29x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.723, Ratio=3.30x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.743, Ratio=3.51x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.714, Ratio=3.28x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.707, Ratio=3.25x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.703, Ratio=3.22x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.703, Ratio=3.40x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.726, Ratio=3.45x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.707, Ratio=3.33x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.706, Ratio=3.27x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.704, Ratio=3.26x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.705, Ratio=3.30x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.715, Ratio=3.31x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.716, Ratio=3.31x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.735, Ratio=3.55x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.728, Ratio=3.43x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.737, Ratio=3.57x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.708, Ratio=3.19x, Gap=-4.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.710, Ratio=3.37x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.745, Ratio=3.51x, Gap=-3.575
Batch 475/537: Loss=1.0157 (C:1.0157, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.716, Ratio=3.29x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.725, Ratio=3.25x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.736, Ratio=3.26x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.706, Ratio=3.19x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.746, Ratio=3.29x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.730, Ratio=3.30x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.743, Ratio=3.49x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.735, Ratio=3.38x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.732, Ratio=3.47x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.711, Ratio=3.37x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.704, Ratio=3.22x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.696, Ratio=3.31x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.714, Ratio=3.30x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.726, Ratio=3.39x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.705, Ratio=3.21x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.698, Ratio=3.18x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.707, Ratio=3.27x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.720, Ratio=3.30x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.705, Ratio=3.33x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.733, Ratio=3.35x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.725, Ratio=3.27x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.695, Ratio=3.27x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.731, Ratio=3.45x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.709, Ratio=3.27x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.737, Ratio=3.40x, Gap=-3.877
Batch 500/537: Loss=1.0371 (C:1.0371, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.713, Ratio=3.23x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.730, Ratio=3.47x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.705, Ratio=3.19x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.716, Ratio=3.34x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.706, Ratio=3.27x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.721, Ratio=3.36x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.731, Ratio=3.42x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.706, Ratio=3.31x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.736, Ratio=3.43x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.707, Ratio=3.25x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.715, Ratio=3.38x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.700, Ratio=3.18x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.718, Ratio=3.33x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.707, Ratio=3.22x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.737, Ratio=3.46x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.711, Ratio=3.27x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.710, Ratio=3.19x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.700, Ratio=3.16x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.723, Ratio=3.34x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.725, Ratio=3.44x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.712, Ratio=3.29x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.704, Ratio=3.18x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.695, Ratio=3.13x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.703, Ratio=3.25x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.721, Ratio=3.37x, Gap=-3.574
Batch 525/537: Loss=1.0400 (C:1.0400, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.720, Ratio=3.38x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.738, Ratio=3.43x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.730, Ratio=3.46x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.704, Ratio=3.28x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.725, Ratio=3.44x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.709, Ratio=3.17x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.719, Ratio=3.33x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.702, Ratio=3.21x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.726, Ratio=3.32x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.702, Ratio=3.22x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.722, Ratio=3.33x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.739, Ratio=3.71x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.731, Ratio=3.59x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.732, Ratio=3.70x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.724, Ratio=3.62x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.705, Ratio=3.39x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.731, Ratio=3.77x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.737, Ratio=3.72x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.729, Ratio=3.64x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.725, Ratio=3.61x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.732, Ratio=3.62x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.742, Ratio=3.68x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.737, Ratio=3.62x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.728, Ratio=3.53x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.729, Ratio=3.61x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.732, Ratio=3.74x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.733, Ratio=3.68x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.728, Ratio=3.68x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.732, Ratio=3.51x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.732, Ratio=3.54x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.725, Ratio=3.51x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.706, Ratio=3.41x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.714, Ratio=3.52x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.712, Ratio=3.47x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.726, Ratio=3.65x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.725, Ratio=3.67x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.734, Ratio=3.64x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.747, Ratio=3.76x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.735, Ratio=3.54x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.742, Ratio=3.72x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.721, Ratio=3.59x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.738, Ratio=3.67x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.720, Ratio=3.52x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.735, Ratio=3.55x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.747, Ratio=3.64x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.710, Ratio=3.55x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.714, Ratio=3.47x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.713, Ratio=3.61x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.724, Ratio=3.62x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.719, Ratio=3.55x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.712, Ratio=3.46x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.730, Ratio=3.57x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.717, Ratio=3.67x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.714, Ratio=3.56x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.736, Ratio=3.57x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.741, Ratio=3.64x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.725, Ratio=3.57x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.726, Ratio=3.58x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.727, Ratio=3.63x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.715, Ratio=3.44x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.739, Ratio=3.50x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.713, Ratio=3.53x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.752, Ratio=3.74x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.714, Ratio=3.52x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.720, Ratio=3.41x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.760, Ratio=3.94x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.738, Ratio=3.67x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.731, Ratio=3.64x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.698, Ratio=3.37x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.738, Ratio=3.74x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.741, Ratio=3.74x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.744, Ratio=3.58x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.716, Ratio=3.51x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.732, Ratio=3.60x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.743, Ratio=3.70x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.737, Ratio=3.62x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.745, Ratio=3.75x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.736, Ratio=3.65x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.732, Ratio=3.58x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.715, Ratio=3.47x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.703, Ratio=3.42x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.713, Ratio=3.45x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.716, Ratio=3.55x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.746, Ratio=3.62x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.717, Ratio=3.60x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.721, Ratio=3.44x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.722, Ratio=3.42x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.748, Ratio=3.66x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.699, Ratio=3.37x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.695, Ratio=3.34x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.732, Ratio=3.64x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.738, Ratio=3.74x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.723, Ratio=3.58x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.718, Ratio=3.53x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.757, Ratio=3.78x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.730, Ratio=3.59x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.748, Ratio=3.70x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.736, Ratio=3.61x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.732, Ratio=3.57x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.731, Ratio=3.50x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.723, Ratio=3.39x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.707, Ratio=3.42x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.732, Ratio=3.69x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.732, Ratio=3.56x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.720, Ratio=3.56x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.737, Ratio=3.64x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.724, Ratio=3.58x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.710, Ratio=3.55x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.711, Ratio=3.52x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.735, Ratio=3.65x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.717, Ratio=3.49x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.743, Ratio=3.75x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.731, Ratio=3.62x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.738, Ratio=3.68x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.719, Ratio=3.55x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.730, Ratio=3.60x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.720, Ratio=3.59x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.700, Ratio=3.49x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.746, Ratio=3.76x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.745, Ratio=3.74x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.721, Ratio=3.43x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.743, Ratio=3.69x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.733, Ratio=3.53x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.731, Ratio=3.55x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.736, Ratio=3.64x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.740, Ratio=3.75x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.726, Ratio=3.52x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.713, Ratio=3.60x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.733, Ratio=3.64x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.741, Ratio=3.74x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.732, Ratio=3.66x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.722, Ratio=3.49x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.741, Ratio=3.63x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.731, Ratio=3.59x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.733, Ratio=3.57x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.752, Ratio=3.73x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.739, Ratio=3.65x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.738, Ratio=3.65x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.755, Ratio=3.77x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.750, Ratio=3.88x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.710, Ratio=3.51x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.728, Ratio=3.49x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.726, Ratio=3.58x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.725, Ratio=3.39x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.729, Ratio=3.56x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.718, Ratio=3.58x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.736, Ratio=3.62x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.737, Ratio=3.64x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.732, Ratio=3.73x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.722, Ratio=3.56x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.731, Ratio=3.65x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.735, Ratio=3.68x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.718, Ratio=3.55x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.730, Ratio=3.73x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.728, Ratio=3.64x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.726, Ratio=3.50x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.737, Ratio=3.63x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.762, Ratio=3.84x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.733, Ratio=3.70x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.740, Ratio=3.65x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.718, Ratio=3.48x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.717, Ratio=3.68x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.711, Ratio=3.47x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.736, Ratio=3.56x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.708, Ratio=3.48x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.761, Ratio=3.80x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.731, Ratio=3.70x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.718, Ratio=3.59x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.725, Ratio=3.53x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.729, Ratio=3.54x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.721, Ratio=3.50x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.716, Ratio=3.56x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.746, Ratio=3.68x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.739, Ratio=3.70x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.731, Ratio=3.59x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.710, Ratio=3.48x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.737, Ratio=3.57x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.741, Ratio=3.66x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.727, Ratio=3.58x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.719, Ratio=3.56x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.726, Ratio=3.60x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.735, Ratio=3.60x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.713, Ratio=3.43x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.706, Ratio=3.44x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.736, Ratio=3.65x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.720, Ratio=3.58x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.721, Ratio=3.60x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.744, Ratio=3.78x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.723, Ratio=3.58x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.741, Ratio=3.64x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.707, Ratio=3.47x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.724, Ratio=3.60x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.747, Ratio=3.67x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.750, Ratio=3.67x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.736, Ratio=3.69x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.725, Ratio=3.54x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.745, Ratio=3.75x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.745, Ratio=3.81x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.748, Ratio=3.74x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.734, Ratio=3.65x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.725, Ratio=3.59x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.732, Ratio=3.79x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.735, Ratio=3.71x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.743, Ratio=3.73x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.774, Ratio=3.97x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.747, Ratio=3.75x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.738, Ratio=3.61x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.749, Ratio=3.78x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.722, Ratio=3.47x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.733, Ratio=3.62x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.733, Ratio=3.55x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.733, Ratio=3.65x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.741, Ratio=3.83x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.741, Ratio=3.66x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.743, Ratio=3.62x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.728, Ratio=3.56x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.715, Ratio=3.48x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.719, Ratio=3.60x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.740, Ratio=3.75x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.694, Ratio=3.38x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.730, Ratio=3.59x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.741, Ratio=3.84x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.725, Ratio=3.64x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.738, Ratio=3.63x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.738, Ratio=3.75x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.721, Ratio=3.58x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.707, Ratio=3.47x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.732, Ratio=3.52x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.726, Ratio=3.63x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.721, Ratio=3.43x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.710, Ratio=3.35x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.747, Ratio=3.79x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.702, Ratio=3.37x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.738, Ratio=3.79x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.709, Ratio=3.41x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.717, Ratio=3.51x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.724, Ratio=3.51x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.715, Ratio=3.50x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.724, Ratio=3.51x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.732, Ratio=3.56x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.739, Ratio=3.69x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.728, Ratio=3.49x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.735, Ratio=3.71x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.735, Ratio=3.63x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.717, Ratio=3.52x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.730, Ratio=3.66x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.749, Ratio=3.68x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.717, Ratio=3.47x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.712, Ratio=3.48x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.731, Ratio=3.59x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.742, Ratio=3.67x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.739, Ratio=3.61x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.734, Ratio=3.78x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.737, Ratio=3.60x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.732, Ratio=3.65x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.748, Ratio=3.72x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.740, Ratio=3.63x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.731, Ratio=3.59x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.714, Ratio=3.50x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.726, Ratio=3.71x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.719, Ratio=3.50x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.733, Ratio=3.60x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.728, Ratio=3.70x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.712, Ratio=3.43x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.738, Ratio=3.69x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.752, Ratio=3.73x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.746, Ratio=3.70x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.729, Ratio=3.57x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.723, Ratio=3.48x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.713, Ratio=3.62x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.726, Ratio=3.57x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.706, Ratio=3.41x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.737, Ratio=3.56x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.729, Ratio=3.65x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.745, Ratio=3.84x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.702, Ratio=3.49x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.721, Ratio=3.63x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.735, Ratio=3.60x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.740, Ratio=3.64x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.745, Ratio=3.68x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.732, Ratio=3.70x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.742, Ratio=3.74x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.745, Ratio=3.77x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.727, Ratio=3.66x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.748, Ratio=3.76x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.721, Ratio=3.50x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.734, Ratio=3.58x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.748, Ratio=3.66x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.720, Ratio=3.60x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.742, Ratio=3.65x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.730, Ratio=3.49x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.731, Ratio=3.55x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.716, Ratio=3.50x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.730, Ratio=3.57x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.719, Ratio=3.48x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.727, Ratio=3.46x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.743, Ratio=3.69x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.733, Ratio=3.68x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.722, Ratio=3.51x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.709, Ratio=3.33x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.696, Ratio=3.39x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.734, Ratio=3.61x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.713, Ratio=3.42x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.727, Ratio=3.58x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.733, Ratio=3.65x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.738, Ratio=3.76x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.717, Ratio=3.59x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.740, Ratio=3.65x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.712, Ratio=3.54x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.721, Ratio=3.66x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.736, Ratio=3.58x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.716, Ratio=3.44x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.710, Ratio=3.44x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.722, Ratio=3.50x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.736, Ratio=3.62x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.723, Ratio=3.71x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.727, Ratio=3.57x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.735, Ratio=3.68x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.746, Ratio=3.70x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.715, Ratio=3.50x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.725, Ratio=3.51x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.716, Ratio=3.42x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.740, Ratio=3.71x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.742, Ratio=3.72x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.709, Ratio=3.44x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.723, Ratio=3.60x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.711, Ratio=3.44x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.749, Ratio=3.74x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.738, Ratio=3.63x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.731, Ratio=3.52x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.742, Ratio=3.57x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.716, Ratio=3.51x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.705, Ratio=3.39x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.733, Ratio=3.53x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.716, Ratio=3.44x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.734, Ratio=3.75x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.716, Ratio=3.49x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.730, Ratio=3.59x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.720, Ratio=3.60x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.728, Ratio=3.57x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.735, Ratio=3.68x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.730, Ratio=3.56x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.721, Ratio=3.65x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.724, Ratio=3.58x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.730, Ratio=3.62x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.724, Ratio=3.67x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.735, Ratio=3.68x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.737, Ratio=3.57x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.722, Ratio=3.67x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.719, Ratio=3.57x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.729, Ratio=3.66x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.754, Ratio=3.75x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.738, Ratio=3.60x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.726, Ratio=3.49x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.715, Ratio=3.54x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.725, Ratio=3.47x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.718, Ratio=3.53x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.722, Ratio=3.51x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.732, Ratio=3.66x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.735, Ratio=3.63x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.715, Ratio=3.45x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.707, Ratio=3.47x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.735, Ratio=3.57x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.736, Ratio=3.70x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.718, Ratio=3.64x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.723, Ratio=3.51x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.729, Ratio=3.58x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.717, Ratio=3.47x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.725, Ratio=3.56x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.716, Ratio=3.62x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.744, Ratio=3.59x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.739, Ratio=3.60x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.719, Ratio=3.67x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.727, Ratio=3.60x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.728, Ratio=3.58x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.733, Ratio=3.57x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.741, Ratio=3.74x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.727, Ratio=3.57x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.728, Ratio=3.54x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.732, Ratio=3.69x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.736, Ratio=3.66x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.718, Ratio=3.47x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.711, Ratio=3.45x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.740, Ratio=3.54x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.726, Ratio=3.54x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.745, Ratio=3.74x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.738, Ratio=3.66x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.728, Ratio=3.58x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.719, Ratio=3.56x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.735, Ratio=3.65x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.726, Ratio=3.64x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.717, Ratio=3.49x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.713, Ratio=3.54x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.729, Ratio=3.51x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.743, Ratio=3.61x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.730, Ratio=3.57x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.727, Ratio=3.59x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.717, Ratio=3.44x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.723, Ratio=3.61x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.725, Ratio=3.62x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.737, Ratio=3.56x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.725, Ratio=3.56x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.729, Ratio=3.64x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.708, Ratio=3.47x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.710, Ratio=3.46x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.753, Ratio=3.73x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.746, Ratio=3.85x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.738, Ratio=3.58x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.730, Ratio=3.60x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.734, Ratio=3.73x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.736, Ratio=3.72x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.706, Ratio=3.49x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.745, Ratio=3.67x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.730, Ratio=3.68x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.746, Ratio=3.69x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.736, Ratio=3.65x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.724, Ratio=3.50x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.758, Ratio=3.81x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.755, Ratio=3.88x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.727, Ratio=3.58x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.728, Ratio=3.62x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.712, Ratio=3.57x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.745, Ratio=3.71x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.718, Ratio=3.50x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.719, Ratio=3.60x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.736, Ratio=3.71x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.740, Ratio=3.73x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.724, Ratio=3.57x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.713, Ratio=3.46x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.737, Ratio=3.62x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.719, Ratio=3.44x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.730, Ratio=3.56x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.729, Ratio=3.55x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.735, Ratio=3.65x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.734, Ratio=3.54x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.710, Ratio=3.40x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.746, Ratio=3.71x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.748, Ratio=3.66x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.718, Ratio=3.47x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.733, Ratio=3.63x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.710, Ratio=3.42x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.732, Ratio=3.78x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.721, Ratio=3.52x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.734, Ratio=3.49x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.744, Ratio=3.70x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.728, Ratio=3.66x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.715, Ratio=3.51x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.711, Ratio=3.45x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.706, Ratio=3.48x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.743, Ratio=3.82x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.700, Ratio=3.30x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.731, Ratio=3.59x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.727, Ratio=3.49x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.727, Ratio=3.55x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.737, Ratio=3.70x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.730, Ratio=3.59x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.740, Ratio=3.66x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.741, Ratio=3.72x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.733, Ratio=3.52x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.717, Ratio=3.46x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.716, Ratio=3.57x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.731, Ratio=3.75x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.714, Ratio=3.50x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.735, Ratio=3.56x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.730, Ratio=3.52x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.725, Ratio=3.46x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.711, Ratio=3.37x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.742, Ratio=3.88x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.739, Ratio=3.76x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.735, Ratio=3.62x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.736, Ratio=3.55x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.717, Ratio=3.50x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.716, Ratio=3.46x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.718, Ratio=3.46x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.746, Ratio=3.72x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.736, Ratio=3.73x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.734, Ratio=3.58x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.748, Ratio=3.77x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.717, Ratio=3.53x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.734, Ratio=3.68x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.726, Ratio=3.53x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.723, Ratio=3.54x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.717, Ratio=3.46x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.722, Ratio=3.55x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.708, Ratio=3.36x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.710, Ratio=3.39x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.727, Ratio=3.62x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.724, Ratio=3.63x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.720, Ratio=3.49x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.732, Ratio=3.61x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.703, Ratio=3.38x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.713, Ratio=3.48x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.729, Ratio=3.55x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.716, Ratio=3.54x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.729, Ratio=3.60x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.725, Ratio=3.63x, Gap=-3.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.713, Ratio=3.38x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.721, Ratio=3.52x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.751, Ratio=3.75x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.740, Ratio=3.69x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.728, Ratio=3.62x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.742, Ratio=3.86x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.749, Ratio=3.80x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.716, Ratio=3.55x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.739, Ratio=3.69x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.713, Ratio=3.54x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.718, Ratio=3.49x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.726, Ratio=3.48x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.723, Ratio=3.48x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.721, Ratio=3.57x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.734, Ratio=3.63x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.750, Ratio=3.76x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.720, Ratio=3.58x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.726, Ratio=3.58x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.739, Ratio=3.63x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.715, Ratio=3.42x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.742, Ratio=3.62x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.758, Ratio=3.76x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.716, Ratio=3.63x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.722, Ratio=3.59x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.735, Ratio=3.69x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.728, Ratio=3.61x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.752, Ratio=3.82x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.733, Ratio=3.66x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.713, Ratio=3.54x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.723, Ratio=3.69x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.731, Ratio=3.63x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.733, Ratio=3.53x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.727, Ratio=3.66x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.729, Ratio=3.60x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.730, Ratio=3.56x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.723, Ratio=3.63x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.704, Ratio=3.44x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.758, Ratio=3.90x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.757, Ratio=3.77x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.728, Ratio=3.51x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.702, Ratio=3.46x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.726, Ratio=3.61x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.722, Ratio=3.63x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.723, Ratio=3.49x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.735, Ratio=3.60x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.754, Ratio=3.92x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.712, Ratio=3.58x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.721, Ratio=3.52x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.743, Ratio=3.71x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.703, Ratio=3.47x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.718, Ratio=3.41x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.709, Ratio=3.48x, Gap=-3.176

============================================================
Epoch 9/20 completed in 31.9s
Train: Loss=1.0519 (C:1.0519, R:0.0000) Ratio=3.18x
Val:   Loss=1.0073 (C:1.0073, R:0.0000) Ratio=3.80x
‚úÖ New best model saved (Val Loss: 1.0073)
============================================================

üåç Updating global dataset at epoch 10
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.471 ¬± 0.559
    Neg distances: 1.761 ¬± 0.882
    Separation ratio: 3.74x
    Gap: -3.228
    ‚úÖ Excellent global separation!

Epoch 10 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.763, Ratio=3.45x, Gap=-3.606
Batch   0/537: Loss=1.0271 (C:1.0271, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.778, Ratio=3.60x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.772, Ratio=3.57x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.768, Ratio=3.51x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.781, Ratio=3.45x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.778, Ratio=3.55x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.787, Ratio=3.58x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.782, Ratio=3.59x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.778, Ratio=3.52x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.804, Ratio=3.61x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.810, Ratio=3.61x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.793, Ratio=3.52x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.795, Ratio=3.54x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.799, Ratio=3.68x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.790, Ratio=3.51x, Gap=-4.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.788, Ratio=3.46x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.783, Ratio=3.58x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.774, Ratio=3.49x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.772, Ratio=3.43x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.807, Ratio=3.73x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.770, Ratio=3.52x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.796, Ratio=3.57x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.774, Ratio=3.38x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.755, Ratio=3.60x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.788, Ratio=3.64x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.780, Ratio=3.46x, Gap=-3.679
Batch  25/537: Loss=1.0219 (C:1.0219, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.796, Ratio=3.69x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.782, Ratio=3.42x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.792, Ratio=3.71x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.785, Ratio=3.49x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.776, Ratio=3.44x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.805, Ratio=3.71x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.778, Ratio=3.56x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.791, Ratio=3.47x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.794, Ratio=3.67x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.790, Ratio=3.61x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.790, Ratio=3.62x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.766, Ratio=3.38x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.763, Ratio=3.46x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.795, Ratio=3.62x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.782, Ratio=3.67x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.769, Ratio=3.42x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.791, Ratio=3.70x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.769, Ratio=3.35x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.768, Ratio=3.34x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.772, Ratio=3.49x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.777, Ratio=3.58x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.770, Ratio=3.51x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.793, Ratio=3.54x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.766, Ratio=3.52x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.775, Ratio=3.58x, Gap=-4.030
Batch  50/537: Loss=1.0003 (C:1.0003, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.783, Ratio=3.45x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.793, Ratio=3.59x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.776, Ratio=3.44x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.759, Ratio=3.43x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.770, Ratio=3.35x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.804, Ratio=3.67x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.790, Ratio=3.54x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.781, Ratio=3.68x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.780, Ratio=3.52x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.781, Ratio=3.49x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.801, Ratio=3.56x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.765, Ratio=3.41x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.790, Ratio=3.66x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.781, Ratio=3.55x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.783, Ratio=3.56x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.775, Ratio=3.50x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.797, Ratio=3.66x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.792, Ratio=3.48x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.796, Ratio=3.62x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.789, Ratio=3.73x, Gap=-4.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.784, Ratio=3.65x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.777, Ratio=3.45x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.776, Ratio=3.47x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.796, Ratio=3.49x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.782, Ratio=3.50x, Gap=-4.164
Batch  75/537: Loss=1.0179 (C:1.0179, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.786, Ratio=3.48x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.774, Ratio=3.47x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.788, Ratio=3.46x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.760, Ratio=3.30x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.783, Ratio=3.69x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.793, Ratio=3.62x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.761, Ratio=3.35x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.753, Ratio=3.27x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.763, Ratio=3.41x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.784, Ratio=3.57x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.783, Ratio=3.48x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.788, Ratio=3.57x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.792, Ratio=3.60x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.772, Ratio=3.49x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.797, Ratio=3.63x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.799, Ratio=3.64x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.797, Ratio=3.54x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.803, Ratio=3.57x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.800, Ratio=3.64x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.782, Ratio=3.61x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.800, Ratio=3.48x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.812, Ratio=3.64x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.792, Ratio=3.46x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.800, Ratio=3.58x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.762, Ratio=3.37x, Gap=-4.216
Batch 100/537: Loss=1.0423 (C:1.0423, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.788, Ratio=3.47x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.756, Ratio=3.42x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.793, Ratio=3.52x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.771, Ratio=3.47x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.783, Ratio=3.49x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.786, Ratio=3.53x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.755, Ratio=3.35x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.766, Ratio=3.44x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.761, Ratio=3.39x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.781, Ratio=3.58x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.763, Ratio=3.33x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.783, Ratio=3.52x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.791, Ratio=3.69x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.798, Ratio=3.61x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.772, Ratio=3.49x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.799, Ratio=3.53x, Gap=-4.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.786, Ratio=3.61x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.802, Ratio=3.57x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.781, Ratio=3.53x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.769, Ratio=3.52x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.772, Ratio=3.31x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.785, Ratio=3.48x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.788, Ratio=3.56x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.773, Ratio=3.48x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.787, Ratio=3.48x, Gap=-3.947
Batch 125/537: Loss=1.0179 (C:1.0179, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.743, Ratio=3.27x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.765, Ratio=3.38x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.763, Ratio=3.34x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.785, Ratio=3.72x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.784, Ratio=3.48x, Gap=-4.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.788, Ratio=3.49x, Gap=-4.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.789, Ratio=3.51x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.775, Ratio=3.46x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.764, Ratio=3.26x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.790, Ratio=3.56x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.781, Ratio=3.61x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.778, Ratio=3.55x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.791, Ratio=3.45x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.800, Ratio=3.73x, Gap=-4.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.766, Ratio=3.32x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.787, Ratio=3.52x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.775, Ratio=3.42x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.791, Ratio=3.59x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.791, Ratio=3.56x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.778, Ratio=3.55x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.779, Ratio=3.59x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.799, Ratio=3.50x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.781, Ratio=3.45x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.773, Ratio=3.41x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.796, Ratio=3.55x, Gap=-3.814
Batch 150/537: Loss=1.0060 (C:1.0060, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.761, Ratio=3.48x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.764, Ratio=3.48x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.761, Ratio=3.52x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.768, Ratio=3.52x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.794, Ratio=3.61x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.757, Ratio=3.50x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.792, Ratio=3.58x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.762, Ratio=3.28x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.770, Ratio=3.38x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.767, Ratio=3.29x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.799, Ratio=3.56x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.772, Ratio=3.54x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.791, Ratio=3.50x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.784, Ratio=3.49x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.750, Ratio=3.22x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.800, Ratio=3.54x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.763, Ratio=3.29x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.797, Ratio=3.56x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.765, Ratio=3.37x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.776, Ratio=3.59x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.755, Ratio=3.37x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.771, Ratio=3.40x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.787, Ratio=3.60x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.774, Ratio=3.45x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.771, Ratio=3.55x, Gap=-3.653
Batch 175/537: Loss=1.0099 (C:1.0099, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.765, Ratio=3.43x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.777, Ratio=3.62x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.781, Ratio=3.55x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.775, Ratio=3.27x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.775, Ratio=3.49x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.759, Ratio=3.25x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.826, Ratio=3.76x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.795, Ratio=3.41x, Gap=-4.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.781, Ratio=3.63x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.770, Ratio=3.42x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.805, Ratio=3.71x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.754, Ratio=3.36x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.780, Ratio=3.49x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.772, Ratio=3.46x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.783, Ratio=3.57x, Gap=-4.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.791, Ratio=3.58x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.786, Ratio=3.58x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.776, Ratio=3.39x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.790, Ratio=3.49x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.772, Ratio=3.36x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.779, Ratio=3.56x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.784, Ratio=3.56x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.797, Ratio=3.68x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.792, Ratio=3.59x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.791, Ratio=3.68x, Gap=-3.730
Batch 200/537: Loss=0.9863 (C:0.9863, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.784, Ratio=3.50x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.770, Ratio=3.47x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.782, Ratio=3.47x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.790, Ratio=3.48x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.760, Ratio=3.25x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.804, Ratio=3.67x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.787, Ratio=3.56x, Gap=-4.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.785, Ratio=3.46x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.750, Ratio=3.28x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.778, Ratio=3.44x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.783, Ratio=3.44x, Gap=-4.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.792, Ratio=3.57x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.775, Ratio=3.57x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.788, Ratio=3.45x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.778, Ratio=3.50x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.774, Ratio=3.40x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.766, Ratio=3.46x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.784, Ratio=3.47x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.778, Ratio=3.46x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.768, Ratio=3.37x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.766, Ratio=3.31x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.779, Ratio=3.43x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.774, Ratio=3.39x, Gap=-4.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.769, Ratio=3.50x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.737, Ratio=3.35x, Gap=-4.208
Batch 225/537: Loss=1.0468 (C:1.0468, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.774, Ratio=3.44x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.759, Ratio=3.48x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.786, Ratio=3.61x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.782, Ratio=3.48x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.786, Ratio=3.41x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.784, Ratio=3.50x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.785, Ratio=3.52x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.771, Ratio=3.38x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.801, Ratio=3.53x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.782, Ratio=3.47x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.770, Ratio=3.44x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.806, Ratio=3.57x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.801, Ratio=3.62x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.786, Ratio=3.43x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.794, Ratio=3.51x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.795, Ratio=3.48x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.770, Ratio=3.46x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.786, Ratio=3.65x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.774, Ratio=3.39x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.804, Ratio=3.70x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.784, Ratio=3.60x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.773, Ratio=3.39x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.749, Ratio=3.28x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.779, Ratio=3.45x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.770, Ratio=3.53x, Gap=-3.771
Batch 250/537: Loss=1.0112 (C:1.0112, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.796, Ratio=3.63x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.800, Ratio=3.72x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.782, Ratio=3.53x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.779, Ratio=3.45x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.786, Ratio=3.51x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.768, Ratio=3.37x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.776, Ratio=3.43x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.794, Ratio=3.52x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.799, Ratio=3.62x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.783, Ratio=3.53x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.794, Ratio=3.61x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.791, Ratio=3.54x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.769, Ratio=3.30x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.733, Ratio=3.13x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.772, Ratio=3.45x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.776, Ratio=3.53x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.775, Ratio=3.57x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.780, Ratio=3.45x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.763, Ratio=3.38x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.784, Ratio=3.57x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.785, Ratio=3.50x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.772, Ratio=3.54x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.788, Ratio=3.53x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.752, Ratio=3.30x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.771, Ratio=3.48x, Gap=-3.912
Batch 275/537: Loss=1.0203 (C:1.0203, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.774, Ratio=3.43x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.784, Ratio=3.48x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.793, Ratio=3.67x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.792, Ratio=3.55x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.785, Ratio=3.57x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.770, Ratio=3.46x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.774, Ratio=3.40x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.800, Ratio=3.61x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.791, Ratio=3.48x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.775, Ratio=3.45x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.788, Ratio=3.51x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.785, Ratio=3.59x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.797, Ratio=3.49x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.793, Ratio=3.69x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.756, Ratio=3.30x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.781, Ratio=3.55x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.802, Ratio=3.56x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.785, Ratio=3.49x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.787, Ratio=3.47x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.763, Ratio=3.45x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.761, Ratio=3.28x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.769, Ratio=3.43x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.761, Ratio=3.43x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.774, Ratio=3.44x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.778, Ratio=3.52x, Gap=-3.821
Batch 300/537: Loss=1.0137 (C:1.0137, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.765, Ratio=3.40x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.784, Ratio=3.51x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.784, Ratio=3.54x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.776, Ratio=3.47x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.759, Ratio=3.34x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.782, Ratio=3.59x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.763, Ratio=3.31x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.769, Ratio=3.33x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.787, Ratio=3.37x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.805, Ratio=3.67x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.787, Ratio=3.49x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.778, Ratio=3.30x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.766, Ratio=3.33x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.771, Ratio=3.32x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.789, Ratio=3.63x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.785, Ratio=3.47x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.798, Ratio=3.56x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.774, Ratio=3.50x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.765, Ratio=3.47x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.761, Ratio=3.38x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.765, Ratio=3.33x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.792, Ratio=3.62x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.777, Ratio=3.53x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.792, Ratio=3.68x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.800, Ratio=3.62x, Gap=-3.816
Batch 325/537: Loss=0.9937 (C:0.9937, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.756, Ratio=3.44x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.792, Ratio=3.59x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.759, Ratio=3.45x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.778, Ratio=3.46x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.776, Ratio=3.42x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.752, Ratio=3.23x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.784, Ratio=3.53x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.751, Ratio=3.35x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.764, Ratio=3.33x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.785, Ratio=3.51x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.769, Ratio=3.39x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.770, Ratio=3.31x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.774, Ratio=3.41x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.768, Ratio=3.40x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.807, Ratio=3.68x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.789, Ratio=3.55x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.778, Ratio=3.53x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.793, Ratio=3.57x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.743, Ratio=3.23x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.783, Ratio=3.53x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.774, Ratio=3.51x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.788, Ratio=3.67x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.769, Ratio=3.46x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.783, Ratio=3.47x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.798, Ratio=3.59x, Gap=-3.552
Batch 350/537: Loss=0.9994 (C:0.9994, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.768, Ratio=3.38x, Gap=-4.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.781, Ratio=3.52x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.762, Ratio=3.46x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.767, Ratio=3.40x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.785, Ratio=3.51x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.790, Ratio=3.62x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.781, Ratio=3.54x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.788, Ratio=3.52x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.793, Ratio=3.54x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.770, Ratio=3.51x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.797, Ratio=3.61x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.782, Ratio=3.64x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.786, Ratio=3.51x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.803, Ratio=3.62x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.743, Ratio=3.34x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.782, Ratio=3.31x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.788, Ratio=3.55x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.765, Ratio=3.36x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.788, Ratio=3.40x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.784, Ratio=3.47x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.771, Ratio=3.42x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.779, Ratio=3.51x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.779, Ratio=3.46x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.794, Ratio=3.63x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.798, Ratio=3.59x, Gap=-4.201
Batch 375/537: Loss=0.9983 (C:0.9983, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.770, Ratio=3.43x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.780, Ratio=3.38x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.785, Ratio=3.64x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.798, Ratio=3.62x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.775, Ratio=3.45x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.742, Ratio=3.47x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.768, Ratio=3.38x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.797, Ratio=3.56x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.750, Ratio=3.20x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.766, Ratio=3.35x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.795, Ratio=3.61x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.786, Ratio=3.50x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.768, Ratio=3.33x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.803, Ratio=3.57x, Gap=-4.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.788, Ratio=3.55x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.780, Ratio=3.48x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.755, Ratio=3.40x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.782, Ratio=3.41x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.797, Ratio=3.47x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.765, Ratio=3.31x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.785, Ratio=3.46x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.753, Ratio=3.34x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.782, Ratio=3.59x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.771, Ratio=3.60x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.781, Ratio=3.38x, Gap=-3.994
Batch 400/537: Loss=1.0375 (C:1.0375, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.782, Ratio=3.54x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.793, Ratio=3.60x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.783, Ratio=3.45x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.784, Ratio=3.52x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.781, Ratio=3.46x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.779, Ratio=3.36x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.760, Ratio=3.39x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.753, Ratio=3.32x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.781, Ratio=3.42x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.806, Ratio=3.69x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.774, Ratio=3.39x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.751, Ratio=3.34x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.758, Ratio=3.24x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.780, Ratio=3.47x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.782, Ratio=3.40x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.784, Ratio=3.54x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.764, Ratio=3.46x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.776, Ratio=3.42x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.776, Ratio=3.45x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.748, Ratio=3.28x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.774, Ratio=3.46x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.800, Ratio=3.60x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.772, Ratio=3.40x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.797, Ratio=3.61x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.766, Ratio=3.42x, Gap=-3.893
Batch 425/537: Loss=1.0309 (C:1.0309, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.799, Ratio=3.54x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.790, Ratio=3.55x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.769, Ratio=3.53x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.792, Ratio=3.55x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.756, Ratio=3.26x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.776, Ratio=3.29x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.775, Ratio=3.28x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.762, Ratio=3.29x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.775, Ratio=3.39x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.787, Ratio=3.59x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.771, Ratio=3.52x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.776, Ratio=3.44x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.777, Ratio=3.49x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.779, Ratio=3.60x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.792, Ratio=3.56x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.768, Ratio=3.40x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.779, Ratio=3.39x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.790, Ratio=3.54x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.780, Ratio=3.38x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.768, Ratio=3.36x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.752, Ratio=3.44x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.784, Ratio=3.55x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.786, Ratio=3.58x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.768, Ratio=3.40x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.776, Ratio=3.43x, Gap=-3.545
Batch 450/537: Loss=1.0296 (C:1.0296, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.819, Ratio=3.56x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.781, Ratio=3.40x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.794, Ratio=3.55x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.803, Ratio=3.63x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.816, Ratio=3.60x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.789, Ratio=3.47x, Gap=-4.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.796, Ratio=3.59x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.777, Ratio=3.45x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.768, Ratio=3.38x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.787, Ratio=3.67x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.780, Ratio=3.39x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.769, Ratio=3.46x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.776, Ratio=3.45x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.772, Ratio=3.37x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.773, Ratio=3.52x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.766, Ratio=3.30x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.757, Ratio=3.41x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.784, Ratio=3.49x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.789, Ratio=3.51x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.782, Ratio=3.44x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.786, Ratio=3.52x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.773, Ratio=3.36x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.778, Ratio=3.51x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.788, Ratio=3.51x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.784, Ratio=3.52x, Gap=-3.779
Batch 475/537: Loss=1.0105 (C:1.0105, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.776, Ratio=3.44x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.777, Ratio=3.34x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.788, Ratio=3.41x, Gap=-4.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.775, Ratio=3.57x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.789, Ratio=3.55x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.790, Ratio=3.45x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.779, Ratio=3.44x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.755, Ratio=3.26x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.809, Ratio=3.69x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.768, Ratio=3.38x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.779, Ratio=3.59x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.788, Ratio=3.70x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.775, Ratio=3.44x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.781, Ratio=3.54x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.775, Ratio=3.38x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.769, Ratio=3.40x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.767, Ratio=3.35x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.787, Ratio=3.59x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.778, Ratio=3.38x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.778, Ratio=3.48x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.804, Ratio=3.64x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.767, Ratio=3.50x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.780, Ratio=3.35x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.776, Ratio=3.51x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.785, Ratio=3.60x, Gap=-3.790
Batch 500/537: Loss=0.9958 (C:0.9958, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.788, Ratio=3.48x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.791, Ratio=3.59x, Gap=-4.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.791, Ratio=3.55x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.788, Ratio=3.51x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.758, Ratio=3.42x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.775, Ratio=3.41x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.787, Ratio=3.48x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.792, Ratio=3.57x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.777, Ratio=3.49x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.808, Ratio=3.60x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.776, Ratio=3.51x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.784, Ratio=3.48x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.783, Ratio=3.49x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.787, Ratio=3.40x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.772, Ratio=3.51x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.782, Ratio=3.47x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.772, Ratio=3.33x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.787, Ratio=3.62x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.778, Ratio=3.51x, Gap=-4.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.782, Ratio=3.45x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.777, Ratio=3.59x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.788, Ratio=3.47x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.787, Ratio=3.55x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.753, Ratio=3.38x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.791, Ratio=3.50x, Gap=-3.803
Batch 525/537: Loss=1.0149 (C:1.0149, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.778, Ratio=3.48x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.779, Ratio=3.46x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.787, Ratio=3.59x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.769, Ratio=3.39x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.793, Ratio=3.62x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.791, Ratio=3.60x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.797, Ratio=3.52x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.754, Ratio=3.37x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.771, Ratio=3.41x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.750, Ratio=3.28x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.774, Ratio=3.47x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.786, Ratio=3.74x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.784, Ratio=3.77x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.809, Ratio=3.80x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.815, Ratio=4.01x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.786, Ratio=3.71x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.759, Ratio=3.59x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.788, Ratio=3.88x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.800, Ratio=3.95x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.776, Ratio=3.65x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.807, Ratio=3.82x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.793, Ratio=3.78x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.804, Ratio=3.84x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.787, Ratio=3.61x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.795, Ratio=3.75x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.784, Ratio=3.54x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.812, Ratio=3.86x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.808, Ratio=3.92x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.778, Ratio=3.67x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.794, Ratio=4.02x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.784, Ratio=3.73x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.792, Ratio=3.74x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.801, Ratio=3.87x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.799, Ratio=3.79x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.791, Ratio=3.80x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.773, Ratio=3.60x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.788, Ratio=3.69x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.806, Ratio=3.83x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.780, Ratio=3.75x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.790, Ratio=3.83x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.809, Ratio=3.87x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.805, Ratio=3.88x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.811, Ratio=3.88x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.793, Ratio=3.80x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.785, Ratio=3.70x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.762, Ratio=3.49x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.789, Ratio=3.61x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.779, Ratio=3.68x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.794, Ratio=3.73x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.780, Ratio=3.65x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.796, Ratio=3.82x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.808, Ratio=3.86x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.800, Ratio=3.84x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.780, Ratio=3.65x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.811, Ratio=3.98x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.798, Ratio=3.92x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.766, Ratio=3.66x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.788, Ratio=3.82x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.786, Ratio=3.75x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.802, Ratio=3.84x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.804, Ratio=3.92x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.791, Ratio=3.69x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.803, Ratio=3.83x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.770, Ratio=3.83x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.785, Ratio=3.73x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.799, Ratio=3.79x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.808, Ratio=3.94x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.808, Ratio=3.90x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.801, Ratio=3.93x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.808, Ratio=4.01x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.812, Ratio=3.96x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.816, Ratio=4.05x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.801, Ratio=3.85x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.798, Ratio=3.78x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.810, Ratio=4.00x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.806, Ratio=3.84x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.769, Ratio=3.75x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.791, Ratio=3.60x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.808, Ratio=3.88x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.802, Ratio=3.74x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.789, Ratio=3.76x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.785, Ratio=3.82x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.810, Ratio=3.84x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.799, Ratio=3.79x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.769, Ratio=3.73x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.817, Ratio=4.12x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.797, Ratio=3.86x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.787, Ratio=3.87x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.774, Ratio=3.70x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.772, Ratio=3.70x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.810, Ratio=3.94x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.783, Ratio=3.72x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.797, Ratio=3.86x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.807, Ratio=3.87x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.786, Ratio=3.72x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.801, Ratio=3.90x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.784, Ratio=3.72x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.797, Ratio=3.81x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.794, Ratio=3.91x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.780, Ratio=3.72x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.783, Ratio=3.68x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.772, Ratio=3.62x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.796, Ratio=3.67x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.790, Ratio=3.62x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.799, Ratio=3.93x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.784, Ratio=3.73x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.796, Ratio=3.88x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.788, Ratio=3.77x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.777, Ratio=3.65x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.773, Ratio=3.77x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.813, Ratio=3.85x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.787, Ratio=3.69x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.771, Ratio=3.64x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.812, Ratio=3.86x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.778, Ratio=3.79x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.791, Ratio=3.70x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.799, Ratio=3.86x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.786, Ratio=3.74x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.789, Ratio=3.76x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.799, Ratio=3.84x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.804, Ratio=3.95x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.803, Ratio=3.87x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.798, Ratio=3.92x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.787, Ratio=3.86x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.796, Ratio=3.76x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.806, Ratio=3.87x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.783, Ratio=3.83x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.806, Ratio=3.79x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.787, Ratio=3.74x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.779, Ratio=3.60x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.804, Ratio=3.76x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.796, Ratio=3.84x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.786, Ratio=3.61x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.802, Ratio=3.88x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.796, Ratio=3.96x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.796, Ratio=3.72x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.810, Ratio=3.97x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.787, Ratio=3.63x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.801, Ratio=3.77x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.799, Ratio=3.91x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.780, Ratio=3.69x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.795, Ratio=3.86x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.796, Ratio=3.80x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.797, Ratio=3.81x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.780, Ratio=3.77x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.794, Ratio=3.67x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.786, Ratio=3.70x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.781, Ratio=3.70x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.773, Ratio=3.59x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.802, Ratio=3.91x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.808, Ratio=3.95x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.782, Ratio=3.72x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.761, Ratio=3.60x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.791, Ratio=3.78x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.809, Ratio=3.75x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.789, Ratio=3.63x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.788, Ratio=3.69x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.802, Ratio=4.04x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.785, Ratio=3.68x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.817, Ratio=4.12x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.805, Ratio=4.06x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.788, Ratio=3.69x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.771, Ratio=3.47x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.787, Ratio=3.73x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.790, Ratio=3.79x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.792, Ratio=3.78x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.782, Ratio=3.85x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.805, Ratio=4.10x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.786, Ratio=3.88x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.775, Ratio=3.57x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.814, Ratio=3.99x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.794, Ratio=3.80x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.781, Ratio=3.72x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.798, Ratio=3.78x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.783, Ratio=3.71x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.802, Ratio=3.91x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.799, Ratio=3.90x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.783, Ratio=3.76x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.801, Ratio=3.84x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.786, Ratio=3.73x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.774, Ratio=3.71x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.763, Ratio=3.70x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.818, Ratio=4.03x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.817, Ratio=3.80x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.800, Ratio=3.69x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.794, Ratio=3.86x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.788, Ratio=3.70x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.784, Ratio=3.77x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.780, Ratio=3.66x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.800, Ratio=3.90x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.794, Ratio=3.78x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.802, Ratio=3.75x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.796, Ratio=3.84x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.810, Ratio=3.96x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.788, Ratio=3.90x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.796, Ratio=3.72x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.798, Ratio=3.80x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.806, Ratio=3.83x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.792, Ratio=3.88x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.796, Ratio=3.77x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.793, Ratio=3.83x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.804, Ratio=3.95x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.775, Ratio=3.69x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.798, Ratio=3.72x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.795, Ratio=3.75x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.799, Ratio=3.86x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.777, Ratio=3.81x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.778, Ratio=3.58x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.752, Ratio=3.46x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.799, Ratio=3.84x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.787, Ratio=3.82x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.823, Ratio=4.19x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.772, Ratio=3.67x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.784, Ratio=3.75x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.795, Ratio=3.64x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.788, Ratio=3.84x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.790, Ratio=3.91x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.799, Ratio=3.82x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.783, Ratio=3.65x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.809, Ratio=4.04x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.811, Ratio=3.89x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.774, Ratio=3.52x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.793, Ratio=3.82x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.802, Ratio=3.92x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.779, Ratio=3.57x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.787, Ratio=3.82x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.771, Ratio=3.69x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.788, Ratio=3.81x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.793, Ratio=3.89x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.783, Ratio=3.73x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.765, Ratio=3.56x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.804, Ratio=3.96x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.792, Ratio=3.75x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.778, Ratio=3.53x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.810, Ratio=3.79x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.773, Ratio=3.60x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.814, Ratio=3.83x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.786, Ratio=3.77x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.791, Ratio=3.75x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.801, Ratio=3.81x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.798, Ratio=3.66x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.803, Ratio=3.77x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.794, Ratio=3.85x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.817, Ratio=4.01x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.770, Ratio=3.63x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.790, Ratio=3.76x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.767, Ratio=3.54x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.786, Ratio=3.75x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.783, Ratio=3.67x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.785, Ratio=3.75x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.793, Ratio=3.84x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.794, Ratio=3.93x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.767, Ratio=3.51x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.802, Ratio=3.83x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.778, Ratio=3.70x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.790, Ratio=3.68x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.794, Ratio=3.84x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.783, Ratio=3.65x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.790, Ratio=3.68x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.774, Ratio=3.57x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.805, Ratio=3.79x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.787, Ratio=3.75x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.780, Ratio=3.74x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.825, Ratio=4.12x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.782, Ratio=3.71x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.787, Ratio=3.79x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.764, Ratio=3.57x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.798, Ratio=3.89x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.794, Ratio=3.78x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.787, Ratio=3.60x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.802, Ratio=3.92x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.800, Ratio=3.84x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.797, Ratio=3.77x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.790, Ratio=3.62x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.797, Ratio=3.79x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.803, Ratio=3.84x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.807, Ratio=3.93x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.793, Ratio=3.68x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.796, Ratio=3.71x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.801, Ratio=3.92x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.790, Ratio=3.74x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.783, Ratio=3.64x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.787, Ratio=3.77x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.783, Ratio=3.75x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.787, Ratio=3.81x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.787, Ratio=3.74x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.789, Ratio=3.89x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.784, Ratio=3.73x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.780, Ratio=3.75x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.791, Ratio=3.76x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.790, Ratio=3.90x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.776, Ratio=3.79x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.792, Ratio=3.73x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.796, Ratio=3.80x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.792, Ratio=3.72x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.779, Ratio=3.64x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.775, Ratio=3.70x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.799, Ratio=3.80x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.788, Ratio=3.77x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.764, Ratio=3.55x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.785, Ratio=3.64x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.790, Ratio=3.70x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.758, Ratio=3.52x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.791, Ratio=3.88x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.787, Ratio=3.72x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.797, Ratio=3.84x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.790, Ratio=3.79x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.789, Ratio=3.73x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.771, Ratio=3.57x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.795, Ratio=3.75x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.795, Ratio=3.78x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.780, Ratio=3.68x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.801, Ratio=3.88x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.804, Ratio=4.03x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.795, Ratio=3.70x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.790, Ratio=3.82x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.806, Ratio=3.90x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.795, Ratio=3.88x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.793, Ratio=3.79x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.823, Ratio=4.10x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.806, Ratio=3.97x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.784, Ratio=3.86x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.790, Ratio=3.77x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.786, Ratio=3.79x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.788, Ratio=3.77x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.785, Ratio=3.84x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.770, Ratio=3.53x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.802, Ratio=3.83x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.773, Ratio=3.63x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.774, Ratio=3.65x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.781, Ratio=3.67x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.781, Ratio=3.66x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.801, Ratio=3.88x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.798, Ratio=3.75x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.808, Ratio=3.86x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.798, Ratio=3.78x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.791, Ratio=3.75x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.798, Ratio=3.93x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.779, Ratio=3.64x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.787, Ratio=3.71x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.812, Ratio=4.05x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.797, Ratio=3.86x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.798, Ratio=3.80x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.788, Ratio=3.90x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.783, Ratio=3.75x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.809, Ratio=3.86x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.800, Ratio=3.96x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.780, Ratio=3.78x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.806, Ratio=3.85x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.783, Ratio=3.85x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.786, Ratio=3.81x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.785, Ratio=3.85x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.795, Ratio=3.82x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.813, Ratio=3.98x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.803, Ratio=3.78x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.781, Ratio=3.77x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.788, Ratio=3.72x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.806, Ratio=3.84x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.784, Ratio=3.65x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.786, Ratio=3.59x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.777, Ratio=3.68x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.776, Ratio=3.67x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.810, Ratio=4.01x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.798, Ratio=3.87x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.794, Ratio=3.93x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.781, Ratio=3.68x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.809, Ratio=3.80x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.807, Ratio=3.84x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.768, Ratio=3.59x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.803, Ratio=3.85x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.785, Ratio=3.63x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.797, Ratio=3.89x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.799, Ratio=3.81x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.786, Ratio=3.63x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.787, Ratio=3.72x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.805, Ratio=3.82x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.801, Ratio=3.84x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.790, Ratio=3.77x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.764, Ratio=3.55x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.799, Ratio=3.85x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.763, Ratio=3.45x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.806, Ratio=3.80x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.798, Ratio=3.80x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.808, Ratio=3.93x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.777, Ratio=3.75x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.775, Ratio=3.71x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.778, Ratio=3.81x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.810, Ratio=3.95x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.791, Ratio=3.75x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.768, Ratio=3.56x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.785, Ratio=3.70x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.788, Ratio=3.69x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.784, Ratio=3.63x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.781, Ratio=3.64x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.783, Ratio=3.82x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.784, Ratio=3.89x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.812, Ratio=3.88x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.811, Ratio=3.86x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.789, Ratio=3.72x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.787, Ratio=3.70x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.795, Ratio=3.88x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.787, Ratio=3.78x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.788, Ratio=3.75x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.776, Ratio=3.71x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.784, Ratio=3.80x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.810, Ratio=3.89x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.785, Ratio=3.70x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.781, Ratio=3.74x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.779, Ratio=3.75x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.764, Ratio=3.62x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.788, Ratio=3.95x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.796, Ratio=3.79x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.786, Ratio=3.78x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.807, Ratio=3.86x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.797, Ratio=3.80x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.791, Ratio=3.76x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.814, Ratio=4.05x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.803, Ratio=3.84x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.794, Ratio=3.79x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.804, Ratio=3.86x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.800, Ratio=3.78x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.789, Ratio=3.81x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.814, Ratio=3.92x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.765, Ratio=3.67x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.793, Ratio=3.78x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.772, Ratio=3.57x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.782, Ratio=3.67x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.799, Ratio=3.90x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.793, Ratio=3.87x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.776, Ratio=3.63x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.799, Ratio=3.91x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.807, Ratio=3.81x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.765, Ratio=3.58x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.788, Ratio=3.74x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.772, Ratio=3.74x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.800, Ratio=3.91x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.795, Ratio=3.76x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.788, Ratio=3.69x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.798, Ratio=3.76x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.808, Ratio=3.80x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.806, Ratio=3.77x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.770, Ratio=3.64x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.802, Ratio=3.91x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.801, Ratio=3.82x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.800, Ratio=3.91x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.783, Ratio=3.75x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.790, Ratio=3.80x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.795, Ratio=3.87x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.789, Ratio=3.74x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.808, Ratio=3.94x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.784, Ratio=3.78x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.757, Ratio=3.45x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.813, Ratio=4.04x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.785, Ratio=3.70x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.782, Ratio=3.58x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.774, Ratio=3.67x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.775, Ratio=3.70x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.784, Ratio=3.75x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.790, Ratio=3.83x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.800, Ratio=3.82x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.789, Ratio=3.72x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.788, Ratio=3.73x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.783, Ratio=3.63x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.790, Ratio=3.83x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.784, Ratio=3.73x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.786, Ratio=3.72x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.762, Ratio=3.64x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.774, Ratio=3.64x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.786, Ratio=3.77x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.796, Ratio=3.77x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.792, Ratio=3.80x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.790, Ratio=3.77x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.795, Ratio=3.83x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.778, Ratio=3.64x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.790, Ratio=3.81x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.789, Ratio=3.68x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.768, Ratio=3.67x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.774, Ratio=3.57x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.780, Ratio=3.71x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.802, Ratio=3.84x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.810, Ratio=4.02x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.792, Ratio=3.72x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.795, Ratio=3.82x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.787, Ratio=3.75x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.794, Ratio=3.65x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.798, Ratio=3.80x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.803, Ratio=3.87x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.799, Ratio=3.89x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.770, Ratio=3.63x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.780, Ratio=3.79x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.776, Ratio=3.62x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.776, Ratio=3.71x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.780, Ratio=3.67x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.793, Ratio=3.63x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.775, Ratio=3.57x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.796, Ratio=3.79x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.761, Ratio=3.67x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.797, Ratio=3.70x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.766, Ratio=3.46x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.771, Ratio=3.59x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.786, Ratio=3.60x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.799, Ratio=3.91x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.792, Ratio=3.78x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.781, Ratio=3.81x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.766, Ratio=3.63x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.792, Ratio=3.80x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.800, Ratio=3.88x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.800, Ratio=3.69x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.784, Ratio=3.74x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.793, Ratio=3.76x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.790, Ratio=3.76x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.770, Ratio=3.74x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.801, Ratio=3.81x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.770, Ratio=3.55x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.807, Ratio=3.87x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.837, Ratio=4.25x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.812, Ratio=3.88x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.794, Ratio=3.84x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.784, Ratio=3.74x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.811, Ratio=4.00x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.792, Ratio=3.85x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.798, Ratio=3.74x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.781, Ratio=3.74x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.769, Ratio=3.58x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.793, Ratio=3.79x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.785, Ratio=3.57x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.796, Ratio=3.78x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.780, Ratio=3.74x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.819, Ratio=3.83x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.800, Ratio=3.86x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.799, Ratio=3.80x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.799, Ratio=3.79x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.800, Ratio=3.77x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.781, Ratio=3.68x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.803, Ratio=3.87x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.783, Ratio=3.81x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.801, Ratio=3.77x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.777, Ratio=3.63x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.802, Ratio=3.85x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.777, Ratio=3.66x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.795, Ratio=3.83x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.789, Ratio=3.64x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.812, Ratio=3.85x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.806, Ratio=3.97x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.777, Ratio=3.76x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.775, Ratio=3.58x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.811, Ratio=4.08x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.787, Ratio=3.83x, Gap=-3.210

============================================================
Epoch 10/20 completed in 38.6s
Train: Loss=1.0181 (C:1.0181, R:0.0000) Ratio=3.23x
Val:   Loss=0.9723 (C:0.9723, R:0.0000) Ratio=3.90x
‚úÖ New best model saved (Val Loss: 0.9723)
Checkpoint saved at epoch 10
============================================================

Epoch 11 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.781, Ratio=3.57x, Gap=-3.575
Batch   0/537: Loss=1.0050 (C:1.0050, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.783, Ratio=3.54x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.786, Ratio=3.61x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.782, Ratio=3.57x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.799, Ratio=3.69x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.803, Ratio=3.57x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.799, Ratio=3.58x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.801, Ratio=3.61x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.824, Ratio=3.71x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.792, Ratio=3.52x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.806, Ratio=3.69x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.770, Ratio=3.49x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.781, Ratio=3.61x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.783, Ratio=3.47x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.803, Ratio=3.60x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.804, Ratio=3.68x, Gap=-4.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.806, Ratio=3.80x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.784, Ratio=3.61x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.793, Ratio=3.66x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.812, Ratio=3.65x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.772, Ratio=3.52x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.775, Ratio=3.47x, Gap=-4.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.796, Ratio=3.66x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.793, Ratio=3.67x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.786, Ratio=3.54x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.772, Ratio=3.51x, Gap=-3.849
Batch  25/537: Loss=1.0141 (C:1.0141, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.782, Ratio=3.43x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.789, Ratio=3.53x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.751, Ratio=3.40x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.792, Ratio=3.65x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.809, Ratio=3.64x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.795, Ratio=3.58x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.790, Ratio=3.45x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.765, Ratio=3.52x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.806, Ratio=3.68x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.793, Ratio=3.58x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.792, Ratio=3.54x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.793, Ratio=3.56x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.781, Ratio=3.50x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.781, Ratio=3.42x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.778, Ratio=3.36x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.799, Ratio=3.54x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.800, Ratio=3.58x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.805, Ratio=3.69x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.778, Ratio=3.54x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.780, Ratio=3.36x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.785, Ratio=3.48x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.809, Ratio=3.56x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.787, Ratio=3.62x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.799, Ratio=3.61x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.794, Ratio=3.63x, Gap=-3.892
Batch  50/537: Loss=0.9917 (C:0.9917, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.759, Ratio=3.52x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.781, Ratio=3.60x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.777, Ratio=3.52x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.790, Ratio=3.58x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.783, Ratio=3.45x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.796, Ratio=3.49x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.788, Ratio=3.56x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.774, Ratio=3.49x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.785, Ratio=3.62x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.802, Ratio=3.65x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.804, Ratio=3.84x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.771, Ratio=3.53x, Gap=-4.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.770, Ratio=3.42x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.787, Ratio=3.55x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.808, Ratio=3.51x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.779, Ratio=3.50x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.771, Ratio=3.56x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.791, Ratio=3.64x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.763, Ratio=3.49x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.778, Ratio=3.45x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.781, Ratio=3.52x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.794, Ratio=3.57x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.805, Ratio=3.63x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.809, Ratio=3.64x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.778, Ratio=3.43x, Gap=-4.039
Batch  75/537: Loss=1.0261 (C:1.0261, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.771, Ratio=3.53x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.794, Ratio=3.61x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.796, Ratio=3.58x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.766, Ratio=3.47x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.789, Ratio=3.61x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.790, Ratio=3.67x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.769, Ratio=3.42x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.762, Ratio=3.39x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.795, Ratio=3.62x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.787, Ratio=3.61x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.787, Ratio=3.48x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.779, Ratio=3.43x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.787, Ratio=3.58x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.792, Ratio=3.59x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.766, Ratio=3.27x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.791, Ratio=3.46x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.777, Ratio=3.49x, Gap=-4.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.788, Ratio=3.53x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.753, Ratio=3.44x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.795, Ratio=3.63x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.795, Ratio=3.51x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.779, Ratio=3.51x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.772, Ratio=3.44x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.781, Ratio=3.64x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.790, Ratio=3.53x, Gap=-3.651
Batch 100/537: Loss=1.0094 (C:1.0094, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.811, Ratio=3.66x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.793, Ratio=3.62x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.768, Ratio=3.35x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.787, Ratio=3.70x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.791, Ratio=3.53x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.791, Ratio=3.57x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.790, Ratio=3.57x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.769, Ratio=3.34x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.773, Ratio=3.48x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.797, Ratio=3.72x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.786, Ratio=3.70x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.775, Ratio=3.36x, Gap=-4.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.760, Ratio=3.27x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.788, Ratio=3.65x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.813, Ratio=3.55x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.765, Ratio=3.57x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.794, Ratio=3.60x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.788, Ratio=3.70x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.794, Ratio=3.45x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.801, Ratio=3.64x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.792, Ratio=3.60x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.773, Ratio=3.42x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.789, Ratio=3.49x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.789, Ratio=3.52x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.783, Ratio=3.74x, Gap=-4.023
Batch 125/537: Loss=0.9722 (C:0.9722, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.783, Ratio=3.73x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.775, Ratio=3.49x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.766, Ratio=3.43x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.794, Ratio=3.60x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.789, Ratio=3.52x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.777, Ratio=3.45x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.797, Ratio=3.71x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.794, Ratio=3.53x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.786, Ratio=3.46x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.795, Ratio=3.58x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.759, Ratio=3.49x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.773, Ratio=3.56x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.805, Ratio=3.61x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.781, Ratio=3.48x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.787, Ratio=3.57x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.780, Ratio=3.40x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.785, Ratio=3.47x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.790, Ratio=3.62x, Gap=-4.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.782, Ratio=3.53x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.784, Ratio=3.56x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.755, Ratio=3.34x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.762, Ratio=3.33x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.773, Ratio=3.47x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.759, Ratio=3.39x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.780, Ratio=3.43x, Gap=-4.424
Batch 150/537: Loss=1.0294 (C:1.0294, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.800, Ratio=3.61x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.777, Ratio=3.47x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.760, Ratio=3.23x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.762, Ratio=3.45x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.781, Ratio=3.46x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.792, Ratio=3.54x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.780, Ratio=3.58x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.776, Ratio=3.55x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.791, Ratio=3.48x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.795, Ratio=3.57x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.779, Ratio=3.53x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.795, Ratio=3.62x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.783, Ratio=3.62x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.751, Ratio=3.42x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.801, Ratio=3.65x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.781, Ratio=3.54x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.762, Ratio=3.26x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.778, Ratio=3.47x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.805, Ratio=3.66x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.758, Ratio=3.49x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.792, Ratio=3.58x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.777, Ratio=3.45x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.779, Ratio=3.53x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.786, Ratio=3.56x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.774, Ratio=3.53x, Gap=-4.112
Batch 175/537: Loss=1.0085 (C:1.0085, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.800, Ratio=3.55x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.776, Ratio=3.48x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.759, Ratio=3.31x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.783, Ratio=3.53x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.800, Ratio=3.71x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.771, Ratio=3.39x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.789, Ratio=3.51x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.801, Ratio=3.60x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.803, Ratio=3.61x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.802, Ratio=3.50x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.796, Ratio=3.61x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.770, Ratio=3.42x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.783, Ratio=3.52x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.773, Ratio=3.45x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.795, Ratio=3.61x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.787, Ratio=3.45x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.787, Ratio=3.49x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.783, Ratio=3.53x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.773, Ratio=3.45x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.786, Ratio=3.71x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.777, Ratio=3.43x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.777, Ratio=3.47x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.793, Ratio=3.57x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.783, Ratio=3.42x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.777, Ratio=3.30x, Gap=-4.036
Batch 200/537: Loss=1.0534 (C:1.0534, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.785, Ratio=3.54x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.778, Ratio=3.46x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.778, Ratio=3.55x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.782, Ratio=3.54x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.796, Ratio=3.58x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.784, Ratio=3.54x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.791, Ratio=3.58x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.791, Ratio=3.55x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.775, Ratio=3.46x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.782, Ratio=3.59x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.772, Ratio=3.43x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.761, Ratio=3.42x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.807, Ratio=3.73x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.790, Ratio=3.56x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.778, Ratio=3.54x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.771, Ratio=3.40x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.777, Ratio=3.56x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.767, Ratio=3.45x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.802, Ratio=3.62x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.783, Ratio=3.49x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.810, Ratio=3.65x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.791, Ratio=3.62x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.813, Ratio=3.76x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.791, Ratio=3.54x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.801, Ratio=3.56x, Gap=-4.234
Batch 225/537: Loss=1.0037 (C:1.0037, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.777, Ratio=3.66x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.804, Ratio=3.62x, Gap=-4.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.778, Ratio=3.44x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.744, Ratio=3.35x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.763, Ratio=3.41x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.798, Ratio=3.82x, Gap=-4.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.780, Ratio=3.60x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.803, Ratio=3.61x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.782, Ratio=3.49x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.797, Ratio=3.63x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.765, Ratio=3.35x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.773, Ratio=3.42x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.795, Ratio=3.53x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.800, Ratio=3.56x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.778, Ratio=3.59x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.792, Ratio=3.43x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.770, Ratio=3.39x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.767, Ratio=3.37x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.778, Ratio=3.42x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.798, Ratio=3.66x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.807, Ratio=3.78x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.789, Ratio=3.61x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.773, Ratio=3.57x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.769, Ratio=3.43x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.793, Ratio=3.65x, Gap=-3.748
Batch 250/537: Loss=0.9909 (C:0.9909, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.775, Ratio=3.48x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.774, Ratio=3.43x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.781, Ratio=3.45x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.787, Ratio=3.54x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.762, Ratio=3.44x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.782, Ratio=3.51x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.782, Ratio=3.55x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.768, Ratio=3.42x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.790, Ratio=3.66x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.813, Ratio=3.65x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.782, Ratio=3.61x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.792, Ratio=3.51x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.791, Ratio=3.53x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.779, Ratio=3.44x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.786, Ratio=3.44x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.792, Ratio=3.56x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.780, Ratio=3.44x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.788, Ratio=3.47x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.790, Ratio=3.51x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.791, Ratio=3.67x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.797, Ratio=3.52x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.820, Ratio=3.75x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.779, Ratio=3.40x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.815, Ratio=3.80x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.772, Ratio=3.44x, Gap=-4.145
Batch 275/537: Loss=1.0268 (C:1.0268, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.797, Ratio=3.48x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.769, Ratio=3.45x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.757, Ratio=3.42x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.765, Ratio=3.41x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.784, Ratio=3.52x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.778, Ratio=3.55x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.775, Ratio=3.50x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.779, Ratio=3.55x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.784, Ratio=3.50x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.798, Ratio=3.53x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.818, Ratio=3.69x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.793, Ratio=3.56x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.781, Ratio=3.53x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.785, Ratio=3.42x, Gap=-4.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.789, Ratio=3.56x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.776, Ratio=3.42x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.778, Ratio=3.38x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.798, Ratio=3.55x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.787, Ratio=3.61x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.780, Ratio=3.52x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.776, Ratio=3.49x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.785, Ratio=3.52x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.799, Ratio=3.62x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.759, Ratio=3.38x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.775, Ratio=3.57x, Gap=-3.474
Batch 300/537: Loss=1.0038 (C:1.0038, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.794, Ratio=3.60x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.796, Ratio=3.77x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.755, Ratio=3.48x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.775, Ratio=3.42x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.763, Ratio=3.26x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.792, Ratio=3.52x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.794, Ratio=3.56x, Gap=-4.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.790, Ratio=3.51x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.763, Ratio=3.34x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.781, Ratio=3.43x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.792, Ratio=3.44x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.789, Ratio=3.47x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.777, Ratio=3.38x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.783, Ratio=3.52x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.762, Ratio=3.33x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.774, Ratio=3.41x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.776, Ratio=3.42x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.793, Ratio=3.52x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.774, Ratio=3.41x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.794, Ratio=3.50x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.772, Ratio=3.35x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.768, Ratio=3.46x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.738, Ratio=3.42x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.764, Ratio=3.43x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.762, Ratio=3.50x, Gap=-3.913
Batch 325/537: Loss=1.0213 (C:1.0213, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.788, Ratio=3.58x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.793, Ratio=3.61x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.772, Ratio=3.41x, Gap=-4.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.762, Ratio=3.36x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.781, Ratio=3.53x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.782, Ratio=3.43x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.778, Ratio=3.48x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.789, Ratio=3.50x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.789, Ratio=3.64x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.782, Ratio=3.42x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.794, Ratio=3.62x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.787, Ratio=3.51x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.795, Ratio=3.51x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.796, Ratio=3.51x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.788, Ratio=3.43x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.790, Ratio=3.55x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.802, Ratio=3.47x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.803, Ratio=3.76x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.810, Ratio=3.83x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.751, Ratio=3.37x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.770, Ratio=3.59x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.771, Ratio=3.60x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.755, Ratio=3.38x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.787, Ratio=3.50x, Gap=-4.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.798, Ratio=3.62x, Gap=-3.852
Batch 350/537: Loss=0.9937 (C:0.9937, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.775, Ratio=3.51x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.768, Ratio=3.41x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.788, Ratio=3.56x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.818, Ratio=3.79x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.788, Ratio=3.56x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.801, Ratio=3.65x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.799, Ratio=3.59x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.781, Ratio=3.45x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.780, Ratio=3.43x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.795, Ratio=3.65x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.802, Ratio=3.58x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.754, Ratio=3.46x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.785, Ratio=3.63x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.793, Ratio=3.60x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.777, Ratio=3.45x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.777, Ratio=3.43x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.777, Ratio=3.47x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.769, Ratio=3.52x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.791, Ratio=3.53x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.794, Ratio=3.65x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.784, Ratio=3.40x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.776, Ratio=3.32x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.764, Ratio=3.41x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.778, Ratio=3.47x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.761, Ratio=3.30x, Gap=-3.865
Batch 375/537: Loss=1.0516 (C:1.0516, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.796, Ratio=3.73x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.792, Ratio=3.45x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.796, Ratio=3.45x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.785, Ratio=3.56x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.762, Ratio=3.40x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.782, Ratio=3.51x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.775, Ratio=3.45x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.771, Ratio=3.43x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.764, Ratio=3.49x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.765, Ratio=3.40x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.772, Ratio=3.54x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.779, Ratio=3.44x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.780, Ratio=3.48x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.784, Ratio=3.41x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.801, Ratio=3.64x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.776, Ratio=3.46x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.796, Ratio=3.58x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.793, Ratio=3.44x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.811, Ratio=3.57x, Gap=-4.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.800, Ratio=3.82x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.781, Ratio=3.47x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.786, Ratio=3.41x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.791, Ratio=3.51x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.801, Ratio=3.70x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.780, Ratio=3.49x, Gap=-3.986
Batch 400/537: Loss=1.0171 (C:1.0171, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.782, Ratio=3.44x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.788, Ratio=3.49x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.771, Ratio=3.37x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.777, Ratio=3.50x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.768, Ratio=3.33x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.751, Ratio=3.37x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.797, Ratio=3.76x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.778, Ratio=3.42x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.788, Ratio=3.48x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.809, Ratio=3.65x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.772, Ratio=3.35x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.786, Ratio=3.43x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.793, Ratio=3.48x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.784, Ratio=3.42x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.776, Ratio=3.41x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.773, Ratio=3.44x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.791, Ratio=3.58x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.775, Ratio=3.42x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.769, Ratio=3.34x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.783, Ratio=3.51x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.797, Ratio=3.78x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.775, Ratio=3.45x, Gap=-4.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.786, Ratio=3.47x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.789, Ratio=3.52x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.763, Ratio=3.53x, Gap=-3.809
Batch 425/537: Loss=1.0105 (C:1.0105, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.794, Ratio=3.47x, Gap=-4.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.792, Ratio=3.63x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.801, Ratio=3.55x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.787, Ratio=3.54x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.810, Ratio=3.66x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.808, Ratio=3.61x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.768, Ratio=3.37x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.800, Ratio=3.59x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.756, Ratio=3.36x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.787, Ratio=3.57x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.769, Ratio=3.52x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.771, Ratio=3.50x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.787, Ratio=3.59x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.784, Ratio=3.52x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.773, Ratio=3.52x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.777, Ratio=3.61x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.773, Ratio=3.40x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.779, Ratio=3.52x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.803, Ratio=3.60x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.800, Ratio=3.58x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.794, Ratio=3.57x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.779, Ratio=3.45x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.802, Ratio=3.63x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.797, Ratio=3.70x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.768, Ratio=3.41x, Gap=-3.975
Batch 450/537: Loss=1.0338 (C:1.0338, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.787, Ratio=3.55x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.806, Ratio=3.66x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.808, Ratio=3.53x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.799, Ratio=3.59x, Gap=-4.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.800, Ratio=3.61x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.803, Ratio=3.66x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.799, Ratio=3.60x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.779, Ratio=3.45x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.795, Ratio=3.62x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.795, Ratio=3.57x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.762, Ratio=3.41x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.779, Ratio=3.50x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.782, Ratio=3.46x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.802, Ratio=3.79x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.761, Ratio=3.54x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.770, Ratio=3.37x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.791, Ratio=3.48x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.797, Ratio=3.70x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.795, Ratio=3.58x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.774, Ratio=3.50x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.769, Ratio=3.39x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.780, Ratio=3.46x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.781, Ratio=3.61x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.784, Ratio=3.49x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.763, Ratio=3.55x, Gap=-4.104
Batch 475/537: Loss=1.0080 (C:1.0080, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.773, Ratio=3.44x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.788, Ratio=3.43x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.802, Ratio=3.69x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.783, Ratio=3.46x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.773, Ratio=3.44x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.759, Ratio=3.24x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.778, Ratio=3.50x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.782, Ratio=3.41x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.778, Ratio=3.41x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.778, Ratio=3.33x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.785, Ratio=3.50x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.787, Ratio=3.43x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.783, Ratio=3.46x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.794, Ratio=3.55x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.772, Ratio=3.46x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.792, Ratio=3.62x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.792, Ratio=3.70x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.796, Ratio=3.52x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.764, Ratio=3.35x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.808, Ratio=3.64x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.766, Ratio=3.38x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.761, Ratio=3.25x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.800, Ratio=3.63x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.776, Ratio=3.40x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.762, Ratio=3.40x, Gap=-3.844
Batch 500/537: Loss=1.0343 (C:1.0343, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.754, Ratio=3.27x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.770, Ratio=3.38x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.781, Ratio=3.35x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.769, Ratio=3.45x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.796, Ratio=3.57x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.787, Ratio=3.46x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.789, Ratio=3.59x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.807, Ratio=3.52x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.765, Ratio=3.28x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.782, Ratio=3.40x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.787, Ratio=3.60x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.766, Ratio=3.51x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.791, Ratio=3.74x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.782, Ratio=3.46x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.752, Ratio=3.40x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.775, Ratio=3.52x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.798, Ratio=3.69x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.795, Ratio=3.66x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.791, Ratio=3.64x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.771, Ratio=3.47x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.793, Ratio=3.60x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.800, Ratio=3.57x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.759, Ratio=3.35x, Gap=-4.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.794, Ratio=3.56x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.795, Ratio=3.60x, Gap=-3.957
Batch 525/537: Loss=0.9976 (C:0.9976, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.798, Ratio=3.54x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.781, Ratio=3.60x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.790, Ratio=3.74x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.797, Ratio=3.53x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.798, Ratio=3.63x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.776, Ratio=3.39x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.799, Ratio=3.53x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.792, Ratio=3.47x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.785, Ratio=3.31x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.792, Ratio=3.57x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.787, Ratio=3.59x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.780, Ratio=3.88x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.793, Ratio=3.78x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.794, Ratio=3.75x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.807, Ratio=3.83x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.784, Ratio=3.74x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.810, Ratio=3.90x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.816, Ratio=4.07x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.810, Ratio=3.91x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.800, Ratio=3.69x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.801, Ratio=3.74x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.797, Ratio=3.75x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.807, Ratio=3.86x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.819, Ratio=4.01x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.813, Ratio=3.95x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.790, Ratio=3.70x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.796, Ratio=3.87x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.802, Ratio=3.84x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.810, Ratio=3.81x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.817, Ratio=3.97x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.817, Ratio=3.93x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.767, Ratio=3.55x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.801, Ratio=3.84x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.803, Ratio=3.75x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.798, Ratio=3.77x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.806, Ratio=3.99x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.800, Ratio=3.98x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.785, Ratio=3.68x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.782, Ratio=3.79x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.772, Ratio=3.68x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.800, Ratio=3.91x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.794, Ratio=3.72x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.804, Ratio=3.97x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.811, Ratio=3.95x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.811, Ratio=3.91x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.806, Ratio=3.93x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.784, Ratio=3.65x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.795, Ratio=3.92x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.824, Ratio=3.93x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.798, Ratio=3.69x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.798, Ratio=3.72x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.805, Ratio=3.82x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.792, Ratio=3.80x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.803, Ratio=3.85x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.788, Ratio=3.85x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.806, Ratio=3.92x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.798, Ratio=3.74x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.808, Ratio=3.84x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.799, Ratio=3.94x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.808, Ratio=3.90x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.799, Ratio=3.77x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.800, Ratio=3.86x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.812, Ratio=3.96x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.790, Ratio=3.83x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.801, Ratio=3.76x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.793, Ratio=3.81x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.805, Ratio=3.81x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.797, Ratio=3.70x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.797, Ratio=3.86x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.802, Ratio=3.85x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.795, Ratio=3.81x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.793, Ratio=3.65x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.801, Ratio=3.91x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.806, Ratio=3.89x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.788, Ratio=3.76x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.821, Ratio=4.02x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.805, Ratio=3.79x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.783, Ratio=3.68x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.789, Ratio=3.74x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.795, Ratio=3.90x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.808, Ratio=3.87x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.793, Ratio=3.77x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.801, Ratio=3.79x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.792, Ratio=3.88x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.810, Ratio=3.87x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.773, Ratio=3.73x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.802, Ratio=3.91x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.781, Ratio=3.72x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.777, Ratio=3.68x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.800, Ratio=3.85x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.807, Ratio=3.93x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.796, Ratio=3.93x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.817, Ratio=4.04x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.780, Ratio=3.69x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.793, Ratio=3.87x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.798, Ratio=3.85x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.799, Ratio=3.75x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.790, Ratio=3.80x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.791, Ratio=3.84x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.804, Ratio=3.84x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.813, Ratio=3.96x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.789, Ratio=3.66x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.802, Ratio=3.87x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.810, Ratio=3.79x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.817, Ratio=3.93x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.787, Ratio=3.68x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.783, Ratio=3.81x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.789, Ratio=3.76x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.802, Ratio=3.86x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.807, Ratio=3.84x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.791, Ratio=3.64x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.797, Ratio=3.70x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.796, Ratio=3.90x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.783, Ratio=3.70x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.816, Ratio=3.96x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.788, Ratio=3.73x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.809, Ratio=4.03x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.779, Ratio=3.79x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.798, Ratio=3.95x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.784, Ratio=3.65x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.793, Ratio=3.80x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.817, Ratio=4.06x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.783, Ratio=3.77x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.815, Ratio=4.05x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.797, Ratio=3.74x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.818, Ratio=4.02x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.792, Ratio=3.83x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.794, Ratio=4.01x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.803, Ratio=3.93x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.797, Ratio=3.77x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.791, Ratio=3.76x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.802, Ratio=3.88x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.812, Ratio=3.96x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.810, Ratio=4.05x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.808, Ratio=3.81x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.803, Ratio=3.71x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.784, Ratio=3.66x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.805, Ratio=3.88x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.792, Ratio=3.76x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.802, Ratio=3.89x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.786, Ratio=3.71x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.782, Ratio=3.82x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.812, Ratio=4.03x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.782, Ratio=3.78x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.796, Ratio=3.78x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.784, Ratio=3.60x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.795, Ratio=3.88x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.806, Ratio=3.93x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.796, Ratio=3.78x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.805, Ratio=3.82x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.789, Ratio=3.69x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.790, Ratio=3.73x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.800, Ratio=3.89x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.794, Ratio=3.81x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.785, Ratio=3.75x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.782, Ratio=3.68x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.795, Ratio=3.87x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.791, Ratio=3.88x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.802, Ratio=3.86x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.804, Ratio=3.81x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.795, Ratio=3.77x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.791, Ratio=3.74x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.818, Ratio=4.04x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.784, Ratio=3.70x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.765, Ratio=3.49x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.809, Ratio=4.02x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.795, Ratio=3.87x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.788, Ratio=3.84x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.797, Ratio=3.76x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.813, Ratio=3.94x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.822, Ratio=3.96x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.797, Ratio=3.74x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.809, Ratio=3.94x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.806, Ratio=3.81x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.815, Ratio=3.86x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.798, Ratio=3.80x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.801, Ratio=3.85x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.791, Ratio=3.63x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.816, Ratio=3.92x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.800, Ratio=3.84x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.793, Ratio=3.94x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.804, Ratio=3.89x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.812, Ratio=3.93x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.789, Ratio=3.81x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.823, Ratio=4.06x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.801, Ratio=3.79x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.782, Ratio=3.60x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.801, Ratio=3.83x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.808, Ratio=3.91x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.808, Ratio=3.90x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.807, Ratio=3.78x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.785, Ratio=3.77x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.780, Ratio=3.62x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.814, Ratio=4.08x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.799, Ratio=3.78x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.807, Ratio=4.05x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.805, Ratio=3.84x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.808, Ratio=3.89x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.796, Ratio=3.85x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.808, Ratio=4.13x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.805, Ratio=3.93x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.804, Ratio=3.95x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.807, Ratio=3.85x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.791, Ratio=3.77x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.784, Ratio=3.68x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.796, Ratio=3.79x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.826, Ratio=4.09x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.789, Ratio=3.80x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.790, Ratio=3.73x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.782, Ratio=3.70x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.796, Ratio=3.89x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.786, Ratio=3.64x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.807, Ratio=3.87x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.798, Ratio=3.87x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.777, Ratio=3.73x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.799, Ratio=3.80x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.784, Ratio=3.72x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.800, Ratio=3.71x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.788, Ratio=3.77x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.791, Ratio=3.84x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.788, Ratio=3.67x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.785, Ratio=3.68x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.788, Ratio=3.79x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.786, Ratio=3.80x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.784, Ratio=3.68x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.802, Ratio=3.94x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.790, Ratio=3.78x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.793, Ratio=3.78x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.786, Ratio=3.73x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.790, Ratio=3.78x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.797, Ratio=3.71x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.794, Ratio=3.81x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.793, Ratio=3.81x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.806, Ratio=3.83x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.806, Ratio=3.93x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.800, Ratio=3.90x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.801, Ratio=3.83x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.801, Ratio=3.77x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.788, Ratio=3.71x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.773, Ratio=3.64x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.797, Ratio=3.78x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.772, Ratio=3.49x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.770, Ratio=3.57x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.816, Ratio=4.08x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.809, Ratio=3.80x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.798, Ratio=3.76x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.802, Ratio=3.80x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.793, Ratio=3.86x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.796, Ratio=3.86x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.813, Ratio=4.01x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.818, Ratio=4.02x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.789, Ratio=3.83x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.777, Ratio=3.67x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.804, Ratio=3.90x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.821, Ratio=3.97x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.791, Ratio=3.79x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.806, Ratio=3.85x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.801, Ratio=3.92x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.788, Ratio=3.76x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.788, Ratio=3.63x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.784, Ratio=3.68x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.797, Ratio=3.83x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.794, Ratio=3.83x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.800, Ratio=3.84x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.809, Ratio=3.99x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.807, Ratio=4.00x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.800, Ratio=3.82x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.796, Ratio=3.81x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.796, Ratio=3.84x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.794, Ratio=3.97x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.794, Ratio=3.71x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.777, Ratio=3.69x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.808, Ratio=3.89x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.804, Ratio=3.91x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.796, Ratio=3.70x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.790, Ratio=3.69x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.810, Ratio=3.92x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.809, Ratio=3.91x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.772, Ratio=3.59x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.809, Ratio=3.90x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.814, Ratio=3.86x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.792, Ratio=3.75x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.809, Ratio=3.91x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.798, Ratio=3.78x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.798, Ratio=3.84x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.802, Ratio=3.95x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.789, Ratio=3.82x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.798, Ratio=3.94x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.782, Ratio=3.78x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.784, Ratio=3.70x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.779, Ratio=3.78x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.778, Ratio=3.66x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.822, Ratio=4.05x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.816, Ratio=3.98x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.805, Ratio=4.02x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.822, Ratio=4.09x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.805, Ratio=3.96x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.791, Ratio=3.80x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.813, Ratio=3.98x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.779, Ratio=3.75x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.799, Ratio=3.81x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.760, Ratio=3.59x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.801, Ratio=3.91x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.811, Ratio=3.94x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.816, Ratio=3.90x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.778, Ratio=3.73x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.803, Ratio=3.71x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.794, Ratio=3.77x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.818, Ratio=3.89x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.789, Ratio=3.90x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.802, Ratio=3.74x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.791, Ratio=3.73x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.821, Ratio=3.94x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.820, Ratio=4.08x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.811, Ratio=3.83x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.786, Ratio=3.76x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.798, Ratio=3.85x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.799, Ratio=3.77x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.792, Ratio=3.74x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.793, Ratio=3.87x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.800, Ratio=3.83x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.819, Ratio=3.94x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.819, Ratio=4.00x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.791, Ratio=3.86x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.805, Ratio=3.90x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.797, Ratio=3.70x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.780, Ratio=3.69x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.783, Ratio=3.73x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.790, Ratio=3.84x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.805, Ratio=3.91x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.804, Ratio=3.71x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.797, Ratio=3.95x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.774, Ratio=3.66x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.811, Ratio=3.91x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.810, Ratio=3.95x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.791, Ratio=3.87x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.794, Ratio=3.79x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.789, Ratio=3.69x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.798, Ratio=3.83x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.796, Ratio=3.83x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.805, Ratio=3.88x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.780, Ratio=3.65x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.790, Ratio=3.77x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.768, Ratio=3.54x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.804, Ratio=3.78x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.794, Ratio=3.75x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.793, Ratio=3.78x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.801, Ratio=3.85x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.809, Ratio=4.03x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.808, Ratio=3.82x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.781, Ratio=3.68x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.806, Ratio=3.87x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.816, Ratio=4.00x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.806, Ratio=4.05x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.781, Ratio=3.77x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.817, Ratio=4.05x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.792, Ratio=3.87x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.801, Ratio=3.89x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.820, Ratio=3.97x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.792, Ratio=3.89x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.786, Ratio=3.72x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.781, Ratio=3.70x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.815, Ratio=4.01x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.822, Ratio=3.95x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.787, Ratio=3.68x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.809, Ratio=3.85x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.783, Ratio=3.61x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.801, Ratio=3.89x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.786, Ratio=3.67x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.793, Ratio=3.74x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.802, Ratio=3.88x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.802, Ratio=3.86x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.807, Ratio=3.91x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.811, Ratio=3.95x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.814, Ratio=3.97x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.781, Ratio=3.70x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.787, Ratio=3.81x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.806, Ratio=3.81x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.797, Ratio=3.77x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.806, Ratio=3.81x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.803, Ratio=3.84x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.816, Ratio=4.04x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.794, Ratio=3.85x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.785, Ratio=3.78x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.782, Ratio=3.77x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.817, Ratio=3.90x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.805, Ratio=3.80x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.811, Ratio=3.92x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.769, Ratio=3.59x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.804, Ratio=3.80x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.811, Ratio=3.80x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.799, Ratio=3.83x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.788, Ratio=3.72x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.793, Ratio=3.80x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.813, Ratio=3.86x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.790, Ratio=3.82x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.813, Ratio=3.98x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.812, Ratio=3.96x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.794, Ratio=3.83x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.798, Ratio=3.79x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.781, Ratio=3.78x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.792, Ratio=3.70x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.792, Ratio=3.70x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.787, Ratio=3.74x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.802, Ratio=3.86x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.789, Ratio=3.80x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.802, Ratio=3.87x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.800, Ratio=3.77x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.783, Ratio=3.82x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.800, Ratio=3.95x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.806, Ratio=3.95x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.806, Ratio=3.94x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.782, Ratio=3.70x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.770, Ratio=3.63x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.805, Ratio=3.84x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.825, Ratio=4.00x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.809, Ratio=3.84x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.805, Ratio=3.90x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.817, Ratio=3.98x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.798, Ratio=3.78x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.802, Ratio=3.89x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.781, Ratio=3.69x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.809, Ratio=3.77x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.803, Ratio=3.96x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.797, Ratio=3.80x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.786, Ratio=3.74x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.806, Ratio=3.99x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.805, Ratio=3.94x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.772, Ratio=3.54x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.787, Ratio=3.63x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.798, Ratio=3.84x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.802, Ratio=3.87x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.816, Ratio=3.82x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.805, Ratio=3.83x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.824, Ratio=4.04x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.799, Ratio=3.76x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.773, Ratio=3.63x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.830, Ratio=4.07x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.794, Ratio=3.83x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.807, Ratio=3.73x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.792, Ratio=3.72x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.804, Ratio=3.94x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.790, Ratio=3.65x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.796, Ratio=3.76x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.810, Ratio=3.95x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.805, Ratio=3.85x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.784, Ratio=3.69x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.809, Ratio=3.96x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.798, Ratio=3.85x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.795, Ratio=3.80x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.803, Ratio=3.91x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.815, Ratio=3.93x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.796, Ratio=3.77x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.802, Ratio=3.68x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.822, Ratio=4.07x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.812, Ratio=3.94x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.793, Ratio=3.73x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.806, Ratio=4.07x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.798, Ratio=3.80x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.807, Ratio=3.82x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.810, Ratio=3.95x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.799, Ratio=3.79x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.796, Ratio=3.86x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.804, Ratio=3.90x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.807, Ratio=3.76x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.810, Ratio=3.94x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.794, Ratio=3.78x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.809, Ratio=3.89x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.786, Ratio=3.72x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.813, Ratio=3.98x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.804, Ratio=3.83x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.783, Ratio=3.71x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.780, Ratio=3.59x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.813, Ratio=3.97x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.787, Ratio=3.83x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.822, Ratio=3.84x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.816, Ratio=4.15x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.808, Ratio=3.86x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.810, Ratio=3.88x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.795, Ratio=3.84x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.793, Ratio=3.65x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.790, Ratio=3.86x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.796, Ratio=3.73x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.784, Ratio=3.74x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.803, Ratio=3.82x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.801, Ratio=3.86x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.789, Ratio=3.80x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.808, Ratio=3.93x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.799, Ratio=3.80x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.794, Ratio=3.84x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.807, Ratio=3.85x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.817, Ratio=3.94x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.795, Ratio=3.82x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.788, Ratio=3.72x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.793, Ratio=3.62x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.821, Ratio=3.94x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.805, Ratio=3.80x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.801, Ratio=3.87x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.788, Ratio=3.78x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.784, Ratio=3.70x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.810, Ratio=3.89x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.781, Ratio=3.66x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.791, Ratio=3.66x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.795, Ratio=3.83x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.798, Ratio=3.79x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.808, Ratio=3.91x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.814, Ratio=3.87x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.827, Ratio=4.12x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.796, Ratio=3.73x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.798, Ratio=3.84x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.804, Ratio=3.95x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.814, Ratio=3.88x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.820, Ratio=4.05x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.807, Ratio=3.92x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.813, Ratio=3.91x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.802, Ratio=3.86x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.807, Ratio=4.00x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.806, Ratio=3.93x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.800, Ratio=3.80x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.800, Ratio=3.79x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.801, Ratio=3.88x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.793, Ratio=3.82x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.812, Ratio=3.91x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.784, Ratio=3.75x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.814, Ratio=3.93x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.803, Ratio=3.80x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.816, Ratio=3.90x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.818, Ratio=3.94x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.798, Ratio=3.85x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.803, Ratio=3.81x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.786, Ratio=3.76x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.802, Ratio=3.74x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.792, Ratio=3.65x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.782, Ratio=3.72x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.804, Ratio=3.93x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.793, Ratio=3.87x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.810, Ratio=3.91x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.796, Ratio=3.83x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.812, Ratio=4.02x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.805, Ratio=3.76x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.803, Ratio=3.90x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.795, Ratio=3.83x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.791, Ratio=3.68x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.810, Ratio=3.89x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.801, Ratio=3.77x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.809, Ratio=3.92x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.796, Ratio=3.92x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.796, Ratio=3.80x, Gap=-3.315

============================================================
Epoch 11/20 completed in 31.6s
Train: Loss=1.0117 (C:1.0117, R:0.0000) Ratio=3.22x
Val:   Loss=0.9632 (C:0.9632, R:0.0000) Ratio=4.05x
‚úÖ New best model saved (Val Loss: 0.9632)
============================================================

Epoch 12 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.805, Ratio=3.79x, Gap=-4.144
Batch   0/537: Loss=0.9645 (C:0.9645, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.777, Ratio=3.45x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.788, Ratio=3.50x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.782, Ratio=3.59x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.761, Ratio=3.41x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.776, Ratio=3.59x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.794, Ratio=3.74x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.775, Ratio=3.63x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.784, Ratio=3.47x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.786, Ratio=3.55x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.777, Ratio=3.42x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.792, Ratio=3.55x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.802, Ratio=3.53x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.786, Ratio=3.50x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.791, Ratio=3.61x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.811, Ratio=3.63x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.822, Ratio=3.67x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.781, Ratio=3.56x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.790, Ratio=3.47x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.784, Ratio=3.55x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.779, Ratio=3.48x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.781, Ratio=3.60x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.790, Ratio=3.66x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.815, Ratio=3.95x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.781, Ratio=3.45x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.779, Ratio=3.49x, Gap=-3.939
Batch  25/537: Loss=1.0156 (C:1.0156, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.804, Ratio=3.71x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.789, Ratio=3.52x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.777, Ratio=3.59x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.789, Ratio=3.55x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.800, Ratio=3.52x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.817, Ratio=3.64x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.814, Ratio=3.64x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.800, Ratio=3.53x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.795, Ratio=3.62x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.799, Ratio=3.57x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.796, Ratio=3.58x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.785, Ratio=3.61x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.804, Ratio=3.69x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.795, Ratio=3.55x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.772, Ratio=3.53x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.770, Ratio=3.56x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.760, Ratio=3.50x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.785, Ratio=3.56x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.775, Ratio=3.57x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.771, Ratio=3.42x, Gap=-4.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.777, Ratio=3.54x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.781, Ratio=3.60x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.793, Ratio=3.57x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.788, Ratio=3.50x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.768, Ratio=3.50x, Gap=-3.915
Batch  50/537: Loss=1.0174 (C:1.0174, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.778, Ratio=3.51x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.790, Ratio=3.54x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.800, Ratio=3.50x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.778, Ratio=3.53x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.802, Ratio=3.60x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.795, Ratio=3.71x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.812, Ratio=3.78x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.754, Ratio=3.33x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.794, Ratio=3.68x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.785, Ratio=3.76x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.805, Ratio=3.63x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.803, Ratio=3.69x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.776, Ratio=3.47x, Gap=-4.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.799, Ratio=3.55x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.808, Ratio=3.53x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.758, Ratio=3.39x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.784, Ratio=3.41x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.769, Ratio=3.50x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.767, Ratio=3.47x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.781, Ratio=3.54x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.798, Ratio=3.71x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.803, Ratio=3.63x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.793, Ratio=3.60x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.802, Ratio=3.60x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.781, Ratio=3.58x, Gap=-3.924
Batch  75/537: Loss=1.0012 (C:1.0012, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.774, Ratio=3.38x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.791, Ratio=3.64x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.789, Ratio=3.57x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.780, Ratio=3.58x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.778, Ratio=3.61x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.777, Ratio=3.52x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.796, Ratio=3.59x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.780, Ratio=3.64x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.765, Ratio=3.42x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.792, Ratio=3.51x, Gap=-4.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.784, Ratio=3.51x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.769, Ratio=3.38x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.794, Ratio=3.60x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.794, Ratio=3.67x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.775, Ratio=3.40x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.778, Ratio=3.47x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.784, Ratio=3.52x, Gap=-4.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.773, Ratio=3.46x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.778, Ratio=3.48x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.792, Ratio=3.56x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.794, Ratio=3.59x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.784, Ratio=3.50x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.792, Ratio=3.58x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.795, Ratio=3.65x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.794, Ratio=3.50x, Gap=-3.901
Batch 100/537: Loss=1.0125 (C:1.0125, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.784, Ratio=3.50x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.802, Ratio=3.69x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.774, Ratio=3.48x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.785, Ratio=3.56x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.787, Ratio=3.54x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.792, Ratio=3.68x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.799, Ratio=3.63x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.773, Ratio=3.52x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.800, Ratio=3.54x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.783, Ratio=3.57x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.796, Ratio=3.53x, Gap=-4.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.800, Ratio=3.65x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.799, Ratio=3.63x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.803, Ratio=3.66x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.803, Ratio=3.55x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.794, Ratio=3.59x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.785, Ratio=3.55x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.768, Ratio=3.49x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.794, Ratio=3.58x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.777, Ratio=3.51x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.780, Ratio=3.56x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.770, Ratio=3.41x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.811, Ratio=3.66x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.762, Ratio=3.44x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.803, Ratio=3.67x, Gap=-4.104
Batch 125/537: Loss=0.9832 (C:0.9832, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.797, Ratio=3.59x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.806, Ratio=3.65x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.784, Ratio=3.50x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.762, Ratio=3.52x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.770, Ratio=3.54x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.811, Ratio=3.70x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.787, Ratio=3.49x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.807, Ratio=3.69x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.800, Ratio=3.63x, Gap=-4.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.793, Ratio=3.47x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.769, Ratio=3.48x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.793, Ratio=3.50x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.761, Ratio=3.47x, Gap=-4.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.756, Ratio=3.43x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.783, Ratio=3.58x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.786, Ratio=3.49x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.762, Ratio=3.44x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.763, Ratio=3.46x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.780, Ratio=3.51x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.766, Ratio=3.39x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.787, Ratio=3.46x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.788, Ratio=3.62x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.797, Ratio=3.66x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.784, Ratio=3.51x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.791, Ratio=3.51x, Gap=-3.743
Batch 150/537: Loss=1.0152 (C:1.0152, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.790, Ratio=3.59x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.771, Ratio=3.38x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.806, Ratio=3.73x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.774, Ratio=3.47x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.774, Ratio=3.34x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.780, Ratio=3.59x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.768, Ratio=3.40x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.792, Ratio=3.47x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.786, Ratio=3.54x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.782, Ratio=3.56x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.789, Ratio=3.49x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.792, Ratio=3.59x, Gap=-4.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.790, Ratio=3.68x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.785, Ratio=3.59x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.789, Ratio=3.58x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.788, Ratio=3.44x, Gap=-4.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.785, Ratio=3.45x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.789, Ratio=3.50x, Gap=-4.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.772, Ratio=3.48x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.804, Ratio=3.56x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.788, Ratio=3.50x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.805, Ratio=3.56x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.784, Ratio=3.62x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.780, Ratio=3.56x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.784, Ratio=3.55x, Gap=-3.919
Batch 175/537: Loss=1.0040 (C:1.0040, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.807, Ratio=3.65x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.794, Ratio=3.65x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.785, Ratio=3.68x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.784, Ratio=3.48x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.783, Ratio=3.62x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.805, Ratio=3.74x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.801, Ratio=3.75x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.816, Ratio=3.79x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.795, Ratio=3.47x, Gap=-4.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.780, Ratio=3.46x, Gap=-4.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.793, Ratio=3.68x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.786, Ratio=3.62x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.792, Ratio=3.58x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.784, Ratio=3.51x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.792, Ratio=3.48x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.783, Ratio=3.55x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.773, Ratio=3.41x, Gap=-4.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.800, Ratio=3.59x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.774, Ratio=3.57x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.784, Ratio=3.47x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.787, Ratio=3.56x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.776, Ratio=3.47x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.806, Ratio=3.67x, Gap=-4.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.789, Ratio=3.52x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.788, Ratio=3.47x, Gap=-3.968
Batch 200/537: Loss=1.0182 (C:1.0182, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.817, Ratio=3.73x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.783, Ratio=3.48x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.792, Ratio=3.55x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.793, Ratio=3.62x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.807, Ratio=3.68x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.790, Ratio=3.54x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.786, Ratio=3.63x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.778, Ratio=3.58x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.792, Ratio=3.53x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.786, Ratio=3.57x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.789, Ratio=3.57x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.789, Ratio=3.54x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.808, Ratio=3.68x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.759, Ratio=3.32x, Gap=-4.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.820, Ratio=3.86x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.780, Ratio=3.67x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.778, Ratio=3.41x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.789, Ratio=3.38x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.787, Ratio=3.71x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.758, Ratio=3.30x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.759, Ratio=3.40x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.792, Ratio=3.49x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.804, Ratio=3.70x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.787, Ratio=3.69x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.782, Ratio=3.49x, Gap=-4.090
Batch 225/537: Loss=1.0156 (C:1.0156, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.794, Ratio=3.55x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.803, Ratio=3.64x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.794, Ratio=3.43x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.788, Ratio=3.53x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.820, Ratio=3.51x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.788, Ratio=3.51x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.787, Ratio=3.49x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.771, Ratio=3.45x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.813, Ratio=3.66x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.794, Ratio=3.63x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.773, Ratio=3.38x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.747, Ratio=3.29x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.804, Ratio=3.71x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.776, Ratio=3.45x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.784, Ratio=3.57x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.760, Ratio=3.34x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.781, Ratio=3.51x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.786, Ratio=3.51x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.818, Ratio=3.77x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.803, Ratio=3.62x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.788, Ratio=3.61x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.798, Ratio=3.58x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.780, Ratio=3.42x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.776, Ratio=3.48x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.783, Ratio=3.59x, Gap=-3.635
Batch 250/537: Loss=0.9973 (C:0.9973, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.782, Ratio=3.44x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.776, Ratio=3.46x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.771, Ratio=3.54x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.785, Ratio=3.50x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.793, Ratio=3.52x, Gap=-5.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.792, Ratio=3.58x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.792, Ratio=3.41x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.777, Ratio=3.50x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.821, Ratio=3.77x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.788, Ratio=3.63x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.797, Ratio=3.39x, Gap=-4.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.771, Ratio=3.40x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.780, Ratio=3.56x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.789, Ratio=3.45x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.792, Ratio=3.50x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.789, Ratio=3.64x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.774, Ratio=3.42x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.778, Ratio=3.61x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.756, Ratio=3.42x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.783, Ratio=3.51x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.790, Ratio=3.52x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.801, Ratio=3.62x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.782, Ratio=3.51x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.789, Ratio=3.62x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.788, Ratio=3.49x, Gap=-4.432
Batch 275/537: Loss=1.0175 (C:1.0175, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.779, Ratio=3.47x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.779, Ratio=3.51x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.799, Ratio=3.59x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.782, Ratio=3.42x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.784, Ratio=3.56x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.778, Ratio=3.52x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.795, Ratio=3.45x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.786, Ratio=3.41x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.795, Ratio=3.60x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.789, Ratio=3.49x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.778, Ratio=3.39x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.781, Ratio=3.53x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.778, Ratio=3.57x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.774, Ratio=3.34x, Gap=-4.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.784, Ratio=3.52x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.810, Ratio=3.66x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.798, Ratio=3.69x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.794, Ratio=3.66x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.788, Ratio=3.49x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.758, Ratio=3.34x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.784, Ratio=3.60x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.771, Ratio=3.47x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.780, Ratio=3.52x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.784, Ratio=3.41x, Gap=-4.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.776, Ratio=3.40x, Gap=-3.850
Batch 300/537: Loss=1.0359 (C:1.0359, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.792, Ratio=3.49x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.802, Ratio=3.69x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.793, Ratio=3.52x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.778, Ratio=3.41x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.779, Ratio=3.58x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.772, Ratio=3.53x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.791, Ratio=3.70x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.771, Ratio=3.58x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.774, Ratio=3.49x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.775, Ratio=3.43x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.779, Ratio=3.62x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.764, Ratio=3.41x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.796, Ratio=3.56x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.802, Ratio=3.56x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.800, Ratio=3.63x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.803, Ratio=3.55x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.792, Ratio=3.49x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.801, Ratio=3.43x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.783, Ratio=3.42x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.785, Ratio=3.43x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.802, Ratio=3.61x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.799, Ratio=3.58x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.803, Ratio=3.60x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.804, Ratio=3.61x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.785, Ratio=3.57x, Gap=-3.814
Batch 325/537: Loss=1.0045 (C:1.0045, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.774, Ratio=3.55x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.769, Ratio=3.42x, Gap=-4.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.774, Ratio=3.44x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.779, Ratio=3.64x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.797, Ratio=3.54x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.790, Ratio=3.60x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.787, Ratio=3.53x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.754, Ratio=3.33x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.786, Ratio=3.56x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.787, Ratio=3.53x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.788, Ratio=3.63x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.777, Ratio=3.55x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.790, Ratio=3.56x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.781, Ratio=3.49x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.780, Ratio=3.55x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.793, Ratio=3.46x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.782, Ratio=3.46x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.766, Ratio=3.45x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.797, Ratio=3.48x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.784, Ratio=3.51x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.789, Ratio=3.55x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.779, Ratio=3.46x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.779, Ratio=3.58x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.799, Ratio=3.53x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.771, Ratio=3.49x, Gap=-3.613
Batch 350/537: Loss=1.0163 (C:1.0163, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.775, Ratio=3.50x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.798, Ratio=3.54x, Gap=-4.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.804, Ratio=3.59x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.795, Ratio=3.60x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.784, Ratio=3.41x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.803, Ratio=3.70x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.788, Ratio=3.77x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.790, Ratio=3.65x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.815, Ratio=3.66x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.777, Ratio=3.48x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.784, Ratio=3.43x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.786, Ratio=3.54x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.802, Ratio=3.64x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.782, Ratio=3.56x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.762, Ratio=3.37x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.791, Ratio=3.55x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.773, Ratio=3.37x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.805, Ratio=3.63x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.788, Ratio=3.59x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.791, Ratio=3.67x, Gap=-4.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.775, Ratio=3.36x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.789, Ratio=3.60x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.779, Ratio=3.60x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.761, Ratio=3.39x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.803, Ratio=3.65x, Gap=-4.019
Batch 375/537: Loss=0.9907 (C:0.9907, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.780, Ratio=3.54x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.795, Ratio=3.61x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.789, Ratio=3.56x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.776, Ratio=3.40x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.794, Ratio=3.55x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.790, Ratio=3.53x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.804, Ratio=3.82x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.784, Ratio=3.61x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.788, Ratio=3.58x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.794, Ratio=3.56x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.794, Ratio=3.51x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.796, Ratio=3.61x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.787, Ratio=3.46x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.769, Ratio=3.38x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.764, Ratio=3.39x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.781, Ratio=3.56x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.806, Ratio=3.77x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.782, Ratio=3.46x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.775, Ratio=3.53x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.789, Ratio=3.56x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.791, Ratio=3.53x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.784, Ratio=3.60x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.769, Ratio=3.40x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.789, Ratio=3.54x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.808, Ratio=3.59x, Gap=-3.917
Batch 400/537: Loss=0.9944 (C:0.9944, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.806, Ratio=3.76x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.791, Ratio=3.41x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.806, Ratio=3.63x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.797, Ratio=3.53x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.799, Ratio=3.56x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.777, Ratio=3.43x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.803, Ratio=3.60x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.784, Ratio=3.50x, Gap=-4.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.753, Ratio=3.33x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.797, Ratio=3.64x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.796, Ratio=3.69x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.790, Ratio=3.62x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.783, Ratio=3.49x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.786, Ratio=3.47x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.749, Ratio=3.16x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.799, Ratio=3.63x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.763, Ratio=3.42x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.781, Ratio=3.48x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.781, Ratio=3.51x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.784, Ratio=3.58x, Gap=-4.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.795, Ratio=3.57x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.780, Ratio=3.48x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.787, Ratio=3.70x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.802, Ratio=3.54x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.777, Ratio=3.47x, Gap=-3.885
Batch 425/537: Loss=1.0225 (C:1.0225, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.794, Ratio=3.57x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.816, Ratio=3.67x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.778, Ratio=3.46x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.783, Ratio=3.60x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.782, Ratio=3.42x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.791, Ratio=3.55x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.771, Ratio=3.42x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.771, Ratio=3.42x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.788, Ratio=3.49x, Gap=-4.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.791, Ratio=3.53x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.787, Ratio=3.60x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.783, Ratio=3.50x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.800, Ratio=3.66x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.762, Ratio=3.48x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.778, Ratio=3.47x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.803, Ratio=3.75x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.811, Ratio=3.62x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.787, Ratio=3.60x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.783, Ratio=3.48x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.812, Ratio=3.75x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.770, Ratio=3.50x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.786, Ratio=3.50x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.775, Ratio=3.46x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.792, Ratio=3.59x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.774, Ratio=3.45x, Gap=-3.952
Batch 450/537: Loss=1.0230 (C:1.0230, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.802, Ratio=3.65x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.790, Ratio=3.60x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.775, Ratio=3.46x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.789, Ratio=3.53x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.766, Ratio=3.39x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.798, Ratio=3.57x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.806, Ratio=3.40x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.786, Ratio=3.52x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.795, Ratio=3.62x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.799, Ratio=3.69x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.797, Ratio=3.59x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.804, Ratio=3.74x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.807, Ratio=3.67x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.808, Ratio=3.62x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.796, Ratio=3.63x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.790, Ratio=3.57x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.804, Ratio=3.72x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.763, Ratio=3.44x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.779, Ratio=3.54x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.797, Ratio=3.52x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.757, Ratio=3.37x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.774, Ratio=3.47x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.807, Ratio=3.69x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.781, Ratio=3.34x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.753, Ratio=3.32x, Gap=-3.774
Batch 475/537: Loss=1.0485 (C:1.0485, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.809, Ratio=3.68x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.796, Ratio=3.61x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.786, Ratio=3.47x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.788, Ratio=3.48x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.799, Ratio=3.53x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.801, Ratio=3.53x, Gap=-4.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.800, Ratio=3.56x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.780, Ratio=3.46x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.794, Ratio=3.73x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.781, Ratio=3.61x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.773, Ratio=3.61x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.795, Ratio=3.61x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.784, Ratio=3.49x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.782, Ratio=3.44x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.776, Ratio=3.60x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.778, Ratio=3.52x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.787, Ratio=3.53x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.774, Ratio=3.50x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.793, Ratio=3.57x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.814, Ratio=3.59x, Gap=-4.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.788, Ratio=3.62x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.814, Ratio=3.63x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.817, Ratio=3.59x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.796, Ratio=3.67x, Gap=-4.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.801, Ratio=3.47x, Gap=-4.044
Batch 500/537: Loss=1.0197 (C:1.0197, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.789, Ratio=3.54x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.771, Ratio=3.45x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.791, Ratio=3.63x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.793, Ratio=3.63x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.805, Ratio=3.61x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.785, Ratio=3.60x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.800, Ratio=3.49x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.758, Ratio=3.32x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.779, Ratio=3.53x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.779, Ratio=3.68x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.779, Ratio=3.46x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.781, Ratio=3.55x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.811, Ratio=3.64x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.752, Ratio=3.37x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.786, Ratio=3.50x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.795, Ratio=3.71x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.754, Ratio=3.33x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.780, Ratio=3.50x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.797, Ratio=3.58x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.798, Ratio=3.54x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.804, Ratio=3.64x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.793, Ratio=3.60x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.839, Ratio=3.78x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.801, Ratio=3.61x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.776, Ratio=3.45x, Gap=-4.472
Batch 525/537: Loss=1.0235 (C:1.0235, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.781, Ratio=3.45x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.801, Ratio=3.63x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.763, Ratio=3.39x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.780, Ratio=3.58x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.798, Ratio=3.62x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.784, Ratio=3.57x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.790, Ratio=3.58x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.767, Ratio=3.45x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.781, Ratio=3.55x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.796, Ratio=3.59x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.789, Ratio=3.35x, Gap=-4.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.786, Ratio=3.69x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.786, Ratio=3.63x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.808, Ratio=3.96x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.800, Ratio=3.74x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.804, Ratio=3.69x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.830, Ratio=4.16x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.800, Ratio=3.89x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.794, Ratio=3.79x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.813, Ratio=3.84x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.809, Ratio=4.02x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.811, Ratio=4.04x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.821, Ratio=4.03x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.784, Ratio=3.63x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.779, Ratio=3.60x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.798, Ratio=3.81x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.803, Ratio=3.87x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.803, Ratio=3.83x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.825, Ratio=3.97x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.811, Ratio=3.96x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.817, Ratio=3.98x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.801, Ratio=3.83x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.790, Ratio=3.68x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.773, Ratio=3.66x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.810, Ratio=3.87x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.822, Ratio=4.09x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.792, Ratio=3.75x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.805, Ratio=3.81x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.789, Ratio=3.85x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.797, Ratio=3.89x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.798, Ratio=3.81x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.813, Ratio=3.92x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.820, Ratio=4.01x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.792, Ratio=3.86x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.800, Ratio=3.69x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.801, Ratio=3.84x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.806, Ratio=3.91x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.793, Ratio=3.90x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.804, Ratio=3.68x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.806, Ratio=3.77x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.798, Ratio=3.82x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.800, Ratio=3.78x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.815, Ratio=3.94x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.803, Ratio=3.82x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.810, Ratio=3.88x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.787, Ratio=3.70x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.816, Ratio=4.03x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.818, Ratio=4.10x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.784, Ratio=3.60x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.829, Ratio=3.97x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.788, Ratio=3.76x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.816, Ratio=3.82x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.799, Ratio=3.86x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.811, Ratio=3.95x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.804, Ratio=3.96x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.814, Ratio=3.82x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.803, Ratio=3.85x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.808, Ratio=3.89x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.812, Ratio=3.81x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.807, Ratio=3.81x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.827, Ratio=3.99x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.802, Ratio=3.85x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.813, Ratio=3.99x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.809, Ratio=3.98x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.802, Ratio=3.80x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.809, Ratio=3.92x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.824, Ratio=3.94x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.798, Ratio=3.85x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.807, Ratio=3.88x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.812, Ratio=3.97x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.809, Ratio=3.93x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.793, Ratio=3.71x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.807, Ratio=3.88x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.825, Ratio=4.13x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.816, Ratio=3.91x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.794, Ratio=3.74x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.795, Ratio=3.89x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.799, Ratio=3.79x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.799, Ratio=3.91x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.800, Ratio=3.87x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.803, Ratio=3.86x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.807, Ratio=3.98x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.818, Ratio=3.91x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.797, Ratio=3.72x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.812, Ratio=3.95x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.810, Ratio=3.98x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.798, Ratio=3.85x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.807, Ratio=3.89x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.818, Ratio=4.08x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.810, Ratio=3.93x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.807, Ratio=3.90x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.821, Ratio=4.12x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.779, Ratio=3.67x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.802, Ratio=3.97x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.813, Ratio=3.78x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.800, Ratio=3.75x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.810, Ratio=3.94x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.807, Ratio=3.90x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.810, Ratio=3.91x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.801, Ratio=3.71x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.780, Ratio=3.75x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.800, Ratio=3.72x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.798, Ratio=3.80x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.776, Ratio=3.70x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.787, Ratio=3.77x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.798, Ratio=3.78x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.821, Ratio=4.02x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.807, Ratio=3.85x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.798, Ratio=3.82x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.795, Ratio=3.83x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.799, Ratio=3.86x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.799, Ratio=3.83x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.797, Ratio=3.74x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.808, Ratio=3.81x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.803, Ratio=3.78x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.814, Ratio=4.03x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.806, Ratio=3.97x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.808, Ratio=3.79x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.801, Ratio=3.88x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.801, Ratio=3.85x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.795, Ratio=3.83x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.789, Ratio=3.77x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.812, Ratio=3.87x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.830, Ratio=4.06x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.806, Ratio=3.91x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.802, Ratio=3.88x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.804, Ratio=3.78x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.788, Ratio=3.71x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.803, Ratio=3.90x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.803, Ratio=3.89x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.789, Ratio=3.64x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.800, Ratio=3.77x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.800, Ratio=3.82x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.786, Ratio=3.70x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.785, Ratio=3.66x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.823, Ratio=4.06x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.791, Ratio=3.75x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.800, Ratio=3.89x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.808, Ratio=3.77x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.801, Ratio=3.88x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.820, Ratio=4.14x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.790, Ratio=3.72x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.832, Ratio=4.07x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.829, Ratio=4.10x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.814, Ratio=3.83x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.814, Ratio=4.03x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.796, Ratio=3.90x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.799, Ratio=3.83x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.818, Ratio=3.98x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.793, Ratio=3.70x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.816, Ratio=3.79x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.792, Ratio=3.82x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.813, Ratio=3.89x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.812, Ratio=3.89x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.811, Ratio=4.02x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.808, Ratio=3.87x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.817, Ratio=3.88x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.822, Ratio=3.90x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.817, Ratio=3.87x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.795, Ratio=3.79x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.828, Ratio=4.23x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.816, Ratio=3.99x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.781, Ratio=3.66x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.800, Ratio=3.76x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.807, Ratio=3.84x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.797, Ratio=3.76x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.796, Ratio=3.81x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.799, Ratio=3.73x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.799, Ratio=3.74x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.792, Ratio=3.87x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.799, Ratio=3.81x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.802, Ratio=3.76x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.779, Ratio=3.75x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.808, Ratio=3.78x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.791, Ratio=3.87x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.793, Ratio=3.77x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.791, Ratio=3.78x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.806, Ratio=3.79x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.767, Ratio=3.54x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.803, Ratio=3.81x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.791, Ratio=3.84x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.827, Ratio=3.92x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.807, Ratio=3.93x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.808, Ratio=3.89x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.794, Ratio=3.76x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.822, Ratio=4.23x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.817, Ratio=3.96x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.793, Ratio=3.75x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.803, Ratio=3.85x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.816, Ratio=3.97x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.811, Ratio=3.91x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.806, Ratio=3.81x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.806, Ratio=3.94x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.810, Ratio=3.83x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.820, Ratio=3.98x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.789, Ratio=3.82x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.790, Ratio=3.69x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.801, Ratio=3.85x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.824, Ratio=4.04x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.804, Ratio=3.92x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.793, Ratio=3.79x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.796, Ratio=3.76x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.800, Ratio=3.86x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.784, Ratio=3.76x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.804, Ratio=3.91x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.808, Ratio=3.96x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.812, Ratio=3.97x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.789, Ratio=3.89x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.804, Ratio=3.86x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.810, Ratio=3.81x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.795, Ratio=3.86x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.795, Ratio=3.87x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.800, Ratio=3.81x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.806, Ratio=3.90x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.812, Ratio=3.81x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.778, Ratio=3.69x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.812, Ratio=3.83x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.815, Ratio=3.95x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.804, Ratio=3.89x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.803, Ratio=3.80x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.799, Ratio=3.82x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.792, Ratio=3.67x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.777, Ratio=3.60x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.803, Ratio=3.76x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.791, Ratio=3.87x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.805, Ratio=3.83x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.797, Ratio=3.81x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.789, Ratio=3.73x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.805, Ratio=3.97x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.816, Ratio=3.90x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.802, Ratio=3.81x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.811, Ratio=3.94x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.810, Ratio=3.88x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.817, Ratio=4.08x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.800, Ratio=3.94x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.818, Ratio=3.96x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.800, Ratio=3.78x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.804, Ratio=3.82x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.785, Ratio=3.73x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.782, Ratio=3.84x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.795, Ratio=3.92x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.822, Ratio=4.01x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.803, Ratio=3.79x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.817, Ratio=3.88x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.833, Ratio=4.19x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.807, Ratio=3.88x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.808, Ratio=3.84x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.789, Ratio=3.84x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.809, Ratio=4.04x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.810, Ratio=3.96x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.796, Ratio=3.91x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.792, Ratio=3.80x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.799, Ratio=3.88x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.803, Ratio=3.88x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.812, Ratio=4.00x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.818, Ratio=4.05x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.814, Ratio=3.93x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.803, Ratio=3.86x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.806, Ratio=3.95x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.822, Ratio=4.10x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.805, Ratio=3.86x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.812, Ratio=4.02x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.809, Ratio=3.89x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.815, Ratio=3.90x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.805, Ratio=3.92x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.789, Ratio=3.85x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.790, Ratio=3.74x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.792, Ratio=3.73x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.817, Ratio=3.88x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.828, Ratio=4.11x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.790, Ratio=3.62x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.810, Ratio=3.94x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.800, Ratio=3.80x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.821, Ratio=3.88x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.802, Ratio=3.74x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.814, Ratio=4.08x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.806, Ratio=3.98x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.792, Ratio=3.84x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.799, Ratio=3.77x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.797, Ratio=3.76x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.821, Ratio=3.96x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.790, Ratio=3.68x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.820, Ratio=4.02x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.797, Ratio=3.68x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.789, Ratio=3.78x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.802, Ratio=3.79x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.813, Ratio=3.89x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.805, Ratio=3.95x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.805, Ratio=3.86x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.808, Ratio=3.84x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.812, Ratio=3.86x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.779, Ratio=3.69x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.814, Ratio=3.96x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.803, Ratio=3.87x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.807, Ratio=3.89x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.804, Ratio=3.83x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.794, Ratio=3.76x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.818, Ratio=3.96x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.793, Ratio=3.68x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.807, Ratio=3.86x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.768, Ratio=3.62x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.805, Ratio=3.86x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.802, Ratio=3.86x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.772, Ratio=3.62x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.791, Ratio=3.88x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.782, Ratio=3.62x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.796, Ratio=3.82x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.786, Ratio=3.66x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.798, Ratio=3.85x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.791, Ratio=3.78x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.793, Ratio=3.75x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.809, Ratio=3.86x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.817, Ratio=4.01x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.828, Ratio=4.00x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.809, Ratio=4.00x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.805, Ratio=3.90x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.822, Ratio=4.16x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.802, Ratio=3.91x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.807, Ratio=4.04x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.803, Ratio=3.86x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.801, Ratio=3.73x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.773, Ratio=3.63x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.821, Ratio=4.05x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.808, Ratio=3.73x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.794, Ratio=3.83x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.794, Ratio=3.77x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.802, Ratio=3.85x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.809, Ratio=3.88x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.811, Ratio=3.79x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.798, Ratio=3.79x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.809, Ratio=4.02x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.815, Ratio=4.00x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.801, Ratio=3.88x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.783, Ratio=3.78x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.791, Ratio=3.79x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.804, Ratio=3.98x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.809, Ratio=3.90x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.801, Ratio=3.87x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.821, Ratio=3.99x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.808, Ratio=3.83x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.804, Ratio=3.92x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.809, Ratio=3.93x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.795, Ratio=3.77x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.810, Ratio=3.99x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.805, Ratio=3.99x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.824, Ratio=4.00x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.792, Ratio=3.98x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.833, Ratio=4.19x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.787, Ratio=3.77x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.773, Ratio=3.59x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.797, Ratio=3.82x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.817, Ratio=3.98x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.800, Ratio=3.75x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.817, Ratio=3.99x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.808, Ratio=3.91x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.806, Ratio=3.93x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.820, Ratio=4.10x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.806, Ratio=3.97x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.800, Ratio=3.87x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.800, Ratio=3.90x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.824, Ratio=4.04x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.780, Ratio=3.75x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.815, Ratio=3.88x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.810, Ratio=4.00x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.795, Ratio=3.73x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.799, Ratio=3.79x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.801, Ratio=3.79x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.788, Ratio=3.72x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.826, Ratio=4.17x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.809, Ratio=3.96x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.827, Ratio=3.95x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.801, Ratio=3.88x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.774, Ratio=3.54x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.805, Ratio=3.91x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.796, Ratio=3.77x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.785, Ratio=3.81x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.787, Ratio=3.72x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.811, Ratio=3.99x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.816, Ratio=3.87x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.800, Ratio=3.93x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.796, Ratio=3.83x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.821, Ratio=3.96x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.819, Ratio=4.15x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.808, Ratio=3.98x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.763, Ratio=3.53x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.792, Ratio=3.79x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.803, Ratio=3.85x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.775, Ratio=3.71x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.826, Ratio=4.04x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.821, Ratio=4.03x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.785, Ratio=3.68x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.811, Ratio=3.91x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.796, Ratio=3.80x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.802, Ratio=3.70x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.788, Ratio=3.68x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.812, Ratio=3.95x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.806, Ratio=3.93x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.800, Ratio=3.85x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.814, Ratio=3.90x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.789, Ratio=3.69x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.800, Ratio=3.69x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.807, Ratio=3.85x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.796, Ratio=3.79x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.792, Ratio=3.80x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.801, Ratio=3.89x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.802, Ratio=3.79x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.781, Ratio=3.70x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.808, Ratio=3.83x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.804, Ratio=3.82x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.808, Ratio=3.84x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.801, Ratio=3.93x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.807, Ratio=3.92x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.826, Ratio=3.96x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.795, Ratio=3.80x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.806, Ratio=3.98x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.802, Ratio=3.83x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.810, Ratio=3.82x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.804, Ratio=3.81x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.801, Ratio=3.91x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.813, Ratio=4.12x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.813, Ratio=4.04x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.827, Ratio=3.89x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.807, Ratio=3.90x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.776, Ratio=3.69x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.810, Ratio=3.92x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.792, Ratio=3.77x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.801, Ratio=3.76x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.817, Ratio=3.93x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.806, Ratio=3.80x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.823, Ratio=4.05x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.818, Ratio=3.96x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.785, Ratio=3.75x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.813, Ratio=4.01x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.806, Ratio=3.85x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.819, Ratio=3.95x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.799, Ratio=4.02x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.793, Ratio=3.66x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.807, Ratio=3.94x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.821, Ratio=3.98x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.827, Ratio=4.08x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.825, Ratio=4.05x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.829, Ratio=3.93x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.817, Ratio=3.97x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.792, Ratio=3.80x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.784, Ratio=3.69x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.794, Ratio=3.80x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.808, Ratio=3.84x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.817, Ratio=3.84x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.828, Ratio=4.02x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.804, Ratio=3.93x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.800, Ratio=3.85x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.828, Ratio=4.00x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.778, Ratio=3.69x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.794, Ratio=3.85x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.805, Ratio=3.85x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.788, Ratio=3.68x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.814, Ratio=4.02x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.814, Ratio=3.99x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.816, Ratio=3.89x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.785, Ratio=3.65x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.810, Ratio=3.88x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.803, Ratio=3.89x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.789, Ratio=3.75x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.798, Ratio=3.84x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.796, Ratio=3.77x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.785, Ratio=3.77x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.823, Ratio=3.96x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.832, Ratio=4.09x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.836, Ratio=4.05x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.812, Ratio=3.90x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.786, Ratio=3.72x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.798, Ratio=3.81x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.816, Ratio=4.04x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.797, Ratio=3.82x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.811, Ratio=4.00x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.812, Ratio=3.86x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.795, Ratio=3.75x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.801, Ratio=3.70x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.799, Ratio=3.82x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.788, Ratio=3.69x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.819, Ratio=4.09x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.786, Ratio=3.60x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.798, Ratio=3.87x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.797, Ratio=3.81x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.789, Ratio=3.79x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.778, Ratio=3.74x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.805, Ratio=3.88x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.796, Ratio=3.77x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.808, Ratio=3.84x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.835, Ratio=4.18x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.787, Ratio=3.68x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.811, Ratio=4.00x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.798, Ratio=3.80x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.810, Ratio=3.90x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.809, Ratio=3.92x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.820, Ratio=4.12x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.823, Ratio=3.96x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.823, Ratio=4.00x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.790, Ratio=3.76x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.796, Ratio=3.90x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.800, Ratio=3.81x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.793, Ratio=3.80x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.791, Ratio=3.81x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.813, Ratio=3.84x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.780, Ratio=3.81x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.783, Ratio=3.92x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.812, Ratio=3.97x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.790, Ratio=3.89x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.792, Ratio=3.80x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.821, Ratio=4.11x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.789, Ratio=3.74x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.802, Ratio=3.87x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.809, Ratio=4.08x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.812, Ratio=3.92x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.797, Ratio=3.86x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.789, Ratio=3.75x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.791, Ratio=3.76x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.793, Ratio=3.80x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.812, Ratio=3.95x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.801, Ratio=3.80x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.809, Ratio=3.95x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.816, Ratio=3.92x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.802, Ratio=3.99x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.802, Ratio=3.84x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.809, Ratio=4.02x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.786, Ratio=3.69x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.827, Ratio=4.09x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.800, Ratio=3.82x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.807, Ratio=3.88x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.786, Ratio=3.67x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.793, Ratio=3.87x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.822, Ratio=4.03x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.785, Ratio=3.74x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.826, Ratio=4.01x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.813, Ratio=3.94x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.799, Ratio=3.79x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.786, Ratio=3.77x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.821, Ratio=3.97x, Gap=-3.303

============================================================
Epoch 12/20 completed in 31.9s
Train: Loss=1.0073 (C:1.0073, R:0.0000) Ratio=3.34x
Val:   Loss=0.9577 (C:0.9577, R:0.0000) Ratio=4.15x
‚úÖ New best model saved (Val Loss: 0.9577)
============================================================

üåç Updating global dataset at epoch 13
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.435 ¬± 0.542
    Neg distances: 1.871 ¬± 0.898
    Separation ratio: 4.30x
    Gap: -3.381
    ‚úÖ Excellent global separation!

Epoch 13 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.869, Ratio=4.15x, Gap=-3.952
Batch   0/537: Loss=0.9050 (C:0.9050, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.872, Ratio=4.01x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.871, Ratio=3.96x, Gap=-4.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.875, Ratio=4.02x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.878, Ratio=3.85x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.841, Ratio=3.59x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.878, Ratio=3.86x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.887, Ratio=3.74x, Gap=-4.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.888, Ratio=4.01x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.939, Ratio=4.33x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.904, Ratio=4.02x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.915, Ratio=4.03x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.859, Ratio=3.74x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.887, Ratio=3.89x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.911, Ratio=3.96x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.900, Ratio=3.97x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.918, Ratio=4.18x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.900, Ratio=3.97x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.863, Ratio=3.78x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.870, Ratio=3.93x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.886, Ratio=4.05x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.868, Ratio=3.92x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.860, Ratio=3.83x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.855, Ratio=3.80x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.881, Ratio=3.96x, Gap=-4.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.878, Ratio=3.80x, Gap=-4.158
Batch  25/537: Loss=0.9512 (C:0.9512, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.885, Ratio=3.83x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.909, Ratio=3.98x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.886, Ratio=3.87x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.894, Ratio=3.89x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.867, Ratio=3.73x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.891, Ratio=3.92x, Gap=-4.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.875, Ratio=3.74x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.877, Ratio=3.82x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.894, Ratio=4.09x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.885, Ratio=4.02x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.882, Ratio=3.94x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.870, Ratio=3.70x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.868, Ratio=3.87x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.891, Ratio=3.93x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.874, Ratio=3.85x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.883, Ratio=3.85x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.901, Ratio=4.03x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.906, Ratio=3.98x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.909, Ratio=3.97x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.893, Ratio=3.91x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.912, Ratio=4.12x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.866, Ratio=3.67x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.883, Ratio=3.81x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.851, Ratio=3.73x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.867, Ratio=3.72x, Gap=-4.124
Batch  50/537: Loss=0.9671 (C:0.9671, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.885, Ratio=3.87x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.870, Ratio=3.88x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.884, Ratio=3.83x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.886, Ratio=3.95x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.890, Ratio=3.93x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.889, Ratio=3.76x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.877, Ratio=3.81x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.910, Ratio=4.04x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.893, Ratio=3.83x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.897, Ratio=4.07x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.881, Ratio=3.86x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.868, Ratio=3.85x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.881, Ratio=3.80x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.859, Ratio=3.86x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.891, Ratio=3.92x, Gap=-5.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.875, Ratio=3.86x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.877, Ratio=3.94x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.899, Ratio=3.92x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.882, Ratio=4.01x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.875, Ratio=3.89x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.887, Ratio=4.02x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.893, Ratio=3.83x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.891, Ratio=3.94x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.913, Ratio=4.03x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.906, Ratio=3.95x, Gap=-4.393
Batch  75/537: Loss=0.9258 (C:0.9258, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.879, Ratio=3.88x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.895, Ratio=3.82x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.882, Ratio=3.83x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.883, Ratio=3.95x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.884, Ratio=3.76x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.888, Ratio=3.82x, Gap=-4.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.885, Ratio=3.96x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.881, Ratio=3.90x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.861, Ratio=3.83x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.893, Ratio=4.03x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.895, Ratio=4.01x, Gap=-4.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.879, Ratio=3.89x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.860, Ratio=3.76x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.878, Ratio=3.81x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.893, Ratio=3.89x, Gap=-4.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.863, Ratio=3.88x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.909, Ratio=4.12x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.869, Ratio=3.96x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.902, Ratio=3.98x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.889, Ratio=3.80x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.879, Ratio=3.67x, Gap=-4.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.874, Ratio=3.80x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.896, Ratio=3.86x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.922, Ratio=4.18x, Gap=-4.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.876, Ratio=3.84x, Gap=-4.179
Batch 100/537: Loss=0.9480 (C:0.9480, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.895, Ratio=4.08x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.887, Ratio=3.97x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.874, Ratio=3.84x, Gap=-4.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.881, Ratio=3.87x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.864, Ratio=3.66x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.880, Ratio=3.81x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.905, Ratio=4.01x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.874, Ratio=3.87x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.886, Ratio=3.81x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.857, Ratio=3.72x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.894, Ratio=3.99x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.868, Ratio=3.95x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.899, Ratio=4.04x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.883, Ratio=3.89x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.890, Ratio=3.80x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.874, Ratio=3.72x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.897, Ratio=4.09x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.896, Ratio=3.84x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.889, Ratio=3.94x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.881, Ratio=3.78x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.881, Ratio=3.94x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.902, Ratio=3.99x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.875, Ratio=3.87x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.867, Ratio=3.64x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.869, Ratio=3.69x, Gap=-4.039
Batch 125/537: Loss=0.9697 (C:0.9697, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.892, Ratio=3.83x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.894, Ratio=3.99x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.868, Ratio=3.75x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.872, Ratio=3.74x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.886, Ratio=3.92x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.892, Ratio=3.96x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.881, Ratio=3.75x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.877, Ratio=3.89x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.873, Ratio=3.85x, Gap=-4.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.888, Ratio=3.96x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.885, Ratio=3.74x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.895, Ratio=3.87x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.895, Ratio=4.15x, Gap=-4.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.900, Ratio=3.97x, Gap=-4.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.886, Ratio=4.00x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.894, Ratio=4.04x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.870, Ratio=3.77x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.874, Ratio=3.83x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.880, Ratio=3.99x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.852, Ratio=3.80x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.884, Ratio=3.87x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.867, Ratio=3.82x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.886, Ratio=3.89x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.886, Ratio=3.89x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.884, Ratio=3.80x, Gap=-4.155
Batch 150/537: Loss=0.9500 (C:0.9500, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.868, Ratio=3.78x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.903, Ratio=3.85x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.878, Ratio=3.81x, Gap=-4.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.879, Ratio=3.89x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.904, Ratio=4.08x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.875, Ratio=3.84x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.875, Ratio=3.83x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.892, Ratio=3.94x, Gap=-4.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.868, Ratio=3.88x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.883, Ratio=3.92x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.867, Ratio=3.74x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.886, Ratio=4.03x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.867, Ratio=3.76x, Gap=-4.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.864, Ratio=3.72x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.890, Ratio=3.75x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.889, Ratio=3.93x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.887, Ratio=3.82x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.895, Ratio=3.86x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.867, Ratio=3.66x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.852, Ratio=3.61x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.863, Ratio=3.62x, Gap=-4.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.893, Ratio=3.82x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.863, Ratio=3.79x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.874, Ratio=3.76x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.896, Ratio=3.79x, Gap=-4.027
Batch 175/537: Loss=0.9576 (C:0.9576, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.861, Ratio=3.63x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.870, Ratio=3.74x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.889, Ratio=4.01x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.867, Ratio=3.85x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.905, Ratio=4.03x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.874, Ratio=3.86x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.865, Ratio=3.88x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.863, Ratio=3.84x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.871, Ratio=3.70x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.861, Ratio=3.70x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.898, Ratio=3.93x, Gap=-4.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.901, Ratio=3.93x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.884, Ratio=3.89x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.884, Ratio=3.84x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.873, Ratio=3.72x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.875, Ratio=3.73x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.865, Ratio=3.64x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.869, Ratio=3.80x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.846, Ratio=3.62x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.863, Ratio=3.68x, Gap=-4.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.880, Ratio=3.90x, Gap=-4.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.886, Ratio=3.92x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.879, Ratio=3.80x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.884, Ratio=3.92x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.868, Ratio=3.85x, Gap=-4.101
Batch 200/537: Loss=0.9458 (C:0.9458, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.885, Ratio=3.81x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.877, Ratio=3.87x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.902, Ratio=3.99x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.869, Ratio=3.58x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.874, Ratio=3.82x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.892, Ratio=3.91x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.876, Ratio=3.68x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.886, Ratio=3.78x, Gap=-4.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.883, Ratio=3.71x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.900, Ratio=4.10x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.892, Ratio=3.85x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.861, Ratio=3.73x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.877, Ratio=3.67x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.867, Ratio=3.79x, Gap=-4.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.897, Ratio=3.83x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.874, Ratio=3.85x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.884, Ratio=3.92x, Gap=-4.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.885, Ratio=3.87x, Gap=-4.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.874, Ratio=3.86x, Gap=-4.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.857, Ratio=3.87x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.849, Ratio=3.64x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.879, Ratio=3.83x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.868, Ratio=3.89x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.887, Ratio=3.94x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.879, Ratio=3.73x, Gap=-4.340
Batch 225/537: Loss=0.9621 (C:0.9621, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.887, Ratio=3.96x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.883, Ratio=3.85x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.889, Ratio=3.93x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.882, Ratio=3.86x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.880, Ratio=3.79x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.873, Ratio=3.79x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.869, Ratio=3.87x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.879, Ratio=3.85x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.895, Ratio=4.06x, Gap=-4.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.898, Ratio=4.00x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.889, Ratio=3.94x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.853, Ratio=3.62x, Gap=-4.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.888, Ratio=3.86x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.885, Ratio=3.83x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.878, Ratio=3.78x, Gap=-4.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.890, Ratio=3.96x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.867, Ratio=3.81x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.867, Ratio=3.77x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.866, Ratio=3.89x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.905, Ratio=4.07x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.884, Ratio=3.88x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.877, Ratio=3.78x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.878, Ratio=3.99x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.901, Ratio=3.89x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.874, Ratio=3.72x, Gap=-4.325
Batch 250/537: Loss=0.9682 (C:0.9682, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.893, Ratio=3.82x, Gap=-4.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.885, Ratio=3.81x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.890, Ratio=3.88x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.868, Ratio=3.75x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.882, Ratio=4.07x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.904, Ratio=4.07x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.870, Ratio=3.82x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.858, Ratio=3.65x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.875, Ratio=3.84x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.878, Ratio=3.88x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.894, Ratio=4.07x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.858, Ratio=3.82x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.870, Ratio=3.66x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.871, Ratio=3.86x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.841, Ratio=3.68x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.867, Ratio=3.81x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.902, Ratio=3.96x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.888, Ratio=3.96x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.890, Ratio=4.04x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.903, Ratio=4.05x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.890, Ratio=3.96x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.920, Ratio=4.12x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.891, Ratio=3.80x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.884, Ratio=3.82x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.874, Ratio=3.66x, Gap=-3.986
Batch 275/537: Loss=0.9761 (C:0.9761, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.864, Ratio=3.69x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.910, Ratio=3.98x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.878, Ratio=3.83x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.861, Ratio=3.64x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.884, Ratio=3.96x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.876, Ratio=3.91x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.864, Ratio=3.69x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.898, Ratio=3.93x, Gap=-4.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.867, Ratio=3.75x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.875, Ratio=3.86x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.880, Ratio=3.80x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.867, Ratio=3.88x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.899, Ratio=3.94x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.885, Ratio=3.94x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.880, Ratio=3.85x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.895, Ratio=3.88x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.881, Ratio=3.78x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.878, Ratio=3.87x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.874, Ratio=3.80x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.894, Ratio=3.70x, Gap=-4.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.885, Ratio=3.71x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.866, Ratio=3.77x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.886, Ratio=3.97x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.852, Ratio=3.71x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.866, Ratio=3.79x, Gap=-4.093
Batch 300/537: Loss=0.9522 (C:0.9522, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.868, Ratio=3.81x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.860, Ratio=3.67x, Gap=-4.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.870, Ratio=3.79x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.873, Ratio=3.85x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.846, Ratio=3.70x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.863, Ratio=3.77x, Gap=-4.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.878, Ratio=3.82x, Gap=-4.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.900, Ratio=4.02x, Gap=-4.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.892, Ratio=3.79x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.886, Ratio=3.84x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.909, Ratio=4.01x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.899, Ratio=4.07x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.883, Ratio=3.71x, Gap=-4.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.889, Ratio=3.75x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.880, Ratio=3.81x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.871, Ratio=3.81x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.878, Ratio=3.82x, Gap=-4.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.852, Ratio=3.58x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.847, Ratio=3.63x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.879, Ratio=3.86x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.868, Ratio=3.96x, Gap=-5.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.890, Ratio=3.95x, Gap=-4.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.852, Ratio=3.71x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.881, Ratio=3.81x, Gap=-4.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.887, Ratio=3.85x, Gap=-4.002
Batch 325/537: Loss=0.9439 (C:0.9439, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.875, Ratio=3.68x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.887, Ratio=3.75x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.872, Ratio=3.85x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.894, Ratio=3.84x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.887, Ratio=3.88x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.874, Ratio=3.71x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.878, Ratio=3.75x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.908, Ratio=3.90x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.884, Ratio=3.87x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.868, Ratio=3.82x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.870, Ratio=3.64x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.877, Ratio=3.83x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.865, Ratio=3.67x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.900, Ratio=3.87x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.889, Ratio=3.88x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.868, Ratio=3.77x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.862, Ratio=3.69x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.870, Ratio=3.81x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.876, Ratio=3.88x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.873, Ratio=3.89x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.898, Ratio=4.01x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.879, Ratio=3.80x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.869, Ratio=3.78x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.895, Ratio=3.95x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.880, Ratio=3.86x, Gap=-3.724
Batch 350/537: Loss=0.9452 (C:0.9452, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.882, Ratio=3.77x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.906, Ratio=3.90x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.873, Ratio=3.73x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.893, Ratio=3.86x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.864, Ratio=3.74x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.868, Ratio=3.64x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.898, Ratio=3.94x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.864, Ratio=3.95x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.864, Ratio=3.78x, Gap=-4.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.883, Ratio=3.89x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.878, Ratio=3.88x, Gap=-4.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.878, Ratio=3.80x, Gap=-4.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.884, Ratio=3.87x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.879, Ratio=3.84x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.859, Ratio=3.63x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.868, Ratio=3.73x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.896, Ratio=4.03x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.885, Ratio=3.93x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.887, Ratio=3.81x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.897, Ratio=3.98x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.879, Ratio=3.77x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.873, Ratio=3.77x, Gap=-4.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.870, Ratio=3.77x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.886, Ratio=3.85x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.863, Ratio=3.80x, Gap=-3.740
Batch 375/537: Loss=0.9515 (C:0.9515, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.884, Ratio=3.91x, Gap=-4.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.874, Ratio=3.75x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.873, Ratio=3.92x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.875, Ratio=3.85x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.895, Ratio=3.67x, Gap=-4.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.897, Ratio=3.93x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.842, Ratio=3.52x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.870, Ratio=3.66x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.902, Ratio=4.03x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.876, Ratio=3.76x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.887, Ratio=4.02x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.881, Ratio=3.78x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.888, Ratio=3.81x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.872, Ratio=3.73x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.888, Ratio=3.88x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.888, Ratio=4.03x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.872, Ratio=3.75x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.855, Ratio=3.65x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.860, Ratio=3.69x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.852, Ratio=3.67x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.843, Ratio=3.72x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.849, Ratio=3.76x, Gap=-4.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.878, Ratio=3.80x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.884, Ratio=3.79x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.885, Ratio=3.83x, Gap=-3.995
Batch 400/537: Loss=0.9469 (C:0.9469, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.878, Ratio=3.63x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.864, Ratio=3.60x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.881, Ratio=3.83x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.871, Ratio=3.71x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.886, Ratio=3.72x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.882, Ratio=3.75x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.868, Ratio=3.79x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.889, Ratio=3.94x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.877, Ratio=3.73x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.874, Ratio=3.82x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.873, Ratio=3.92x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.857, Ratio=3.64x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.850, Ratio=3.67x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.886, Ratio=3.89x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.903, Ratio=3.87x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.869, Ratio=3.68x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.861, Ratio=3.64x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.905, Ratio=3.99x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.851, Ratio=3.54x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.885, Ratio=3.84x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.873, Ratio=3.92x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.863, Ratio=3.75x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.886, Ratio=3.78x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.870, Ratio=3.74x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.893, Ratio=3.94x, Gap=-4.318
Batch 425/537: Loss=0.9339 (C:0.9339, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.854, Ratio=3.61x, Gap=-4.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.897, Ratio=3.97x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.884, Ratio=3.94x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.863, Ratio=3.88x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.892, Ratio=3.92x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.883, Ratio=3.82x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.860, Ratio=3.58x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.887, Ratio=3.85x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.895, Ratio=3.92x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.886, Ratio=3.70x, Gap=-4.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.886, Ratio=3.75x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.893, Ratio=3.88x, Gap=-4.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.873, Ratio=3.81x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.881, Ratio=3.85x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.881, Ratio=3.80x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.901, Ratio=4.12x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.883, Ratio=3.83x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.866, Ratio=3.83x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.852, Ratio=3.70x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.878, Ratio=3.90x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.880, Ratio=3.93x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.865, Ratio=3.85x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.892, Ratio=3.97x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.886, Ratio=3.92x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.867, Ratio=3.68x, Gap=-4.325
Batch 450/537: Loss=0.9713 (C:0.9713, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.898, Ratio=3.89x, Gap=-4.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.889, Ratio=3.86x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.885, Ratio=3.79x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.885, Ratio=3.78x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.876, Ratio=3.72x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.853, Ratio=3.76x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.895, Ratio=3.79x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.888, Ratio=3.88x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.867, Ratio=3.75x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.889, Ratio=3.96x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.894, Ratio=3.89x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.897, Ratio=4.00x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.905, Ratio=4.09x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.874, Ratio=3.82x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.882, Ratio=3.80x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.869, Ratio=3.76x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.882, Ratio=3.84x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.868, Ratio=3.82x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.889, Ratio=3.86x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.887, Ratio=3.99x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.870, Ratio=3.76x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.889, Ratio=3.89x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.888, Ratio=3.80x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.876, Ratio=3.92x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.868, Ratio=3.73x, Gap=-4.227
Batch 475/537: Loss=0.9643 (C:0.9643, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.884, Ratio=3.90x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.869, Ratio=3.72x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.887, Ratio=3.68x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.885, Ratio=3.89x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.902, Ratio=4.04x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.865, Ratio=3.75x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.880, Ratio=3.83x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.878, Ratio=3.76x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.902, Ratio=4.09x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.868, Ratio=3.65x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.867, Ratio=3.87x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.879, Ratio=3.80x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.869, Ratio=3.74x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.884, Ratio=3.83x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.870, Ratio=3.74x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.880, Ratio=3.76x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.887, Ratio=3.84x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.888, Ratio=3.87x, Gap=-4.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.894, Ratio=3.95x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.860, Ratio=3.67x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.889, Ratio=3.83x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.892, Ratio=3.93x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.890, Ratio=3.84x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.893, Ratio=3.83x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.900, Ratio=3.86x, Gap=-4.294
Batch 500/537: Loss=0.9428 (C:0.9428, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.897, Ratio=3.99x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.888, Ratio=3.94x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.904, Ratio=4.08x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.842, Ratio=3.64x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.865, Ratio=3.80x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.861, Ratio=3.85x, Gap=-4.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.880, Ratio=3.88x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.869, Ratio=3.64x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.853, Ratio=3.73x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.863, Ratio=3.88x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.877, Ratio=3.78x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.876, Ratio=3.71x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.880, Ratio=3.92x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.892, Ratio=3.91x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.879, Ratio=3.66x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.901, Ratio=3.92x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.859, Ratio=3.72x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.870, Ratio=3.65x, Gap=-4.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.910, Ratio=4.12x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.893, Ratio=4.02x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.880, Ratio=3.79x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.866, Ratio=3.78x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.909, Ratio=3.97x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.868, Ratio=3.83x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.910, Ratio=4.18x, Gap=-3.804
Batch 525/537: Loss=0.8973 (C:0.8973, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.882, Ratio=3.93x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.880, Ratio=3.71x, Gap=-5.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.859, Ratio=3.79x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.871, Ratio=3.84x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.893, Ratio=3.91x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.882, Ratio=3.75x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.899, Ratio=4.09x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.892, Ratio=3.90x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.875, Ratio=3.82x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.881, Ratio=3.80x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.867, Ratio=3.75x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.914, Ratio=4.35x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.907, Ratio=4.25x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.902, Ratio=4.36x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.904, Ratio=4.45x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.903, Ratio=4.28x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.869, Ratio=4.00x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.905, Ratio=4.30x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.907, Ratio=4.27x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.912, Ratio=4.35x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.888, Ratio=4.10x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.884, Ratio=4.24x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.885, Ratio=4.09x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.886, Ratio=4.30x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.898, Ratio=4.25x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.894, Ratio=4.22x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.907, Ratio=4.51x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.900, Ratio=4.33x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.894, Ratio=4.18x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.906, Ratio=4.46x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.901, Ratio=4.19x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.879, Ratio=4.15x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.874, Ratio=4.09x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.903, Ratio=4.40x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.891, Ratio=4.21x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.917, Ratio=4.43x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.903, Ratio=4.19x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.878, Ratio=4.08x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.889, Ratio=4.26x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.873, Ratio=3.99x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.884, Ratio=4.18x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.890, Ratio=4.31x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.891, Ratio=4.23x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.915, Ratio=4.39x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.889, Ratio=4.30x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.888, Ratio=4.10x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.911, Ratio=4.38x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.896, Ratio=4.42x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.906, Ratio=4.38x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.930, Ratio=4.57x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.903, Ratio=4.33x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.901, Ratio=4.16x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.894, Ratio=4.23x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.895, Ratio=4.22x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.892, Ratio=4.21x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.887, Ratio=4.07x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.898, Ratio=4.21x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.908, Ratio=4.32x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.879, Ratio=4.19x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.887, Ratio=4.15x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.878, Ratio=4.05x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.904, Ratio=4.15x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.898, Ratio=4.13x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.915, Ratio=4.47x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.889, Ratio=4.40x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.912, Ratio=4.23x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.894, Ratio=4.22x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.894, Ratio=4.23x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.906, Ratio=4.39x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.911, Ratio=4.35x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.901, Ratio=4.23x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.927, Ratio=4.45x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.887, Ratio=4.07x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.897, Ratio=4.24x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.890, Ratio=4.27x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.886, Ratio=4.28x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.891, Ratio=4.21x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.903, Ratio=4.34x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.887, Ratio=4.18x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.900, Ratio=4.26x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.887, Ratio=4.20x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.874, Ratio=4.05x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.882, Ratio=4.22x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.908, Ratio=4.43x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.905, Ratio=4.31x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.909, Ratio=4.43x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.905, Ratio=4.29x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.895, Ratio=4.17x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.894, Ratio=4.36x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.908, Ratio=4.33x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.918, Ratio=4.33x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.913, Ratio=4.26x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.911, Ratio=4.58x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.882, Ratio=4.19x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.907, Ratio=4.39x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.885, Ratio=4.14x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.898, Ratio=4.27x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.884, Ratio=4.09x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.904, Ratio=4.42x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.897, Ratio=4.17x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.905, Ratio=4.35x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.901, Ratio=4.27x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.899, Ratio=4.43x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.892, Ratio=4.39x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.885, Ratio=4.29x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.892, Ratio=4.20x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.889, Ratio=4.10x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.885, Ratio=4.29x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.906, Ratio=4.38x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.909, Ratio=4.32x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.887, Ratio=4.26x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.905, Ratio=4.43x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.903, Ratio=4.38x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.887, Ratio=4.30x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.895, Ratio=4.17x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.902, Ratio=4.34x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.884, Ratio=4.08x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.905, Ratio=4.26x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.879, Ratio=4.15x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.892, Ratio=4.01x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.900, Ratio=4.38x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.919, Ratio=4.57x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.890, Ratio=4.27x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.885, Ratio=4.19x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.919, Ratio=4.46x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.889, Ratio=4.24x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.907, Ratio=4.27x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.906, Ratio=4.32x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.884, Ratio=4.16x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.894, Ratio=4.28x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.895, Ratio=3.98x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.894, Ratio=4.18x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.883, Ratio=3.97x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.871, Ratio=4.03x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.882, Ratio=4.23x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.870, Ratio=3.98x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.911, Ratio=4.45x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.888, Ratio=4.21x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.883, Ratio=3.92x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.893, Ratio=4.14x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.889, Ratio=4.29x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.886, Ratio=4.28x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.879, Ratio=4.22x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.896, Ratio=4.19x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.898, Ratio=4.08x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.908, Ratio=4.46x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.900, Ratio=4.31x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.910, Ratio=4.50x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.885, Ratio=4.24x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.884, Ratio=4.17x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.888, Ratio=4.11x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.903, Ratio=4.42x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.889, Ratio=4.17x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.880, Ratio=4.14x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.907, Ratio=4.47x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.915, Ratio=4.56x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.887, Ratio=4.10x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.899, Ratio=4.29x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.871, Ratio=4.01x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.934, Ratio=4.60x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.917, Ratio=4.36x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.883, Ratio=4.06x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.906, Ratio=4.44x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.861, Ratio=3.96x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.880, Ratio=4.14x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.865, Ratio=4.05x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.881, Ratio=3.94x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.913, Ratio=4.28x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.887, Ratio=4.12x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.887, Ratio=4.26x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.915, Ratio=4.34x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.883, Ratio=4.10x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.891, Ratio=4.32x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.898, Ratio=4.25x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.903, Ratio=4.34x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.890, Ratio=4.07x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.876, Ratio=4.08x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.902, Ratio=4.28x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.902, Ratio=4.23x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.886, Ratio=4.27x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.900, Ratio=4.22x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.900, Ratio=4.37x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.908, Ratio=4.40x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.908, Ratio=4.25x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.885, Ratio=4.16x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.881, Ratio=4.20x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.899, Ratio=4.16x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.886, Ratio=4.06x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.910, Ratio=4.51x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.927, Ratio=4.48x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.908, Ratio=4.41x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.880, Ratio=3.90x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.919, Ratio=4.35x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.900, Ratio=4.37x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.917, Ratio=4.40x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.889, Ratio=4.04x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.888, Ratio=4.15x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.904, Ratio=4.31x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.893, Ratio=4.29x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.909, Ratio=4.26x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.920, Ratio=4.60x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.899, Ratio=4.13x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.906, Ratio=4.19x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.879, Ratio=3.96x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.894, Ratio=4.16x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.896, Ratio=4.30x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.889, Ratio=4.31x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.887, Ratio=4.12x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.918, Ratio=4.42x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.906, Ratio=4.39x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.896, Ratio=4.36x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.903, Ratio=4.40x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.893, Ratio=4.22x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.880, Ratio=4.03x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.860, Ratio=3.96x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.898, Ratio=4.22x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.904, Ratio=4.29x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.895, Ratio=4.23x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.884, Ratio=4.17x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.887, Ratio=4.20x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.896, Ratio=4.04x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.905, Ratio=4.22x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.897, Ratio=4.24x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.909, Ratio=4.23x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.898, Ratio=4.24x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.897, Ratio=4.40x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.892, Ratio=4.16x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.899, Ratio=4.23x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.902, Ratio=4.21x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.886, Ratio=4.18x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.903, Ratio=4.37x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.908, Ratio=4.32x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.892, Ratio=4.28x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.894, Ratio=4.36x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.906, Ratio=4.52x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.885, Ratio=4.39x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.889, Ratio=4.19x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.891, Ratio=4.18x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.882, Ratio=4.23x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.894, Ratio=4.35x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.896, Ratio=4.33x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.884, Ratio=4.09x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.903, Ratio=4.27x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.894, Ratio=4.25x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.890, Ratio=4.21x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.883, Ratio=4.06x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.885, Ratio=4.13x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.903, Ratio=4.27x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.899, Ratio=4.37x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.885, Ratio=4.30x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.910, Ratio=4.31x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.892, Ratio=4.16x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.887, Ratio=4.23x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.886, Ratio=4.14x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.912, Ratio=4.33x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.894, Ratio=4.16x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.891, Ratio=4.22x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.893, Ratio=4.29x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.893, Ratio=4.20x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.883, Ratio=4.01x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.887, Ratio=4.05x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.908, Ratio=4.21x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.909, Ratio=4.44x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.897, Ratio=4.33x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.898, Ratio=4.27x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.901, Ratio=4.28x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.901, Ratio=4.24x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.877, Ratio=4.17x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.923, Ratio=4.40x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.888, Ratio=3.97x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.935, Ratio=4.63x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.914, Ratio=4.38x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.910, Ratio=4.18x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.879, Ratio=4.13x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.890, Ratio=4.19x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.893, Ratio=4.14x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.895, Ratio=4.30x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.910, Ratio=4.49x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.899, Ratio=4.22x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.901, Ratio=4.32x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.894, Ratio=4.15x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.892, Ratio=4.22x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.904, Ratio=4.28x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.884, Ratio=4.21x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.915, Ratio=4.47x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.879, Ratio=3.92x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.886, Ratio=4.08x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.900, Ratio=4.25x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.880, Ratio=4.07x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.928, Ratio=4.37x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.890, Ratio=4.28x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.913, Ratio=4.33x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.895, Ratio=4.10x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.889, Ratio=4.23x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.886, Ratio=4.24x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.912, Ratio=4.44x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.906, Ratio=4.39x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.895, Ratio=4.17x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.897, Ratio=4.22x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.873, Ratio=4.17x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.919, Ratio=4.30x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.887, Ratio=4.20x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.883, Ratio=4.15x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.878, Ratio=4.24x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.910, Ratio=4.22x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.894, Ratio=4.47x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.906, Ratio=4.35x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.873, Ratio=3.95x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.917, Ratio=4.44x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.881, Ratio=3.97x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.893, Ratio=4.14x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.919, Ratio=4.35x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.910, Ratio=4.31x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.901, Ratio=4.34x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.898, Ratio=4.19x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.891, Ratio=4.22x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.886, Ratio=4.09x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.896, Ratio=4.21x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.880, Ratio=4.10x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.892, Ratio=4.15x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.914, Ratio=4.23x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.897, Ratio=4.37x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.883, Ratio=4.11x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.885, Ratio=4.11x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.888, Ratio=4.18x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.881, Ratio=4.20x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.886, Ratio=4.16x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.891, Ratio=4.15x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.886, Ratio=4.19x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.921, Ratio=4.49x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.923, Ratio=4.49x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.919, Ratio=4.56x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.894, Ratio=4.17x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.908, Ratio=4.35x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.893, Ratio=4.14x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.907, Ratio=4.23x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.884, Ratio=4.26x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.917, Ratio=4.48x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.892, Ratio=4.20x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.917, Ratio=4.54x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.889, Ratio=4.14x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.885, Ratio=4.12x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.904, Ratio=4.22x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.916, Ratio=4.38x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.898, Ratio=4.32x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.880, Ratio=4.21x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.904, Ratio=4.20x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.898, Ratio=4.38x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.895, Ratio=4.16x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.917, Ratio=4.41x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.895, Ratio=4.05x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.888, Ratio=4.27x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.895, Ratio=4.23x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.916, Ratio=4.39x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.875, Ratio=3.98x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.874, Ratio=4.12x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.883, Ratio=4.04x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.890, Ratio=4.22x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.883, Ratio=4.02x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.878, Ratio=4.12x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.890, Ratio=4.11x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.893, Ratio=4.22x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.881, Ratio=4.15x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.885, Ratio=4.16x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.918, Ratio=4.54x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.895, Ratio=4.35x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.884, Ratio=4.12x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.902, Ratio=4.36x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.900, Ratio=4.13x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.910, Ratio=4.44x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.900, Ratio=4.30x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.910, Ratio=4.25x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.887, Ratio=4.07x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.893, Ratio=4.17x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.900, Ratio=4.29x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.888, Ratio=4.05x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.894, Ratio=4.35x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.892, Ratio=4.16x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.894, Ratio=4.28x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.908, Ratio=4.33x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.912, Ratio=4.29x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.910, Ratio=4.45x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.890, Ratio=4.25x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.910, Ratio=4.29x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.872, Ratio=4.01x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.895, Ratio=4.23x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.893, Ratio=4.28x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.894, Ratio=4.35x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.905, Ratio=4.20x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.890, Ratio=4.25x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.901, Ratio=4.40x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.911, Ratio=4.59x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.910, Ratio=4.25x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.901, Ratio=4.22x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.907, Ratio=4.33x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.904, Ratio=4.38x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.898, Ratio=4.25x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.906, Ratio=4.13x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.898, Ratio=4.27x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.906, Ratio=4.37x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.910, Ratio=4.42x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.877, Ratio=4.25x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.903, Ratio=4.32x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.899, Ratio=4.19x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.897, Ratio=4.14x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.870, Ratio=4.10x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.894, Ratio=4.07x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.890, Ratio=4.40x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.890, Ratio=4.25x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.892, Ratio=4.31x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.899, Ratio=4.30x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.876, Ratio=4.03x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.895, Ratio=4.28x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.887, Ratio=4.19x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.905, Ratio=4.49x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.906, Ratio=4.19x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.888, Ratio=4.14x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.913, Ratio=4.50x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.897, Ratio=4.19x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.891, Ratio=4.20x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.891, Ratio=4.34x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.892, Ratio=4.30x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.904, Ratio=4.25x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.907, Ratio=4.29x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.895, Ratio=4.28x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.886, Ratio=4.05x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.915, Ratio=4.36x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.879, Ratio=4.07x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.888, Ratio=4.19x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.895, Ratio=4.31x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.895, Ratio=4.31x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.881, Ratio=3.94x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.911, Ratio=4.29x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.883, Ratio=4.15x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.900, Ratio=4.25x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.898, Ratio=4.24x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.888, Ratio=4.15x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.898, Ratio=4.43x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.871, Ratio=3.92x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.905, Ratio=4.35x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.891, Ratio=4.13x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.907, Ratio=4.30x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.888, Ratio=4.11x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.903, Ratio=4.31x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.879, Ratio=4.02x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.894, Ratio=4.19x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.893, Ratio=4.16x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.885, Ratio=4.16x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.891, Ratio=4.18x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.890, Ratio=4.12x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.888, Ratio=4.10x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.894, Ratio=4.21x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.887, Ratio=4.25x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.885, Ratio=4.20x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.880, Ratio=4.10x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.898, Ratio=4.23x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.902, Ratio=4.27x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.896, Ratio=4.26x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.879, Ratio=4.11x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.904, Ratio=4.40x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.907, Ratio=4.36x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.912, Ratio=4.39x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.906, Ratio=4.44x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.892, Ratio=4.29x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.889, Ratio=4.37x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.906, Ratio=4.20x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.903, Ratio=4.34x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.882, Ratio=4.13x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.895, Ratio=4.19x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.906, Ratio=4.51x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.885, Ratio=4.12x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.890, Ratio=4.26x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.890, Ratio=4.23x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.902, Ratio=4.27x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.928, Ratio=4.66x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.884, Ratio=4.19x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.872, Ratio=4.01x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.889, Ratio=4.15x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.906, Ratio=4.29x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.870, Ratio=4.01x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.877, Ratio=4.04x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.891, Ratio=4.18x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.886, Ratio=4.31x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.898, Ratio=4.18x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.880, Ratio=4.12x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.886, Ratio=4.04x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.893, Ratio=4.23x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.920, Ratio=4.36x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.913, Ratio=4.35x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.884, Ratio=4.04x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.888, Ratio=4.13x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.893, Ratio=4.33x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.893, Ratio=4.24x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.894, Ratio=4.03x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.890, Ratio=4.07x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.899, Ratio=4.34x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.897, Ratio=4.41x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.890, Ratio=4.31x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.869, Ratio=4.00x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.888, Ratio=4.11x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.889, Ratio=4.09x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.873, Ratio=4.09x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.907, Ratio=4.27x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.918, Ratio=4.39x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.894, Ratio=4.26x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.909, Ratio=4.43x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.907, Ratio=4.37x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.900, Ratio=4.35x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.895, Ratio=4.25x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.898, Ratio=4.37x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.898, Ratio=4.46x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.893, Ratio=4.25x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.874, Ratio=3.99x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.900, Ratio=4.43x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.887, Ratio=4.18x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.883, Ratio=4.07x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.909, Ratio=4.33x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.901, Ratio=4.17x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.856, Ratio=3.90x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.896, Ratio=4.29x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.903, Ratio=4.41x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.906, Ratio=4.27x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.881, Ratio=4.04x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.894, Ratio=4.24x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.890, Ratio=4.11x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.894, Ratio=4.15x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.869, Ratio=4.00x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.907, Ratio=4.40x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.878, Ratio=4.00x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.870, Ratio=4.00x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.910, Ratio=4.25x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.892, Ratio=4.36x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.886, Ratio=4.24x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.922, Ratio=4.36x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.910, Ratio=4.39x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.893, Ratio=4.28x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.896, Ratio=4.36x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.913, Ratio=4.44x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.908, Ratio=4.38x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.884, Ratio=4.03x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.916, Ratio=4.43x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.900, Ratio=4.31x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.896, Ratio=4.26x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.889, Ratio=4.22x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.868, Ratio=4.04x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.912, Ratio=4.36x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.886, Ratio=4.02x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.894, Ratio=4.25x, Gap=-3.369

============================================================
Epoch 13/20 completed in 38.9s
Train: Loss=0.9464 (C:0.9464, R:0.0000) Ratio=3.36x
Val:   Loss=0.8918 (C:0.8918, R:0.0000) Ratio=4.24x
‚úÖ New best model saved (Val Loss: 0.8918)
============================================================

Epoch 14 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.882, Ratio=4.00x, Gap=-3.897
Batch   0/537: Loss=0.9256 (C:0.9256, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.892, Ratio=3.94x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.893, Ratio=4.02x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.915, Ratio=4.14x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.892, Ratio=3.98x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.892, Ratio=3.98x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.900, Ratio=4.08x, Gap=-4.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.897, Ratio=3.96x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.899, Ratio=4.04x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.870, Ratio=3.75x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.906, Ratio=4.04x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.891, Ratio=3.81x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.902, Ratio=4.11x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.894, Ratio=4.07x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.881, Ratio=3.77x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.885, Ratio=3.97x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.896, Ratio=3.94x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.879, Ratio=3.94x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.893, Ratio=4.03x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.882, Ratio=3.84x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.910, Ratio=4.06x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.896, Ratio=3.99x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.886, Ratio=4.08x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.883, Ratio=3.95x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.878, Ratio=3.87x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.879, Ratio=3.81x, Gap=-4.089
Batch  25/537: Loss=0.9495 (C:0.9495, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.856, Ratio=3.80x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.902, Ratio=4.09x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.882, Ratio=3.84x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.896, Ratio=3.80x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.887, Ratio=3.90x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.893, Ratio=3.91x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.896, Ratio=4.03x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.882, Ratio=3.71x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.882, Ratio=3.82x, Gap=-4.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.874, Ratio=3.71x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.900, Ratio=4.02x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.882, Ratio=3.87x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.879, Ratio=3.85x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.873, Ratio=3.71x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.904, Ratio=4.05x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.883, Ratio=3.61x, Gap=-4.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.883, Ratio=3.96x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.849, Ratio=3.74x, Gap=-4.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.870, Ratio=3.85x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.880, Ratio=3.86x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.906, Ratio=4.13x, Gap=-4.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.901, Ratio=4.03x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.884, Ratio=3.93x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.877, Ratio=3.82x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.892, Ratio=4.01x, Gap=-4.172
Batch  50/537: Loss=0.9181 (C:0.9181, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.898, Ratio=4.06x, Gap=-4.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.885, Ratio=3.81x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.868, Ratio=3.75x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.888, Ratio=3.90x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.894, Ratio=3.90x, Gap=-5.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.915, Ratio=4.04x, Gap=-4.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.880, Ratio=3.75x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.876, Ratio=3.87x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.916, Ratio=4.09x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.896, Ratio=3.89x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.871, Ratio=3.92x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.900, Ratio=3.98x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.883, Ratio=3.87x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.886, Ratio=3.90x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.889, Ratio=3.89x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.882, Ratio=3.80x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.892, Ratio=4.02x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.865, Ratio=3.77x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.886, Ratio=3.99x, Gap=-4.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.917, Ratio=4.26x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.913, Ratio=3.95x, Gap=-4.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.876, Ratio=3.79x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.908, Ratio=4.03x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.906, Ratio=4.04x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.918, Ratio=4.18x, Gap=-3.817
Batch  75/537: Loss=0.8992 (C:0.8992, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.895, Ratio=3.94x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.884, Ratio=3.82x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.875, Ratio=3.75x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.866, Ratio=3.91x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.878, Ratio=3.91x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.891, Ratio=4.00x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.908, Ratio=4.09x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.878, Ratio=3.94x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.879, Ratio=4.01x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.877, Ratio=3.77x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.870, Ratio=3.73x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.921, Ratio=4.20x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.890, Ratio=4.06x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.900, Ratio=3.98x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.893, Ratio=3.84x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.891, Ratio=3.77x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.903, Ratio=3.99x, Gap=-4.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.890, Ratio=3.83x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.871, Ratio=3.72x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.890, Ratio=3.84x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.901, Ratio=4.21x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.872, Ratio=3.77x, Gap=-4.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.897, Ratio=3.79x, Gap=-4.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.906, Ratio=4.11x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.870, Ratio=3.82x, Gap=-4.312
Batch 100/537: Loss=0.9496 (C:0.9496, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.890, Ratio=4.10x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.888, Ratio=3.96x, Gap=-4.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.900, Ratio=4.01x, Gap=-4.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.900, Ratio=4.17x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.902, Ratio=3.96x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.872, Ratio=3.66x, Gap=-4.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.891, Ratio=4.18x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.898, Ratio=4.06x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.877, Ratio=3.88x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.889, Ratio=3.97x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.874, Ratio=3.72x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.901, Ratio=4.11x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.878, Ratio=3.88x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.921, Ratio=4.09x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.900, Ratio=3.99x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.874, Ratio=3.80x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.903, Ratio=4.02x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.909, Ratio=3.97x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.877, Ratio=3.85x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.877, Ratio=3.75x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.880, Ratio=3.79x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.889, Ratio=3.81x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.880, Ratio=3.93x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.886, Ratio=3.74x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.905, Ratio=3.91x, Gap=-4.406
Batch 125/537: Loss=0.9376 (C:0.9376, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.876, Ratio=3.84x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.880, Ratio=3.80x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.843, Ratio=3.67x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.871, Ratio=3.90x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.890, Ratio=3.90x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.893, Ratio=4.11x, Gap=-4.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.881, Ratio=4.02x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.875, Ratio=3.71x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.884, Ratio=3.79x, Gap=-4.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.883, Ratio=3.89x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.920, Ratio=4.23x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.885, Ratio=3.71x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.855, Ratio=3.62x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.880, Ratio=3.88x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.861, Ratio=3.80x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.904, Ratio=4.05x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.870, Ratio=3.75x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.890, Ratio=3.81x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.870, Ratio=3.75x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.874, Ratio=3.99x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.891, Ratio=4.00x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.882, Ratio=3.70x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.883, Ratio=4.08x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.854, Ratio=3.77x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.864, Ratio=3.70x, Gap=-4.171
Batch 150/537: Loss=0.9708 (C:0.9708, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.879, Ratio=3.78x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.883, Ratio=3.87x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.873, Ratio=3.88x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.909, Ratio=4.04x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.888, Ratio=4.03x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.894, Ratio=3.88x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.880, Ratio=3.92x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.902, Ratio=3.92x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.921, Ratio=4.06x, Gap=-4.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.893, Ratio=3.95x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.887, Ratio=3.90x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.904, Ratio=4.02x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.885, Ratio=3.98x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.882, Ratio=4.00x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.881, Ratio=3.95x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.898, Ratio=4.05x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.880, Ratio=3.97x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.882, Ratio=3.93x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.881, Ratio=3.80x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.896, Ratio=3.89x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.883, Ratio=3.84x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.893, Ratio=3.88x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.893, Ratio=3.92x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.883, Ratio=3.71x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.903, Ratio=3.97x, Gap=-4.119
Batch 175/537: Loss=0.9255 (C:0.9255, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.894, Ratio=3.86x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.888, Ratio=3.78x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.881, Ratio=3.84x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.906, Ratio=4.03x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.864, Ratio=3.64x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.874, Ratio=3.87x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.889, Ratio=3.90x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.890, Ratio=3.96x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.903, Ratio=4.11x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.865, Ratio=3.70x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.894, Ratio=3.99x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.904, Ratio=3.92x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.887, Ratio=3.92x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.899, Ratio=3.98x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.869, Ratio=3.82x, Gap=-4.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.875, Ratio=3.82x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.869, Ratio=3.67x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.874, Ratio=3.80x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.893, Ratio=4.00x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.878, Ratio=3.88x, Gap=-4.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.896, Ratio=3.96x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.877, Ratio=3.96x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.890, Ratio=3.93x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.868, Ratio=3.78x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.860, Ratio=3.73x, Gap=-3.972
Batch 200/537: Loss=0.9638 (C:0.9638, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.859, Ratio=3.71x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.885, Ratio=3.85x, Gap=-4.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.892, Ratio=3.85x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.901, Ratio=4.01x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.906, Ratio=3.99x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.900, Ratio=3.84x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.871, Ratio=3.85x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.882, Ratio=3.88x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.882, Ratio=3.89x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.900, Ratio=4.01x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.878, Ratio=3.83x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.895, Ratio=3.95x, Gap=-4.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.915, Ratio=4.08x, Gap=-4.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.860, Ratio=3.83x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.885, Ratio=3.87x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.884, Ratio=3.94x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.892, Ratio=3.89x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.883, Ratio=3.77x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.865, Ratio=3.77x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.887, Ratio=4.01x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.871, Ratio=3.77x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.896, Ratio=4.12x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.889, Ratio=3.98x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.885, Ratio=3.90x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.868, Ratio=3.83x, Gap=-4.202
Batch 225/537: Loss=0.9481 (C:0.9481, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.879, Ratio=3.86x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.890, Ratio=4.02x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.880, Ratio=3.79x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.888, Ratio=3.91x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.879, Ratio=3.81x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.898, Ratio=3.80x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.909, Ratio=3.99x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.887, Ratio=3.95x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.892, Ratio=3.83x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.890, Ratio=3.92x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.873, Ratio=3.77x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.882, Ratio=3.76x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.889, Ratio=3.86x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.870, Ratio=3.71x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.910, Ratio=4.07x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.884, Ratio=3.87x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.865, Ratio=3.89x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.871, Ratio=3.70x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.889, Ratio=3.75x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.890, Ratio=4.04x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.885, Ratio=3.83x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.881, Ratio=3.90x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.899, Ratio=4.00x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.872, Ratio=3.90x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.903, Ratio=4.02x, Gap=-4.154
Batch 250/537: Loss=0.9171 (C:0.9171, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.862, Ratio=3.74x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.888, Ratio=3.78x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.911, Ratio=3.96x, Gap=-4.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.873, Ratio=3.83x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.887, Ratio=4.02x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.892, Ratio=4.08x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.884, Ratio=3.95x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.901, Ratio=3.93x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.871, Ratio=3.85x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.912, Ratio=3.99x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.911, Ratio=4.08x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.872, Ratio=3.80x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.876, Ratio=3.86x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.885, Ratio=3.85x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.874, Ratio=3.89x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.883, Ratio=3.83x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.886, Ratio=3.87x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.864, Ratio=3.75x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.854, Ratio=3.79x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.860, Ratio=3.77x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.893, Ratio=3.84x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.864, Ratio=3.66x, Gap=-4.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.894, Ratio=3.85x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.886, Ratio=3.73x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.889, Ratio=4.03x, Gap=-3.624
Batch 275/537: Loss=0.9191 (C:0.9191, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.888, Ratio=3.94x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.904, Ratio=3.92x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.887, Ratio=3.89x, Gap=-4.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.886, Ratio=3.78x, Gap=-4.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.887, Ratio=3.81x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.895, Ratio=3.78x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.868, Ratio=3.83x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.878, Ratio=3.81x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.909, Ratio=3.97x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.894, Ratio=4.01x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.885, Ratio=3.93x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.881, Ratio=4.02x, Gap=-4.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.890, Ratio=4.16x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.883, Ratio=3.78x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.868, Ratio=3.80x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.870, Ratio=3.78x, Gap=-4.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.860, Ratio=3.62x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.866, Ratio=3.74x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.881, Ratio=3.88x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.897, Ratio=3.98x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.907, Ratio=3.99x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.855, Ratio=3.67x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.898, Ratio=3.96x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.908, Ratio=4.05x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.878, Ratio=3.66x, Gap=-3.979
Batch 300/537: Loss=0.9757 (C:0.9757, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.904, Ratio=3.82x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.906, Ratio=3.92x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.895, Ratio=3.86x, Gap=-4.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.884, Ratio=3.92x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.876, Ratio=3.93x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.884, Ratio=4.05x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.880, Ratio=3.85x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.898, Ratio=3.91x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.864, Ratio=3.81x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.868, Ratio=3.83x, Gap=-4.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.860, Ratio=3.77x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.914, Ratio=4.14x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.885, Ratio=3.79x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.888, Ratio=3.94x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.888, Ratio=3.90x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.911, Ratio=3.95x, Gap=-4.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.892, Ratio=4.07x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.908, Ratio=3.96x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.874, Ratio=3.82x, Gap=-4.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.901, Ratio=4.03x, Gap=-4.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.889, Ratio=3.89x, Gap=-4.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.887, Ratio=3.86x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.895, Ratio=3.93x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.894, Ratio=4.01x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.883, Ratio=3.88x, Gap=-4.067
Batch 325/537: Loss=0.9379 (C:0.9379, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.887, Ratio=3.92x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.869, Ratio=3.79x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.881, Ratio=3.61x, Gap=-4.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.880, Ratio=3.84x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.889, Ratio=3.83x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.896, Ratio=3.79x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.894, Ratio=3.80x, Gap=-4.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.890, Ratio=3.99x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.880, Ratio=3.96x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.870, Ratio=3.72x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.888, Ratio=3.92x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.890, Ratio=3.86x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.880, Ratio=3.65x, Gap=-4.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.887, Ratio=3.85x, Gap=-4.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.894, Ratio=4.06x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.865, Ratio=3.72x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.864, Ratio=3.74x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.902, Ratio=3.88x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.893, Ratio=4.04x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.892, Ratio=4.07x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.878, Ratio=3.87x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.869, Ratio=3.68x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.867, Ratio=3.82x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.873, Ratio=3.80x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.873, Ratio=3.84x, Gap=-3.972
Batch 350/537: Loss=0.9463 (C:0.9463, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.872, Ratio=3.75x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.875, Ratio=3.91x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.900, Ratio=3.99x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.871, Ratio=3.75x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.894, Ratio=3.79x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.887, Ratio=3.92x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.870, Ratio=3.85x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.887, Ratio=3.79x, Gap=-4.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.880, Ratio=4.06x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.882, Ratio=3.84x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.873, Ratio=3.72x, Gap=-4.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.905, Ratio=4.13x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.884, Ratio=3.79x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.864, Ratio=3.70x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.871, Ratio=3.84x, Gap=-4.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.874, Ratio=3.86x, Gap=-4.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.890, Ratio=4.01x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.901, Ratio=3.96x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.890, Ratio=3.95x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.883, Ratio=3.92x, Gap=-4.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.876, Ratio=3.93x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.887, Ratio=3.84x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.888, Ratio=3.89x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.863, Ratio=3.77x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.904, Ratio=4.02x, Gap=-3.904
Batch 375/537: Loss=0.9158 (C:0.9158, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.901, Ratio=3.92x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.898, Ratio=3.95x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.881, Ratio=3.84x, Gap=-4.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.901, Ratio=4.03x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.898, Ratio=3.98x, Gap=-4.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.885, Ratio=3.85x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.895, Ratio=3.84x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.870, Ratio=3.77x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.894, Ratio=3.98x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.886, Ratio=3.82x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.875, Ratio=3.85x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.860, Ratio=3.82x, Gap=-4.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.892, Ratio=3.89x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.875, Ratio=3.85x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.859, Ratio=3.70x, Gap=-4.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.869, Ratio=3.82x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.869, Ratio=3.80x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.878, Ratio=3.77x, Gap=-4.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.894, Ratio=4.00x, Gap=-4.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.880, Ratio=3.63x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.904, Ratio=3.87x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.881, Ratio=3.80x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.882, Ratio=3.78x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.876, Ratio=3.74x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.876, Ratio=3.89x, Gap=-3.960
Batch 400/537: Loss=0.9392 (C:0.9392, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.854, Ratio=3.70x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.915, Ratio=4.04x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.907, Ratio=4.05x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.898, Ratio=4.01x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.906, Ratio=4.03x, Gap=-4.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.883, Ratio=3.84x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.891, Ratio=3.97x, Gap=-4.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.871, Ratio=3.64x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.877, Ratio=3.87x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.892, Ratio=3.74x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.870, Ratio=3.69x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.869, Ratio=3.68x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.861, Ratio=3.77x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.872, Ratio=3.80x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.867, Ratio=3.70x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.863, Ratio=3.76x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.883, Ratio=3.84x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.887, Ratio=3.92x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.886, Ratio=3.85x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.914, Ratio=3.98x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.893, Ratio=3.79x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.886, Ratio=3.89x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.917, Ratio=4.17x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.883, Ratio=3.89x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.898, Ratio=3.99x, Gap=-4.516
Batch 425/537: Loss=0.9206 (C:0.9206, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.894, Ratio=3.84x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.888, Ratio=3.90x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.873, Ratio=3.72x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.903, Ratio=3.96x, Gap=-4.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.881, Ratio=3.72x, Gap=-4.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.896, Ratio=4.01x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.877, Ratio=3.80x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.890, Ratio=3.94x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.867, Ratio=3.74x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.868, Ratio=3.80x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.885, Ratio=3.83x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.891, Ratio=3.95x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.875, Ratio=3.78x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.879, Ratio=3.74x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.876, Ratio=3.86x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.903, Ratio=3.97x, Gap=-4.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.894, Ratio=3.95x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.917, Ratio=4.12x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.893, Ratio=3.91x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.889, Ratio=3.85x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.894, Ratio=3.84x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.862, Ratio=3.72x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.903, Ratio=4.09x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.885, Ratio=3.75x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.901, Ratio=3.92x, Gap=-4.653
Batch 450/537: Loss=0.9347 (C:0.9347, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.865, Ratio=3.70x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.886, Ratio=3.88x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.879, Ratio=3.85x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.861, Ratio=3.75x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.887, Ratio=3.83x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.881, Ratio=3.91x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.879, Ratio=3.79x, Gap=-4.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.866, Ratio=3.79x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.877, Ratio=3.77x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.880, Ratio=3.87x, Gap=-4.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.894, Ratio=3.98x, Gap=-4.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.889, Ratio=3.88x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.877, Ratio=3.77x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.883, Ratio=3.93x, Gap=-4.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.896, Ratio=3.96x, Gap=-4.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.887, Ratio=3.69x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.859, Ratio=3.56x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.895, Ratio=3.89x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.906, Ratio=3.77x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.881, Ratio=3.77x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.868, Ratio=3.67x, Gap=-4.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.875, Ratio=3.86x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.872, Ratio=3.87x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.858, Ratio=3.65x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.888, Ratio=3.92x, Gap=-4.510
Batch 475/537: Loss=0.9344 (C:0.9344, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.874, Ratio=3.86x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.879, Ratio=3.90x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.884, Ratio=3.98x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.880, Ratio=3.77x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.875, Ratio=3.70x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.887, Ratio=3.85x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.894, Ratio=3.97x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.900, Ratio=3.92x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.869, Ratio=3.69x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.892, Ratio=3.88x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.894, Ratio=3.93x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.890, Ratio=3.99x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.861, Ratio=3.73x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.871, Ratio=3.74x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.878, Ratio=3.95x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.889, Ratio=3.90x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.864, Ratio=3.77x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.871, Ratio=3.89x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.883, Ratio=3.95x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.883, Ratio=3.96x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.891, Ratio=3.88x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.889, Ratio=3.75x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.907, Ratio=4.01x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.893, Ratio=3.82x, Gap=-5.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.868, Ratio=3.91x, Gap=-4.258
Batch 500/537: Loss=0.9369 (C:0.9369, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.870, Ratio=3.87x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.876, Ratio=3.73x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.868, Ratio=3.75x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.870, Ratio=3.79x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.889, Ratio=3.83x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.874, Ratio=3.92x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.872, Ratio=3.70x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.869, Ratio=3.80x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.864, Ratio=3.76x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.887, Ratio=4.03x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.880, Ratio=3.80x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.857, Ratio=3.66x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.882, Ratio=3.90x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.890, Ratio=3.80x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.885, Ratio=3.91x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.900, Ratio=4.10x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.884, Ratio=3.87x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.892, Ratio=3.81x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.880, Ratio=3.93x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.895, Ratio=4.08x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.878, Ratio=3.89x, Gap=-4.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.883, Ratio=3.90x, Gap=-4.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.854, Ratio=3.80x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.890, Ratio=3.86x, Gap=-4.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.887, Ratio=3.85x, Gap=-3.902
Batch 525/537: Loss=0.9443 (C:0.9443, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.873, Ratio=3.66x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.895, Ratio=4.01x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.882, Ratio=3.79x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.868, Ratio=3.76x, Gap=-4.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.893, Ratio=3.81x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.893, Ratio=3.85x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.879, Ratio=3.77x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.877, Ratio=3.89x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.865, Ratio=3.82x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.884, Ratio=3.92x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.878, Ratio=3.82x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.929, Ratio=4.63x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.903, Ratio=4.15x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.899, Ratio=4.29x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.891, Ratio=4.33x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.910, Ratio=4.43x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.888, Ratio=4.19x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.894, Ratio=4.29x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.883, Ratio=4.26x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.891, Ratio=4.31x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.909, Ratio=4.45x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.895, Ratio=4.40x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.902, Ratio=4.35x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.894, Ratio=4.23x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.896, Ratio=4.27x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.908, Ratio=4.45x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.904, Ratio=4.25x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.909, Ratio=4.30x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.876, Ratio=4.12x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.887, Ratio=4.25x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.897, Ratio=4.43x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.900, Ratio=4.36x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.878, Ratio=4.12x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.906, Ratio=4.34x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.885, Ratio=4.22x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.881, Ratio=4.11x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.892, Ratio=4.26x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.893, Ratio=4.18x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.896, Ratio=4.32x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.902, Ratio=4.29x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.881, Ratio=4.08x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.891, Ratio=4.16x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.885, Ratio=4.10x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.895, Ratio=4.36x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.881, Ratio=4.14x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.904, Ratio=4.38x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.908, Ratio=4.45x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.909, Ratio=4.27x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.902, Ratio=4.46x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.894, Ratio=4.26x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.899, Ratio=4.40x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.914, Ratio=4.55x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.890, Ratio=4.19x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.909, Ratio=4.42x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.902, Ratio=4.45x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.886, Ratio=4.33x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.868, Ratio=4.07x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.914, Ratio=4.33x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.904, Ratio=4.44x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.896, Ratio=4.36x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.885, Ratio=4.14x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.890, Ratio=4.19x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.908, Ratio=4.27x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.894, Ratio=4.26x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.901, Ratio=4.45x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.885, Ratio=4.04x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.881, Ratio=4.26x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.893, Ratio=4.22x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.908, Ratio=4.46x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.887, Ratio=4.30x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.902, Ratio=4.41x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.880, Ratio=4.09x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.894, Ratio=4.28x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.890, Ratio=4.23x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.898, Ratio=4.18x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.898, Ratio=4.25x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.898, Ratio=4.16x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.862, Ratio=4.02x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.902, Ratio=4.39x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.894, Ratio=4.25x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.886, Ratio=4.28x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.908, Ratio=4.41x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.896, Ratio=4.43x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.915, Ratio=4.41x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.906, Ratio=4.20x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.892, Ratio=4.27x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.881, Ratio=4.23x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.902, Ratio=4.51x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.880, Ratio=4.24x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.885, Ratio=4.28x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.890, Ratio=4.07x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.907, Ratio=4.22x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.901, Ratio=4.23x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.912, Ratio=4.49x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.905, Ratio=4.41x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.881, Ratio=4.15x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.897, Ratio=4.32x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.893, Ratio=4.22x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.917, Ratio=4.46x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.915, Ratio=4.49x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.907, Ratio=4.29x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.899, Ratio=4.36x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.886, Ratio=4.12x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.894, Ratio=4.30x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.390, Neg=1.932, Ratio=4.95x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.913, Ratio=4.66x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.888, Ratio=4.34x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.895, Ratio=4.36x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.907, Ratio=4.45x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.883, Ratio=4.28x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.877, Ratio=4.05x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.880, Ratio=4.14x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.887, Ratio=4.14x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.909, Ratio=4.51x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.902, Ratio=4.36x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.893, Ratio=4.34x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.899, Ratio=4.35x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.912, Ratio=4.32x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.914, Ratio=4.37x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.925, Ratio=4.52x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.880, Ratio=4.10x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.873, Ratio=4.11x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.918, Ratio=4.33x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.874, Ratio=4.17x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.916, Ratio=4.51x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.917, Ratio=4.25x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.884, Ratio=4.31x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.917, Ratio=4.56x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.895, Ratio=4.25x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.883, Ratio=4.19x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.914, Ratio=4.49x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.888, Ratio=4.21x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.901, Ratio=4.25x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.898, Ratio=4.37x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.886, Ratio=4.28x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.912, Ratio=4.38x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.872, Ratio=4.11x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.908, Ratio=4.37x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.913, Ratio=4.43x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.890, Ratio=4.34x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.862, Ratio=4.01x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.917, Ratio=4.67x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.904, Ratio=4.32x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.889, Ratio=4.21x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.884, Ratio=4.20x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.877, Ratio=4.19x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.923, Ratio=4.55x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.868, Ratio=4.16x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.897, Ratio=4.26x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.903, Ratio=4.53x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.900, Ratio=4.36x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.874, Ratio=4.20x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.924, Ratio=4.64x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.918, Ratio=4.40x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.898, Ratio=4.22x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.886, Ratio=4.30x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.887, Ratio=4.13x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.873, Ratio=4.11x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.902, Ratio=4.24x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.916, Ratio=4.55x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.899, Ratio=4.31x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.910, Ratio=4.40x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.901, Ratio=4.33x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.889, Ratio=4.21x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.888, Ratio=4.10x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.876, Ratio=4.09x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.886, Ratio=4.27x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.886, Ratio=4.29x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.907, Ratio=4.40x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.891, Ratio=4.29x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.893, Ratio=4.21x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.888, Ratio=4.20x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.907, Ratio=4.36x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.879, Ratio=4.22x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.908, Ratio=4.52x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.888, Ratio=4.22x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.875, Ratio=4.16x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.895, Ratio=4.29x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.895, Ratio=4.33x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.899, Ratio=4.30x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.898, Ratio=4.39x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.885, Ratio=4.18x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.904, Ratio=4.37x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.892, Ratio=4.06x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.873, Ratio=4.06x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.900, Ratio=4.25x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.876, Ratio=4.06x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.908, Ratio=4.44x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.897, Ratio=4.55x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.914, Ratio=4.47x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.891, Ratio=4.37x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.888, Ratio=4.10x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.888, Ratio=4.40x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.907, Ratio=4.30x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.866, Ratio=4.13x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.889, Ratio=4.21x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.882, Ratio=4.31x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.901, Ratio=4.35x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.908, Ratio=4.48x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.891, Ratio=4.39x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.883, Ratio=4.18x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.904, Ratio=4.52x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.896, Ratio=4.40x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.917, Ratio=4.55x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.879, Ratio=4.18x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.876, Ratio=4.24x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.919, Ratio=4.52x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.882, Ratio=4.20x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.881, Ratio=4.24x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.911, Ratio=4.41x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.905, Ratio=4.45x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.897, Ratio=4.52x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.908, Ratio=4.31x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.892, Ratio=4.34x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.888, Ratio=4.17x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.886, Ratio=4.26x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.913, Ratio=4.37x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.920, Ratio=4.54x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.886, Ratio=4.30x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.920, Ratio=4.39x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.912, Ratio=4.49x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.898, Ratio=4.21x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.883, Ratio=4.10x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.919, Ratio=4.69x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.896, Ratio=4.35x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.872, Ratio=4.05x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.902, Ratio=4.34x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.899, Ratio=4.27x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.911, Ratio=4.22x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.914, Ratio=4.56x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.883, Ratio=4.17x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.895, Ratio=4.24x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.877, Ratio=4.24x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.891, Ratio=4.19x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.903, Ratio=4.37x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.887, Ratio=4.26x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.908, Ratio=4.46x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.874, Ratio=4.18x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.900, Ratio=4.44x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.913, Ratio=4.50x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.901, Ratio=4.37x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.887, Ratio=4.16x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.881, Ratio=4.13x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.891, Ratio=4.23x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.893, Ratio=4.15x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.875, Ratio=4.08x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.883, Ratio=4.29x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.868, Ratio=3.98x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.902, Ratio=4.43x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.901, Ratio=4.45x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.909, Ratio=4.60x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.892, Ratio=4.27x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.899, Ratio=4.35x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.899, Ratio=4.17x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.918, Ratio=4.65x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.908, Ratio=4.50x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.902, Ratio=4.34x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.896, Ratio=4.36x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.911, Ratio=4.47x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.889, Ratio=4.30x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.878, Ratio=4.04x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.927, Ratio=4.55x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.872, Ratio=4.04x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.910, Ratio=4.31x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.889, Ratio=4.46x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.891, Ratio=4.34x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.883, Ratio=4.25x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.902, Ratio=4.55x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.924, Ratio=4.70x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.866, Ratio=4.09x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.887, Ratio=4.11x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.893, Ratio=4.14x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.892, Ratio=4.37x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.883, Ratio=4.12x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.885, Ratio=4.33x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.913, Ratio=4.41x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.901, Ratio=4.27x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.892, Ratio=4.22x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.877, Ratio=4.08x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.899, Ratio=4.35x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.886, Ratio=4.35x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.871, Ratio=4.13x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.894, Ratio=4.25x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.896, Ratio=4.36x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.900, Ratio=4.35x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.901, Ratio=4.41x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.900, Ratio=4.32x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.883, Ratio=4.11x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.893, Ratio=4.30x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.894, Ratio=4.25x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.908, Ratio=4.36x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.883, Ratio=4.12x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.915, Ratio=4.41x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.909, Ratio=4.54x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.903, Ratio=4.24x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.879, Ratio=4.27x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.901, Ratio=4.30x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.897, Ratio=4.31x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.883, Ratio=4.33x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.916, Ratio=4.50x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.896, Ratio=4.28x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.893, Ratio=4.46x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.914, Ratio=4.49x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.890, Ratio=4.39x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.897, Ratio=4.20x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.871, Ratio=4.18x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.892, Ratio=4.38x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.901, Ratio=4.24x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.896, Ratio=4.42x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.890, Ratio=4.21x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.908, Ratio=4.38x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.881, Ratio=4.15x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.877, Ratio=4.00x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.909, Ratio=4.52x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.908, Ratio=4.47x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.890, Ratio=4.27x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.885, Ratio=4.27x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.895, Ratio=4.32x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.896, Ratio=4.25x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.865, Ratio=3.96x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.904, Ratio=4.30x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.895, Ratio=4.33x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.872, Ratio=4.10x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.898, Ratio=4.24x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.889, Ratio=4.27x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.877, Ratio=4.17x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.928, Ratio=4.68x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.884, Ratio=4.12x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.895, Ratio=4.26x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.899, Ratio=4.34x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.893, Ratio=4.26x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.881, Ratio=4.36x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.912, Ratio=4.50x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.890, Ratio=4.18x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.897, Ratio=4.43x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.899, Ratio=4.47x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.910, Ratio=4.28x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.895, Ratio=4.29x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.901, Ratio=4.39x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.889, Ratio=4.30x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.887, Ratio=4.25x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.894, Ratio=4.31x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.891, Ratio=4.26x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.876, Ratio=4.10x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.898, Ratio=4.34x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.892, Ratio=4.30x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.911, Ratio=4.50x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.892, Ratio=4.35x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.885, Ratio=4.18x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.894, Ratio=4.22x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.915, Ratio=4.34x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.925, Ratio=4.56x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.906, Ratio=4.41x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.898, Ratio=4.44x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.883, Ratio=4.23x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.876, Ratio=4.13x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.882, Ratio=4.17x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.889, Ratio=4.39x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.909, Ratio=4.43x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.905, Ratio=4.32x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.883, Ratio=4.06x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.922, Ratio=4.55x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.883, Ratio=4.18x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.879, Ratio=4.14x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.887, Ratio=4.16x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.897, Ratio=4.38x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.883, Ratio=4.25x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.888, Ratio=4.22x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.879, Ratio=4.17x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.925, Ratio=4.65x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.888, Ratio=4.24x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.899, Ratio=4.36x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.871, Ratio=4.16x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.886, Ratio=4.16x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.885, Ratio=4.25x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.884, Ratio=4.41x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.900, Ratio=4.41x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.890, Ratio=4.20x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.900, Ratio=4.18x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.901, Ratio=4.32x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.894, Ratio=4.29x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.895, Ratio=4.40x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.868, Ratio=4.26x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.920, Ratio=4.51x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.903, Ratio=4.22x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.896, Ratio=4.16x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.889, Ratio=4.27x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.880, Ratio=4.10x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.898, Ratio=4.35x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.898, Ratio=4.37x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.890, Ratio=4.31x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.904, Ratio=4.27x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.921, Ratio=4.50x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.892, Ratio=4.39x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.892, Ratio=4.33x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.898, Ratio=4.35x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.900, Ratio=4.28x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.885, Ratio=4.10x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.900, Ratio=4.43x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.934, Ratio=4.67x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.897, Ratio=4.32x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.904, Ratio=4.32x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.891, Ratio=4.27x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.894, Ratio=4.37x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.904, Ratio=4.41x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.871, Ratio=4.22x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.886, Ratio=4.17x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.916, Ratio=4.48x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.891, Ratio=4.20x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.884, Ratio=4.46x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.885, Ratio=4.28x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.888, Ratio=4.17x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.906, Ratio=4.55x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.927, Ratio=4.70x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.870, Ratio=4.09x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.881, Ratio=4.12x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.880, Ratio=4.10x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.884, Ratio=4.20x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.912, Ratio=4.56x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.887, Ratio=4.11x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.887, Ratio=3.94x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.919, Ratio=4.47x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.884, Ratio=4.15x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.907, Ratio=4.36x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.913, Ratio=4.45x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.898, Ratio=4.27x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.888, Ratio=4.23x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.889, Ratio=4.21x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.884, Ratio=4.13x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.893, Ratio=4.18x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.921, Ratio=4.57x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.878, Ratio=4.20x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.882, Ratio=4.21x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.911, Ratio=4.33x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.882, Ratio=4.21x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.887, Ratio=4.11x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.894, Ratio=4.36x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.890, Ratio=4.16x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.917, Ratio=4.45x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.883, Ratio=4.16x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.886, Ratio=4.32x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.892, Ratio=4.38x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.910, Ratio=4.56x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.923, Ratio=4.51x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.897, Ratio=4.25x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.891, Ratio=4.24x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.910, Ratio=4.37x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.880, Ratio=4.06x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.906, Ratio=4.31x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.878, Ratio=4.15x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.891, Ratio=4.37x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.912, Ratio=4.43x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.901, Ratio=4.39x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.893, Ratio=4.26x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.911, Ratio=4.56x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.873, Ratio=4.25x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.901, Ratio=4.58x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.902, Ratio=4.36x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.887, Ratio=4.33x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.891, Ratio=4.17x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.901, Ratio=4.25x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.911, Ratio=4.45x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.898, Ratio=4.24x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.888, Ratio=4.23x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.895, Ratio=4.29x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.912, Ratio=4.48x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.895, Ratio=4.27x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.882, Ratio=4.12x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.892, Ratio=4.33x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.913, Ratio=4.45x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.905, Ratio=4.33x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.889, Ratio=4.33x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.875, Ratio=4.15x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.921, Ratio=4.51x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.897, Ratio=4.35x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.903, Ratio=4.28x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.877, Ratio=4.14x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.905, Ratio=4.34x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.880, Ratio=4.11x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.897, Ratio=4.31x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.880, Ratio=4.17x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.903, Ratio=4.35x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.900, Ratio=4.37x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.872, Ratio=4.08x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.874, Ratio=4.18x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.907, Ratio=4.51x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.900, Ratio=4.27x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.890, Ratio=4.21x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.896, Ratio=4.11x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.899, Ratio=4.29x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.898, Ratio=4.35x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.909, Ratio=4.34x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.908, Ratio=4.31x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.915, Ratio=4.37x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.902, Ratio=4.33x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.886, Ratio=4.12x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.905, Ratio=4.33x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.895, Ratio=4.19x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.898, Ratio=4.38x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.916, Ratio=4.43x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.900, Ratio=4.42x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.918, Ratio=4.59x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.892, Ratio=4.14x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.904, Ratio=4.47x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.893, Ratio=4.23x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.901, Ratio=4.48x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.893, Ratio=4.27x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.910, Ratio=4.38x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.877, Ratio=4.11x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.915, Ratio=4.44x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.894, Ratio=4.18x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.886, Ratio=4.23x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.901, Ratio=4.23x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.888, Ratio=4.21x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.904, Ratio=4.34x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.903, Ratio=4.35x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.895, Ratio=4.30x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.906, Ratio=4.40x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.883, Ratio=4.12x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.898, Ratio=4.26x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.893, Ratio=4.27x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.884, Ratio=4.17x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.902, Ratio=4.27x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.880, Ratio=4.05x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.887, Ratio=4.12x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.908, Ratio=4.31x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.863, Ratio=4.03x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.907, Ratio=4.27x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.883, Ratio=4.13x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.883, Ratio=4.35x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.897, Ratio=4.22x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.897, Ratio=4.51x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.877, Ratio=4.13x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.879, Ratio=4.24x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.874, Ratio=4.02x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.885, Ratio=4.23x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.904, Ratio=4.33x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.898, Ratio=4.47x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.909, Ratio=4.42x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.884, Ratio=4.22x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.904, Ratio=4.40x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.908, Ratio=4.54x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.912, Ratio=4.36x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.901, Ratio=4.33x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.900, Ratio=4.33x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.902, Ratio=4.35x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.898, Ratio=4.51x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.867, Ratio=4.06x, Gap=-3.409

============================================================
Epoch 14/20 completed in 32.2s
Train: Loss=0.9406 (C:0.9406, R:0.0000) Ratio=3.52x
Val:   Loss=0.8848 (C:0.8848, R:0.0000) Ratio=4.36x
‚úÖ New best model saved (Val Loss: 0.8848)
============================================================

Epoch 15 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.884, Ratio=3.84x, Gap=-4.189
Batch   0/537: Loss=0.9474 (C:0.9474, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.877, Ratio=3.80x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.899, Ratio=4.08x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.865, Ratio=3.86x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.911, Ratio=4.09x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.909, Ratio=4.08x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.879, Ratio=3.78x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.897, Ratio=4.09x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.888, Ratio=3.88x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.897, Ratio=3.85x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.868, Ratio=3.70x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.892, Ratio=3.85x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.915, Ratio=4.15x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.889, Ratio=3.96x, Gap=-4.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.911, Ratio=4.00x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.901, Ratio=4.01x, Gap=-4.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.869, Ratio=3.84x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.872, Ratio=3.87x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.871, Ratio=3.68x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.889, Ratio=3.91x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.878, Ratio=3.98x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.905, Ratio=4.09x, Gap=-4.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.872, Ratio=3.89x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.882, Ratio=3.91x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.890, Ratio=4.05x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.914, Ratio=4.09x, Gap=-4.004
Batch  25/537: Loss=0.9094 (C:0.9094, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.890, Ratio=3.92x, Gap=-4.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.908, Ratio=3.92x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.904, Ratio=4.07x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.890, Ratio=4.05x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.886, Ratio=3.91x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.885, Ratio=3.81x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.875, Ratio=3.82x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.886, Ratio=3.98x, Gap=-4.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.854, Ratio=3.73x, Gap=-4.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.911, Ratio=4.05x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.909, Ratio=4.12x, Gap=-4.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.896, Ratio=3.97x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.888, Ratio=3.94x, Gap=-4.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.906, Ratio=3.94x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.904, Ratio=3.99x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.888, Ratio=3.92x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.898, Ratio=4.11x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.883, Ratio=4.07x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.863, Ratio=3.77x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.917, Ratio=4.16x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.882, Ratio=3.94x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.888, Ratio=3.90x, Gap=-4.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.890, Ratio=3.95x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.868, Ratio=3.75x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.881, Ratio=3.83x, Gap=-4.031
Batch  50/537: Loss=0.9489 (C:0.9489, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.876, Ratio=3.80x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.915, Ratio=4.13x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.896, Ratio=3.99x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.896, Ratio=4.05x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.882, Ratio=4.00x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.880, Ratio=3.94x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.875, Ratio=3.85x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.887, Ratio=3.94x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.918, Ratio=4.17x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.879, Ratio=3.87x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.900, Ratio=4.00x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.884, Ratio=3.86x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.904, Ratio=3.93x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.888, Ratio=4.02x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.896, Ratio=3.84x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.896, Ratio=3.86x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.916, Ratio=4.17x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.908, Ratio=4.02x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.893, Ratio=3.86x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.901, Ratio=4.14x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.907, Ratio=4.09x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.890, Ratio=3.89x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.900, Ratio=4.05x, Gap=-4.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.883, Ratio=3.88x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.883, Ratio=3.87x, Gap=-4.246
Batch  75/537: Loss=0.9410 (C:0.9410, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.902, Ratio=4.08x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.860, Ratio=3.80x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.913, Ratio=4.08x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.915, Ratio=3.93x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.909, Ratio=4.03x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.880, Ratio=3.79x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.877, Ratio=3.72x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.908, Ratio=4.17x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.871, Ratio=3.71x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.893, Ratio=4.00x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.916, Ratio=4.14x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.913, Ratio=3.97x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.902, Ratio=3.94x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.885, Ratio=3.95x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.867, Ratio=3.76x, Gap=-4.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.878, Ratio=3.93x, Gap=-4.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.880, Ratio=3.92x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.900, Ratio=4.05x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.889, Ratio=3.83x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.888, Ratio=3.93x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.896, Ratio=3.97x, Gap=-4.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.873, Ratio=3.82x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.875, Ratio=3.82x, Gap=-4.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.881, Ratio=3.88x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.867, Ratio=3.82x, Gap=-3.884
Batch 100/537: Loss=0.9497 (C:0.9497, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.908, Ratio=3.99x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.882, Ratio=3.92x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.896, Ratio=4.22x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.884, Ratio=3.82x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.899, Ratio=4.07x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.916, Ratio=4.00x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.888, Ratio=4.00x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.863, Ratio=3.68x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.875, Ratio=3.98x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.910, Ratio=3.98x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.901, Ratio=4.09x, Gap=-4.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.891, Ratio=3.87x, Gap=-4.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.874, Ratio=3.85x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.897, Ratio=4.04x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.869, Ratio=3.78x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.887, Ratio=3.96x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.889, Ratio=3.91x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.903, Ratio=3.93x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.876, Ratio=3.91x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.881, Ratio=3.81x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.880, Ratio=3.85x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.890, Ratio=3.85x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.874, Ratio=3.74x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.904, Ratio=3.99x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.893, Ratio=3.92x, Gap=-4.453
Batch 125/537: Loss=0.9322 (C:0.9322, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.892, Ratio=3.94x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.889, Ratio=3.87x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.902, Ratio=4.08x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.873, Ratio=3.72x, Gap=-4.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.890, Ratio=3.98x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.870, Ratio=3.90x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.886, Ratio=3.78x, Gap=-4.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.869, Ratio=3.83x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.896, Ratio=4.16x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.892, Ratio=3.84x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.895, Ratio=3.96x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.905, Ratio=4.01x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.886, Ratio=3.77x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.896, Ratio=3.93x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.890, Ratio=3.86x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.889, Ratio=3.80x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.902, Ratio=3.90x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.916, Ratio=4.08x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.909, Ratio=3.98x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.898, Ratio=4.07x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.902, Ratio=4.11x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.904, Ratio=3.89x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.888, Ratio=3.94x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.896, Ratio=3.96x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.866, Ratio=3.92x, Gap=-3.751
Batch 150/537: Loss=0.9350 (C:0.9350, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.886, Ratio=4.04x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.873, Ratio=3.75x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.901, Ratio=3.94x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.867, Ratio=3.71x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.886, Ratio=3.88x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.901, Ratio=3.93x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.890, Ratio=3.91x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.891, Ratio=3.92x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.896, Ratio=3.88x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.913, Ratio=4.07x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.893, Ratio=3.89x, Gap=-4.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.896, Ratio=3.89x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.880, Ratio=3.83x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.882, Ratio=3.81x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.888, Ratio=3.91x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.891, Ratio=3.88x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.891, Ratio=3.97x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.860, Ratio=3.75x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.898, Ratio=3.98x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.885, Ratio=4.01x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.896, Ratio=4.09x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.863, Ratio=3.88x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.920, Ratio=4.11x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.906, Ratio=4.30x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.892, Ratio=3.76x, Gap=-3.652
Batch 175/537: Loss=0.9610 (C:0.9610, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.911, Ratio=3.99x, Gap=-4.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.894, Ratio=4.01x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.904, Ratio=4.05x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.877, Ratio=3.99x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.907, Ratio=4.05x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.909, Ratio=3.98x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.883, Ratio=3.79x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.900, Ratio=3.94x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.902, Ratio=3.91x, Gap=-4.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.875, Ratio=3.75x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.913, Ratio=3.98x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.889, Ratio=3.86x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.897, Ratio=4.00x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.893, Ratio=4.19x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.860, Ratio=3.66x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.883, Ratio=3.84x, Gap=-4.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.895, Ratio=4.09x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.897, Ratio=4.02x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.890, Ratio=3.88x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.897, Ratio=4.06x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.906, Ratio=3.96x, Gap=-4.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.888, Ratio=3.76x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.884, Ratio=3.66x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.882, Ratio=3.80x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.874, Ratio=3.73x, Gap=-3.910
Batch 200/537: Loss=0.9666 (C:0.9666, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.896, Ratio=3.95x, Gap=-4.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.901, Ratio=3.94x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.871, Ratio=3.91x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.885, Ratio=3.91x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.880, Ratio=3.91x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.891, Ratio=4.00x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.878, Ratio=3.85x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.887, Ratio=4.05x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.894, Ratio=3.88x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.874, Ratio=3.74x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.903, Ratio=4.05x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.888, Ratio=4.06x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.905, Ratio=3.98x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.907, Ratio=4.17x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.892, Ratio=3.93x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.887, Ratio=3.84x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.901, Ratio=3.92x, Gap=-4.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.873, Ratio=3.88x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.889, Ratio=3.92x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.882, Ratio=3.96x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.905, Ratio=4.02x, Gap=-4.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.875, Ratio=3.82x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.903, Ratio=4.14x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.887, Ratio=3.92x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.877, Ratio=3.87x, Gap=-3.967
Batch 225/537: Loss=0.9396 (C:0.9396, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.873, Ratio=3.80x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.891, Ratio=4.04x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.883, Ratio=3.92x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.861, Ratio=3.80x, Gap=-4.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.894, Ratio=3.79x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.916, Ratio=4.04x, Gap=-4.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.880, Ratio=3.92x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.876, Ratio=3.73x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.891, Ratio=3.72x, Gap=-4.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.897, Ratio=3.97x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.926, Ratio=4.17x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.879, Ratio=3.81x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.889, Ratio=3.92x, Gap=-4.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.876, Ratio=3.89x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.891, Ratio=3.87x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.853, Ratio=3.79x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.878, Ratio=3.87x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.908, Ratio=3.98x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.921, Ratio=4.38x, Gap=-4.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.878, Ratio=3.86x, Gap=-4.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.884, Ratio=3.90x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.888, Ratio=3.93x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.872, Ratio=3.85x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.885, Ratio=3.84x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.882, Ratio=3.91x, Gap=-4.157
Batch 250/537: Loss=0.9347 (C:0.9347, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.886, Ratio=3.80x, Gap=-4.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.883, Ratio=3.73x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.913, Ratio=3.92x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.907, Ratio=3.92x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.893, Ratio=3.89x, Gap=-4.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.898, Ratio=3.95x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.893, Ratio=3.99x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.872, Ratio=3.98x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.892, Ratio=4.03x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.901, Ratio=4.05x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.884, Ratio=3.95x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.883, Ratio=3.88x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.873, Ratio=3.89x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.874, Ratio=3.89x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.897, Ratio=4.05x, Gap=-4.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.905, Ratio=4.07x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.894, Ratio=3.94x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.910, Ratio=4.09x, Gap=-4.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.894, Ratio=3.97x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.864, Ratio=3.70x, Gap=-4.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.888, Ratio=3.86x, Gap=-4.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.887, Ratio=3.92x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.885, Ratio=3.96x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.893, Ratio=3.95x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.904, Ratio=4.04x, Gap=-4.045
Batch 275/537: Loss=0.9160 (C:0.9160, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.883, Ratio=3.78x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.906, Ratio=4.08x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.889, Ratio=3.83x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.878, Ratio=4.04x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.876, Ratio=3.72x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.899, Ratio=4.01x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.938, Ratio=4.28x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.885, Ratio=3.93x, Gap=-4.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.859, Ratio=3.66x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.882, Ratio=4.08x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.870, Ratio=3.91x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.893, Ratio=4.13x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.878, Ratio=3.78x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.878, Ratio=3.87x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.895, Ratio=3.83x, Gap=-4.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.912, Ratio=3.94x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.903, Ratio=4.04x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.906, Ratio=3.90x, Gap=-4.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.891, Ratio=3.84x, Gap=-4.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.891, Ratio=3.84x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.901, Ratio=3.98x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.898, Ratio=3.99x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.891, Ratio=3.85x, Gap=-4.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.896, Ratio=3.96x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.866, Ratio=3.76x, Gap=-4.010
Batch 300/537: Loss=0.9608 (C:0.9608, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.906, Ratio=4.14x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.892, Ratio=3.99x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.892, Ratio=3.85x, Gap=-4.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.899, Ratio=3.97x, Gap=-4.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.884, Ratio=3.71x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.888, Ratio=3.89x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.870, Ratio=3.90x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.902, Ratio=4.00x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.878, Ratio=3.63x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.878, Ratio=3.81x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.881, Ratio=3.90x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.887, Ratio=3.86x, Gap=-5.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.895, Ratio=3.85x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.880, Ratio=3.68x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.899, Ratio=4.12x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.892, Ratio=3.94x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.864, Ratio=3.82x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.874, Ratio=3.85x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.898, Ratio=4.05x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.882, Ratio=3.92x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.887, Ratio=4.01x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.865, Ratio=3.66x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.860, Ratio=3.66x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.897, Ratio=4.01x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.898, Ratio=3.76x, Gap=-4.077
Batch 325/537: Loss=0.9582 (C:0.9582, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.910, Ratio=4.03x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.879, Ratio=3.86x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.895, Ratio=3.92x, Gap=-4.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.887, Ratio=3.85x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.874, Ratio=3.82x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.900, Ratio=4.00x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.877, Ratio=3.82x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.873, Ratio=3.91x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.874, Ratio=3.78x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.880, Ratio=3.91x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.897, Ratio=3.89x, Gap=-4.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.868, Ratio=3.94x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.884, Ratio=3.94x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.876, Ratio=3.91x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.871, Ratio=3.92x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.869, Ratio=3.88x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.905, Ratio=3.96x, Gap=-4.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.907, Ratio=3.92x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.886, Ratio=3.88x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.890, Ratio=3.98x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.865, Ratio=3.66x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.885, Ratio=3.92x, Gap=-4.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.874, Ratio=3.73x, Gap=-4.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.912, Ratio=4.04x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.884, Ratio=3.81x, Gap=-4.440
Batch 350/537: Loss=0.9503 (C:0.9503, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.875, Ratio=3.87x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.877, Ratio=3.69x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.869, Ratio=3.89x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.886, Ratio=3.81x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.904, Ratio=4.17x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.887, Ratio=3.88x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.884, Ratio=4.00x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.881, Ratio=3.83x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.885, Ratio=3.97x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.879, Ratio=3.82x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.904, Ratio=4.13x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.897, Ratio=3.90x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.871, Ratio=3.67x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.881, Ratio=3.81x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.879, Ratio=3.91x, Gap=-4.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.876, Ratio=3.85x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.871, Ratio=3.82x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.873, Ratio=3.83x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.891, Ratio=3.88x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.885, Ratio=3.90x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.900, Ratio=3.88x, Gap=-5.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.892, Ratio=3.95x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.855, Ratio=3.72x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.885, Ratio=3.90x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.905, Ratio=3.87x, Gap=-4.053
Batch 375/537: Loss=0.9389 (C:0.9389, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.904, Ratio=4.11x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.905, Ratio=4.00x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.878, Ratio=3.75x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.900, Ratio=3.98x, Gap=-4.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.883, Ratio=3.91x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.864, Ratio=3.77x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.869, Ratio=3.75x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.881, Ratio=3.83x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.892, Ratio=3.89x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.892, Ratio=3.98x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.895, Ratio=3.91x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.907, Ratio=4.13x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.877, Ratio=3.92x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.893, Ratio=3.89x, Gap=-4.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.893, Ratio=3.90x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.891, Ratio=3.98x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.876, Ratio=3.75x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.894, Ratio=4.03x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.882, Ratio=3.92x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.895, Ratio=3.88x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.913, Ratio=4.17x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.903, Ratio=3.99x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.898, Ratio=3.91x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.901, Ratio=3.89x, Gap=-4.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.893, Ratio=3.88x, Gap=-4.535
Batch 400/537: Loss=0.9391 (C:0.9391, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.893, Ratio=3.81x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.886, Ratio=3.81x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.859, Ratio=3.62x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.922, Ratio=4.01x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.911, Ratio=3.88x, Gap=-4.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.868, Ratio=3.66x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.869, Ratio=3.80x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.888, Ratio=3.88x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.879, Ratio=3.94x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.888, Ratio=3.98x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.869, Ratio=3.96x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.852, Ratio=3.80x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.921, Ratio=4.07x, Gap=-4.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.891, Ratio=3.82x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.904, Ratio=4.11x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.899, Ratio=3.91x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.891, Ratio=3.88x, Gap=-4.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.886, Ratio=3.82x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.912, Ratio=3.97x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.894, Ratio=3.97x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.903, Ratio=4.07x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.896, Ratio=3.90x, Gap=-4.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.877, Ratio=3.89x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.886, Ratio=3.84x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.871, Ratio=3.59x, Gap=-3.928
Batch 425/537: Loss=0.9885 (C:0.9885, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.884, Ratio=3.84x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.879, Ratio=3.81x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.879, Ratio=3.80x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.879, Ratio=3.85x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.859, Ratio=3.74x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.885, Ratio=3.93x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.882, Ratio=3.98x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.864, Ratio=3.77x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.896, Ratio=3.94x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.880, Ratio=3.76x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.884, Ratio=3.79x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.877, Ratio=3.83x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.902, Ratio=3.94x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.875, Ratio=3.89x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.887, Ratio=3.78x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.846, Ratio=3.59x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.907, Ratio=4.00x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.882, Ratio=3.77x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.874, Ratio=3.88x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.857, Ratio=3.81x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.907, Ratio=3.95x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.894, Ratio=3.82x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.865, Ratio=3.77x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.883, Ratio=3.88x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.865, Ratio=3.81x, Gap=-4.031
Batch 450/537: Loss=0.9518 (C:0.9518, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.895, Ratio=4.02x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.883, Ratio=3.76x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.894, Ratio=3.87x, Gap=-4.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.883, Ratio=3.86x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.877, Ratio=3.76x, Gap=-4.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.876, Ratio=3.79x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.896, Ratio=3.88x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.894, Ratio=3.78x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.901, Ratio=3.99x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.876, Ratio=3.93x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.879, Ratio=3.77x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.877, Ratio=3.76x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.887, Ratio=3.80x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.853, Ratio=3.72x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.870, Ratio=3.81x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.893, Ratio=3.98x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.882, Ratio=3.92x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.887, Ratio=3.86x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.872, Ratio=3.97x, Gap=-4.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.926, Ratio=4.22x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.876, Ratio=3.90x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.864, Ratio=3.78x, Gap=-4.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.873, Ratio=3.86x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.871, Ratio=3.71x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.886, Ratio=3.93x, Gap=-3.924
Batch 475/537: Loss=0.9322 (C:0.9322, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.891, Ratio=3.88x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.919, Ratio=4.13x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.917, Ratio=4.20x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.877, Ratio=3.84x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.888, Ratio=4.04x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.893, Ratio=3.79x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.888, Ratio=3.83x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.875, Ratio=3.79x, Gap=-4.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.879, Ratio=3.78x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.873, Ratio=3.76x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.890, Ratio=3.84x, Gap=-4.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.876, Ratio=3.94x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.886, Ratio=3.84x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.896, Ratio=3.97x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.880, Ratio=3.88x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.882, Ratio=3.89x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.894, Ratio=3.90x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.890, Ratio=3.92x, Gap=-4.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.887, Ratio=3.80x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.887, Ratio=3.87x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.872, Ratio=3.95x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.891, Ratio=4.00x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.888, Ratio=3.74x, Gap=-4.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.901, Ratio=3.99x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.917, Ratio=4.08x, Gap=-4.083
Batch 500/537: Loss=0.9096 (C:0.9096, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.888, Ratio=3.92x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.862, Ratio=3.73x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.915, Ratio=4.14x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.879, Ratio=3.99x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.858, Ratio=3.69x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.896, Ratio=3.91x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.877, Ratio=3.68x, Gap=-4.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.851, Ratio=3.67x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.870, Ratio=3.74x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.896, Ratio=3.97x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.868, Ratio=3.72x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.872, Ratio=3.84x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.882, Ratio=3.67x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.872, Ratio=3.83x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.886, Ratio=3.92x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.879, Ratio=3.78x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.897, Ratio=3.94x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.870, Ratio=3.83x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.873, Ratio=3.78x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.890, Ratio=3.88x, Gap=-4.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.872, Ratio=3.81x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.868, Ratio=3.91x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.857, Ratio=3.81x, Gap=-4.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.868, Ratio=3.79x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.867, Ratio=3.87x, Gap=-3.767
Batch 525/537: Loss=0.9418 (C:0.9418, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.884, Ratio=3.79x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.855, Ratio=3.69x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.872, Ratio=3.70x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.876, Ratio=3.76x, Gap=-4.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.900, Ratio=3.82x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.901, Ratio=3.81x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.894, Ratio=3.87x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.905, Ratio=3.84x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.899, Ratio=4.03x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.882, Ratio=3.84x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.870, Ratio=3.77x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.882, Ratio=4.22x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.896, Ratio=4.25x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.892, Ratio=4.35x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.896, Ratio=4.25x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.880, Ratio=4.30x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.902, Ratio=4.43x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.870, Ratio=4.02x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.899, Ratio=4.36x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.894, Ratio=4.43x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.913, Ratio=4.30x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.929, Ratio=4.59x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.912, Ratio=4.57x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.915, Ratio=4.39x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.901, Ratio=4.38x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.899, Ratio=4.33x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.907, Ratio=4.35x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.912, Ratio=4.33x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.900, Ratio=4.27x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.893, Ratio=4.29x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.913, Ratio=4.51x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.888, Ratio=4.28x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.892, Ratio=4.24x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.916, Ratio=4.39x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.908, Ratio=4.63x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.909, Ratio=4.34x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.880, Ratio=4.18x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.894, Ratio=4.34x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.888, Ratio=4.25x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.919, Ratio=4.67x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.898, Ratio=4.26x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.892, Ratio=4.36x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.900, Ratio=4.30x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.904, Ratio=4.40x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.899, Ratio=4.18x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.923, Ratio=4.40x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.882, Ratio=4.09x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.902, Ratio=4.40x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.922, Ratio=4.30x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.890, Ratio=4.13x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.916, Ratio=4.55x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.912, Ratio=4.36x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.912, Ratio=4.49x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.906, Ratio=4.40x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.894, Ratio=4.34x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.900, Ratio=4.39x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.908, Ratio=4.31x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.910, Ratio=4.51x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.901, Ratio=4.34x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.908, Ratio=4.39x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.893, Ratio=4.47x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.898, Ratio=4.42x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.895, Ratio=4.34x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.883, Ratio=4.15x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.907, Ratio=4.41x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.929, Ratio=4.47x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.909, Ratio=4.53x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.899, Ratio=4.37x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.897, Ratio=4.29x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.901, Ratio=4.39x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.889, Ratio=4.15x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.909, Ratio=4.54x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.897, Ratio=4.28x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.905, Ratio=4.39x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.907, Ratio=4.41x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.889, Ratio=4.26x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.891, Ratio=4.21x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.881, Ratio=4.18x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.896, Ratio=4.23x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.889, Ratio=4.28x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.917, Ratio=4.54x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.892, Ratio=4.41x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.904, Ratio=4.30x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.922, Ratio=4.60x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.894, Ratio=4.34x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.897, Ratio=4.37x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.878, Ratio=4.15x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.921, Ratio=4.44x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.904, Ratio=4.42x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.892, Ratio=4.25x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.908, Ratio=4.52x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.913, Ratio=4.63x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.918, Ratio=4.58x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.880, Ratio=4.30x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.902, Ratio=4.30x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.931, Ratio=4.68x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.908, Ratio=4.31x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.906, Ratio=4.43x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.893, Ratio=4.21x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.905, Ratio=4.25x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.880, Ratio=4.08x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.903, Ratio=4.49x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.897, Ratio=4.26x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.912, Ratio=4.48x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.891, Ratio=4.31x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.897, Ratio=4.25x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.893, Ratio=4.28x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.891, Ratio=4.40x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.890, Ratio=4.22x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.920, Ratio=4.50x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.886, Ratio=4.25x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.911, Ratio=4.38x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.890, Ratio=4.11x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.889, Ratio=4.24x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.905, Ratio=4.38x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.901, Ratio=4.20x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.886, Ratio=4.17x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.910, Ratio=4.37x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.910, Ratio=4.57x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.890, Ratio=4.32x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.899, Ratio=4.41x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.889, Ratio=4.26x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.890, Ratio=4.28x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.910, Ratio=4.43x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.893, Ratio=4.22x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.905, Ratio=4.32x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.897, Ratio=4.21x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.906, Ratio=4.30x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.922, Ratio=4.45x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.919, Ratio=4.67x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.887, Ratio=4.31x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.895, Ratio=4.28x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.920, Ratio=4.47x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.911, Ratio=4.48x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.911, Ratio=4.45x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.918, Ratio=4.48x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.908, Ratio=4.49x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.887, Ratio=4.29x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.882, Ratio=4.15x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.911, Ratio=4.45x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.908, Ratio=4.53x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.883, Ratio=4.21x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.897, Ratio=4.28x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.906, Ratio=4.55x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.917, Ratio=4.55x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.914, Ratio=4.43x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.889, Ratio=4.20x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.894, Ratio=4.26x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.905, Ratio=4.38x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.876, Ratio=3.99x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.907, Ratio=4.29x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.921, Ratio=4.44x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.899, Ratio=4.36x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.910, Ratio=4.66x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.897, Ratio=4.34x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.895, Ratio=4.33x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.896, Ratio=4.30x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.880, Ratio=4.23x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.900, Ratio=4.33x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.919, Ratio=4.53x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.909, Ratio=4.43x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.895, Ratio=4.25x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.908, Ratio=4.41x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.905, Ratio=4.37x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.894, Ratio=4.16x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.898, Ratio=4.25x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.922, Ratio=4.47x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.881, Ratio=4.09x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.886, Ratio=4.17x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.888, Ratio=4.30x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.924, Ratio=4.58x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.897, Ratio=4.24x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.903, Ratio=4.36x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.904, Ratio=4.35x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.918, Ratio=4.48x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.894, Ratio=4.16x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.917, Ratio=4.29x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.908, Ratio=4.35x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.917, Ratio=4.55x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.905, Ratio=4.35x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.898, Ratio=4.36x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.893, Ratio=4.26x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.900, Ratio=4.37x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.886, Ratio=4.33x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.920, Ratio=4.70x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.887, Ratio=4.22x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.905, Ratio=4.45x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.903, Ratio=4.30x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.902, Ratio=4.34x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.898, Ratio=4.34x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.902, Ratio=4.53x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.897, Ratio=4.24x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.898, Ratio=4.33x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.903, Ratio=4.39x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.895, Ratio=4.46x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.896, Ratio=4.40x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.899, Ratio=4.31x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.882, Ratio=4.15x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.880, Ratio=4.06x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.897, Ratio=4.39x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.907, Ratio=4.44x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.902, Ratio=4.37x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.907, Ratio=4.35x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.913, Ratio=4.29x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.903, Ratio=4.35x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.900, Ratio=4.43x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.901, Ratio=4.50x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.872, Ratio=3.94x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.906, Ratio=4.55x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.900, Ratio=4.49x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.892, Ratio=4.44x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.921, Ratio=4.58x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.893, Ratio=4.19x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.901, Ratio=4.24x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.911, Ratio=4.46x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.917, Ratio=4.46x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.893, Ratio=4.19x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.913, Ratio=4.38x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.916, Ratio=4.34x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.885, Ratio=4.23x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.907, Ratio=4.35x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.894, Ratio=4.18x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.902, Ratio=4.38x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.932, Ratio=4.83x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.885, Ratio=4.22x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.912, Ratio=4.44x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.896, Ratio=4.39x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.901, Ratio=4.39x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.903, Ratio=4.47x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.909, Ratio=4.45x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.904, Ratio=4.46x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.894, Ratio=4.31x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.901, Ratio=4.35x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.924, Ratio=4.37x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.902, Ratio=4.26x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.904, Ratio=4.34x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.917, Ratio=4.55x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.909, Ratio=4.40x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.926, Ratio=4.61x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.919, Ratio=4.59x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.888, Ratio=4.20x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.909, Ratio=4.57x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.919, Ratio=4.40x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.890, Ratio=4.32x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.882, Ratio=4.12x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.919, Ratio=4.47x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.916, Ratio=4.46x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.904, Ratio=4.39x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.921, Ratio=4.47x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.900, Ratio=4.46x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.883, Ratio=4.24x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.898, Ratio=4.24x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.901, Ratio=4.39x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.908, Ratio=4.48x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.919, Ratio=4.42x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.899, Ratio=4.30x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.906, Ratio=4.35x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.910, Ratio=4.44x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.894, Ratio=4.46x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.908, Ratio=4.33x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.893, Ratio=4.30x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.924, Ratio=4.63x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.903, Ratio=4.30x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.897, Ratio=4.35x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.892, Ratio=4.13x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.897, Ratio=4.31x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.907, Ratio=4.31x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.897, Ratio=4.17x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.913, Ratio=4.60x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.892, Ratio=4.20x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.919, Ratio=4.41x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.868, Ratio=4.05x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.920, Ratio=4.58x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.905, Ratio=4.15x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.904, Ratio=4.50x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.895, Ratio=4.28x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.888, Ratio=4.23x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.894, Ratio=4.33x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.868, Ratio=3.94x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.920, Ratio=4.41x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.897, Ratio=4.43x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.890, Ratio=4.23x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.916, Ratio=4.54x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.915, Ratio=4.42x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.902, Ratio=4.38x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.913, Ratio=4.39x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.905, Ratio=4.35x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.888, Ratio=4.22x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.881, Ratio=4.11x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.894, Ratio=4.37x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.894, Ratio=4.48x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.889, Ratio=4.31x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.883, Ratio=4.07x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.888, Ratio=4.21x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.892, Ratio=4.30x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.898, Ratio=4.28x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.896, Ratio=4.22x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.884, Ratio=4.36x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.897, Ratio=4.35x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.898, Ratio=4.39x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.910, Ratio=4.34x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.896, Ratio=4.45x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.895, Ratio=4.32x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.889, Ratio=4.16x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.884, Ratio=4.22x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.903, Ratio=4.29x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.920, Ratio=4.60x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.883, Ratio=4.20x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.900, Ratio=4.33x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.887, Ratio=4.11x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.879, Ratio=4.10x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.894, Ratio=4.18x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.886, Ratio=4.26x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.918, Ratio=4.41x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.914, Ratio=4.55x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.900, Ratio=4.39x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.895, Ratio=4.36x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.919, Ratio=4.56x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.894, Ratio=4.30x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.902, Ratio=4.26x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.873, Ratio=4.10x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.886, Ratio=4.19x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.879, Ratio=4.20x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.913, Ratio=4.45x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.889, Ratio=4.28x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.893, Ratio=4.19x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.892, Ratio=4.33x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.920, Ratio=4.57x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.885, Ratio=4.30x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.909, Ratio=4.53x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.907, Ratio=4.46x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.905, Ratio=4.38x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.904, Ratio=4.39x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.896, Ratio=4.29x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.900, Ratio=4.29x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.897, Ratio=4.37x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.919, Ratio=4.53x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.916, Ratio=4.50x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.907, Ratio=4.37x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.894, Ratio=4.15x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.885, Ratio=4.23x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.886, Ratio=4.22x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.894, Ratio=4.29x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.897, Ratio=4.23x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.896, Ratio=4.31x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.904, Ratio=4.29x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.896, Ratio=4.42x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.894, Ratio=4.31x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.907, Ratio=4.39x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.913, Ratio=4.64x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.896, Ratio=4.28x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.905, Ratio=4.28x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.899, Ratio=4.36x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.920, Ratio=4.33x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.907, Ratio=4.46x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.880, Ratio=4.06x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.913, Ratio=4.48x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.899, Ratio=4.11x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.920, Ratio=4.61x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.896, Ratio=4.20x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.893, Ratio=4.21x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.913, Ratio=4.50x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.900, Ratio=4.31x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.882, Ratio=4.23x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.906, Ratio=4.34x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.877, Ratio=4.08x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.888, Ratio=4.12x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.892, Ratio=4.14x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.907, Ratio=4.28x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.907, Ratio=4.46x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.895, Ratio=4.17x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.876, Ratio=4.12x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.890, Ratio=4.22x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.919, Ratio=4.52x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.897, Ratio=4.39x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.891, Ratio=4.15x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.879, Ratio=4.04x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.895, Ratio=4.24x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.891, Ratio=4.30x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.892, Ratio=4.25x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.910, Ratio=4.47x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.887, Ratio=4.22x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.893, Ratio=4.36x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.889, Ratio=4.35x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.894, Ratio=4.24x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.897, Ratio=4.13x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.894, Ratio=4.25x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.885, Ratio=4.15x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.904, Ratio=4.45x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.903, Ratio=4.45x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.916, Ratio=4.46x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.924, Ratio=4.46x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.906, Ratio=4.41x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.900, Ratio=4.44x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.873, Ratio=4.05x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.892, Ratio=4.42x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.912, Ratio=4.38x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.884, Ratio=4.14x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.885, Ratio=4.13x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.903, Ratio=4.37x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.926, Ratio=4.47x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.896, Ratio=4.39x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.896, Ratio=4.39x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.895, Ratio=4.43x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.898, Ratio=4.30x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.903, Ratio=4.46x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.925, Ratio=4.44x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.891, Ratio=4.27x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.888, Ratio=4.24x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.908, Ratio=4.35x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.890, Ratio=4.29x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.901, Ratio=4.41x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.881, Ratio=4.26x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.890, Ratio=4.23x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.899, Ratio=4.39x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.913, Ratio=4.53x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.908, Ratio=4.37x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.871, Ratio=3.93x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.921, Ratio=4.57x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.918, Ratio=4.38x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.915, Ratio=4.54x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.900, Ratio=4.40x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.889, Ratio=4.12x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.915, Ratio=4.45x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.885, Ratio=4.24x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.905, Ratio=4.37x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.893, Ratio=4.25x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.894, Ratio=4.46x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.891, Ratio=4.28x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.890, Ratio=4.35x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.913, Ratio=4.57x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.917, Ratio=4.54x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.891, Ratio=4.24x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.908, Ratio=4.39x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.904, Ratio=4.38x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.889, Ratio=4.24x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.897, Ratio=4.37x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.894, Ratio=4.29x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.894, Ratio=4.18x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.893, Ratio=4.41x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.926, Ratio=4.61x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.884, Ratio=4.14x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.904, Ratio=4.46x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.879, Ratio=4.23x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.892, Ratio=4.40x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.891, Ratio=4.19x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.901, Ratio=4.28x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.905, Ratio=4.38x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.891, Ratio=4.46x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.895, Ratio=4.28x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.896, Ratio=4.38x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.887, Ratio=4.27x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.911, Ratio=4.40x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.909, Ratio=4.25x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.883, Ratio=4.28x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.924, Ratio=4.53x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.890, Ratio=4.31x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.903, Ratio=4.49x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.906, Ratio=4.38x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.901, Ratio=4.23x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.884, Ratio=4.15x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.904, Ratio=4.26x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.931, Ratio=4.58x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.912, Ratio=4.51x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.906, Ratio=4.47x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.912, Ratio=4.39x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.919, Ratio=4.40x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.897, Ratio=4.29x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.909, Ratio=4.49x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.897, Ratio=4.26x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.891, Ratio=4.36x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.906, Ratio=4.39x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.892, Ratio=4.21x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.881, Ratio=4.14x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.911, Ratio=4.47x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.900, Ratio=4.41x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.906, Ratio=4.32x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.874, Ratio=4.03x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.913, Ratio=4.49x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.891, Ratio=4.33x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.902, Ratio=4.32x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.909, Ratio=4.39x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.902, Ratio=4.42x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.901, Ratio=4.16x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.905, Ratio=4.34x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.906, Ratio=4.32x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.903, Ratio=4.23x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.905, Ratio=4.37x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.879, Ratio=4.18x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.918, Ratio=4.18x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.888, Ratio=4.17x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.883, Ratio=4.13x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.905, Ratio=4.31x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.910, Ratio=4.47x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.896, Ratio=4.39x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.883, Ratio=4.19x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.879, Ratio=4.14x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.903, Ratio=4.42x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.898, Ratio=4.28x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.930, Ratio=4.60x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.910, Ratio=4.39x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.890, Ratio=4.30x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.914, Ratio=4.53x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.906, Ratio=4.35x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.912, Ratio=4.59x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.892, Ratio=4.24x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.903, Ratio=4.26x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.921, Ratio=4.66x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.906, Ratio=4.42x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.890, Ratio=4.32x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.912, Ratio=4.35x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.897, Ratio=4.33x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.896, Ratio=4.20x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.906, Ratio=4.46x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.887, Ratio=4.26x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.892, Ratio=4.31x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.900, Ratio=4.29x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.905, Ratio=4.42x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.916, Ratio=4.39x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.901, Ratio=4.29x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.894, Ratio=4.32x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.906, Ratio=4.34x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.904, Ratio=4.59x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.930, Ratio=4.60x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.924, Ratio=4.50x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.903, Ratio=4.38x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.884, Ratio=4.23x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.901, Ratio=4.32x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.897, Ratio=4.15x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.897, Ratio=4.29x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.900, Ratio=4.36x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.886, Ratio=4.09x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.896, Ratio=4.40x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.894, Ratio=4.29x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.909, Ratio=4.31x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.906, Ratio=4.30x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.913, Ratio=4.40x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.904, Ratio=4.34x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.898, Ratio=4.30x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.904, Ratio=4.36x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.895, Ratio=4.30x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.887, Ratio=4.36x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.897, Ratio=4.33x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.900, Ratio=4.36x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.913, Ratio=4.54x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.895, Ratio=4.31x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.876, Ratio=4.12x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.894, Ratio=4.41x, Gap=-3.374

============================================================
Epoch 15/20 completed in 33.7s
Train: Loss=0.9364 (C:0.9364, R:0.0000) Ratio=3.51x
Val:   Loss=0.8793 (C:0.8793, R:0.0000) Ratio=4.48x
‚úÖ New best model saved (Val Loss: 0.8793)
Checkpoint saved at epoch 15
============================================================

üåç Updating global dataset at epoch 16
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.404 ¬± 0.529
    Neg distances: 1.957 ¬± 0.902
    Separation ratio: 4.84x
    Gap: -3.468
    ‚úÖ Excellent global separation!

Epoch 16 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.944, Ratio=4.33x, Gap=-3.835
Batch   0/537: Loss=0.8669 (C:0.8669, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.952, Ratio=4.30x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.952, Ratio=4.44x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.962, Ratio=4.34x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.946, Ratio=4.14x, Gap=-4.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.947, Ratio=4.12x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.962, Ratio=4.17x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.998, Ratio=4.31x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.973, Ratio=4.10x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.988, Ratio=4.28x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.984, Ratio=4.08x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.977, Ratio=4.09x, Gap=-4.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.968, Ratio=4.25x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.012, Ratio=4.45x, Gap=-4.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.983, Ratio=4.26x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.973, Ratio=4.24x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.956, Ratio=4.07x, Gap=-4.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.985, Ratio=4.27x, Gap=-4.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.937, Ratio=4.12x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.964, Ratio=4.38x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.970, Ratio=4.31x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.964, Ratio=4.23x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.976, Ratio=4.30x, Gap=-4.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.977, Ratio=4.39x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.978, Ratio=4.35x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.961, Ratio=4.11x, Gap=-4.330
Batch  25/537: Loss=0.8923 (C:0.8923, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.987, Ratio=4.36x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.988, Ratio=4.31x, Gap=-5.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.961, Ratio=4.39x, Gap=-4.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.964, Ratio=4.35x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.942, Ratio=3.89x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.967, Ratio=4.34x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.967, Ratio=4.31x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.955, Ratio=4.17x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.945, Ratio=4.05x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.958, Ratio=4.09x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.959, Ratio=4.22x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.948, Ratio=3.95x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.955, Ratio=4.08x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.949, Ratio=4.12x, Gap=-4.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.987, Ratio=4.27x, Gap=-4.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.998, Ratio=4.44x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.990, Ratio=4.59x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.992, Ratio=4.22x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.946, Ratio=4.13x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.989, Ratio=4.26x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.956, Ratio=4.13x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.974, Ratio=4.28x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.951, Ratio=4.17x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.971, Ratio=4.32x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.943, Ratio=4.17x, Gap=-4.197
Batch  50/537: Loss=0.8860 (C:0.8860, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.955, Ratio=4.29x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.969, Ratio=4.35x, Gap=-5.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.974, Ratio=4.23x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.999, Ratio=4.38x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.977, Ratio=4.24x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.986, Ratio=4.31x, Gap=-4.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.962, Ratio=4.01x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.972, Ratio=4.19x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.985, Ratio=4.38x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.986, Ratio=4.32x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.980, Ratio=4.32x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.993, Ratio=4.66x, Gap=-4.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.959, Ratio=4.12x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.963, Ratio=4.10x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.961, Ratio=4.06x, Gap=-4.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.940, Ratio=3.97x, Gap=-4.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.976, Ratio=4.30x, Gap=-4.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.975, Ratio=4.36x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.984, Ratio=4.28x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.972, Ratio=4.10x, Gap=-4.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.965, Ratio=4.15x, Gap=-4.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.972, Ratio=4.18x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.951, Ratio=4.16x, Gap=-4.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.979, Ratio=4.20x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.972, Ratio=4.30x, Gap=-4.290
Batch  75/537: Loss=0.8654 (C:0.8654, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.978, Ratio=4.16x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.001, Ratio=4.54x, Gap=-4.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.987, Ratio=4.20x, Gap=-4.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.964, Ratio=4.33x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.965, Ratio=4.16x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.938, Ratio=4.07x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.954, Ratio=4.16x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.976, Ratio=4.24x, Gap=-4.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.967, Ratio=4.36x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.959, Ratio=4.19x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.971, Ratio=4.47x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.953, Ratio=4.16x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.963, Ratio=4.04x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.976, Ratio=4.19x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.974, Ratio=4.11x, Gap=-4.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.954, Ratio=4.10x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.988, Ratio=4.48x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.991, Ratio=4.41x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.966, Ratio=4.36x, Gap=-4.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.967, Ratio=4.03x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.982, Ratio=4.48x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.986, Ratio=4.24x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.968, Ratio=4.16x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.988, Ratio=4.22x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.950, Ratio=4.10x, Gap=-4.258
Batch 100/537: Loss=0.8950 (C:0.8950, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.968, Ratio=4.26x, Gap=-4.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.961, Ratio=4.27x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.970, Ratio=4.18x, Gap=-4.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.951, Ratio=4.07x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.971, Ratio=4.22x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.975, Ratio=4.33x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.950, Ratio=4.00x, Gap=-4.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.982, Ratio=4.28x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.968, Ratio=4.23x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.969, Ratio=4.25x, Gap=-4.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.970, Ratio=4.16x, Gap=-4.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.979, Ratio=4.33x, Gap=-4.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.982, Ratio=4.28x, Gap=-4.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.982, Ratio=4.18x, Gap=-4.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.981, Ratio=4.35x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.988, Ratio=4.35x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.975, Ratio=4.14x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.969, Ratio=4.42x, Gap=-4.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.984, Ratio=4.50x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.971, Ratio=4.32x, Gap=-4.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.951, Ratio=3.96x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.970, Ratio=4.17x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.960, Ratio=4.01x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.937, Ratio=4.22x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.980, Ratio=4.22x, Gap=-4.058
Batch 125/537: Loss=0.8765 (C:0.8765, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.959, Ratio=4.25x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.967, Ratio=4.26x, Gap=-4.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.943, Ratio=4.01x, Gap=-4.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.974, Ratio=4.19x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.970, Ratio=4.35x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.962, Ratio=4.03x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.997, Ratio=4.53x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.962, Ratio=4.17x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.947, Ratio=4.05x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.956, Ratio=4.02x, Gap=-4.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.965, Ratio=4.27x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.988, Ratio=4.37x, Gap=-4.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.974, Ratio=4.21x, Gap=-4.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.973, Ratio=4.23x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.947, Ratio=4.02x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.977, Ratio=4.19x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.944, Ratio=3.96x, Gap=-4.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.962, Ratio=4.26x, Gap=-4.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.969, Ratio=4.43x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.967, Ratio=4.40x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.947, Ratio=3.99x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.981, Ratio=4.41x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.964, Ratio=4.17x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.984, Ratio=4.42x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.984, Ratio=4.34x, Gap=-4.481
Batch 150/537: Loss=0.8579 (C:0.8579, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.972, Ratio=4.37x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.960, Ratio=4.11x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.981, Ratio=4.40x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.005, Ratio=4.40x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.985, Ratio=4.42x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.943, Ratio=4.04x, Gap=-4.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.969, Ratio=4.30x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.976, Ratio=4.17x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.983, Ratio=4.28x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.956, Ratio=4.05x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.961, Ratio=4.10x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.972, Ratio=4.10x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.981, Ratio=4.25x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.970, Ratio=4.34x, Gap=-4.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.958, Ratio=4.02x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.964, Ratio=4.34x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.954, Ratio=4.14x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.961, Ratio=4.27x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.952, Ratio=4.12x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.945, Ratio=3.97x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.989, Ratio=4.39x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.992, Ratio=4.34x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.962, Ratio=4.25x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.985, Ratio=4.30x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.950, Ratio=4.13x, Gap=-4.371
Batch 175/537: Loss=0.8914 (C:0.8914, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.985, Ratio=4.21x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.989, Ratio=4.34x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.966, Ratio=4.12x, Gap=-4.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.948, Ratio=4.03x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.965, Ratio=4.18x, Gap=-4.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.943, Ratio=3.92x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.966, Ratio=4.27x, Gap=-4.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.962, Ratio=4.12x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.977, Ratio=4.18x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.979, Ratio=4.25x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.972, Ratio=4.17x, Gap=-4.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.973, Ratio=4.18x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.982, Ratio=4.55x, Gap=-4.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.956, Ratio=4.14x, Gap=-4.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.951, Ratio=4.09x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.979, Ratio=4.20x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.964, Ratio=4.13x, Gap=-4.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.967, Ratio=4.12x, Gap=-4.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.956, Ratio=4.16x, Gap=-4.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.950, Ratio=4.18x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.979, Ratio=4.32x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.936, Ratio=4.00x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.984, Ratio=4.26x, Gap=-4.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.981, Ratio=4.31x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.981, Ratio=4.17x, Gap=-4.278
Batch 200/537: Loss=0.8852 (C:0.8852, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.955, Ratio=3.97x, Gap=-4.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.956, Ratio=4.02x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.967, Ratio=4.04x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.946, Ratio=3.85x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.938, Ratio=3.97x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.979, Ratio=4.47x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.939, Ratio=4.06x, Gap=-4.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.966, Ratio=4.36x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.966, Ratio=4.16x, Gap=-4.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.962, Ratio=4.32x, Gap=-4.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.952, Ratio=4.19x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.970, Ratio=4.17x, Gap=-4.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.951, Ratio=3.94x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.985, Ratio=4.39x, Gap=-4.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.968, Ratio=4.07x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.953, Ratio=4.13x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.976, Ratio=4.29x, Gap=-4.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.968, Ratio=4.09x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.946, Ratio=3.92x, Gap=-4.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.981, Ratio=4.26x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.962, Ratio=4.29x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.979, Ratio=4.39x, Gap=-4.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.960, Ratio=4.11x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.976, Ratio=4.15x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.950, Ratio=4.07x, Gap=-4.036
Batch 225/537: Loss=0.8992 (C:0.8992, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.980, Ratio=4.27x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.957, Ratio=4.03x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.955, Ratio=4.17x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.973, Ratio=4.20x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.945, Ratio=3.96x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.961, Ratio=4.03x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.958, Ratio=4.14x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.968, Ratio=4.18x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.979, Ratio=4.25x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.977, Ratio=4.29x, Gap=-4.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.952, Ratio=4.10x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.971, Ratio=4.36x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.948, Ratio=4.07x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.952, Ratio=4.00x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.970, Ratio=4.19x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.961, Ratio=4.19x, Gap=-4.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.942, Ratio=4.11x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.974, Ratio=4.32x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.963, Ratio=4.16x, Gap=-5.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.963, Ratio=4.04x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.969, Ratio=4.20x, Gap=-4.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.952, Ratio=3.94x, Gap=-4.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.975, Ratio=4.21x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.965, Ratio=4.12x, Gap=-4.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.962, Ratio=3.97x, Gap=-4.118
Batch 250/537: Loss=0.9132 (C:0.9132, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.969, Ratio=4.10x, Gap=-4.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.997, Ratio=4.48x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.944, Ratio=3.95x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.992, Ratio=4.48x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.974, Ratio=4.26x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.968, Ratio=4.08x, Gap=-4.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.970, Ratio=4.23x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.958, Ratio=4.01x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.956, Ratio=4.16x, Gap=-4.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.937, Ratio=3.93x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.930, Ratio=3.70x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.946, Ratio=4.14x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.977, Ratio=4.33x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.942, Ratio=4.02x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.973, Ratio=4.16x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.969, Ratio=4.11x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.946, Ratio=4.19x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.973, Ratio=4.42x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.974, Ratio=4.14x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.980, Ratio=4.23x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.970, Ratio=4.25x, Gap=-4.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.976, Ratio=4.24x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.981, Ratio=4.30x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.951, Ratio=3.83x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.974, Ratio=4.35x, Gap=-4.052
Batch 275/537: Loss=0.8592 (C:0.8592, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.968, Ratio=4.34x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.964, Ratio=4.14x, Gap=-4.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.967, Ratio=4.27x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.957, Ratio=4.09x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.967, Ratio=4.16x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.953, Ratio=4.16x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.950, Ratio=3.95x, Gap=-4.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.947, Ratio=3.98x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.950, Ratio=3.90x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.969, Ratio=4.25x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.975, Ratio=4.19x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.965, Ratio=4.08x, Gap=-4.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.962, Ratio=4.22x, Gap=-4.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.939, Ratio=4.09x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.950, Ratio=4.15x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.987, Ratio=4.24x, Gap=-4.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.967, Ratio=4.04x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.973, Ratio=4.28x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.968, Ratio=4.29x, Gap=-4.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.968, Ratio=4.03x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.971, Ratio=4.31x, Gap=-4.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.985, Ratio=4.38x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.981, Ratio=4.28x, Gap=-4.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.959, Ratio=4.05x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.968, Ratio=4.20x, Gap=-4.192
Batch 300/537: Loss=0.8795 (C:0.8795, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.972, Ratio=4.28x, Gap=-4.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.947, Ratio=4.09x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.981, Ratio=4.30x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.952, Ratio=4.13x, Gap=-4.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.965, Ratio=4.24x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.971, Ratio=4.24x, Gap=-4.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.965, Ratio=4.08x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.957, Ratio=4.24x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.944, Ratio=4.00x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.961, Ratio=4.06x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.982, Ratio=4.30x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.976, Ratio=4.06x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.962, Ratio=4.01x, Gap=-4.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.962, Ratio=3.89x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.959, Ratio=4.02x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.938, Ratio=3.88x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.972, Ratio=4.32x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.991, Ratio=4.37x, Gap=-4.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.977, Ratio=4.25x, Gap=-4.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.951, Ratio=3.90x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.972, Ratio=4.27x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.997, Ratio=4.34x, Gap=-4.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.964, Ratio=4.23x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.955, Ratio=4.04x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.982, Ratio=4.19x, Gap=-3.984
Batch 325/537: Loss=0.8795 (C:0.8795, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.982, Ratio=4.12x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.954, Ratio=4.07x, Gap=-4.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.952, Ratio=3.96x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.979, Ratio=4.20x, Gap=-4.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.989, Ratio=4.23x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.958, Ratio=4.11x, Gap=-4.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.950, Ratio=4.02x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.963, Ratio=4.21x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.967, Ratio=4.35x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.960, Ratio=4.22x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.950, Ratio=4.22x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.949, Ratio=4.16x, Gap=-4.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.948, Ratio=4.09x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.957, Ratio=4.23x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.953, Ratio=4.20x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.966, Ratio=4.13x, Gap=-4.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.990, Ratio=4.32x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.994, Ratio=4.31x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.994, Ratio=4.39x, Gap=-4.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.964, Ratio=4.12x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.980, Ratio=4.17x, Gap=-4.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.983, Ratio=4.25x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.959, Ratio=4.13x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.968, Ratio=4.21x, Gap=-4.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.972, Ratio=4.25x, Gap=-4.898
Batch 350/537: Loss=0.8728 (C:0.8728, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.974, Ratio=4.21x, Gap=-4.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.947, Ratio=4.14x, Gap=-4.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.941, Ratio=3.95x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.949, Ratio=4.07x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.976, Ratio=4.26x, Gap=-4.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.959, Ratio=4.23x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.965, Ratio=4.29x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.961, Ratio=4.08x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.972, Ratio=4.33x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.974, Ratio=4.31x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.973, Ratio=4.10x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.974, Ratio=4.13x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.951, Ratio=4.06x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.965, Ratio=4.14x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.969, Ratio=4.02x, Gap=-4.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.951, Ratio=3.97x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.949, Ratio=3.94x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.961, Ratio=4.09x, Gap=-4.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.965, Ratio=4.22x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.965, Ratio=4.02x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.959, Ratio=4.17x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.968, Ratio=4.25x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.933, Ratio=3.96x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.942, Ratio=4.03x, Gap=-4.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.957, Ratio=3.96x, Gap=-3.986
Batch 375/537: Loss=0.9183 (C:0.9183, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.969, Ratio=4.23x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.971, Ratio=4.24x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.946, Ratio=4.01x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.950, Ratio=3.96x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.956, Ratio=4.00x, Gap=-4.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.968, Ratio=4.25x, Gap=-4.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.953, Ratio=4.06x, Gap=-4.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.961, Ratio=4.22x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.961, Ratio=4.00x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.975, Ratio=4.02x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.007, Ratio=4.38x, Gap=-4.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.984, Ratio=4.17x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.966, Ratio=4.12x, Gap=-4.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.944, Ratio=3.83x, Gap=-4.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.958, Ratio=3.89x, Gap=-4.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.950, Ratio=4.21x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.951, Ratio=4.13x, Gap=-4.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.960, Ratio=4.18x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.952, Ratio=4.14x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.939, Ratio=3.95x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.967, Ratio=4.25x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.965, Ratio=4.02x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.995, Ratio=4.43x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.954, Ratio=4.17x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.965, Ratio=4.25x, Gap=-4.365
Batch 400/537: Loss=0.8734 (C:0.8734, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.974, Ratio=4.21x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.973, Ratio=4.24x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.978, Ratio=4.28x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.951, Ratio=4.04x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.961, Ratio=4.07x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.974, Ratio=4.21x, Gap=-4.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.966, Ratio=4.11x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.966, Ratio=4.17x, Gap=-4.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.954, Ratio=4.25x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.958, Ratio=4.09x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.938, Ratio=3.99x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.947, Ratio=4.27x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.966, Ratio=4.15x, Gap=-4.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.958, Ratio=4.11x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.953, Ratio=4.03x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.969, Ratio=4.05x, Gap=-4.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.984, Ratio=4.22x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.950, Ratio=4.05x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.967, Ratio=4.13x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.975, Ratio=4.20x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.961, Ratio=3.99x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.960, Ratio=4.04x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.980, Ratio=4.23x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.964, Ratio=4.18x, Gap=-4.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.970, Ratio=4.20x, Gap=-4.239
Batch 425/537: Loss=0.8796 (C:0.8796, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.960, Ratio=3.99x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.985, Ratio=4.21x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.959, Ratio=4.16x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.960, Ratio=4.13x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.963, Ratio=4.21x, Gap=-4.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.967, Ratio=4.21x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.959, Ratio=3.96x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.978, Ratio=4.30x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.989, Ratio=4.27x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.951, Ratio=3.97x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.979, Ratio=4.22x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.977, Ratio=4.27x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.995, Ratio=4.38x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.986, Ratio=4.19x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.977, Ratio=4.19x, Gap=-4.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.954, Ratio=4.08x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.970, Ratio=4.20x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.945, Ratio=4.01x, Gap=-5.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.955, Ratio=4.20x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.974, Ratio=4.28x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.959, Ratio=4.26x, Gap=-4.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.945, Ratio=3.99x, Gap=-4.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.977, Ratio=4.12x, Gap=-4.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.980, Ratio=4.22x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.966, Ratio=4.07x, Gap=-4.542
Batch 450/537: Loss=0.9013 (C:0.9013, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.963, Ratio=4.40x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.953, Ratio=4.11x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.968, Ratio=4.11x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.978, Ratio=4.02x, Gap=-4.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.991, Ratio=4.23x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.976, Ratio=4.14x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.976, Ratio=4.32x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.973, Ratio=4.21x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.984, Ratio=4.17x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.983, Ratio=4.25x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.965, Ratio=4.18x, Gap=-4.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.952, Ratio=4.11x, Gap=-4.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.946, Ratio=4.07x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.969, Ratio=4.30x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.962, Ratio=4.18x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.956, Ratio=4.04x, Gap=-4.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.958, Ratio=4.06x, Gap=-4.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.978, Ratio=4.19x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.955, Ratio=4.16x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.986, Ratio=4.34x, Gap=-4.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.967, Ratio=4.36x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.963, Ratio=4.13x, Gap=-4.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.958, Ratio=3.99x, Gap=-4.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.979, Ratio=4.30x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.990, Ratio=4.36x, Gap=-4.286
Batch 475/537: Loss=0.8590 (C:0.8590, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.981, Ratio=4.24x, Gap=-4.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.966, Ratio=4.20x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.970, Ratio=4.10x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.967, Ratio=4.23x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.979, Ratio=4.38x, Gap=-4.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.968, Ratio=4.16x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.954, Ratio=4.08x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.954, Ratio=4.24x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.952, Ratio=4.02x, Gap=-4.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.960, Ratio=4.20x, Gap=-4.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.965, Ratio=4.18x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.948, Ratio=4.09x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.954, Ratio=3.98x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.949, Ratio=4.09x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.968, Ratio=4.18x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.975, Ratio=4.18x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.972, Ratio=4.26x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.957, Ratio=4.14x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.977, Ratio=4.16x, Gap=-4.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.984, Ratio=4.35x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.953, Ratio=3.98x, Gap=-4.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.972, Ratio=4.05x, Gap=-4.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.973, Ratio=4.10x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.963, Ratio=4.07x, Gap=-4.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.969, Ratio=4.19x, Gap=-3.738
Batch 500/537: Loss=0.8846 (C:0.8846, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.958, Ratio=4.08x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.961, Ratio=4.14x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.969, Ratio=4.04x, Gap=-4.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.943, Ratio=4.10x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.973, Ratio=4.23x, Gap=-4.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.937, Ratio=3.96x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.938, Ratio=4.02x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.968, Ratio=4.09x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.949, Ratio=3.91x, Gap=-4.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.971, Ratio=4.32x, Gap=-4.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.969, Ratio=4.32x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.988, Ratio=4.46x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.968, Ratio=4.23x, Gap=-4.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.972, Ratio=4.14x, Gap=-4.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.960, Ratio=3.95x, Gap=-4.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.976, Ratio=4.22x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.009, Ratio=4.44x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.953, Ratio=4.09x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.981, Ratio=4.15x, Gap=-4.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.993, Ratio=4.45x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.950, Ratio=4.06x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.977, Ratio=4.33x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.963, Ratio=4.25x, Gap=-4.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.970, Ratio=4.47x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.949, Ratio=4.09x, Gap=-3.940
Batch 525/537: Loss=0.8958 (C:0.8958, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.960, Ratio=4.16x, Gap=-4.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.962, Ratio=4.09x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.975, Ratio=4.22x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.982, Ratio=4.39x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.979, Ratio=4.22x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.979, Ratio=4.18x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.951, Ratio=4.08x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.967, Ratio=4.06x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.969, Ratio=4.05x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.970, Ratio=4.09x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.963, Ratio=4.08x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.987, Ratio=4.66x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.983, Ratio=4.74x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.975, Ratio=4.45x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.991, Ratio=4.44x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.993, Ratio=4.74x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.969, Ratio=4.37x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.975, Ratio=4.44x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.993, Ratio=4.78x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.998, Ratio=4.64x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.998, Ratio=4.73x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.977, Ratio=4.59x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.980, Ratio=4.43x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.987, Ratio=4.64x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.020, Ratio=4.94x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.001, Ratio=4.59x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.976, Ratio=4.63x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.992, Ratio=4.67x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.986, Ratio=4.68x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.986, Ratio=4.65x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.010, Ratio=4.86x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.969, Ratio=4.45x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.993, Ratio=4.70x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.995, Ratio=4.63x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.985, Ratio=4.56x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.008, Ratio=4.96x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.001, Ratio=4.64x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.993, Ratio=4.60x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.991, Ratio=4.66x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.985, Ratio=4.46x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.999, Ratio=4.94x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.989, Ratio=4.40x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.986, Ratio=4.63x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.985, Ratio=4.50x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.990, Ratio=4.75x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.991, Ratio=4.71x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.995, Ratio=4.57x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.981, Ratio=4.45x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.980, Ratio=4.53x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.997, Ratio=4.73x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.978, Ratio=4.62x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.988, Ratio=4.55x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.000, Ratio=4.87x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.016, Ratio=4.80x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.989, Ratio=4.83x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.991, Ratio=4.61x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.992, Ratio=4.98x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.021, Ratio=4.93x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.015, Ratio=4.76x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.007, Ratio=4.85x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.985, Ratio=4.50x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.987, Ratio=4.51x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.002, Ratio=4.74x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.974, Ratio=4.54x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.981, Ratio=4.54x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.996, Ratio=4.81x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.984, Ratio=4.70x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.006, Ratio=4.77x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.013, Ratio=4.89x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.978, Ratio=4.67x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.006, Ratio=4.97x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.980, Ratio=4.68x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.993, Ratio=4.64x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.990, Ratio=4.68x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.980, Ratio=4.60x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=2.008, Ratio=5.02x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.990, Ratio=4.58x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.983, Ratio=4.62x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.987, Ratio=4.64x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.000, Ratio=4.65x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.987, Ratio=4.59x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.992, Ratio=4.75x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.985, Ratio=4.55x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.000, Ratio=4.61x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.004, Ratio=4.85x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.975, Ratio=4.36x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.992, Ratio=4.72x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.992, Ratio=4.77x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.992, Ratio=4.83x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.992, Ratio=4.77x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.997, Ratio=4.64x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.994, Ratio=4.87x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.975, Ratio=4.51x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.989, Ratio=4.85x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.014, Ratio=4.86x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.986, Ratio=4.74x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.993, Ratio=4.73x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.997, Ratio=4.71x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.986, Ratio=4.40x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.987, Ratio=4.68x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.965, Ratio=4.61x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.987, Ratio=4.71x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.991, Ratio=4.65x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.994, Ratio=4.61x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.966, Ratio=4.52x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.967, Ratio=4.50x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.998, Ratio=4.73x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.986, Ratio=4.67x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.960, Ratio=4.49x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.991, Ratio=4.73x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.001, Ratio=4.80x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.979, Ratio=4.47x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.997, Ratio=4.88x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.967, Ratio=4.45x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.006, Ratio=4.82x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.996, Ratio=4.83x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.989, Ratio=4.83x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.968, Ratio=4.43x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.008, Ratio=4.75x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.990, Ratio=4.70x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.974, Ratio=4.49x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.984, Ratio=4.71x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.960, Ratio=4.43x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.980, Ratio=4.51x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.997, Ratio=4.77x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.005, Ratio=4.74x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.972, Ratio=4.55x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.977, Ratio=4.61x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.996, Ratio=4.65x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.974, Ratio=4.57x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.007, Ratio=4.70x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.986, Ratio=4.64x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.975, Ratio=4.53x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.976, Ratio=4.58x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.987, Ratio=4.93x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.009, Ratio=4.87x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.988, Ratio=4.73x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.974, Ratio=4.48x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.973, Ratio=4.56x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.014, Ratio=4.75x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.978, Ratio=4.69x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.983, Ratio=4.65x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.008, Ratio=4.91x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.987, Ratio=4.59x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.980, Ratio=4.43x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.976, Ratio=4.55x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.979, Ratio=4.65x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.957, Ratio=4.41x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.986, Ratio=4.62x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.984, Ratio=4.55x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.975, Ratio=4.51x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.015, Ratio=4.89x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.989, Ratio=4.71x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.994, Ratio=4.73x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.988, Ratio=4.61x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.986, Ratio=4.66x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.974, Ratio=4.59x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.983, Ratio=4.55x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.012, Ratio=4.76x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.984, Ratio=4.47x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.980, Ratio=4.58x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.000, Ratio=4.77x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.998, Ratio=4.50x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.997, Ratio=4.60x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.992, Ratio=4.90x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.969, Ratio=4.58x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.999, Ratio=4.91x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.020, Ratio=4.87x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.993, Ratio=4.74x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.980, Ratio=4.49x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.004, Ratio=4.77x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.990, Ratio=4.51x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.987, Ratio=4.62x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.002, Ratio=4.84x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.994, Ratio=4.68x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.985, Ratio=4.47x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.017, Ratio=4.95x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.003, Ratio=4.81x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.989, Ratio=4.70x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=2.031, Ratio=5.10x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.995, Ratio=4.70x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.994, Ratio=4.64x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.991, Ratio=4.78x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.993, Ratio=4.88x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.992, Ratio=4.61x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.983, Ratio=4.75x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.980, Ratio=4.51x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.972, Ratio=4.53x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.999, Ratio=4.63x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.969, Ratio=4.44x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.997, Ratio=4.74x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.970, Ratio=4.54x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.952, Ratio=4.30x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.021, Ratio=4.92x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.982, Ratio=4.47x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.014, Ratio=4.83x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.994, Ratio=4.65x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.000, Ratio=4.88x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.988, Ratio=4.84x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.005, Ratio=4.81x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.008, Ratio=4.94x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.985, Ratio=4.69x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.997, Ratio=4.63x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.971, Ratio=4.29x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.003, Ratio=4.88x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.988, Ratio=4.63x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.980, Ratio=4.51x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.973, Ratio=4.58x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.983, Ratio=4.70x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.004, Ratio=4.79x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.012, Ratio=4.85x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.981, Ratio=4.40x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.991, Ratio=4.69x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.977, Ratio=4.60x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.009, Ratio=4.82x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.998, Ratio=4.56x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.994, Ratio=4.63x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.994, Ratio=4.77x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.998, Ratio=4.85x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.979, Ratio=4.72x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.014, Ratio=4.86x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.997, Ratio=4.60x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.987, Ratio=4.52x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.990, Ratio=4.59x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.990, Ratio=4.69x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.998, Ratio=4.78x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.004, Ratio=4.84x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.992, Ratio=4.62x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.998, Ratio=4.68x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.989, Ratio=4.85x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.012, Ratio=4.88x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.994, Ratio=4.84x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.986, Ratio=4.62x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.980, Ratio=4.53x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.981, Ratio=4.62x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.972, Ratio=4.53x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.991, Ratio=4.68x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.989, Ratio=4.65x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.970, Ratio=4.45x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.981, Ratio=4.61x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.978, Ratio=4.61x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.987, Ratio=4.71x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.388, Neg=2.028, Ratio=5.23x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.992, Ratio=4.59x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.995, Ratio=4.76x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.005, Ratio=4.68x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.977, Ratio=4.53x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.983, Ratio=4.49x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.992, Ratio=4.67x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.991, Ratio=4.69x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.965, Ratio=4.35x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.002, Ratio=4.76x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.010, Ratio=4.72x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.992, Ratio=4.63x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.989, Ratio=4.62x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.986, Ratio=4.68x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.003, Ratio=4.71x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.995, Ratio=4.71x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.007, Ratio=4.84x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.966, Ratio=4.56x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.983, Ratio=4.62x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.986, Ratio=4.51x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.995, Ratio=4.59x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.971, Ratio=4.52x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.007, Ratio=4.99x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.976, Ratio=4.63x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.982, Ratio=4.55x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.974, Ratio=4.47x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.976, Ratio=4.56x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.007, Ratio=4.93x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.994, Ratio=4.67x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.007, Ratio=4.74x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.985, Ratio=4.52x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.991, Ratio=4.53x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.000, Ratio=4.77x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.976, Ratio=4.35x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.008, Ratio=4.72x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.981, Ratio=4.79x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.997, Ratio=4.60x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.995, Ratio=4.63x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.986, Ratio=4.54x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.982, Ratio=4.63x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.005, Ratio=4.81x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.002, Ratio=4.93x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.988, Ratio=4.52x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.989, Ratio=4.55x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.983, Ratio=4.58x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.011, Ratio=4.79x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.995, Ratio=4.61x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=2.005, Ratio=5.02x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.993, Ratio=4.64x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.977, Ratio=4.57x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.984, Ratio=4.65x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.977, Ratio=4.32x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.982, Ratio=4.48x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.999, Ratio=4.63x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.994, Ratio=4.78x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.982, Ratio=4.57x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.985, Ratio=4.54x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.995, Ratio=4.86x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.988, Ratio=4.87x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.969, Ratio=4.61x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.006, Ratio=4.81x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.004, Ratio=4.76x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.987, Ratio=4.64x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.972, Ratio=4.53x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.995, Ratio=4.61x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.016, Ratio=5.02x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.996, Ratio=4.85x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.006, Ratio=4.86x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.984, Ratio=4.50x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.995, Ratio=4.76x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.991, Ratio=4.64x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.000, Ratio=4.99x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.994, Ratio=4.76x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.996, Ratio=4.85x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.984, Ratio=4.59x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.990, Ratio=4.75x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.983, Ratio=4.83x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.994, Ratio=4.87x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.991, Ratio=4.66x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.989, Ratio=4.62x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.993, Ratio=4.67x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.969, Ratio=4.41x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.016, Ratio=4.88x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.004, Ratio=4.68x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.988, Ratio=4.76x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.979, Ratio=4.57x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.996, Ratio=4.71x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.994, Ratio=4.74x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.987, Ratio=4.54x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.996, Ratio=4.71x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.999, Ratio=4.47x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.958, Ratio=4.21x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.997, Ratio=4.75x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.994, Ratio=4.54x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.009, Ratio=4.82x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.987, Ratio=4.63x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.016, Ratio=4.94x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.995, Ratio=4.81x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.993, Ratio=4.45x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.984, Ratio=4.60x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.995, Ratio=4.70x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.986, Ratio=4.57x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.973, Ratio=4.49x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.006, Ratio=5.00x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.971, Ratio=4.47x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.972, Ratio=4.55x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.975, Ratio=4.81x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.005, Ratio=4.80x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.982, Ratio=4.61x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.991, Ratio=4.75x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.968, Ratio=4.45x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.016, Ratio=4.83x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.981, Ratio=4.72x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.956, Ratio=4.29x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.982, Ratio=4.51x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.976, Ratio=4.67x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.957, Ratio=4.51x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.981, Ratio=4.67x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.987, Ratio=4.65x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.959, Ratio=4.30x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.988, Ratio=4.66x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.994, Ratio=4.92x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.988, Ratio=4.54x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.004, Ratio=4.78x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.967, Ratio=4.29x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.002, Ratio=4.74x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.991, Ratio=4.69x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.011, Ratio=4.94x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.986, Ratio=4.65x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.005, Ratio=4.80x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.970, Ratio=4.66x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.983, Ratio=4.60x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.990, Ratio=4.60x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.990, Ratio=4.66x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.999, Ratio=4.77x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.002, Ratio=4.87x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.002, Ratio=4.63x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.997, Ratio=4.71x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.989, Ratio=4.64x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.976, Ratio=4.63x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.987, Ratio=4.58x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.000, Ratio=4.85x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.972, Ratio=4.38x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.974, Ratio=4.55x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.989, Ratio=4.60x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.969, Ratio=4.41x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.005, Ratio=4.66x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.998, Ratio=4.68x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.000, Ratio=4.81x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.982, Ratio=4.65x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.983, Ratio=4.59x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.980, Ratio=4.38x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.976, Ratio=4.62x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.983, Ratio=4.70x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.972, Ratio=4.59x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.989, Ratio=4.77x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.998, Ratio=4.79x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.004, Ratio=4.82x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.992, Ratio=4.67x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.978, Ratio=4.56x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.000, Ratio=4.77x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.990, Ratio=4.62x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.992, Ratio=4.82x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.987, Ratio=4.68x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.981, Ratio=4.82x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.997, Ratio=4.62x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.973, Ratio=4.64x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.991, Ratio=4.89x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.977, Ratio=4.48x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.011, Ratio=4.96x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.004, Ratio=4.70x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.995, Ratio=4.63x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.976, Ratio=4.47x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.978, Ratio=4.49x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.995, Ratio=4.62x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.003, Ratio=4.67x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.998, Ratio=4.64x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.972, Ratio=4.47x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.992, Ratio=4.65x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.991, Ratio=4.70x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.972, Ratio=4.56x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.994, Ratio=4.67x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.973, Ratio=4.53x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.005, Ratio=4.89x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.996, Ratio=4.66x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.981, Ratio=4.59x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.993, Ratio=4.66x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.991, Ratio=4.68x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.011, Ratio=4.90x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.984, Ratio=4.83x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.988, Ratio=4.58x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.989, Ratio=4.46x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.992, Ratio=4.89x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.998, Ratio=4.86x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.975, Ratio=4.63x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.997, Ratio=4.68x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.996, Ratio=4.78x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.980, Ratio=4.66x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.981, Ratio=4.53x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.985, Ratio=4.57x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.988, Ratio=4.72x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.976, Ratio=4.64x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.976, Ratio=4.68x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.981, Ratio=4.59x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.992, Ratio=4.68x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.001, Ratio=4.70x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.983, Ratio=4.62x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.977, Ratio=4.45x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.004, Ratio=4.75x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.987, Ratio=4.56x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.981, Ratio=4.51x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.000, Ratio=4.77x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.972, Ratio=4.55x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.977, Ratio=4.57x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.002, Ratio=4.88x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.000, Ratio=4.73x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.995, Ratio=4.68x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.996, Ratio=4.92x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.001, Ratio=4.90x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.024, Ratio=4.96x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.973, Ratio=4.37x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.981, Ratio=4.56x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.981, Ratio=4.54x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.982, Ratio=4.53x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.008, Ratio=4.87x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.981, Ratio=4.53x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.979, Ratio=4.71x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.003, Ratio=4.96x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.987, Ratio=4.70x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.999, Ratio=4.72x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.984, Ratio=4.73x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.987, Ratio=4.53x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.018, Ratio=4.66x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.982, Ratio=4.59x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.996, Ratio=4.78x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.986, Ratio=4.50x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.004, Ratio=4.83x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.980, Ratio=4.82x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.012, Ratio=4.65x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.002, Ratio=4.79x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.009, Ratio=4.78x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.960, Ratio=4.30x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.967, Ratio=4.41x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.999, Ratio=4.91x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.011, Ratio=4.95x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.002, Ratio=4.89x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.999, Ratio=4.68x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.002, Ratio=4.68x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.001, Ratio=4.84x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.003, Ratio=4.96x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.984, Ratio=4.56x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.000, Ratio=4.58x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.998, Ratio=4.80x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.977, Ratio=4.34x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.985, Ratio=4.45x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.988, Ratio=4.70x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.974, Ratio=4.46x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.991, Ratio=4.52x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.977, Ratio=4.69x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.970, Ratio=4.47x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.983, Ratio=4.49x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.983, Ratio=4.50x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.986, Ratio=4.69x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.015, Ratio=5.00x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.965, Ratio=4.55x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.980, Ratio=4.48x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.973, Ratio=4.44x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.027, Ratio=5.11x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.006, Ratio=4.73x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.952, Ratio=4.25x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.970, Ratio=4.35x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.970, Ratio=4.58x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.993, Ratio=4.51x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.985, Ratio=4.52x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.984, Ratio=4.51x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.002, Ratio=4.72x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.973, Ratio=4.42x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.987, Ratio=4.74x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.978, Ratio=4.58x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.001, Ratio=4.82x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.996, Ratio=4.64x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.002, Ratio=4.75x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.007, Ratio=4.67x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.989, Ratio=4.93x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.011, Ratio=4.90x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.971, Ratio=4.53x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.994, Ratio=4.70x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.006, Ratio=4.75x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.988, Ratio=4.77x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.997, Ratio=4.66x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.990, Ratio=4.56x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.971, Ratio=4.46x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.994, Ratio=4.79x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.971, Ratio=4.42x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.988, Ratio=4.74x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.980, Ratio=4.64x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.995, Ratio=4.91x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.995, Ratio=4.59x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.993, Ratio=4.70x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.996, Ratio=4.70x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.997, Ratio=4.79x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.997, Ratio=4.67x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.003, Ratio=4.85x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.001, Ratio=4.72x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.971, Ratio=4.56x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.995, Ratio=4.75x, Gap=-3.525

============================================================
Epoch 16/20 completed in 41.1s
Train: Loss=0.8836 (C:0.8836, R:0.0000) Ratio=3.59x
Val:   Loss=0.8230 (C:0.8230, R:0.0000) Ratio=4.58x
‚úÖ New best model saved (Val Loss: 0.8230)
============================================================

Epoch 17 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.997, Ratio=4.63x, Gap=-4.486
Batch   0/537: Loss=0.8237 (C:0.8237, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.982, Ratio=4.26x, Gap=-4.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.996, Ratio=4.40x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.988, Ratio=4.44x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.955, Ratio=4.16x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.971, Ratio=4.41x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.985, Ratio=4.32x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.957, Ratio=4.22x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.991, Ratio=4.32x, Gap=-5.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.940, Ratio=3.94x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.980, Ratio=4.39x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.995, Ratio=4.22x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.964, Ratio=4.06x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.972, Ratio=4.25x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.989, Ratio=4.47x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.982, Ratio=4.30x, Gap=-4.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.991, Ratio=4.33x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.964, Ratio=4.41x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.997, Ratio=4.37x, Gap=-4.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.002, Ratio=4.43x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.991, Ratio=4.49x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.960, Ratio=4.25x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.975, Ratio=4.14x, Gap=-4.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.972, Ratio=4.34x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.972, Ratio=4.18x, Gap=-4.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.986, Ratio=4.33x, Gap=-4.188
Batch  25/537: Loss=0.8593 (C:0.8593, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.961, Ratio=4.29x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.982, Ratio=4.28x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.977, Ratio=4.27x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.983, Ratio=4.45x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.990, Ratio=4.29x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.970, Ratio=4.28x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.963, Ratio=4.05x, Gap=-4.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.976, Ratio=4.41x, Gap=-5.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.003, Ratio=4.50x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.996, Ratio=4.43x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.976, Ratio=4.33x, Gap=-4.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.980, Ratio=4.26x, Gap=-4.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.001, Ratio=4.23x, Gap=-4.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.976, Ratio=4.22x, Gap=-4.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.977, Ratio=4.17x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.949, Ratio=4.03x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.956, Ratio=4.01x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.980, Ratio=4.22x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.965, Ratio=4.10x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.955, Ratio=4.03x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.969, Ratio=4.27x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.997, Ratio=4.55x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.974, Ratio=4.30x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.983, Ratio=4.43x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.983, Ratio=4.43x, Gap=-4.334
Batch  50/537: Loss=0.8516 (C:0.8516, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.938, Ratio=3.94x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.955, Ratio=4.11x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.970, Ratio=4.28x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.984, Ratio=4.30x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.979, Ratio=4.24x, Gap=-4.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.956, Ratio=4.12x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.955, Ratio=4.19x, Gap=-4.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.960, Ratio=4.00x, Gap=-4.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.974, Ratio=4.12x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.972, Ratio=4.18x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.977, Ratio=4.28x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.974, Ratio=4.07x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.975, Ratio=4.34x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.983, Ratio=4.30x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.975, Ratio=4.22x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.965, Ratio=4.17x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.972, Ratio=4.24x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.976, Ratio=4.32x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.968, Ratio=4.17x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.940, Ratio=4.09x, Gap=-4.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.955, Ratio=4.28x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.982, Ratio=4.33x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.967, Ratio=4.24x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.977, Ratio=4.34x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.001, Ratio=4.47x, Gap=-4.204
Batch  75/537: Loss=0.8431 (C:0.8431, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.972, Ratio=4.24x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.978, Ratio=4.31x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.980, Ratio=4.17x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.968, Ratio=4.00x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.949, Ratio=3.94x, Gap=-4.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.991, Ratio=4.41x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.973, Ratio=4.25x, Gap=-4.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.976, Ratio=4.14x, Gap=-4.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.955, Ratio=4.10x, Gap=-4.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.968, Ratio=4.20x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.001, Ratio=4.50x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.978, Ratio=4.36x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.968, Ratio=4.42x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.950, Ratio=4.08x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.931, Ratio=3.83x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.974, Ratio=4.40x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.958, Ratio=4.23x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.957, Ratio=4.12x, Gap=-4.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.967, Ratio=4.23x, Gap=-4.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.947, Ratio=4.17x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.966, Ratio=4.00x, Gap=-4.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.977, Ratio=4.24x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.980, Ratio=4.23x, Gap=-4.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.019, Ratio=4.67x, Gap=-4.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.981, Ratio=4.37x, Gap=-4.158
Batch 100/537: Loss=0.8544 (C:0.8544, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.957, Ratio=3.99x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.960, Ratio=4.32x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.976, Ratio=4.21x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.970, Ratio=3.96x, Gap=-4.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.988, Ratio=4.38x, Gap=-4.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.983, Ratio=4.53x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.978, Ratio=4.26x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.963, Ratio=4.34x, Gap=-4.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.967, Ratio=4.23x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.940, Ratio=4.12x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.963, Ratio=4.25x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.972, Ratio=4.28x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.949, Ratio=4.19x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.975, Ratio=4.28x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.935, Ratio=4.07x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.967, Ratio=4.32x, Gap=-4.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.964, Ratio=4.30x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.964, Ratio=4.22x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.992, Ratio=4.23x, Gap=-4.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.967, Ratio=4.25x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.993, Ratio=4.34x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.984, Ratio=4.13x, Gap=-4.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.998, Ratio=4.61x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.994, Ratio=4.38x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.985, Ratio=4.28x, Gap=-4.650
Batch 125/537: Loss=0.8679 (C:0.8679, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.966, Ratio=4.09x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.999, Ratio=4.37x, Gap=-4.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.974, Ratio=4.14x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.971, Ratio=4.33x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.968, Ratio=4.15x, Gap=-4.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.941, Ratio=4.06x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.961, Ratio=4.14x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.972, Ratio=4.42x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.958, Ratio=4.16x, Gap=-4.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.973, Ratio=4.34x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.951, Ratio=3.99x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.954, Ratio=4.23x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.974, Ratio=4.25x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.955, Ratio=4.32x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.991, Ratio=4.43x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.946, Ratio=3.96x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.985, Ratio=4.01x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.975, Ratio=4.20x, Gap=-4.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.981, Ratio=4.30x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.957, Ratio=4.20x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.959, Ratio=4.11x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.947, Ratio=4.06x, Gap=-4.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.961, Ratio=4.31x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.969, Ratio=4.18x, Gap=-4.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.973, Ratio=4.51x, Gap=-3.761
Batch 150/537: Loss=0.8405 (C:0.8405, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.976, Ratio=4.33x, Gap=-4.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.973, Ratio=4.15x, Gap=-4.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.980, Ratio=4.08x, Gap=-4.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.973, Ratio=4.09x, Gap=-4.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.982, Ratio=4.21x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.969, Ratio=4.37x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.960, Ratio=4.13x, Gap=-4.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.976, Ratio=4.18x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.970, Ratio=4.23x, Gap=-4.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.964, Ratio=4.30x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.957, Ratio=4.08x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.975, Ratio=4.30x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.953, Ratio=4.04x, Gap=-4.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.008, Ratio=4.55x, Gap=-4.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.963, Ratio=4.02x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.961, Ratio=4.15x, Gap=-4.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.955, Ratio=4.14x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.975, Ratio=4.45x, Gap=-4.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.934, Ratio=4.02x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.956, Ratio=4.20x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.981, Ratio=4.41x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.953, Ratio=4.14x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.954, Ratio=4.01x, Gap=-4.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.933, Ratio=3.94x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.975, Ratio=4.08x, Gap=-4.271
Batch 175/537: Loss=0.8979 (C:0.8979, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.012, Ratio=4.48x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.988, Ratio=4.19x, Gap=-4.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.981, Ratio=4.21x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.970, Ratio=4.23x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.958, Ratio=4.10x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.957, Ratio=4.09x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.969, Ratio=4.27x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.965, Ratio=4.20x, Gap=-4.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.949, Ratio=4.08x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.964, Ratio=4.21x, Gap=-4.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.950, Ratio=4.20x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.968, Ratio=4.27x, Gap=-5.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.972, Ratio=4.11x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.957, Ratio=4.00x, Gap=-4.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.992, Ratio=4.31x, Gap=-4.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.000, Ratio=4.51x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.995, Ratio=4.34x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.974, Ratio=4.14x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.953, Ratio=4.04x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.977, Ratio=4.22x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.991, Ratio=4.35x, Gap=-4.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.997, Ratio=4.46x, Gap=-4.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.981, Ratio=4.30x, Gap=-4.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.946, Ratio=3.97x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.970, Ratio=4.19x, Gap=-4.391
Batch 200/537: Loss=0.8830 (C:0.8830, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.966, Ratio=4.00x, Gap=-4.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.974, Ratio=4.42x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.992, Ratio=4.34x, Gap=-4.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.962, Ratio=3.94x, Gap=-4.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.006, Ratio=4.52x, Gap=-4.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.976, Ratio=4.50x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.950, Ratio=4.13x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.957, Ratio=4.18x, Gap=-4.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.967, Ratio=4.17x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.969, Ratio=4.25x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.963, Ratio=4.20x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.985, Ratio=4.25x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.963, Ratio=4.19x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.973, Ratio=4.14x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.953, Ratio=4.13x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.965, Ratio=4.27x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.950, Ratio=4.13x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.984, Ratio=4.21x, Gap=-4.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.968, Ratio=4.19x, Gap=-4.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.960, Ratio=4.11x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.957, Ratio=4.08x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.954, Ratio=4.00x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.969, Ratio=4.18x, Gap=-4.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.976, Ratio=4.19x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.983, Ratio=4.20x, Gap=-4.523
Batch 225/537: Loss=0.8782 (C:0.8782, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.983, Ratio=4.34x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.990, Ratio=4.33x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.979, Ratio=4.23x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.968, Ratio=4.31x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.985, Ratio=4.19x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.995, Ratio=4.33x, Gap=-4.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.009, Ratio=4.60x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.961, Ratio=3.93x, Gap=-4.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.990, Ratio=4.50x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.985, Ratio=4.37x, Gap=-4.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.984, Ratio=4.28x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.986, Ratio=4.34x, Gap=-4.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.953, Ratio=4.14x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.969, Ratio=4.39x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.962, Ratio=4.08x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.967, Ratio=4.13x, Gap=-4.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.944, Ratio=4.16x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.946, Ratio=4.14x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.992, Ratio=4.33x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.966, Ratio=4.03x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.982, Ratio=4.12x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.998, Ratio=4.49x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.942, Ratio=4.04x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.985, Ratio=4.26x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.979, Ratio=4.30x, Gap=-4.275
Batch 250/537: Loss=0.8704 (C:0.8704, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.968, Ratio=4.20x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.956, Ratio=4.21x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.965, Ratio=4.16x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.986, Ratio=4.27x, Gap=-4.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.954, Ratio=4.05x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.960, Ratio=4.00x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.001, Ratio=4.46x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.981, Ratio=4.19x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.953, Ratio=4.31x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.961, Ratio=4.22x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.981, Ratio=4.56x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.964, Ratio=4.13x, Gap=-4.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.957, Ratio=4.12x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.959, Ratio=4.17x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.961, Ratio=4.20x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.955, Ratio=4.17x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.966, Ratio=4.30x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.959, Ratio=4.11x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.949, Ratio=4.06x, Gap=-4.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.988, Ratio=4.24x, Gap=-4.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.980, Ratio=4.21x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.965, Ratio=4.13x, Gap=-4.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.947, Ratio=3.93x, Gap=-4.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.989, Ratio=4.28x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.985, Ratio=4.15x, Gap=-4.305
Batch 275/537: Loss=0.8872 (C:0.8872, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.992, Ratio=4.47x, Gap=-4.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.952, Ratio=4.10x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.966, Ratio=4.06x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.966, Ratio=3.99x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.957, Ratio=4.13x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.956, Ratio=4.03x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.957, Ratio=4.17x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.931, Ratio=3.93x, Gap=-4.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.967, Ratio=4.15x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.941, Ratio=4.16x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.967, Ratio=4.18x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.985, Ratio=4.19x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.992, Ratio=4.52x, Gap=-4.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.972, Ratio=4.25x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.957, Ratio=4.02x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.988, Ratio=4.28x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.978, Ratio=4.31x, Gap=-4.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.955, Ratio=4.13x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.967, Ratio=4.14x, Gap=-4.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.951, Ratio=3.98x, Gap=-4.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.955, Ratio=4.30x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.975, Ratio=4.22x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.985, Ratio=4.20x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.963, Ratio=4.20x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.965, Ratio=4.02x, Gap=-4.282
Batch 300/537: Loss=0.9074 (C:0.9074, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.964, Ratio=4.10x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.960, Ratio=4.11x, Gap=-4.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.969, Ratio=4.18x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.965, Ratio=4.24x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.969, Ratio=4.21x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.951, Ratio=4.03x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.955, Ratio=3.96x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.967, Ratio=4.13x, Gap=-4.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.966, Ratio=4.19x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.950, Ratio=4.06x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.946, Ratio=4.05x, Gap=-4.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.959, Ratio=4.03x, Gap=-4.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.981, Ratio=4.20x, Gap=-4.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.950, Ratio=3.90x, Gap=-4.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.978, Ratio=4.21x, Gap=-4.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.976, Ratio=4.36x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.955, Ratio=4.15x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.947, Ratio=4.05x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.948, Ratio=3.92x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.966, Ratio=4.25x, Gap=-4.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.964, Ratio=4.28x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.971, Ratio=4.43x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.974, Ratio=4.30x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.964, Ratio=3.91x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.980, Ratio=4.32x, Gap=-4.330
Batch 325/537: Loss=0.8622 (C:0.8622, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.985, Ratio=4.26x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.966, Ratio=4.14x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.983, Ratio=4.16x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.994, Ratio=4.21x, Gap=-4.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.968, Ratio=4.19x, Gap=-4.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.953, Ratio=3.92x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.987, Ratio=4.34x, Gap=-4.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.953, Ratio=4.02x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.986, Ratio=4.27x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.986, Ratio=4.33x, Gap=-4.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.969, Ratio=4.15x, Gap=-4.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.981, Ratio=4.22x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.959, Ratio=4.14x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.947, Ratio=4.05x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.966, Ratio=4.16x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.963, Ratio=4.20x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.944, Ratio=4.16x, Gap=-4.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.945, Ratio=4.02x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.973, Ratio=4.23x, Gap=-4.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.990, Ratio=4.25x, Gap=-4.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.967, Ratio=4.17x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.976, Ratio=4.13x, Gap=-5.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.966, Ratio=4.10x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.976, Ratio=4.15x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.984, Ratio=4.27x, Gap=-4.400
Batch 350/537: Loss=0.8667 (C:0.8667, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.954, Ratio=3.98x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.973, Ratio=4.22x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.964, Ratio=4.21x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.957, Ratio=4.17x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.973, Ratio=4.26x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.946, Ratio=3.91x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.971, Ratio=4.20x, Gap=-4.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.963, Ratio=4.26x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.953, Ratio=4.16x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.960, Ratio=4.20x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.986, Ratio=4.35x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.968, Ratio=4.28x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.985, Ratio=4.23x, Gap=-4.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.968, Ratio=4.12x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.976, Ratio=4.06x, Gap=-4.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.964, Ratio=4.19x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.985, Ratio=4.26x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.976, Ratio=4.23x, Gap=-4.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.961, Ratio=4.15x, Gap=-4.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.980, Ratio=4.13x, Gap=-4.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.976, Ratio=4.17x, Gap=-4.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.942, Ratio=4.00x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.987, Ratio=4.36x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.958, Ratio=4.03x, Gap=-4.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.982, Ratio=4.29x, Gap=-4.193
Batch 375/537: Loss=0.8665 (C:0.8665, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.946, Ratio=4.00x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.973, Ratio=4.12x, Gap=-4.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.954, Ratio=4.00x, Gap=-4.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.935, Ratio=3.97x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.949, Ratio=3.89x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.964, Ratio=4.21x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.963, Ratio=4.14x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.959, Ratio=4.15x, Gap=-4.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.937, Ratio=3.97x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.967, Ratio=4.30x, Gap=-4.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.969, Ratio=4.15x, Gap=-4.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.977, Ratio=4.19x, Gap=-4.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.965, Ratio=4.09x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.979, Ratio=4.18x, Gap=-4.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.957, Ratio=3.99x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.969, Ratio=4.04x, Gap=-4.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.960, Ratio=4.24x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.974, Ratio=4.30x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.959, Ratio=4.04x, Gap=-4.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.978, Ratio=4.27x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.991, Ratio=4.32x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.989, Ratio=4.41x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.007, Ratio=4.48x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.953, Ratio=4.10x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.964, Ratio=4.24x, Gap=-3.961
Batch 400/537: Loss=0.8740 (C:0.8740, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.962, Ratio=4.16x, Gap=-4.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.954, Ratio=4.16x, Gap=-4.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.975, Ratio=4.19x, Gap=-4.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.960, Ratio=4.22x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.981, Ratio=4.20x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.961, Ratio=3.98x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.957, Ratio=4.02x, Gap=-4.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.011, Ratio=4.49x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.962, Ratio=4.10x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.950, Ratio=4.08x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.976, Ratio=4.20x, Gap=-4.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.958, Ratio=3.95x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.977, Ratio=4.30x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.969, Ratio=4.25x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.976, Ratio=4.40x, Gap=-4.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.945, Ratio=4.05x, Gap=-4.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.967, Ratio=4.49x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.963, Ratio=4.24x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.977, Ratio=4.32x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.974, Ratio=4.22x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.960, Ratio=4.02x, Gap=-4.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.955, Ratio=4.05x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.986, Ratio=4.32x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.989, Ratio=4.36x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.946, Ratio=4.10x, Gap=-4.739
Batch 425/537: Loss=0.8923 (C:0.8923, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.988, Ratio=4.25x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.983, Ratio=4.21x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.962, Ratio=4.12x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.981, Ratio=4.36x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.980, Ratio=4.27x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.967, Ratio=4.11x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.964, Ratio=4.14x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.981, Ratio=4.45x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.951, Ratio=4.22x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.967, Ratio=4.13x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.959, Ratio=4.08x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.976, Ratio=4.27x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.941, Ratio=4.00x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.966, Ratio=4.05x, Gap=-4.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.981, Ratio=4.23x, Gap=-4.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.976, Ratio=4.26x, Gap=-4.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.983, Ratio=4.28x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.986, Ratio=4.16x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.992, Ratio=4.42x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.966, Ratio=4.13x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.977, Ratio=4.30x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.981, Ratio=4.21x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.972, Ratio=4.33x, Gap=-4.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.957, Ratio=4.07x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.965, Ratio=4.12x, Gap=-4.195
Batch 450/537: Loss=0.8901 (C:0.8901, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.971, Ratio=4.49x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.946, Ratio=4.03x, Gap=-4.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.968, Ratio=4.31x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.952, Ratio=4.15x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.968, Ratio=4.05x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.954, Ratio=4.11x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.968, Ratio=4.25x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.963, Ratio=4.14x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.968, Ratio=4.20x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.963, Ratio=4.22x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.960, Ratio=3.99x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.987, Ratio=4.22x, Gap=-4.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.962, Ratio=4.10x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.956, Ratio=4.01x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.972, Ratio=4.04x, Gap=-4.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.975, Ratio=4.17x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.960, Ratio=4.09x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.991, Ratio=4.38x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.969, Ratio=4.26x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.976, Ratio=4.14x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.957, Ratio=4.00x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.943, Ratio=4.17x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.957, Ratio=4.20x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.951, Ratio=4.07x, Gap=-4.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.965, Ratio=4.26x, Gap=-4.112
Batch 475/537: Loss=0.8747 (C:0.8747, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.981, Ratio=4.29x, Gap=-4.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.943, Ratio=4.08x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.947, Ratio=4.12x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.976, Ratio=4.23x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.968, Ratio=4.10x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.968, Ratio=4.14x, Gap=-4.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.975, Ratio=4.25x, Gap=-4.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.952, Ratio=4.05x, Gap=-4.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.967, Ratio=4.11x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.934, Ratio=3.89x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.976, Ratio=4.29x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.956, Ratio=3.87x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.953, Ratio=4.05x, Gap=-4.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.979, Ratio=4.20x, Gap=-4.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.956, Ratio=3.94x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.965, Ratio=4.10x, Gap=-4.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.953, Ratio=4.06x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.971, Ratio=4.25x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.955, Ratio=4.08x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.983, Ratio=4.34x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.958, Ratio=4.23x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.957, Ratio=4.16x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.947, Ratio=4.05x, Gap=-4.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.958, Ratio=4.03x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.965, Ratio=4.08x, Gap=-4.459
Batch 500/537: Loss=0.8981 (C:0.8981, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.969, Ratio=4.15x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.994, Ratio=4.40x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.956, Ratio=4.29x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.976, Ratio=4.27x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.953, Ratio=3.99x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.981, Ratio=4.21x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.961, Ratio=4.18x, Gap=-4.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.975, Ratio=4.15x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.998, Ratio=4.28x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.992, Ratio=4.18x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.972, Ratio=4.01x, Gap=-4.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.971, Ratio=4.16x, Gap=-4.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.984, Ratio=4.30x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.948, Ratio=4.31x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.970, Ratio=4.21x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.944, Ratio=3.97x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.946, Ratio=4.15x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.974, Ratio=4.34x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.963, Ratio=4.20x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.963, Ratio=4.32x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.980, Ratio=4.22x, Gap=-4.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.989, Ratio=4.47x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.950, Ratio=4.20x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.968, Ratio=4.18x, Gap=-4.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.961, Ratio=4.18x, Gap=-4.343
Batch 525/537: Loss=0.8823 (C:0.8823, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.004, Ratio=4.38x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.977, Ratio=4.05x, Gap=-4.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.992, Ratio=4.47x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.984, Ratio=4.26x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.968, Ratio=3.99x, Gap=-4.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.994, Ratio=4.51x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.959, Ratio=3.99x, Gap=-5.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.962, Ratio=4.22x, Gap=-4.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.962, Ratio=4.01x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.959, Ratio=4.00x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.964, Ratio=4.37x, Gap=-4.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.977, Ratio=4.45x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.977, Ratio=4.39x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.991, Ratio=4.59x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.001, Ratio=4.91x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=2.016, Ratio=5.07x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.960, Ratio=4.41x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.973, Ratio=4.68x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.994, Ratio=4.67x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.995, Ratio=4.74x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.990, Ratio=4.72x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.994, Ratio=4.93x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.988, Ratio=4.78x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.984, Ratio=4.78x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.013, Ratio=4.89x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.989, Ratio=4.72x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.980, Ratio=4.53x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.991, Ratio=4.72x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.992, Ratio=4.82x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.977, Ratio=4.73x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=2.013, Ratio=5.18x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.983, Ratio=4.82x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.976, Ratio=4.57x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=2.021, Ratio=5.07x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.009, Ratio=4.92x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.965, Ratio=4.42x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.954, Ratio=4.34x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.979, Ratio=4.56x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.005, Ratio=5.05x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.981, Ratio=4.54x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.992, Ratio=4.93x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.969, Ratio=4.53x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.984, Ratio=4.68x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.987, Ratio=4.57x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.962, Ratio=4.39x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.991, Ratio=4.80x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.982, Ratio=4.80x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.999, Ratio=4.92x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.991, Ratio=4.83x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.979, Ratio=4.61x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.977, Ratio=4.52x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.989, Ratio=4.70x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.973, Ratio=4.78x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.983, Ratio=4.82x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.977, Ratio=4.41x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.976, Ratio=4.89x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.973, Ratio=4.57x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.986, Ratio=4.68x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.999, Ratio=4.81x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.985, Ratio=4.80x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.977, Ratio=4.69x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.965, Ratio=4.55x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.980, Ratio=4.57x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.994, Ratio=4.79x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.989, Ratio=4.74x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.992, Ratio=4.90x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.983, Ratio=4.62x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.001, Ratio=4.91x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.976, Ratio=4.47x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.991, Ratio=4.67x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.992, Ratio=4.82x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.980, Ratio=4.59x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.002, Ratio=4.72x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.979, Ratio=4.70x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.994, Ratio=4.85x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.972, Ratio=4.69x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.992, Ratio=4.67x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.993, Ratio=4.93x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.993, Ratio=4.68x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.994, Ratio=4.81x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.984, Ratio=4.57x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.990, Ratio=4.63x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.970, Ratio=4.61x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.007, Ratio=4.99x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=2.025, Ratio=5.13x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.992, Ratio=4.78x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.988, Ratio=4.65x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.967, Ratio=4.47x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.990, Ratio=4.71x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.001, Ratio=4.93x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.000, Ratio=4.72x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.989, Ratio=4.55x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.984, Ratio=4.66x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.004, Ratio=4.74x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.994, Ratio=4.81x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.974, Ratio=4.65x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.993, Ratio=4.87x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.012, Ratio=5.01x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.976, Ratio=4.58x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.992, Ratio=4.75x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.973, Ratio=4.61x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.992, Ratio=4.67x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.982, Ratio=4.46x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.985, Ratio=4.64x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.978, Ratio=4.70x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.969, Ratio=4.63x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.988, Ratio=4.65x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.005, Ratio=5.05x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.997, Ratio=4.98x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.982, Ratio=4.59x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.988, Ratio=4.73x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.996, Ratio=4.81x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.992, Ratio=4.75x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.010, Ratio=4.99x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.961, Ratio=4.53x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.993, Ratio=4.72x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.002, Ratio=4.84x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.991, Ratio=4.76x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.004, Ratio=4.91x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.976, Ratio=4.65x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.001, Ratio=4.83x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.997, Ratio=4.83x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.980, Ratio=4.57x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.005, Ratio=4.86x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.997, Ratio=4.85x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.969, Ratio=4.44x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.990, Ratio=4.69x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.987, Ratio=4.73x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=2.012, Ratio=5.09x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.006, Ratio=4.87x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.974, Ratio=4.55x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.992, Ratio=4.80x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.993, Ratio=4.69x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.980, Ratio=4.48x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.003, Ratio=4.82x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.976, Ratio=4.48x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.987, Ratio=4.92x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.000, Ratio=4.97x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.972, Ratio=4.56x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.988, Ratio=4.87x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.992, Ratio=4.74x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.990, Ratio=4.56x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.992, Ratio=4.68x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.994, Ratio=4.87x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.978, Ratio=4.75x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.979, Ratio=4.65x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.983, Ratio=4.47x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.971, Ratio=4.66x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.005, Ratio=5.00x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.993, Ratio=4.69x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.967, Ratio=4.45x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.977, Ratio=4.54x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.382, Neg=2.002, Ratio=5.23x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.987, Ratio=4.84x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.009, Ratio=4.84x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.983, Ratio=4.70x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.970, Ratio=4.56x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.002, Ratio=4.81x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.000, Ratio=4.79x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.980, Ratio=4.67x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.983, Ratio=4.69x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.999, Ratio=4.92x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.009, Ratio=4.99x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.970, Ratio=4.58x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.997, Ratio=4.67x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.988, Ratio=4.54x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.981, Ratio=4.71x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.011, Ratio=4.99x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.983, Ratio=4.66x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.972, Ratio=4.70x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.002, Ratio=4.67x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.983, Ratio=4.80x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.972, Ratio=4.52x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.968, Ratio=4.58x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.998, Ratio=4.84x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.957, Ratio=4.42x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.997, Ratio=4.96x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.980, Ratio=4.73x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.988, Ratio=4.66x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.984, Ratio=4.81x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.995, Ratio=4.80x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.992, Ratio=4.85x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.995, Ratio=4.72x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.994, Ratio=4.78x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.989, Ratio=4.72x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.003, Ratio=4.87x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.967, Ratio=4.46x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.971, Ratio=4.59x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.984, Ratio=4.65x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.982, Ratio=4.60x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.991, Ratio=4.76x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.007, Ratio=4.99x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.993, Ratio=4.65x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.989, Ratio=4.99x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.990, Ratio=4.99x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.995, Ratio=4.79x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.983, Ratio=4.65x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.990, Ratio=4.92x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.966, Ratio=4.51x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.000, Ratio=4.98x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.986, Ratio=4.62x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.985, Ratio=4.72x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.996, Ratio=4.85x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.963, Ratio=4.48x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.007, Ratio=4.97x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.007, Ratio=4.99x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.979, Ratio=4.67x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.974, Ratio=4.53x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.974, Ratio=4.54x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.980, Ratio=4.66x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.955, Ratio=4.40x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.983, Ratio=4.78x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.967, Ratio=4.42x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.991, Ratio=4.68x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.979, Ratio=4.59x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.003, Ratio=4.74x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.961, Ratio=4.51x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.011, Ratio=4.88x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.995, Ratio=4.82x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.005, Ratio=4.99x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.997, Ratio=4.90x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.967, Ratio=4.45x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.982, Ratio=4.64x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.973, Ratio=4.57x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.988, Ratio=4.73x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.979, Ratio=4.84x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.989, Ratio=4.81x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.974, Ratio=4.46x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.991, Ratio=4.94x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.993, Ratio=4.85x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.977, Ratio=4.80x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.981, Ratio=4.77x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.977, Ratio=4.75x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.986, Ratio=4.80x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.004, Ratio=4.96x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.981, Ratio=4.53x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.980, Ratio=4.67x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.988, Ratio=4.71x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.983, Ratio=4.71x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.985, Ratio=4.70x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.993, Ratio=5.04x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.977, Ratio=4.54x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.984, Ratio=4.73x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.976, Ratio=4.88x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.951, Ratio=4.33x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.985, Ratio=4.80x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.995, Ratio=4.88x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.010, Ratio=5.06x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.980, Ratio=4.52x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.978, Ratio=4.52x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.986, Ratio=4.73x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.966, Ratio=4.49x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.980, Ratio=4.59x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.978, Ratio=4.66x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.982, Ratio=4.67x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.986, Ratio=4.62x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.983, Ratio=4.62x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.998, Ratio=4.90x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.997, Ratio=4.93x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.992, Ratio=4.75x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.977, Ratio=4.51x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.993, Ratio=4.73x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.004, Ratio=4.94x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.987, Ratio=4.66x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.993, Ratio=4.73x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.001, Ratio=4.77x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.978, Ratio=4.73x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.979, Ratio=4.58x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=2.016, Ratio=5.10x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.987, Ratio=4.75x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.379, Neg=2.028, Ratio=5.35x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.992, Ratio=4.69x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.988, Ratio=4.70x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.980, Ratio=4.86x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.984, Ratio=4.77x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.967, Ratio=4.53x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.980, Ratio=4.56x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.992, Ratio=4.78x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.981, Ratio=4.77x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.987, Ratio=4.74x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.984, Ratio=4.62x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.986, Ratio=4.69x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.984, Ratio=4.69x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.974, Ratio=4.66x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.984, Ratio=4.56x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.983, Ratio=4.72x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.996, Ratio=4.81x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.984, Ratio=4.57x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.974, Ratio=4.68x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.963, Ratio=4.75x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.977, Ratio=4.60x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.986, Ratio=4.76x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.970, Ratio=4.58x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.999, Ratio=5.07x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.011, Ratio=5.00x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.988, Ratio=4.79x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.982, Ratio=4.67x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.987, Ratio=4.69x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.975, Ratio=4.60x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.975, Ratio=4.59x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.002, Ratio=5.04x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.998, Ratio=4.57x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.978, Ratio=4.79x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.993, Ratio=4.90x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.976, Ratio=4.65x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.994, Ratio=5.04x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.996, Ratio=4.82x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.952, Ratio=4.28x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.977, Ratio=4.70x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.995, Ratio=4.82x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.984, Ratio=4.70x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=2.018, Ratio=5.11x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.983, Ratio=4.89x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.977, Ratio=4.57x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.979, Ratio=4.42x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.000, Ratio=4.81x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.979, Ratio=4.57x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.999, Ratio=4.87x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.974, Ratio=4.68x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.974, Ratio=4.57x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.003, Ratio=4.89x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.977, Ratio=4.49x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.979, Ratio=4.42x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.962, Ratio=4.39x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.996, Ratio=4.76x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.005, Ratio=4.98x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.975, Ratio=4.51x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.976, Ratio=4.62x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.978, Ratio=4.68x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.982, Ratio=4.58x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.960, Ratio=4.44x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.989, Ratio=4.67x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.981, Ratio=4.58x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.971, Ratio=4.42x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.003, Ratio=5.00x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.970, Ratio=4.64x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.995, Ratio=5.01x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.003, Ratio=4.86x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.977, Ratio=4.62x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.984, Ratio=4.95x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.988, Ratio=4.71x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.975, Ratio=4.57x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.986, Ratio=4.62x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.978, Ratio=4.43x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.979, Ratio=4.68x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.006, Ratio=4.75x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=2.013, Ratio=5.09x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.984, Ratio=4.62x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.985, Ratio=4.57x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.014, Ratio=4.92x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.977, Ratio=4.53x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.990, Ratio=4.95x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.000, Ratio=4.78x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.985, Ratio=4.59x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.968, Ratio=4.61x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.986, Ratio=4.57x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.990, Ratio=4.80x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.999, Ratio=4.91x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.993, Ratio=4.71x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.964, Ratio=4.51x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.984, Ratio=4.57x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.978, Ratio=4.70x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.001, Ratio=4.83x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.997, Ratio=4.80x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.997, Ratio=4.79x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.987, Ratio=4.63x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.999, Ratio=4.65x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.963, Ratio=4.34x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.986, Ratio=4.74x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.992, Ratio=4.64x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.988, Ratio=4.66x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=2.018, Ratio=5.16x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.000, Ratio=4.95x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.012, Ratio=4.93x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.976, Ratio=4.67x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.010, Ratio=4.92x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.006, Ratio=4.90x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.995, Ratio=4.53x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.987, Ratio=4.84x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.990, Ratio=4.87x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.980, Ratio=4.61x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.993, Ratio=4.83x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.990, Ratio=4.78x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.973, Ratio=4.63x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.992, Ratio=4.87x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.989, Ratio=4.72x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.980, Ratio=4.69x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.998, Ratio=4.82x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.971, Ratio=4.53x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.973, Ratio=4.61x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.996, Ratio=4.77x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.994, Ratio=4.67x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.985, Ratio=4.74x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.965, Ratio=4.58x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.994, Ratio=4.72x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.988, Ratio=4.68x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.968, Ratio=4.66x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.978, Ratio=4.75x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.990, Ratio=4.64x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.991, Ratio=4.83x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.966, Ratio=4.55x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.999, Ratio=4.97x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.990, Ratio=4.91x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.994, Ratio=4.57x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.986, Ratio=4.71x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.975, Ratio=4.73x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.990, Ratio=4.64x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.001, Ratio=4.71x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.977, Ratio=4.77x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.002, Ratio=4.90x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.977, Ratio=4.64x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.994, Ratio=4.68x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.989, Ratio=4.84x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.996, Ratio=4.83x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.983, Ratio=4.82x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.001, Ratio=4.99x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.978, Ratio=4.62x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.973, Ratio=4.65x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=2.012, Ratio=5.15x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.961, Ratio=4.53x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.996, Ratio=4.90x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.986, Ratio=4.54x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.991, Ratio=4.94x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.988, Ratio=4.71x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.986, Ratio=4.79x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.970, Ratio=4.86x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.984, Ratio=4.90x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.974, Ratio=4.54x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.987, Ratio=4.63x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.987, Ratio=4.75x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.974, Ratio=4.95x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.975, Ratio=4.57x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.979, Ratio=4.77x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.995, Ratio=4.97x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.983, Ratio=4.68x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.973, Ratio=4.60x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.978, Ratio=4.72x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.980, Ratio=4.67x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.983, Ratio=4.58x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.985, Ratio=4.93x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.003, Ratio=4.97x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.998, Ratio=4.82x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.996, Ratio=4.78x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.962, Ratio=4.69x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.997, Ratio=5.01x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.991, Ratio=4.89x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.998, Ratio=4.96x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.994, Ratio=4.80x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.007, Ratio=4.83x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.002, Ratio=4.98x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.984, Ratio=4.68x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.981, Ratio=4.66x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.990, Ratio=4.68x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.997, Ratio=4.91x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.990, Ratio=4.88x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.991, Ratio=4.93x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.003, Ratio=4.80x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.999, Ratio=4.87x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.009, Ratio=4.72x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.003, Ratio=5.04x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.015, Ratio=4.88x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.002, Ratio=4.90x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.965, Ratio=4.35x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.987, Ratio=4.83x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.999, Ratio=5.06x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.989, Ratio=4.86x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.994, Ratio=4.74x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.998, Ratio=4.85x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.980, Ratio=4.48x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.966, Ratio=4.71x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.975, Ratio=4.65x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.981, Ratio=4.69x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.985, Ratio=4.63x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.991, Ratio=4.68x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.990, Ratio=4.83x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.001, Ratio=4.94x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.983, Ratio=4.72x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.992, Ratio=4.61x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.978, Ratio=4.67x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.965, Ratio=4.53x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.962, Ratio=4.68x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.978, Ratio=4.81x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.983, Ratio=4.57x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.992, Ratio=4.71x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.978, Ratio=4.43x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.981, Ratio=4.59x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.993, Ratio=4.72x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.980, Ratio=4.62x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=2.016, Ratio=5.11x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.998, Ratio=4.70x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.981, Ratio=4.71x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.988, Ratio=4.72x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.966, Ratio=4.65x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.977, Ratio=4.54x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.997, Ratio=4.68x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.987, Ratio=4.66x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.977, Ratio=4.63x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.984, Ratio=4.52x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.978, Ratio=4.67x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.985, Ratio=4.62x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.971, Ratio=4.58x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.981, Ratio=4.80x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=2.008, Ratio=5.05x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.989, Ratio=4.57x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.983, Ratio=4.92x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.998, Ratio=4.81x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.989, Ratio=4.69x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.992, Ratio=4.65x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.970, Ratio=4.46x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.977, Ratio=4.52x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.000, Ratio=4.89x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.990, Ratio=4.68x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.998, Ratio=4.76x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.001, Ratio=4.88x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.981, Ratio=4.68x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.979, Ratio=4.64x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.004, Ratio=4.96x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.007, Ratio=4.82x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.974, Ratio=4.70x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.986, Ratio=4.94x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.009, Ratio=4.77x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.976, Ratio=4.62x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.978, Ratio=4.73x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.989, Ratio=4.69x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=2.006, Ratio=5.04x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.984, Ratio=4.65x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.982, Ratio=4.75x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.010, Ratio=4.94x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.990, Ratio=4.74x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.962, Ratio=4.38x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.999, Ratio=4.70x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.977, Ratio=4.51x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.991, Ratio=4.75x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.985, Ratio=4.65x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.977, Ratio=4.51x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.967, Ratio=4.56x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.971, Ratio=4.44x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.000, Ratio=4.97x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.989, Ratio=4.47x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.980, Ratio=4.54x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.999, Ratio=4.79x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.966, Ratio=4.50x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.986, Ratio=4.85x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.011, Ratio=4.84x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.982, Ratio=4.57x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.989, Ratio=4.74x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.958, Ratio=4.54x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.993, Ratio=4.79x, Gap=-3.520

============================================================
Epoch 17/20 completed in 33.2s
Train: Loss=0.8802 (C:0.8802, R:0.0000) Ratio=3.65x
Val:   Loss=0.8173 (C:0.8173, R:0.0000) Ratio=4.70x
‚úÖ New best model saved (Val Loss: 0.8173)
============================================================

Epoch 18 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.995, Ratio=4.53x, Gap=-4.249
Batch   0/537: Loss=0.8385 (C:0.8385, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.986, Ratio=4.27x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.966, Ratio=4.17x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.986, Ratio=4.33x, Gap=-4.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.972, Ratio=4.33x, Gap=-4.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.992, Ratio=4.43x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.941, Ratio=3.91x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.972, Ratio=4.16x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.974, Ratio=4.54x, Gap=-4.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.968, Ratio=4.16x, Gap=-4.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.971, Ratio=4.34x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.974, Ratio=4.32x, Gap=-4.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.993, Ratio=4.38x, Gap=-4.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.976, Ratio=4.21x, Gap=-4.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.982, Ratio=4.28x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.973, Ratio=4.22x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.992, Ratio=4.44x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.978, Ratio=4.31x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.981, Ratio=4.31x, Gap=-4.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.969, Ratio=4.14x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.976, Ratio=4.28x, Gap=-4.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.984, Ratio=4.39x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.962, Ratio=4.32x, Gap=-4.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.983, Ratio=4.30x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.987, Ratio=4.28x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.986, Ratio=4.41x, Gap=-4.010
Batch  25/537: Loss=0.8516 (C:0.8516, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.984, Ratio=4.31x, Gap=-4.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.976, Ratio=4.41x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.983, Ratio=4.35x, Gap=-4.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.969, Ratio=4.18x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.960, Ratio=4.45x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.981, Ratio=4.31x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.950, Ratio=4.19x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.986, Ratio=4.40x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.994, Ratio=4.48x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.006, Ratio=4.47x, Gap=-4.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.001, Ratio=4.54x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.974, Ratio=4.29x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.997, Ratio=4.25x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.971, Ratio=4.31x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.977, Ratio=4.19x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.968, Ratio=4.20x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.996, Ratio=4.50x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.961, Ratio=4.38x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.947, Ratio=4.12x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.974, Ratio=4.31x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.982, Ratio=4.43x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.970, Ratio=4.31x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.017, Ratio=4.36x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.996, Ratio=4.43x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.961, Ratio=4.25x, Gap=-4.482
Batch  50/537: Loss=0.8686 (C:0.8686, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.990, Ratio=4.17x, Gap=-4.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.999, Ratio=4.42x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.979, Ratio=4.13x, Gap=-4.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.982, Ratio=4.12x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.983, Ratio=4.38x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.983, Ratio=4.25x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.965, Ratio=4.10x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.945, Ratio=4.10x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.983, Ratio=4.46x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.960, Ratio=4.17x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.958, Ratio=4.15x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.005, Ratio=4.62x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.963, Ratio=4.21x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.962, Ratio=4.25x, Gap=-4.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.979, Ratio=4.36x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.972, Ratio=4.40x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.975, Ratio=4.49x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.005, Ratio=4.32x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.997, Ratio=4.39x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.974, Ratio=4.25x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.977, Ratio=4.29x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.997, Ratio=4.20x, Gap=-4.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.000, Ratio=4.37x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.967, Ratio=4.12x, Gap=-4.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.989, Ratio=4.44x, Gap=-4.758
Batch  75/537: Loss=0.8458 (C:0.8458, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.996, Ratio=4.41x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.972, Ratio=4.22x, Gap=-4.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.983, Ratio=4.63x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.958, Ratio=4.08x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.964, Ratio=4.21x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.977, Ratio=4.29x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.975, Ratio=4.28x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.949, Ratio=4.13x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.960, Ratio=4.22x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.948, Ratio=4.13x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.997, Ratio=4.55x, Gap=-4.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.000, Ratio=4.46x, Gap=-4.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.966, Ratio=4.22x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.980, Ratio=4.44x, Gap=-4.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.989, Ratio=4.38x, Gap=-4.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.965, Ratio=4.01x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.964, Ratio=4.16x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.006, Ratio=4.29x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.998, Ratio=4.41x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.973, Ratio=4.27x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.967, Ratio=4.32x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.955, Ratio=4.15x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.983, Ratio=4.40x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.996, Ratio=4.46x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.984, Ratio=4.28x, Gap=-4.555
Batch 100/537: Loss=0.8680 (C:0.8680, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.985, Ratio=4.44x, Gap=-4.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.012, Ratio=4.48x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.972, Ratio=4.18x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.959, Ratio=4.18x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.970, Ratio=4.17x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.971, Ratio=4.19x, Gap=-4.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.995, Ratio=4.44x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.991, Ratio=4.44x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.964, Ratio=4.18x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.995, Ratio=4.27x, Gap=-4.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.961, Ratio=4.14x, Gap=-4.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.984, Ratio=4.33x, Gap=-5.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.001, Ratio=4.46x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.978, Ratio=4.42x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.966, Ratio=4.12x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.981, Ratio=4.35x, Gap=-4.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.958, Ratio=4.29x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.974, Ratio=4.30x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.975, Ratio=4.03x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.986, Ratio=4.27x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.985, Ratio=4.41x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.955, Ratio=4.12x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.977, Ratio=4.22x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.961, Ratio=4.23x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.952, Ratio=4.03x, Gap=-4.263
Batch 125/537: Loss=0.9071 (C:0.9071, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.955, Ratio=4.09x, Gap=-4.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.962, Ratio=4.06x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.932, Ratio=3.98x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.994, Ratio=4.41x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.966, Ratio=4.22x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.950, Ratio=4.02x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.995, Ratio=4.26x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.972, Ratio=4.28x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.948, Ratio=4.03x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.962, Ratio=4.08x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.008, Ratio=4.56x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.980, Ratio=4.23x, Gap=-4.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.991, Ratio=4.53x, Gap=-4.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.979, Ratio=4.36x, Gap=-4.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.967, Ratio=4.16x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.958, Ratio=4.30x, Gap=-4.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.984, Ratio=4.37x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.966, Ratio=4.09x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.003, Ratio=4.68x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.995, Ratio=4.38x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.976, Ratio=4.30x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.956, Ratio=4.26x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.948, Ratio=4.12x, Gap=-4.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.985, Ratio=4.27x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.972, Ratio=4.26x, Gap=-4.244
Batch 150/537: Loss=0.8690 (C:0.8690, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.983, Ratio=4.28x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.972, Ratio=4.16x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.962, Ratio=4.15x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.001, Ratio=4.51x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.968, Ratio=4.21x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.992, Ratio=4.55x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.971, Ratio=4.19x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.972, Ratio=4.12x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.955, Ratio=4.04x, Gap=-4.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.000, Ratio=4.37x, Gap=-4.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.969, Ratio=4.28x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.964, Ratio=4.13x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.952, Ratio=4.14x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.964, Ratio=4.16x, Gap=-4.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.972, Ratio=4.13x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.982, Ratio=4.31x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.977, Ratio=4.35x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.995, Ratio=4.35x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.952, Ratio=4.03x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.005, Ratio=4.43x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.950, Ratio=4.02x, Gap=-4.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.966, Ratio=4.50x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.962, Ratio=4.24x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.964, Ratio=4.18x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.970, Ratio=4.20x, Gap=-4.336
Batch 175/537: Loss=0.8786 (C:0.8786, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.960, Ratio=4.27x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.960, Ratio=4.08x, Gap=-4.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.975, Ratio=4.30x, Gap=-4.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.978, Ratio=4.35x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.981, Ratio=4.43x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.990, Ratio=4.48x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.953, Ratio=4.10x, Gap=-4.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.939, Ratio=3.95x, Gap=-4.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.981, Ratio=4.19x, Gap=-4.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.973, Ratio=4.18x, Gap=-4.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.991, Ratio=4.37x, Gap=-4.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.984, Ratio=4.40x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.972, Ratio=4.14x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.980, Ratio=4.40x, Gap=-4.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.978, Ratio=4.34x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.999, Ratio=4.54x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.990, Ratio=4.45x, Gap=-4.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.959, Ratio=4.09x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.967, Ratio=4.12x, Gap=-4.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.976, Ratio=4.43x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.972, Ratio=4.34x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.978, Ratio=4.36x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.987, Ratio=4.21x, Gap=-4.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.967, Ratio=4.22x, Gap=-4.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.986, Ratio=4.45x, Gap=-4.427
Batch 200/537: Loss=0.8473 (C:0.8473, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.003, Ratio=4.43x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.969, Ratio=4.29x, Gap=-4.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.990, Ratio=4.48x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.980, Ratio=4.39x, Gap=-4.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.987, Ratio=4.30x, Gap=-4.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.976, Ratio=4.16x, Gap=-4.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.963, Ratio=4.15x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.993, Ratio=4.47x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.974, Ratio=4.30x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.951, Ratio=4.07x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.996, Ratio=4.22x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.988, Ratio=4.37x, Gap=-4.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.958, Ratio=3.97x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.985, Ratio=4.42x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.978, Ratio=4.31x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.973, Ratio=4.37x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.974, Ratio=4.38x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.964, Ratio=4.25x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.966, Ratio=4.17x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.968, Ratio=4.16x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.975, Ratio=4.21x, Gap=-4.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.960, Ratio=4.24x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.956, Ratio=4.13x, Gap=-4.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.993, Ratio=4.26x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.978, Ratio=4.33x, Gap=-4.591
Batch 225/537: Loss=0.8612 (C:0.8612, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.963, Ratio=4.13x, Gap=-4.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.971, Ratio=4.29x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.984, Ratio=4.44x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.978, Ratio=4.29x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.977, Ratio=4.36x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.972, Ratio=4.21x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.956, Ratio=4.17x, Gap=-4.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.963, Ratio=4.02x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.961, Ratio=4.06x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.964, Ratio=4.19x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.939, Ratio=3.90x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.969, Ratio=4.28x, Gap=-4.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.965, Ratio=4.35x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.964, Ratio=4.04x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.013, Ratio=4.45x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.965, Ratio=4.17x, Gap=-4.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.969, Ratio=4.16x, Gap=-4.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.972, Ratio=4.34x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.972, Ratio=4.25x, Gap=-4.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.982, Ratio=4.30x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.996, Ratio=4.29x, Gap=-4.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.953, Ratio=4.10x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.957, Ratio=4.20x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.984, Ratio=4.38x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.942, Ratio=4.26x, Gap=-4.152
Batch 250/537: Loss=0.8724 (C:0.8724, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.957, Ratio=4.35x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.969, Ratio=4.12x, Gap=-4.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.972, Ratio=4.38x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.969, Ratio=4.24x, Gap=-4.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.977, Ratio=4.29x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.971, Ratio=4.22x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.983, Ratio=4.31x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.974, Ratio=4.26x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.987, Ratio=4.18x, Gap=-4.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.981, Ratio=4.22x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.976, Ratio=4.14x, Gap=-4.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.991, Ratio=4.33x, Gap=-4.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.938, Ratio=4.05x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.974, Ratio=4.27x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.943, Ratio=4.10x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.967, Ratio=4.22x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.977, Ratio=4.32x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.950, Ratio=4.19x, Gap=-4.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.956, Ratio=4.27x, Gap=-4.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.985, Ratio=4.42x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.967, Ratio=4.21x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.963, Ratio=4.14x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.987, Ratio=4.36x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.993, Ratio=4.35x, Gap=-4.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.989, Ratio=4.40x, Gap=-4.144
Batch 275/537: Loss=0.8494 (C:0.8494, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.978, Ratio=4.36x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.972, Ratio=4.31x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.011, Ratio=4.22x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.984, Ratio=4.11x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.003, Ratio=4.49x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.963, Ratio=4.21x, Gap=-4.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.974, Ratio=4.24x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.969, Ratio=4.12x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.956, Ratio=4.05x, Gap=-4.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.964, Ratio=4.25x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.964, Ratio=4.24x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.960, Ratio=4.06x, Gap=-4.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.983, Ratio=4.30x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.965, Ratio=4.35x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.972, Ratio=4.24x, Gap=-4.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.942, Ratio=4.10x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.961, Ratio=4.12x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.969, Ratio=4.21x, Gap=-4.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.993, Ratio=4.42x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.974, Ratio=4.25x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.982, Ratio=4.39x, Gap=-4.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.981, Ratio=4.17x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.963, Ratio=4.11x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.966, Ratio=4.16x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.986, Ratio=4.16x, Gap=-4.219
Batch 300/537: Loss=0.8852 (C:0.8852, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.975, Ratio=4.21x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.948, Ratio=4.10x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.988, Ratio=4.49x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.960, Ratio=4.11x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.958, Ratio=4.07x, Gap=-4.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.979, Ratio=4.44x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.975, Ratio=4.40x, Gap=-4.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.963, Ratio=4.01x, Gap=-4.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.952, Ratio=4.14x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.962, Ratio=4.10x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.952, Ratio=4.03x, Gap=-4.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.967, Ratio=4.05x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.976, Ratio=4.15x, Gap=-4.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.981, Ratio=4.33x, Gap=-4.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.982, Ratio=4.28x, Gap=-4.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.981, Ratio=4.41x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.938, Ratio=3.92x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.972, Ratio=4.34x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.969, Ratio=4.15x, Gap=-4.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.979, Ratio=4.42x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.972, Ratio=4.26x, Gap=-4.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.941, Ratio=3.95x, Gap=-4.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.971, Ratio=4.32x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.985, Ratio=4.28x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.951, Ratio=4.19x, Gap=-4.249
Batch 325/537: Loss=0.8833 (C:0.8833, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.977, Ratio=4.29x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.999, Ratio=4.43x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.967, Ratio=4.03x, Gap=-4.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.978, Ratio=4.42x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.970, Ratio=4.11x, Gap=-4.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.973, Ratio=4.27x, Gap=-4.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.957, Ratio=4.14x, Gap=-4.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.968, Ratio=4.16x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.957, Ratio=4.35x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.956, Ratio=4.14x, Gap=-4.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.964, Ratio=4.15x, Gap=-4.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.963, Ratio=4.20x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.966, Ratio=4.26x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.942, Ratio=4.10x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.972, Ratio=4.12x, Gap=-4.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.965, Ratio=4.18x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.973, Ratio=4.31x, Gap=-4.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.958, Ratio=4.03x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.957, Ratio=4.28x, Gap=-4.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.970, Ratio=4.31x, Gap=-4.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.972, Ratio=4.24x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.959, Ratio=4.07x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.952, Ratio=3.93x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.965, Ratio=4.13x, Gap=-4.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.959, Ratio=4.22x, Gap=-4.097
Batch 350/537: Loss=0.8748 (C:0.8748, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.985, Ratio=4.17x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.012, Ratio=4.35x, Gap=-5.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.993, Ratio=4.34x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.985, Ratio=4.20x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.003, Ratio=4.41x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.971, Ratio=4.13x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.979, Ratio=4.13x, Gap=-4.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.006, Ratio=4.43x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.972, Ratio=4.30x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.960, Ratio=4.31x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.942, Ratio=4.15x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.942, Ratio=4.03x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.967, Ratio=4.26x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.968, Ratio=4.23x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.974, Ratio=4.31x, Gap=-4.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.968, Ratio=4.25x, Gap=-4.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.947, Ratio=4.04x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.970, Ratio=4.22x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.989, Ratio=4.40x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.977, Ratio=4.30x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.959, Ratio=4.18x, Gap=-5.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.975, Ratio=4.22x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.978, Ratio=4.30x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.999, Ratio=4.28x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.935, Ratio=3.94x, Gap=-4.057
Batch 375/537: Loss=0.9176 (C:0.9176, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.979, Ratio=4.28x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.942, Ratio=4.12x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.989, Ratio=4.36x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.970, Ratio=4.36x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.963, Ratio=4.13x, Gap=-5.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.947, Ratio=3.94x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.967, Ratio=4.29x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.968, Ratio=4.23x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.973, Ratio=4.18x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.982, Ratio=4.35x, Gap=-4.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.974, Ratio=4.20x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.968, Ratio=4.38x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.995, Ratio=4.14x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.990, Ratio=4.34x, Gap=-4.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.951, Ratio=4.15x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.962, Ratio=4.12x, Gap=-4.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.967, Ratio=4.17x, Gap=-4.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.966, Ratio=4.15x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.968, Ratio=4.27x, Gap=-4.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.959, Ratio=4.10x, Gap=-4.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.978, Ratio=4.56x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.935, Ratio=4.03x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.954, Ratio=4.13x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.954, Ratio=4.09x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.959, Ratio=4.02x, Gap=-5.526
Batch 400/537: Loss=0.9078 (C:0.9078, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.973, Ratio=4.30x, Gap=-4.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.967, Ratio=4.20x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.969, Ratio=4.14x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.980, Ratio=4.42x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.972, Ratio=4.12x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.995, Ratio=4.32x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.966, Ratio=4.25x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.960, Ratio=4.16x, Gap=-4.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.961, Ratio=4.24x, Gap=-4.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.967, Ratio=4.08x, Gap=-4.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.976, Ratio=4.31x, Gap=-4.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.953, Ratio=4.05x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.998, Ratio=4.30x, Gap=-4.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.964, Ratio=4.21x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.954, Ratio=4.06x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.970, Ratio=4.02x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.986, Ratio=4.58x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.973, Ratio=4.17x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.977, Ratio=4.18x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.947, Ratio=4.01x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.964, Ratio=3.92x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.954, Ratio=4.14x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.964, Ratio=4.12x, Gap=-4.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.972, Ratio=4.19x, Gap=-4.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.934, Ratio=3.92x, Gap=-4.190
Batch 425/537: Loss=0.9233 (C:0.9233, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.971, Ratio=4.32x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.978, Ratio=4.48x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.974, Ratio=4.40x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.005, Ratio=4.51x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.974, Ratio=4.26x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.944, Ratio=4.12x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.996, Ratio=4.28x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.944, Ratio=4.01x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.974, Ratio=4.30x, Gap=-4.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.967, Ratio=4.12x, Gap=-4.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.968, Ratio=4.22x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.954, Ratio=4.17x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.972, Ratio=4.15x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.964, Ratio=4.25x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.956, Ratio=4.12x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.946, Ratio=4.05x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.974, Ratio=4.18x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.987, Ratio=4.29x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.984, Ratio=4.14x, Gap=-4.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.979, Ratio=4.25x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.976, Ratio=4.12x, Gap=-4.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.000, Ratio=4.25x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.979, Ratio=4.28x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.990, Ratio=4.41x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.953, Ratio=4.06x, Gap=-4.248
Batch 450/537: Loss=0.8975 (C:0.8975, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.958, Ratio=4.15x, Gap=-4.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.980, Ratio=4.37x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.949, Ratio=4.14x, Gap=-4.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.983, Ratio=4.40x, Gap=-4.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.966, Ratio=4.13x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.984, Ratio=4.48x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.949, Ratio=4.18x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.986, Ratio=4.28x, Gap=-4.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.971, Ratio=4.14x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.959, Ratio=4.15x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.967, Ratio=4.35x, Gap=-4.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.964, Ratio=4.23x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.984, Ratio=4.20x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.993, Ratio=4.40x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.968, Ratio=4.24x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.006, Ratio=4.41x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.956, Ratio=4.08x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.973, Ratio=4.21x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.986, Ratio=4.39x, Gap=-4.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.962, Ratio=4.15x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.960, Ratio=4.10x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.973, Ratio=4.23x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.973, Ratio=4.36x, Gap=-4.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.975, Ratio=3.94x, Gap=-4.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.967, Ratio=4.35x, Gap=-4.213
Batch 475/537: Loss=0.8591 (C:0.8591, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.968, Ratio=4.32x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.970, Ratio=4.24x, Gap=-4.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.988, Ratio=4.60x, Gap=-4.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.948, Ratio=3.94x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.970, Ratio=4.22x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.950, Ratio=4.05x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.978, Ratio=4.11x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.973, Ratio=4.27x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.967, Ratio=4.22x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.969, Ratio=4.21x, Gap=-4.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.987, Ratio=4.48x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.949, Ratio=4.22x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.945, Ratio=4.03x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.963, Ratio=4.14x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.964, Ratio=4.37x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.970, Ratio=4.02x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.002, Ratio=4.22x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.964, Ratio=4.28x, Gap=-4.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.978, Ratio=4.33x, Gap=-4.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.988, Ratio=4.33x, Gap=-4.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.982, Ratio=4.24x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.985, Ratio=4.34x, Gap=-4.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.953, Ratio=4.14x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.955, Ratio=4.19x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.983, Ratio=4.32x, Gap=-4.174
Batch 500/537: Loss=0.8675 (C:0.8675, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.981, Ratio=4.26x, Gap=-5.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.971, Ratio=4.14x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.984, Ratio=4.30x, Gap=-4.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.943, Ratio=4.07x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.002, Ratio=4.54x, Gap=-4.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.980, Ratio=4.34x, Gap=-4.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.950, Ratio=4.00x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.996, Ratio=4.56x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.972, Ratio=4.20x, Gap=-4.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.994, Ratio=4.33x, Gap=-4.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.985, Ratio=4.32x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.975, Ratio=4.19x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.966, Ratio=4.15x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.969, Ratio=3.94x, Gap=-4.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.975, Ratio=4.13x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.954, Ratio=4.17x, Gap=-4.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.958, Ratio=4.26x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.981, Ratio=4.06x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.967, Ratio=4.19x, Gap=-4.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.985, Ratio=4.39x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.975, Ratio=4.19x, Gap=-4.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.974, Ratio=4.12x, Gap=-4.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.968, Ratio=4.31x, Gap=-4.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.933, Ratio=4.05x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.968, Ratio=4.38x, Gap=-3.943
Batch 525/537: Loss=0.8525 (C:0.8525, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.978, Ratio=4.36x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.972, Ratio=4.21x, Gap=-4.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.974, Ratio=4.35x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.979, Ratio=4.17x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.991, Ratio=4.52x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.992, Ratio=4.44x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.994, Ratio=4.40x, Gap=-4.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.002, Ratio=4.34x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.972, Ratio=4.14x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.981, Ratio=4.27x, Gap=-4.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.968, Ratio=4.04x, Gap=-4.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.976, Ratio=4.83x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.985, Ratio=4.69x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.979, Ratio=4.73x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.976, Ratio=4.58x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.993, Ratio=4.83x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.973, Ratio=4.48x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.013, Ratio=4.90x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.996, Ratio=4.79x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.991, Ratio=4.72x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.974, Ratio=4.63x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.979, Ratio=4.64x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.998, Ratio=5.00x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.988, Ratio=4.66x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.991, Ratio=4.89x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.974, Ratio=4.66x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.988, Ratio=4.84x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.001, Ratio=4.89x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.992, Ratio=4.82x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.949, Ratio=4.37x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.973, Ratio=4.57x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.988, Ratio=4.82x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.992, Ratio=4.78x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.992, Ratio=4.81x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.998, Ratio=4.84x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.984, Ratio=4.89x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.974, Ratio=4.56x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.984, Ratio=4.78x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.990, Ratio=4.79x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.976, Ratio=4.61x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.969, Ratio=4.62x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.969, Ratio=4.39x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.992, Ratio=4.73x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.968, Ratio=4.72x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.984, Ratio=4.68x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.987, Ratio=4.71x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.995, Ratio=4.84x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.018, Ratio=5.02x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.999, Ratio=4.75x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.966, Ratio=4.49x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.976, Ratio=4.59x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.994, Ratio=4.94x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.381, Neg=2.015, Ratio=5.29x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.979, Ratio=4.57x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.986, Ratio=4.70x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.975, Ratio=4.68x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.979, Ratio=4.50x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.989, Ratio=4.82x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.978, Ratio=4.73x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.981, Ratio=4.70x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.987, Ratio=4.73x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.980, Ratio=4.82x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.982, Ratio=4.57x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.998, Ratio=4.60x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.979, Ratio=4.58x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.971, Ratio=4.64x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.988, Ratio=4.90x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.996, Ratio=4.60x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.976, Ratio=4.68x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.992, Ratio=4.87x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.999, Ratio=4.99x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.970, Ratio=4.54x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.999, Ratio=4.97x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.978, Ratio=4.71x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.993, Ratio=4.65x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.993, Ratio=4.85x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.976, Ratio=4.59x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.986, Ratio=4.75x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.976, Ratio=4.59x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.990, Ratio=4.68x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.980, Ratio=4.79x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.004, Ratio=4.89x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.005, Ratio=4.83x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.989, Ratio=4.84x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.981, Ratio=4.75x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.990, Ratio=4.91x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.995, Ratio=4.91x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.975, Ratio=4.53x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.012, Ratio=4.98x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.992, Ratio=4.83x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.984, Ratio=4.60x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.976, Ratio=4.57x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.976, Ratio=4.74x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.963, Ratio=4.50x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=2.017, Ratio=5.16x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.960, Ratio=4.58x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.984, Ratio=4.85x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.973, Ratio=4.77x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.971, Ratio=4.57x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.983, Ratio=4.70x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.983, Ratio=4.74x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.974, Ratio=4.65x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.994, Ratio=4.93x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.972, Ratio=4.58x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.999, Ratio=4.91x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.971, Ratio=4.57x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.998, Ratio=5.00x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.968, Ratio=4.65x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.000, Ratio=4.95x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.982, Ratio=4.78x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.997, Ratio=5.03x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.002, Ratio=4.92x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.953, Ratio=4.59x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.970, Ratio=4.56x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.998, Ratio=4.78x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.983, Ratio=4.88x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.978, Ratio=4.64x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.986, Ratio=4.89x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.985, Ratio=4.74x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.989, Ratio=4.67x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.986, Ratio=4.84x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.963, Ratio=4.62x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.987, Ratio=4.82x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.977, Ratio=4.76x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.011, Ratio=4.86x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.980, Ratio=4.80x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.980, Ratio=4.59x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.992, Ratio=4.79x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.961, Ratio=4.33x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.990, Ratio=4.70x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.962, Ratio=4.65x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.985, Ratio=4.66x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.976, Ratio=4.59x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.995, Ratio=4.70x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.988, Ratio=4.62x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.987, Ratio=4.69x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.990, Ratio=4.98x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.962, Ratio=4.49x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.966, Ratio=4.51x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.974, Ratio=4.64x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.972, Ratio=4.35x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.986, Ratio=4.90x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.982, Ratio=4.67x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=2.020, Ratio=5.12x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.993, Ratio=5.00x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.972, Ratio=4.54x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.002, Ratio=4.96x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.005, Ratio=4.97x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.991, Ratio=4.60x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.971, Ratio=4.74x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.982, Ratio=4.71x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.986, Ratio=4.72x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.977, Ratio=4.58x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.975, Ratio=4.65x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.961, Ratio=4.42x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.986, Ratio=4.56x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.980, Ratio=4.69x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=2.004, Ratio=5.08x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.988, Ratio=4.84x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.014, Ratio=5.07x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.989, Ratio=4.80x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.001, Ratio=4.79x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.968, Ratio=4.62x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.992, Ratio=4.82x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.985, Ratio=4.73x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.977, Ratio=4.71x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.961, Ratio=4.27x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.977, Ratio=4.68x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.987, Ratio=4.64x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.990, Ratio=4.82x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.989, Ratio=4.94x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.975, Ratio=4.74x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.990, Ratio=4.64x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.982, Ratio=4.52x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.990, Ratio=4.73x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.998, Ratio=4.90x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.982, Ratio=4.49x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.995, Ratio=4.79x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.971, Ratio=4.48x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.995, Ratio=4.75x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.954, Ratio=4.51x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.974, Ratio=4.56x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.979, Ratio=4.67x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.967, Ratio=4.58x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.979, Ratio=4.69x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.966, Ratio=4.67x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.978, Ratio=4.52x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.979, Ratio=4.64x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.978, Ratio=4.43x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.982, Ratio=4.73x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.982, Ratio=4.66x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.987, Ratio=4.77x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.982, Ratio=4.71x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.983, Ratio=4.84x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.968, Ratio=4.60x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.981, Ratio=4.72x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.976, Ratio=4.66x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.976, Ratio=4.61x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.984, Ratio=4.91x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.997, Ratio=4.60x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=2.016, Ratio=5.07x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.003, Ratio=4.99x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.973, Ratio=4.61x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.989, Ratio=4.74x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.978, Ratio=4.63x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.968, Ratio=4.48x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.994, Ratio=4.70x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.982, Ratio=4.79x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.003, Ratio=4.86x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.997, Ratio=4.78x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.965, Ratio=4.61x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.989, Ratio=4.95x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.963, Ratio=4.70x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.983, Ratio=4.70x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.990, Ratio=4.62x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.007, Ratio=4.97x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.978, Ratio=4.69x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.986, Ratio=4.63x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.002, Ratio=4.83x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.968, Ratio=4.51x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.997, Ratio=4.86x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.989, Ratio=4.89x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.974, Ratio=4.59x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.997, Ratio=4.77x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.988, Ratio=4.94x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.994, Ratio=4.91x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.982, Ratio=4.65x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.997, Ratio=4.94x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.003, Ratio=4.71x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.962, Ratio=4.52x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.996, Ratio=4.83x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.968, Ratio=4.58x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.997, Ratio=4.94x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.982, Ratio=4.56x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.999, Ratio=4.88x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.984, Ratio=4.79x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.983, Ratio=4.73x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.994, Ratio=4.77x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.994, Ratio=4.73x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.016, Ratio=5.01x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.015, Ratio=4.86x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.977, Ratio=4.73x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.983, Ratio=4.46x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.998, Ratio=4.92x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.984, Ratio=4.70x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.968, Ratio=4.57x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.993, Ratio=4.88x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.999, Ratio=5.11x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.006, Ratio=4.89x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.998, Ratio=4.81x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.978, Ratio=4.80x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.977, Ratio=4.72x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.005, Ratio=4.81x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.960, Ratio=4.57x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.994, Ratio=4.71x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.000, Ratio=4.95x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.990, Ratio=4.69x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.971, Ratio=4.67x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.970, Ratio=4.58x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.972, Ratio=4.63x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.378, Neg=2.018, Ratio=5.34x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.982, Ratio=4.76x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.976, Ratio=4.89x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.993, Ratio=4.80x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.967, Ratio=4.46x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.983, Ratio=4.76x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.994, Ratio=4.83x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.986, Ratio=4.96x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.976, Ratio=4.71x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.992, Ratio=4.86x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.007, Ratio=5.01x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.975, Ratio=4.76x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.992, Ratio=4.97x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.986, Ratio=4.86x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.016, Ratio=4.99x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.997, Ratio=4.90x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.995, Ratio=4.74x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.974, Ratio=4.68x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.999, Ratio=4.91x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.990, Ratio=4.85x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.979, Ratio=4.79x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.015, Ratio=4.93x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.989, Ratio=4.63x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.982, Ratio=4.72x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.998, Ratio=4.98x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.957, Ratio=4.67x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.999, Ratio=4.84x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.973, Ratio=4.48x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.010, Ratio=4.69x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.989, Ratio=4.64x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.976, Ratio=4.77x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.968, Ratio=4.54x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.004, Ratio=4.97x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.992, Ratio=4.84x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.962, Ratio=4.48x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.987, Ratio=5.03x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.978, Ratio=4.78x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.990, Ratio=4.73x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.996, Ratio=4.67x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.011, Ratio=4.81x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.987, Ratio=4.95x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.001, Ratio=4.98x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=2.010, Ratio=5.04x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.988, Ratio=4.73x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.999, Ratio=4.89x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.007, Ratio=4.92x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.984, Ratio=4.68x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.993, Ratio=4.84x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.988, Ratio=4.85x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.987, Ratio=4.87x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=2.006, Ratio=5.16x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.011, Ratio=4.94x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.992, Ratio=4.90x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.994, Ratio=4.88x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.977, Ratio=4.64x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=2.007, Ratio=5.02x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.981, Ratio=4.61x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.974, Ratio=4.62x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.027, Ratio=5.11x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.003, Ratio=4.81x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.985, Ratio=4.73x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.996, Ratio=4.80x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.981, Ratio=4.76x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.001, Ratio=4.91x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.999, Ratio=4.93x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=2.006, Ratio=5.08x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.016, Ratio=4.89x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.993, Ratio=5.03x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.963, Ratio=4.45x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.993, Ratio=5.00x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.990, Ratio=4.61x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.974, Ratio=4.72x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=2.019, Ratio=5.09x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.957, Ratio=4.47x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.983, Ratio=4.73x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.957, Ratio=4.59x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.004, Ratio=4.81x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=2.009, Ratio=5.05x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.969, Ratio=4.65x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.995, Ratio=4.78x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.985, Ratio=4.79x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.994, Ratio=4.73x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.990, Ratio=4.87x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.966, Ratio=4.58x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.998, Ratio=4.82x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.992, Ratio=4.72x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.984, Ratio=4.74x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.008, Ratio=4.92x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.002, Ratio=4.87x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.989, Ratio=4.83x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.977, Ratio=4.69x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.388, Neg=2.010, Ratio=5.18x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.967, Ratio=4.53x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.983, Ratio=4.72x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.983, Ratio=4.81x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.986, Ratio=4.94x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=2.012, Ratio=5.10x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.984, Ratio=4.53x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.007, Ratio=4.92x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.975, Ratio=4.75x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.974, Ratio=4.77x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.989, Ratio=4.89x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.984, Ratio=4.78x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.977, Ratio=4.63x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.979, Ratio=4.81x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.964, Ratio=4.59x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.983, Ratio=4.68x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.985, Ratio=4.75x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.996, Ratio=4.87x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=2.010, Ratio=5.08x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.968, Ratio=4.54x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.009, Ratio=4.89x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.972, Ratio=4.50x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.002, Ratio=4.73x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.995, Ratio=4.94x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.994, Ratio=5.02x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.981, Ratio=4.61x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.004, Ratio=4.80x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.987, Ratio=4.82x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.002, Ratio=4.87x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.970, Ratio=4.58x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.974, Ratio=4.67x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.986, Ratio=4.97x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.975, Ratio=4.77x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.994, Ratio=4.99x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.390, Neg=2.015, Ratio=5.17x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.985, Ratio=4.69x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.985, Ratio=4.84x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.976, Ratio=4.55x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.989, Ratio=4.80x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.979, Ratio=4.89x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.975, Ratio=4.63x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.002, Ratio=4.90x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.989, Ratio=4.95x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=2.001, Ratio=5.00x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.987, Ratio=4.87x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.970, Ratio=4.53x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.966, Ratio=4.49x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.984, Ratio=4.67x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.986, Ratio=4.71x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.383, Neg=2.010, Ratio=5.25x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.971, Ratio=4.59x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.971, Ratio=4.61x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.001, Ratio=4.71x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.977, Ratio=4.74x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.984, Ratio=4.60x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.006, Ratio=4.90x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.979, Ratio=4.52x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.007, Ratio=5.06x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.984, Ratio=4.68x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.981, Ratio=4.69x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.971, Ratio=4.74x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.986, Ratio=4.61x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.004, Ratio=4.86x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.992, Ratio=4.75x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.993, Ratio=4.83x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=2.012, Ratio=5.13x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.995, Ratio=4.96x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.965, Ratio=4.61x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.991, Ratio=4.71x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.979, Ratio=4.80x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.971, Ratio=4.57x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.999, Ratio=5.08x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.975, Ratio=4.65x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.980, Ratio=4.78x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.999, Ratio=4.86x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.983, Ratio=4.62x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.988, Ratio=4.61x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.987, Ratio=4.63x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.983, Ratio=4.54x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.991, Ratio=4.73x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.982, Ratio=4.74x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.961, Ratio=4.38x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.993, Ratio=4.80x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.959, Ratio=4.77x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.982, Ratio=4.73x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.996, Ratio=4.78x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.983, Ratio=4.84x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.997, Ratio=4.96x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.970, Ratio=4.58x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.979, Ratio=4.74x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.003, Ratio=4.78x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.991, Ratio=4.64x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=2.015, Ratio=5.06x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.993, Ratio=4.71x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.978, Ratio=4.76x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.978, Ratio=4.39x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.385, Neg=1.999, Ratio=5.19x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.982, Ratio=4.60x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.388, Neg=2.009, Ratio=5.18x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.983, Ratio=4.93x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.988, Ratio=4.77x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.011, Ratio=5.01x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.013, Ratio=4.97x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.973, Ratio=4.70x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.968, Ratio=4.76x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.021, Ratio=5.09x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.989, Ratio=4.77x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.991, Ratio=4.77x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.968, Ratio=4.55x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.975, Ratio=4.42x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.004, Ratio=4.95x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.995, Ratio=4.92x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.994, Ratio=4.95x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.996, Ratio=4.76x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.992, Ratio=4.69x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.986, Ratio=4.99x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.983, Ratio=4.72x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.010, Ratio=4.76x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.999, Ratio=4.96x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.978, Ratio=4.45x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.000, Ratio=4.81x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.987, Ratio=4.83x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.997, Ratio=4.79x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.980, Ratio=4.61x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.994, Ratio=4.80x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.992, Ratio=4.68x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.983, Ratio=4.78x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.997, Ratio=5.01x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.998, Ratio=4.80x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.978, Ratio=4.69x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.996, Ratio=4.87x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.982, Ratio=4.52x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.978, Ratio=4.76x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.998, Ratio=4.79x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.991, Ratio=4.86x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.004, Ratio=4.87x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.980, Ratio=4.64x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.969, Ratio=4.61x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.004, Ratio=4.85x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.992, Ratio=5.05x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.990, Ratio=4.81x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.983, Ratio=4.55x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.986, Ratio=4.73x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.973, Ratio=4.59x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.968, Ratio=4.66x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.991, Ratio=4.90x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.983, Ratio=4.90x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.999, Ratio=4.94x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=2.009, Ratio=5.02x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.005, Ratio=4.87x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.994, Ratio=4.90x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.973, Ratio=4.58x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.997, Ratio=5.08x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.979, Ratio=4.64x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.985, Ratio=4.74x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.980, Ratio=4.83x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.995, Ratio=4.73x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.989, Ratio=4.67x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.979, Ratio=4.43x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.989, Ratio=4.82x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.989, Ratio=4.86x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.988, Ratio=4.73x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.976, Ratio=4.73x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.968, Ratio=4.69x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.982, Ratio=4.76x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.992, Ratio=4.71x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.998, Ratio=4.74x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.005, Ratio=4.83x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.990, Ratio=4.75x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.969, Ratio=4.62x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.990, Ratio=4.75x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.979, Ratio=4.41x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.977, Ratio=4.82x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.982, Ratio=4.66x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.013, Ratio=4.98x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.004, Ratio=4.83x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.009, Ratio=4.98x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.976, Ratio=4.59x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.985, Ratio=4.81x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.981, Ratio=4.64x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.988, Ratio=4.91x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.961, Ratio=4.53x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.978, Ratio=4.86x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.974, Ratio=4.65x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.982, Ratio=4.65x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.996, Ratio=4.80x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.992, Ratio=4.75x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.991, Ratio=4.88x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.991, Ratio=4.87x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.970, Ratio=4.60x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.984, Ratio=4.87x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.979, Ratio=4.65x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.982, Ratio=4.66x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.984, Ratio=4.89x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.972, Ratio=4.60x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.991, Ratio=5.04x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.987, Ratio=4.65x, Gap=-3.505

============================================================
Epoch 18/20 completed in 34.0s
Train: Loss=0.8734 (C:0.8734, R:0.0000) Ratio=3.68x
Val:   Loss=0.8132 (C:0.8132, R:0.0000) Ratio=4.77x
‚úÖ New best model saved (Val Loss: 0.8132)
============================================================

üåç Updating global dataset at epoch 19
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.413 ¬± 0.558
    Neg distances: 2.036 ¬± 0.930
    Separation ratio: 4.92x
    Gap: -3.597
    ‚úÖ Excellent global separation!

Epoch 19 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.020, Ratio=4.39x, Gap=-4.165
Batch   0/537: Loss=0.8465 (C:0.8465, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.002, Ratio=4.28x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.025, Ratio=4.50x, Gap=-5.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.027, Ratio=4.20x, Gap=-4.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.037, Ratio=4.43x, Gap=-4.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.041, Ratio=4.39x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.036, Ratio=4.19x, Gap=-4.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.043, Ratio=4.33x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.060, Ratio=4.34x, Gap=-5.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.071, Ratio=4.55x, Gap=-5.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.041, Ratio=4.25x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.098, Ratio=4.58x, Gap=-4.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.072, Ratio=4.52x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.054, Ratio=4.37x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.060, Ratio=4.45x, Gap=-4.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.063, Ratio=4.41x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.047, Ratio=4.40x, Gap=-4.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.034, Ratio=4.00x, Gap=-4.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.029, Ratio=4.49x, Gap=-4.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.026, Ratio=4.28x, Gap=-4.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.049, Ratio=4.52x, Gap=-4.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.051, Ratio=4.47x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.076, Ratio=4.64x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.058, Ratio=4.34x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.063, Ratio=4.38x, Gap=-4.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.053, Ratio=4.38x, Gap=-4.682
Batch  25/537: Loss=0.8430 (C:0.8430, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.038, Ratio=4.19x, Gap=-4.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.073, Ratio=4.57x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.047, Ratio=4.33x, Gap=-4.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.057, Ratio=4.35x, Gap=-4.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.047, Ratio=4.33x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.036, Ratio=4.32x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.047, Ratio=4.22x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.037, Ratio=4.42x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.075, Ratio=4.60x, Gap=-4.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.060, Ratio=4.65x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.027, Ratio=4.25x, Gap=-4.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.042, Ratio=4.56x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.057, Ratio=4.35x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.074, Ratio=4.43x, Gap=-4.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.043, Ratio=4.23x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.033, Ratio=4.07x, Gap=-4.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.067, Ratio=4.50x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.062, Ratio=4.38x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.051, Ratio=4.33x, Gap=-4.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.045, Ratio=4.31x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.049, Ratio=4.30x, Gap=-4.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.050, Ratio=4.30x, Gap=-4.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.065, Ratio=4.54x, Gap=-4.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.048, Ratio=4.31x, Gap=-4.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.037, Ratio=4.46x, Gap=-4.213
Batch  50/537: Loss=0.8327 (C:0.8327, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.046, Ratio=4.40x, Gap=-4.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.067, Ratio=4.53x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.015, Ratio=4.26x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.033, Ratio=4.35x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.054, Ratio=4.40x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.049, Ratio=4.37x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.055, Ratio=4.53x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.035, Ratio=4.28x, Gap=-4.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.054, Ratio=4.55x, Gap=-4.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.043, Ratio=4.31x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.036, Ratio=4.18x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.028, Ratio=4.19x, Gap=-4.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.053, Ratio=4.26x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.077, Ratio=4.54x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.055, Ratio=4.08x, Gap=-5.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.023, Ratio=4.22x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.064, Ratio=4.42x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.075, Ratio=4.45x, Gap=-4.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.038, Ratio=4.22x, Gap=-5.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.048, Ratio=4.25x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.035, Ratio=4.32x, Gap=-4.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.067, Ratio=4.46x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.045, Ratio=4.25x, Gap=-4.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.041, Ratio=4.20x, Gap=-4.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.061, Ratio=4.46x, Gap=-4.319
Batch  75/537: Loss=0.8334 (C:0.8334, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.067, Ratio=4.49x, Gap=-4.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.024, Ratio=4.10x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.028, Ratio=4.31x, Gap=-4.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.069, Ratio=4.39x, Gap=-4.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.057, Ratio=4.33x, Gap=-4.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.061, Ratio=4.22x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.050, Ratio=4.18x, Gap=-4.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.046, Ratio=4.32x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.062, Ratio=4.41x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.043, Ratio=4.40x, Gap=-4.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.039, Ratio=4.22x, Gap=-4.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.053, Ratio=4.45x, Gap=-4.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.052, Ratio=4.36x, Gap=-4.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.043, Ratio=4.18x, Gap=-4.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.022, Ratio=4.19x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.057, Ratio=4.42x, Gap=-4.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.025, Ratio=4.25x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.024, Ratio=4.24x, Gap=-4.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.055, Ratio=4.22x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.057, Ratio=4.44x, Gap=-4.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.054, Ratio=4.24x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.059, Ratio=4.20x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.056, Ratio=4.43x, Gap=-4.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.070, Ratio=4.48x, Gap=-4.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.065, Ratio=4.49x, Gap=-4.274
Batch 100/537: Loss=0.8315 (C:0.8315, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.030, Ratio=4.25x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.072, Ratio=4.51x, Gap=-4.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.031, Ratio=4.21x, Gap=-4.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.040, Ratio=4.39x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.068, Ratio=4.44x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.038, Ratio=4.22x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.032, Ratio=4.13x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.024, Ratio=4.15x, Gap=-4.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.022, Ratio=4.16x, Gap=-4.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.062, Ratio=4.37x, Gap=-4.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.035, Ratio=4.17x, Gap=-4.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.038, Ratio=4.41x, Gap=-4.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.052, Ratio=4.31x, Gap=-4.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.042, Ratio=4.24x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.052, Ratio=4.35x, Gap=-4.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.060, Ratio=4.31x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.045, Ratio=4.25x, Gap=-4.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.042, Ratio=4.27x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.060, Ratio=4.30x, Gap=-4.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.050, Ratio=4.42x, Gap=-4.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.019, Ratio=4.17x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.029, Ratio=4.25x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.038, Ratio=4.25x, Gap=-4.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.039, Ratio=4.26x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.031, Ratio=4.15x, Gap=-4.347
Batch 125/537: Loss=0.8766 (C:0.8766, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.031, Ratio=4.15x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.050, Ratio=4.30x, Gap=-4.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.046, Ratio=4.20x, Gap=-4.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.043, Ratio=4.24x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.033, Ratio=4.10x, Gap=-4.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.054, Ratio=4.31x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.053, Ratio=4.34x, Gap=-4.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.051, Ratio=4.23x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.043, Ratio=4.31x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.045, Ratio=4.14x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.037, Ratio=4.42x, Gap=-4.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.056, Ratio=4.51x, Gap=-4.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.030, Ratio=4.15x, Gap=-4.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.044, Ratio=4.48x, Gap=-4.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.047, Ratio=4.24x, Gap=-4.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.013, Ratio=4.20x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.025, Ratio=4.32x, Gap=-4.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.038, Ratio=4.27x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.029, Ratio=4.17x, Gap=-4.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.040, Ratio=4.31x, Gap=-4.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.008, Ratio=4.08x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.053, Ratio=4.59x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.025, Ratio=4.14x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.048, Ratio=4.30x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.059, Ratio=4.13x, Gap=-4.458
Batch 150/537: Loss=0.8771 (C:0.8771, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.059, Ratio=4.40x, Gap=-4.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.039, Ratio=4.16x, Gap=-4.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.053, Ratio=4.41x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.063, Ratio=4.42x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.080, Ratio=4.52x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.062, Ratio=4.33x, Gap=-4.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.034, Ratio=4.47x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.048, Ratio=4.39x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.043, Ratio=4.27x, Gap=-4.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.066, Ratio=4.67x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.050, Ratio=4.25x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.015, Ratio=4.19x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.037, Ratio=4.35x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.026, Ratio=4.24x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.048, Ratio=4.38x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.054, Ratio=4.25x, Gap=-4.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.056, Ratio=4.28x, Gap=-4.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.063, Ratio=4.30x, Gap=-4.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.060, Ratio=4.32x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.064, Ratio=4.53x, Gap=-4.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.032, Ratio=4.16x, Gap=-4.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=2.018, Ratio=3.93x, Gap=-4.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.055, Ratio=4.45x, Gap=-4.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.055, Ratio=4.53x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.044, Ratio=4.41x, Gap=-4.293
Batch 175/537: Loss=0.8373 (C:0.8373, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.064, Ratio=4.50x, Gap=-5.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.041, Ratio=4.44x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.058, Ratio=4.38x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.046, Ratio=4.20x, Gap=-4.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.027, Ratio=4.27x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.048, Ratio=4.25x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.053, Ratio=4.31x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.087, Ratio=4.65x, Gap=-4.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.062, Ratio=4.47x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.043, Ratio=4.06x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.027, Ratio=4.05x, Gap=-4.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.041, Ratio=4.24x, Gap=-4.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.028, Ratio=4.17x, Gap=-4.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.059, Ratio=4.39x, Gap=-4.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.055, Ratio=4.39x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.040, Ratio=4.28x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.027, Ratio=4.23x, Gap=-4.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.060, Ratio=4.50x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.062, Ratio=4.37x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.051, Ratio=4.40x, Gap=-4.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.055, Ratio=4.43x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.055, Ratio=4.40x, Gap=-4.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.079, Ratio=4.57x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.048, Ratio=4.36x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.039, Ratio=4.53x, Gap=-4.342
Batch 200/537: Loss=0.8205 (C:0.8205, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.055, Ratio=4.53x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.043, Ratio=4.33x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.045, Ratio=4.40x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.042, Ratio=4.14x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.077, Ratio=4.29x, Gap=-4.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.045, Ratio=4.31x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.046, Ratio=4.28x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.043, Ratio=4.33x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.052, Ratio=4.32x, Gap=-4.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.033, Ratio=4.28x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.046, Ratio=4.19x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.032, Ratio=4.14x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.030, Ratio=4.19x, Gap=-4.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.052, Ratio=4.25x, Gap=-4.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.041, Ratio=4.29x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.053, Ratio=4.27x, Gap=-4.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.053, Ratio=4.52x, Gap=-4.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.046, Ratio=4.42x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.054, Ratio=4.33x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.064, Ratio=4.37x, Gap=-4.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.040, Ratio=4.20x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.038, Ratio=4.23x, Gap=-4.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.047, Ratio=4.38x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.055, Ratio=4.57x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.041, Ratio=4.26x, Gap=-4.157
Batch 225/537: Loss=0.8588 (C:0.8588, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.056, Ratio=4.57x, Gap=-4.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.055, Ratio=4.28x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.054, Ratio=4.26x, Gap=-4.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.049, Ratio=4.43x, Gap=-4.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.065, Ratio=4.43x, Gap=-4.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.080, Ratio=4.46x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.055, Ratio=4.46x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.028, Ratio=4.02x, Gap=-4.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.037, Ratio=4.34x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.024, Ratio=4.15x, Gap=-4.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.025, Ratio=4.32x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.044, Ratio=4.40x, Gap=-4.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.046, Ratio=4.35x, Gap=-4.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.055, Ratio=4.38x, Gap=-4.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.034, Ratio=4.21x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.081, Ratio=4.43x, Gap=-4.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.045, Ratio=4.28x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.023, Ratio=4.04x, Gap=-4.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.053, Ratio=4.26x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.035, Ratio=4.23x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.061, Ratio=4.64x, Gap=-4.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.059, Ratio=4.44x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.060, Ratio=4.41x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.055, Ratio=4.43x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.040, Ratio=4.16x, Gap=-4.698
Batch 250/537: Loss=0.8715 (C:0.8715, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.049, Ratio=4.53x, Gap=-4.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.052, Ratio=4.46x, Gap=-4.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.046, Ratio=4.49x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.068, Ratio=4.46x, Gap=-4.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.051, Ratio=4.23x, Gap=-4.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.043, Ratio=4.25x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.055, Ratio=4.34x, Gap=-4.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.040, Ratio=4.01x, Gap=-4.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.009, Ratio=4.14x, Gap=-4.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.042, Ratio=4.22x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.048, Ratio=4.22x, Gap=-4.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.066, Ratio=4.46x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.053, Ratio=4.32x, Gap=-5.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.046, Ratio=4.20x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.066, Ratio=4.48x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.029, Ratio=4.18x, Gap=-4.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.050, Ratio=4.43x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.049, Ratio=4.20x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.065, Ratio=4.48x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.065, Ratio=4.34x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.042, Ratio=4.15x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.050, Ratio=4.70x, Gap=-4.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.049, Ratio=4.19x, Gap=-4.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.035, Ratio=4.36x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.051, Ratio=4.27x, Gap=-4.350
Batch 275/537: Loss=0.8607 (C:0.8607, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.084, Ratio=4.57x, Gap=-4.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.037, Ratio=4.47x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.034, Ratio=4.45x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.056, Ratio=4.44x, Gap=-5.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.018, Ratio=4.08x, Gap=-4.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.031, Ratio=4.26x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.006, Ratio=3.96x, Gap=-4.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.036, Ratio=4.35x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.040, Ratio=4.20x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.052, Ratio=4.26x, Gap=-4.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.057, Ratio=4.45x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.074, Ratio=4.35x, Gap=-4.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.064, Ratio=4.35x, Gap=-4.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.027, Ratio=4.24x, Gap=-4.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.064, Ratio=4.42x, Gap=-4.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.035, Ratio=4.10x, Gap=-4.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.018, Ratio=4.21x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.011, Ratio=4.17x, Gap=-4.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.057, Ratio=4.36x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.031, Ratio=4.08x, Gap=-5.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.059, Ratio=4.42x, Gap=-4.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.038, Ratio=4.25x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.014, Ratio=4.09x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.049, Ratio=4.13x, Gap=-4.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.039, Ratio=4.23x, Gap=-4.108
Batch 300/537: Loss=0.8639 (C:0.8639, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.025, Ratio=4.14x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.050, Ratio=4.54x, Gap=-4.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.041, Ratio=4.13x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.062, Ratio=4.57x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.031, Ratio=4.09x, Gap=-4.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.050, Ratio=4.22x, Gap=-4.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.066, Ratio=4.54x, Gap=-4.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.069, Ratio=4.54x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.048, Ratio=4.29x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.068, Ratio=4.34x, Gap=-4.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.067, Ratio=4.59x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.033, Ratio=4.11x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.035, Ratio=4.13x, Gap=-4.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.016, Ratio=4.19x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.033, Ratio=4.10x, Gap=-4.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.056, Ratio=4.53x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.072, Ratio=4.32x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.038, Ratio=4.34x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.038, Ratio=4.24x, Gap=-4.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.046, Ratio=4.31x, Gap=-4.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.048, Ratio=4.33x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.032, Ratio=4.19x, Gap=-4.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.038, Ratio=4.26x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.043, Ratio=4.43x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.066, Ratio=4.55x, Gap=-4.236
Batch 325/537: Loss=0.8225 (C:0.8225, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.040, Ratio=4.35x, Gap=-4.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.054, Ratio=4.24x, Gap=-4.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.041, Ratio=4.23x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.083, Ratio=4.39x, Gap=-4.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.051, Ratio=4.23x, Gap=-4.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.031, Ratio=4.07x, Gap=-4.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.046, Ratio=4.40x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.052, Ratio=4.45x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.061, Ratio=4.47x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.035, Ratio=4.28x, Gap=-4.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.049, Ratio=4.32x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.058, Ratio=4.46x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.032, Ratio=4.22x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.030, Ratio=4.19x, Gap=-4.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.065, Ratio=4.54x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.049, Ratio=4.33x, Gap=-4.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.059, Ratio=4.30x, Gap=-4.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.059, Ratio=4.32x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.056, Ratio=4.57x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.059, Ratio=4.63x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.047, Ratio=4.25x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.042, Ratio=4.30x, Gap=-4.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.078, Ratio=4.45x, Gap=-4.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.049, Ratio=4.33x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.062, Ratio=4.16x, Gap=-4.351
Batch 350/537: Loss=0.8769 (C:0.8769, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.048, Ratio=4.31x, Gap=-4.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.066, Ratio=4.55x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.036, Ratio=4.26x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.032, Ratio=4.07x, Gap=-4.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.049, Ratio=4.49x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.035, Ratio=4.39x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.040, Ratio=4.26x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.047, Ratio=4.36x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.068, Ratio=4.40x, Gap=-4.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.036, Ratio=4.31x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.057, Ratio=4.28x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.047, Ratio=4.20x, Gap=-4.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.040, Ratio=4.23x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.034, Ratio=4.21x, Gap=-4.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.019, Ratio=4.15x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.035, Ratio=4.20x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.063, Ratio=4.57x, Gap=-4.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.052, Ratio=4.20x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.038, Ratio=4.23x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.028, Ratio=4.25x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.053, Ratio=4.18x, Gap=-4.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.037, Ratio=4.24x, Gap=-4.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.070, Ratio=4.38x, Gap=-4.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.049, Ratio=4.41x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.029, Ratio=4.13x, Gap=-4.349
Batch 375/537: Loss=0.8774 (C:0.8774, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.055, Ratio=4.37x, Gap=-5.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.034, Ratio=4.13x, Gap=-4.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.037, Ratio=4.27x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.009, Ratio=4.15x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.047, Ratio=4.35x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.042, Ratio=4.17x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.030, Ratio=4.35x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.043, Ratio=4.29x, Gap=-4.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.070, Ratio=4.55x, Gap=-4.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.030, Ratio=4.30x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.026, Ratio=4.24x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.047, Ratio=4.27x, Gap=-4.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.048, Ratio=4.25x, Gap=-4.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.051, Ratio=4.31x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.043, Ratio=4.24x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.051, Ratio=4.23x, Gap=-4.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.074, Ratio=4.33x, Gap=-4.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.069, Ratio=4.54x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.037, Ratio=4.12x, Gap=-4.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.076, Ratio=4.39x, Gap=-4.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.047, Ratio=4.20x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.056, Ratio=4.34x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.054, Ratio=4.38x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.050, Ratio=4.33x, Gap=-4.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.023, Ratio=4.19x, Gap=-4.230
Batch 400/537: Loss=0.8670 (C:0.8670, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.014, Ratio=4.12x, Gap=-4.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.029, Ratio=4.05x, Gap=-4.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.060, Ratio=4.62x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.028, Ratio=4.40x, Gap=-4.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.021, Ratio=4.17x, Gap=-4.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.052, Ratio=4.26x, Gap=-4.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.048, Ratio=4.40x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.059, Ratio=4.46x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.049, Ratio=4.20x, Gap=-4.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.033, Ratio=4.07x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.060, Ratio=4.36x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.057, Ratio=4.50x, Gap=-4.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.019, Ratio=4.15x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.058, Ratio=4.11x, Gap=-4.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.060, Ratio=4.33x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.057, Ratio=4.26x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.043, Ratio=4.25x, Gap=-4.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.055, Ratio=4.29x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.035, Ratio=4.26x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.034, Ratio=4.30x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.031, Ratio=4.25x, Gap=-4.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.028, Ratio=4.30x, Gap=-4.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.054, Ratio=4.59x, Gap=-4.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.042, Ratio=4.33x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.045, Ratio=4.48x, Gap=-4.213
Batch 425/537: Loss=0.8300 (C:0.8300, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.055, Ratio=4.46x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.042, Ratio=4.24x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.018, Ratio=4.10x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.042, Ratio=4.16x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.039, Ratio=4.22x, Gap=-4.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.051, Ratio=4.41x, Gap=-4.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.056, Ratio=4.47x, Gap=-4.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.023, Ratio=4.08x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.065, Ratio=4.28x, Gap=-4.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.057, Ratio=4.20x, Gap=-4.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.043, Ratio=4.37x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.062, Ratio=4.46x, Gap=-4.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.051, Ratio=4.42x, Gap=-4.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.058, Ratio=4.52x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.040, Ratio=4.26x, Gap=-4.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.030, Ratio=4.20x, Gap=-4.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.035, Ratio=4.12x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.020, Ratio=4.15x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.083, Ratio=4.51x, Gap=-4.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.030, Ratio=4.16x, Gap=-4.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.037, Ratio=4.25x, Gap=-4.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.034, Ratio=4.15x, Gap=-4.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.040, Ratio=4.16x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.030, Ratio=4.16x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.033, Ratio=4.29x, Gap=-4.261
Batch 450/537: Loss=0.8564 (C:0.8564, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.035, Ratio=4.20x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.033, Ratio=4.07x, Gap=-4.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.038, Ratio=4.22x, Gap=-4.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.049, Ratio=4.45x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.045, Ratio=4.35x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.029, Ratio=4.24x, Gap=-4.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.059, Ratio=4.63x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.045, Ratio=4.25x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.051, Ratio=4.37x, Gap=-4.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.045, Ratio=4.18x, Gap=-4.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.034, Ratio=4.17x, Gap=-4.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.060, Ratio=4.33x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.047, Ratio=4.27x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.034, Ratio=4.16x, Gap=-4.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.034, Ratio=4.09x, Gap=-4.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.035, Ratio=4.22x, Gap=-4.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.037, Ratio=4.27x, Gap=-4.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.045, Ratio=4.21x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.050, Ratio=4.09x, Gap=-4.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.046, Ratio=4.32x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.028, Ratio=4.42x, Gap=-4.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.039, Ratio=4.30x, Gap=-4.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.082, Ratio=4.66x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.044, Ratio=4.23x, Gap=-5.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.033, Ratio=4.20x, Gap=-4.640
Batch 475/537: Loss=0.8665 (C:0.8665, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.046, Ratio=4.36x, Gap=-4.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.040, Ratio=4.18x, Gap=-4.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.056, Ratio=4.29x, Gap=-4.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.038, Ratio=4.21x, Gap=-4.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.016, Ratio=4.03x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.022, Ratio=4.25x, Gap=-4.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.027, Ratio=4.00x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.060, Ratio=4.50x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.040, Ratio=4.24x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.048, Ratio=4.29x, Gap=-4.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.052, Ratio=4.44x, Gap=-4.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.044, Ratio=4.41x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.067, Ratio=4.37x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.031, Ratio=4.14x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.039, Ratio=4.17x, Gap=-5.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.037, Ratio=4.14x, Gap=-4.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.040, Ratio=4.18x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.045, Ratio=4.21x, Gap=-4.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=2.026, Ratio=3.96x, Gap=-5.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.035, Ratio=4.36x, Gap=-4.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.032, Ratio=4.21x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.048, Ratio=4.35x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.039, Ratio=4.38x, Gap=-4.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.016, Ratio=4.25x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.049, Ratio=4.41x, Gap=-4.214
Batch 500/537: Loss=0.8400 (C:0.8400, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.033, Ratio=4.15x, Gap=-4.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.036, Ratio=4.31x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.040, Ratio=4.21x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.057, Ratio=4.47x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.053, Ratio=4.45x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.028, Ratio=4.30x, Gap=-4.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=2.024, Ratio=3.94x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.057, Ratio=4.28x, Gap=-4.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.073, Ratio=4.40x, Gap=-4.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.053, Ratio=4.21x, Gap=-4.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.048, Ratio=4.12x, Gap=-4.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.032, Ratio=4.23x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.055, Ratio=4.41x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.034, Ratio=4.04x, Gap=-4.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.052, Ratio=4.43x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.041, Ratio=4.40x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.056, Ratio=4.53x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.053, Ratio=4.47x, Gap=-4.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.034, Ratio=4.22x, Gap=-4.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.012, Ratio=3.96x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.036, Ratio=4.36x, Gap=-4.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.045, Ratio=4.26x, Gap=-4.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.044, Ratio=4.10x, Gap=-4.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.024, Ratio=4.09x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.075, Ratio=4.45x, Gap=-4.324
Batch 525/537: Loss=0.8320 (C:0.8320, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.056, Ratio=4.24x, Gap=-4.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.038, Ratio=4.27x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.021, Ratio=4.05x, Gap=-4.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.029, Ratio=4.05x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.043, Ratio=4.23x, Gap=-4.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.037, Ratio=4.22x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.048, Ratio=4.24x, Gap=-4.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.015, Ratio=4.13x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.035, Ratio=4.13x, Gap=-4.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.028, Ratio=4.21x, Gap=-4.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.027, Ratio=4.26x, Gap=-4.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.069, Ratio=5.10x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.064, Ratio=4.85x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.068, Ratio=4.83x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.029, Ratio=4.72x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.061, Ratio=4.91x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.066, Ratio=4.99x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.036, Ratio=4.58x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.061, Ratio=4.75x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.060, Ratio=4.93x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.059, Ratio=4.92x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.045, Ratio=4.83x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.069, Ratio=5.12x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.054, Ratio=4.72x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.081, Ratio=5.20x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.068, Ratio=5.11x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.069, Ratio=4.78x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.062, Ratio=4.89x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.065, Ratio=4.86x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.065, Ratio=4.62x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.057, Ratio=4.84x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.072, Ratio=4.89x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.054, Ratio=4.69x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.037, Ratio=4.66x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.073, Ratio=5.01x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.046, Ratio=4.83x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.083, Ratio=5.13x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.053, Ratio=4.82x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.063, Ratio=4.81x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.056, Ratio=4.89x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.044, Ratio=4.54x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.069, Ratio=4.83x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.055, Ratio=4.75x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.051, Ratio=4.69x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.041, Ratio=4.70x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.050, Ratio=4.76x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.064, Ratio=4.82x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.045, Ratio=4.66x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.074, Ratio=4.91x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.054, Ratio=4.73x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.068, Ratio=5.13x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.052, Ratio=4.80x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.051, Ratio=4.84x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.068, Ratio=4.93x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.064, Ratio=4.89x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.066, Ratio=4.94x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.066, Ratio=4.72x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.089, Ratio=5.16x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.068, Ratio=4.75x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.073, Ratio=5.04x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.019, Ratio=4.39x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.074, Ratio=5.01x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.046, Ratio=4.63x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.052, Ratio=4.83x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.041, Ratio=4.75x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.066, Ratio=4.92x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.073, Ratio=4.83x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.061, Ratio=5.03x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.039, Ratio=4.78x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.058, Ratio=4.85x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.068, Ratio=5.09x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.061, Ratio=4.99x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.025, Ratio=4.58x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.066, Ratio=4.74x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.061, Ratio=4.91x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.054, Ratio=4.85x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.063, Ratio=4.88x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.078, Ratio=5.11x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.058, Ratio=4.84x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.049, Ratio=4.83x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.068, Ratio=5.00x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.059, Ratio=4.77x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.058, Ratio=4.95x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.067, Ratio=5.08x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.050, Ratio=4.80x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.054, Ratio=4.78x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.063, Ratio=4.88x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.057, Ratio=4.87x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.034, Ratio=4.54x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.058, Ratio=4.91x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.051, Ratio=4.78x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.063, Ratio=4.93x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.048, Ratio=4.59x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.071, Ratio=5.14x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.058, Ratio=4.72x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.081, Ratio=5.03x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.053, Ratio=4.68x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.059, Ratio=4.75x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.059, Ratio=4.97x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.051, Ratio=4.92x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.039, Ratio=4.84x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.061, Ratio=4.86x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.050, Ratio=4.95x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.058, Ratio=5.04x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.053, Ratio=4.74x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.065, Ratio=4.85x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.078, Ratio=5.05x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.069, Ratio=4.83x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.064, Ratio=4.81x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.073, Ratio=5.10x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.046, Ratio=4.85x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.058, Ratio=4.78x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.077, Ratio=4.95x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.050, Ratio=4.79x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.050, Ratio=4.91x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.060, Ratio=4.84x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.054, Ratio=5.00x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=2.087, Ratio=5.23x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.041, Ratio=4.88x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.045, Ratio=4.54x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.058, Ratio=5.02x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.051, Ratio=4.86x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.068, Ratio=4.80x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.048, Ratio=4.82x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.050, Ratio=4.75x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.053, Ratio=4.67x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.069, Ratio=4.87x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.062, Ratio=5.08x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.039, Ratio=4.70x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.052, Ratio=4.83x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.045, Ratio=4.94x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.048, Ratio=4.71x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.037, Ratio=4.70x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.060, Ratio=4.75x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.065, Ratio=4.81x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.055, Ratio=4.74x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.056, Ratio=4.91x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.067, Ratio=5.04x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.056, Ratio=4.77x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.061, Ratio=4.82x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.039, Ratio=4.53x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.057, Ratio=4.76x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.044, Ratio=4.61x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.070, Ratio=5.15x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.047, Ratio=4.47x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.048, Ratio=4.77x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.078, Ratio=5.17x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=2.077, Ratio=5.20x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.043, Ratio=4.72x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.047, Ratio=4.75x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.071, Ratio=5.08x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=2.078, Ratio=5.31x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.061, Ratio=4.95x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.062, Ratio=4.75x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.060, Ratio=4.92x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.049, Ratio=4.68x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.058, Ratio=4.74x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.062, Ratio=4.99x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.051, Ratio=4.84x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.042, Ratio=4.70x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.049, Ratio=4.99x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.049, Ratio=4.76x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.059, Ratio=5.07x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.383, Neg=2.095, Ratio=5.47x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.030, Ratio=4.53x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.059, Ratio=4.82x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.071, Ratio=5.11x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.040, Ratio=4.83x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.094, Ratio=5.18x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.047, Ratio=4.85x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.046, Ratio=4.77x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.072, Ratio=5.01x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.050, Ratio=4.82x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.070, Ratio=4.99x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.035, Ratio=4.82x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.076, Ratio=5.12x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.076, Ratio=5.04x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.074, Ratio=5.01x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.037, Ratio=4.66x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.056, Ratio=5.12x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.048, Ratio=4.93x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.054, Ratio=4.81x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.052, Ratio=4.67x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.062, Ratio=4.99x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.064, Ratio=4.98x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.042, Ratio=4.62x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.040, Ratio=4.83x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.052, Ratio=4.93x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.067, Ratio=4.85x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.070, Ratio=4.88x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.073, Ratio=5.08x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.066, Ratio=4.74x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.052, Ratio=4.86x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.051, Ratio=4.80x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.065, Ratio=4.92x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.059, Ratio=4.79x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.066, Ratio=4.92x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.069, Ratio=5.07x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.060, Ratio=4.89x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.063, Ratio=5.11x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.049, Ratio=4.70x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.060, Ratio=4.87x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=2.078, Ratio=5.23x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.050, Ratio=4.81x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.057, Ratio=4.81x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.055, Ratio=4.91x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.068, Ratio=4.83x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.045, Ratio=4.75x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.081, Ratio=5.02x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.055, Ratio=4.82x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.077, Ratio=5.23x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.062, Ratio=4.97x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.040, Ratio=4.80x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.055, Ratio=4.81x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.043, Ratio=4.57x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=2.067, Ratio=5.18x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.067, Ratio=4.94x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.051, Ratio=4.82x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.051, Ratio=4.56x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.048, Ratio=4.79x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.063, Ratio=4.79x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.064, Ratio=4.81x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.069, Ratio=4.85x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.074, Ratio=4.99x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.080, Ratio=5.02x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.063, Ratio=4.83x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.050, Ratio=4.83x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.062, Ratio=4.94x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.051, Ratio=4.74x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.036, Ratio=4.78x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.041, Ratio=4.75x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.041, Ratio=4.45x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.051, Ratio=5.01x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=2.081, Ratio=5.24x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.057, Ratio=4.93x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.052, Ratio=4.76x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.081, Ratio=5.05x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.052, Ratio=4.72x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.068, Ratio=4.79x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.070, Ratio=4.93x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.079, Ratio=5.07x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.071, Ratio=5.14x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.046, Ratio=4.66x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.068, Ratio=4.79x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.056, Ratio=4.96x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.058, Ratio=4.88x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.058, Ratio=4.89x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.066, Ratio=4.86x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.051, Ratio=4.78x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.075, Ratio=5.04x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.033, Ratio=4.43x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.066, Ratio=5.00x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.050, Ratio=4.94x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.058, Ratio=5.09x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.057, Ratio=4.97x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.045, Ratio=4.95x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.053, Ratio=4.85x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.055, Ratio=5.05x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.066, Ratio=4.76x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.069, Ratio=4.85x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.076, Ratio=5.02x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.071, Ratio=4.93x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.056, Ratio=4.58x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.067, Ratio=5.10x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.064, Ratio=5.07x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.055, Ratio=4.87x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.055, Ratio=4.81x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.058, Ratio=4.86x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.055, Ratio=4.82x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.062, Ratio=4.70x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=2.083, Ratio=5.29x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.075, Ratio=5.07x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.091, Ratio=5.22x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.066, Ratio=4.79x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.065, Ratio=4.93x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.047, Ratio=4.75x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.046, Ratio=4.59x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.048, Ratio=4.78x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.045, Ratio=4.68x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.062, Ratio=4.86x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.040, Ratio=4.58x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.056, Ratio=4.97x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.064, Ratio=5.02x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.023, Ratio=4.54x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=2.082, Ratio=5.22x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.049, Ratio=4.78x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.059, Ratio=4.64x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.055, Ratio=4.84x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.052, Ratio=4.96x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.044, Ratio=4.79x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.072, Ratio=5.08x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.044, Ratio=4.50x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.050, Ratio=4.69x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.053, Ratio=4.71x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.045, Ratio=4.75x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.036, Ratio=4.83x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.069, Ratio=5.09x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.068, Ratio=4.96x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.072, Ratio=4.92x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.063, Ratio=4.89x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.061, Ratio=4.88x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.066, Ratio=4.97x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.058, Ratio=4.90x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.072, Ratio=5.03x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.058, Ratio=4.90x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=2.088, Ratio=5.33x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.066, Ratio=5.04x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.047, Ratio=4.80x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.079, Ratio=4.98x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.065, Ratio=4.87x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.035, Ratio=4.64x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.070, Ratio=4.82x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.058, Ratio=4.76x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.055, Ratio=4.87x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.068, Ratio=4.87x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.057, Ratio=4.94x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=2.062, Ratio=5.17x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.068, Ratio=4.92x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.080, Ratio=5.08x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.036, Ratio=4.65x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.052, Ratio=4.85x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.042, Ratio=4.77x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.076, Ratio=5.02x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.068, Ratio=4.87x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.065, Ratio=4.75x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=2.088, Ratio=5.24x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.064, Ratio=5.12x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.047, Ratio=4.63x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.070, Ratio=4.95x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.070, Ratio=5.00x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.060, Ratio=4.87x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.041, Ratio=4.65x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.061, Ratio=4.71x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=2.093, Ratio=5.32x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.051, Ratio=4.69x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.037, Ratio=4.54x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.057, Ratio=4.83x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.041, Ratio=4.81x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.075, Ratio=5.11x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.069, Ratio=5.03x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.055, Ratio=4.80x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.067, Ratio=4.92x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.069, Ratio=5.05x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.053, Ratio=4.84x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.057, Ratio=4.89x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.050, Ratio=4.74x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.072, Ratio=5.07x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.064, Ratio=4.85x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.069, Ratio=4.94x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.052, Ratio=4.76x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.067, Ratio=5.07x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.045, Ratio=4.60x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.051, Ratio=4.60x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.042, Ratio=4.57x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.046, Ratio=4.78x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.062, Ratio=4.90x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=2.084, Ratio=5.29x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.062, Ratio=4.97x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.052, Ratio=4.86x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.023, Ratio=4.51x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.078, Ratio=4.98x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.075, Ratio=4.82x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.052, Ratio=4.57x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.058, Ratio=4.65x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.034, Ratio=4.76x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.061, Ratio=5.04x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.054, Ratio=4.88x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.064, Ratio=5.04x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.071, Ratio=5.03x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.068, Ratio=4.93x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.042, Ratio=4.66x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.074, Ratio=5.08x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.066, Ratio=4.93x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.050, Ratio=4.82x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.060, Ratio=4.88x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.072, Ratio=4.91x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.064, Ratio=4.79x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.060, Ratio=4.84x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.061, Ratio=4.87x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.052, Ratio=4.74x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.037, Ratio=4.55x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.071, Ratio=4.94x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.069, Ratio=5.09x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.050, Ratio=4.82x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.057, Ratio=4.99x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.048, Ratio=4.82x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.064, Ratio=4.93x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.054, Ratio=4.67x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.052, Ratio=4.73x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.082, Ratio=5.12x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.047, Ratio=4.64x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.048, Ratio=4.73x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.038, Ratio=4.80x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.063, Ratio=4.91x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.073, Ratio=5.00x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.052, Ratio=5.02x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.051, Ratio=4.83x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.044, Ratio=4.77x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.061, Ratio=4.88x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.053, Ratio=4.86x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.039, Ratio=4.58x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.051, Ratio=4.75x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.063, Ratio=4.89x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.058, Ratio=4.78x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.057, Ratio=4.65x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.053, Ratio=4.71x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.032, Ratio=4.52x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.031, Ratio=4.62x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.045, Ratio=4.55x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.055, Ratio=5.03x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.079, Ratio=5.11x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.064, Ratio=4.82x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.040, Ratio=4.59x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.082, Ratio=5.06x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.031, Ratio=4.65x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.042, Ratio=4.76x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.067, Ratio=5.08x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.069, Ratio=4.96x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.056, Ratio=4.81x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.061, Ratio=4.91x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.043, Ratio=4.71x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.063, Ratio=4.96x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.067, Ratio=4.92x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.051, Ratio=4.89x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.066, Ratio=4.98x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.046, Ratio=4.59x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.069, Ratio=4.90x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.053, Ratio=5.05x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.040, Ratio=4.78x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.059, Ratio=4.83x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.055, Ratio=4.72x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.052, Ratio=4.84x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.024, Ratio=4.44x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.055, Ratio=5.01x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.037, Ratio=4.47x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.031, Ratio=4.65x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.057, Ratio=4.81x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.065, Ratio=5.14x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.053, Ratio=4.73x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.065, Ratio=4.74x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.071, Ratio=4.75x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.051, Ratio=4.66x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.060, Ratio=4.82x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.063, Ratio=4.84x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.069, Ratio=4.85x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.063, Ratio=4.79x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.055, Ratio=4.74x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.045, Ratio=4.78x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=2.075, Ratio=5.20x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.049, Ratio=4.89x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.046, Ratio=4.82x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.049, Ratio=4.71x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.027, Ratio=4.53x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.056, Ratio=4.73x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.057, Ratio=4.63x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.076, Ratio=5.08x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.057, Ratio=4.85x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.041, Ratio=4.79x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.065, Ratio=5.15x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.063, Ratio=4.79x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=2.079, Ratio=5.27x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.067, Ratio=5.00x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.076, Ratio=5.03x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.062, Ratio=4.91x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.042, Ratio=4.69x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.064, Ratio=4.81x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.061, Ratio=4.73x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.025, Ratio=4.72x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.066, Ratio=4.85x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.047, Ratio=4.64x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.065, Ratio=4.88x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.083, Ratio=5.17x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.091, Ratio=4.98x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.051, Ratio=4.69x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.036, Ratio=4.57x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.083, Ratio=5.00x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.055, Ratio=4.82x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.061, Ratio=4.96x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.058, Ratio=5.06x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.054, Ratio=4.76x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.053, Ratio=4.55x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.055, Ratio=4.81x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.039, Ratio=4.52x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.081, Ratio=4.95x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.052, Ratio=4.88x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.082, Ratio=5.05x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.073, Ratio=4.95x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.045, Ratio=4.87x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.051, Ratio=4.83x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.080, Ratio=4.96x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.066, Ratio=4.77x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.073, Ratio=4.85x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.075, Ratio=4.86x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.058, Ratio=4.76x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.071, Ratio=5.03x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.052, Ratio=4.92x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.065, Ratio=4.88x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.062, Ratio=4.92x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.060, Ratio=4.95x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.050, Ratio=4.89x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.033, Ratio=4.68x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.032, Ratio=4.55x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.052, Ratio=4.79x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.074, Ratio=4.90x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.038, Ratio=4.74x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.032, Ratio=4.67x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.065, Ratio=5.10x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.072, Ratio=5.09x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.076, Ratio=5.05x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.046, Ratio=4.69x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.080, Ratio=4.99x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.058, Ratio=4.84x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.070, Ratio=5.02x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.021, Ratio=4.58x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.031, Ratio=4.63x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.068, Ratio=4.72x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.044, Ratio=4.51x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.058, Ratio=4.87x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.066, Ratio=4.89x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.065, Ratio=5.11x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.071, Ratio=5.10x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.061, Ratio=4.78x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.059, Ratio=4.90x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.042, Ratio=4.57x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.048, Ratio=4.83x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=2.081, Ratio=5.31x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.068, Ratio=5.01x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.061, Ratio=4.94x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=2.074, Ratio=5.24x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.033, Ratio=4.60x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.051, Ratio=4.87x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.070, Ratio=5.00x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.021, Ratio=4.54x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.041, Ratio=4.75x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.073, Ratio=4.92x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.058, Ratio=4.75x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.076, Ratio=5.02x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.068, Ratio=4.96x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.063, Ratio=4.78x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.058, Ratio=4.94x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=2.089, Ratio=5.32x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.057, Ratio=4.99x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.058, Ratio=4.80x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.056, Ratio=4.82x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.071, Ratio=4.90x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.059, Ratio=5.04x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.051, Ratio=4.74x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.066, Ratio=4.89x, Gap=-3.709

============================================================
Epoch 19/20 completed in 40.5s
Train: Loss=0.8529 (C:0.8529, R:0.0000) Ratio=3.70x
Val:   Loss=0.7868 (C:0.7868, R:0.0000) Ratio=4.85x
‚úÖ New best model saved (Val Loss: 0.7868)
============================================================

Epoch 20 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.035, Ratio=4.28x, Gap=-4.672
Batch   0/537: Loss=0.8540 (C:0.8540, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.048, Ratio=4.40x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.076, Ratio=4.63x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.052, Ratio=4.47x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.050, Ratio=4.40x, Gap=-4.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.079, Ratio=4.54x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.082, Ratio=4.58x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.055, Ratio=4.21x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.055, Ratio=4.38x, Gap=-4.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.070, Ratio=4.58x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.064, Ratio=4.37x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.053, Ratio=4.25x, Gap=-4.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.068, Ratio=4.59x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.029, Ratio=4.14x, Gap=-4.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.059, Ratio=4.38x, Gap=-4.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.052, Ratio=4.37x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.058, Ratio=4.54x, Gap=-4.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.044, Ratio=4.43x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.063, Ratio=4.55x, Gap=-4.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.034, Ratio=4.30x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.045, Ratio=4.42x, Gap=-4.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.051, Ratio=4.51x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.029, Ratio=4.15x, Gap=-4.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.053, Ratio=4.30x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.063, Ratio=4.45x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.061, Ratio=4.73x, Gap=-4.382
Batch  25/537: Loss=0.7970 (C:0.7970, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.044, Ratio=4.39x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.052, Ratio=4.31x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.046, Ratio=4.39x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.059, Ratio=4.49x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.071, Ratio=4.32x, Gap=-5.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.040, Ratio=4.36x, Gap=-4.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.070, Ratio=4.21x, Gap=-4.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.062, Ratio=4.38x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.056, Ratio=4.30x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.033, Ratio=4.46x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.049, Ratio=4.43x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.050, Ratio=4.62x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.076, Ratio=4.41x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.060, Ratio=4.37x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.038, Ratio=4.35x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.037, Ratio=4.17x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.055, Ratio=4.38x, Gap=-4.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.047, Ratio=4.37x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.053, Ratio=4.25x, Gap=-4.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.060, Ratio=4.42x, Gap=-4.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.030, Ratio=4.15x, Gap=-4.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.060, Ratio=4.32x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.062, Ratio=4.54x, Gap=-4.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.045, Ratio=4.53x, Gap=-4.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.039, Ratio=4.31x, Gap=-4.251
Batch  50/537: Loss=0.8482 (C:0.8482, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.053, Ratio=4.38x, Gap=-4.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.042, Ratio=4.24x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.052, Ratio=4.34x, Gap=-4.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.071, Ratio=4.56x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.048, Ratio=4.37x, Gap=-4.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.062, Ratio=4.30x, Gap=-5.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.048, Ratio=4.33x, Gap=-4.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.046, Ratio=4.19x, Gap=-4.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.061, Ratio=4.56x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.040, Ratio=4.26x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.036, Ratio=4.33x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.035, Ratio=4.29x, Gap=-4.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.046, Ratio=4.43x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.063, Ratio=4.45x, Gap=-4.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.055, Ratio=4.32x, Gap=-4.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.058, Ratio=4.58x, Gap=-4.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.046, Ratio=4.29x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.013, Ratio=4.03x, Gap=-4.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.042, Ratio=4.26x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.058, Ratio=4.34x, Gap=-4.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.061, Ratio=4.49x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.041, Ratio=4.16x, Gap=-4.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.038, Ratio=4.30x, Gap=-4.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.083, Ratio=4.58x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.051, Ratio=4.56x, Gap=-4.227
Batch  75/537: Loss=0.8186 (C:0.8186, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.057, Ratio=4.31x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.088, Ratio=4.59x, Gap=-5.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.054, Ratio=4.42x, Gap=-4.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.048, Ratio=4.47x, Gap=-4.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.043, Ratio=4.31x, Gap=-4.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.042, Ratio=4.42x, Gap=-4.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.053, Ratio=4.43x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.068, Ratio=4.41x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.061, Ratio=4.34x, Gap=-4.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.043, Ratio=4.26x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.058, Ratio=4.28x, Gap=-4.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.049, Ratio=4.28x, Gap=-4.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.048, Ratio=4.23x, Gap=-4.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.060, Ratio=4.48x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.040, Ratio=4.18x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.078, Ratio=4.50x, Gap=-4.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.067, Ratio=4.51x, Gap=-4.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.075, Ratio=4.44x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.058, Ratio=4.43x, Gap=-4.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.049, Ratio=4.45x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.053, Ratio=4.44x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.044, Ratio=4.44x, Gap=-4.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.037, Ratio=4.43x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.064, Ratio=4.18x, Gap=-4.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.060, Ratio=4.58x, Gap=-4.171
Batch 100/537: Loss=0.8131 (C:0.8131, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.046, Ratio=4.31x, Gap=-4.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.049, Ratio=4.53x, Gap=-4.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.057, Ratio=4.32x, Gap=-4.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.038, Ratio=4.33x, Gap=-4.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.077, Ratio=4.66x, Gap=-4.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.041, Ratio=4.34x, Gap=-4.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.067, Ratio=4.36x, Gap=-4.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.054, Ratio=4.32x, Gap=-4.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.051, Ratio=4.29x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.059, Ratio=4.28x, Gap=-4.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.050, Ratio=4.34x, Gap=-4.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.070, Ratio=4.55x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.082, Ratio=4.65x, Gap=-4.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.053, Ratio=4.30x, Gap=-4.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.056, Ratio=4.27x, Gap=-5.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.029, Ratio=4.24x, Gap=-4.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.048, Ratio=4.37x, Gap=-4.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.051, Ratio=4.42x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.063, Ratio=4.56x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.051, Ratio=4.43x, Gap=-4.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.045, Ratio=4.24x, Gap=-4.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.040, Ratio=4.18x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.053, Ratio=4.40x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.043, Ratio=4.27x, Gap=-4.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.070, Ratio=4.63x, Gap=-4.645
Batch 125/537: Loss=0.8116 (C:0.8116, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.037, Ratio=4.19x, Gap=-4.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.035, Ratio=4.07x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.030, Ratio=4.31x, Gap=-4.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.046, Ratio=4.21x, Gap=-4.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.042, Ratio=4.49x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.039, Ratio=4.36x, Gap=-4.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.054, Ratio=4.26x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.051, Ratio=4.40x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.066, Ratio=4.54x, Gap=-4.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.064, Ratio=4.59x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.060, Ratio=4.49x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.055, Ratio=4.29x, Gap=-5.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.064, Ratio=4.32x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.058, Ratio=4.36x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.052, Ratio=4.40x, Gap=-4.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.017, Ratio=4.03x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.036, Ratio=4.27x, Gap=-4.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.046, Ratio=4.21x, Gap=-4.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.041, Ratio=4.18x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.049, Ratio=4.44x, Gap=-4.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.056, Ratio=4.40x, Gap=-4.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.040, Ratio=4.19x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.064, Ratio=4.51x, Gap=-4.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.059, Ratio=4.56x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.083, Ratio=4.64x, Gap=-4.413
Batch 150/537: Loss=0.8108 (C:0.8108, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.065, Ratio=4.48x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.055, Ratio=4.54x, Gap=-4.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.028, Ratio=4.19x, Gap=-4.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.080, Ratio=4.49x, Gap=-4.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.042, Ratio=4.23x, Gap=-4.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.054, Ratio=4.62x, Gap=-4.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.061, Ratio=4.49x, Gap=-5.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.056, Ratio=4.31x, Gap=-4.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.076, Ratio=4.51x, Gap=-4.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.055, Ratio=4.36x, Gap=-4.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.043, Ratio=4.37x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.027, Ratio=4.21x, Gap=-4.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.041, Ratio=4.31x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.054, Ratio=4.37x, Gap=-4.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.046, Ratio=4.40x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.038, Ratio=4.25x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.054, Ratio=4.31x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.054, Ratio=4.37x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.028, Ratio=4.18x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.070, Ratio=4.50x, Gap=-4.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.040, Ratio=4.30x, Gap=-4.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.041, Ratio=4.38x, Gap=-4.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.038, Ratio=4.27x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.076, Ratio=4.39x, Gap=-4.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.043, Ratio=4.43x, Gap=-4.339
Batch 175/537: Loss=0.8342 (C:0.8342, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.043, Ratio=4.24x, Gap=-4.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.066, Ratio=4.64x, Gap=-4.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.030, Ratio=4.39x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.041, Ratio=4.12x, Gap=-4.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.064, Ratio=4.50x, Gap=-4.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.042, Ratio=4.19x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.054, Ratio=4.13x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.053, Ratio=4.50x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.047, Ratio=4.46x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.043, Ratio=4.40x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.052, Ratio=4.33x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.062, Ratio=4.53x, Gap=-4.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.056, Ratio=4.48x, Gap=-4.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.046, Ratio=4.45x, Gap=-4.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.044, Ratio=4.20x, Gap=-4.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.050, Ratio=4.28x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.061, Ratio=4.42x, Gap=-4.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.036, Ratio=4.24x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.053, Ratio=4.49x, Gap=-5.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.059, Ratio=4.29x, Gap=-4.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.058, Ratio=4.36x, Gap=-4.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.045, Ratio=4.51x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.039, Ratio=4.40x, Gap=-4.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.061, Ratio=4.64x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.054, Ratio=4.30x, Gap=-4.201
Batch 200/537: Loss=0.8545 (C:0.8545, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.030, Ratio=4.23x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.032, Ratio=4.37x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.055, Ratio=4.38x, Gap=-4.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.065, Ratio=4.52x, Gap=-4.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.053, Ratio=4.24x, Gap=-5.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=2.029, Ratio=3.94x, Gap=-4.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.041, Ratio=4.25x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.042, Ratio=4.20x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.058, Ratio=4.33x, Gap=-4.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.034, Ratio=4.33x, Gap=-4.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.042, Ratio=4.33x, Gap=-4.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.027, Ratio=4.31x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=2.034, Ratio=4.02x, Gap=-4.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.044, Ratio=4.28x, Gap=-4.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.041, Ratio=4.18x, Gap=-4.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.059, Ratio=4.36x, Gap=-4.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.039, Ratio=4.24x, Gap=-4.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.063, Ratio=4.39x, Gap=-4.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.040, Ratio=4.10x, Gap=-4.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.024, Ratio=4.07x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.048, Ratio=4.24x, Gap=-4.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.026, Ratio=4.24x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.030, Ratio=4.17x, Gap=-4.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.039, Ratio=4.37x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.045, Ratio=4.38x, Gap=-4.954
Batch 225/537: Loss=0.8419 (C:0.8419, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.041, Ratio=4.17x, Gap=-4.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.057, Ratio=4.51x, Gap=-4.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.069, Ratio=4.58x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.086, Ratio=4.70x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.056, Ratio=4.42x, Gap=-4.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.024, Ratio=4.16x, Gap=-4.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.064, Ratio=4.57x, Gap=-4.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.028, Ratio=4.08x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.065, Ratio=4.28x, Gap=-4.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.063, Ratio=4.40x, Gap=-4.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.077, Ratio=4.56x, Gap=-4.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.051, Ratio=4.35x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.048, Ratio=4.36x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.063, Ratio=4.37x, Gap=-4.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.049, Ratio=4.38x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.051, Ratio=4.56x, Gap=-4.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.047, Ratio=4.21x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.051, Ratio=4.27x, Gap=-4.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.057, Ratio=4.35x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.026, Ratio=4.44x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.072, Ratio=4.52x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.079, Ratio=4.33x, Gap=-4.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.057, Ratio=4.37x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.053, Ratio=4.22x, Gap=-4.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.037, Ratio=4.18x, Gap=-4.199
Batch 250/537: Loss=0.8673 (C:0.8673, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.059, Ratio=4.37x, Gap=-4.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.079, Ratio=4.48x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.037, Ratio=4.09x, Gap=-4.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.048, Ratio=4.58x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.034, Ratio=4.34x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.035, Ratio=4.20x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.038, Ratio=4.27x, Gap=-4.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.030, Ratio=4.23x, Gap=-4.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.061, Ratio=4.29x, Gap=-4.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.068, Ratio=4.38x, Gap=-4.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.020, Ratio=4.16x, Gap=-4.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.056, Ratio=4.26x, Gap=-4.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.049, Ratio=4.24x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.062, Ratio=4.40x, Gap=-4.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.015, Ratio=4.20x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.054, Ratio=4.42x, Gap=-4.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.050, Ratio=4.49x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.051, Ratio=4.29x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.044, Ratio=4.30x, Gap=-4.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.084, Ratio=4.56x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.061, Ratio=4.43x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.068, Ratio=4.58x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.051, Ratio=4.30x, Gap=-4.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.076, Ratio=4.65x, Gap=-4.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.035, Ratio=4.25x, Gap=-4.248
Batch 275/537: Loss=0.8606 (C:0.8606, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.049, Ratio=4.25x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.055, Ratio=4.19x, Gap=-4.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.048, Ratio=4.36x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.044, Ratio=4.44x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.035, Ratio=4.24x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.072, Ratio=4.59x, Gap=-4.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.059, Ratio=4.43x, Gap=-4.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.060, Ratio=4.31x, Gap=-4.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.061, Ratio=4.33x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.051, Ratio=4.33x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.038, Ratio=4.20x, Gap=-4.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.056, Ratio=4.26x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.021, Ratio=4.24x, Gap=-4.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.040, Ratio=4.21x, Gap=-4.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.070, Ratio=4.53x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.012, Ratio=4.09x, Gap=-4.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.043, Ratio=4.37x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.036, Ratio=4.24x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.053, Ratio=4.30x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.056, Ratio=4.42x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.033, Ratio=4.20x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.053, Ratio=4.21x, Gap=-4.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.031, Ratio=4.10x, Gap=-4.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.070, Ratio=4.44x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.051, Ratio=4.51x, Gap=-4.193
Batch 300/537: Loss=0.8244 (C:0.8244, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.058, Ratio=4.46x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.040, Ratio=4.24x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.047, Ratio=4.24x, Gap=-4.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.063, Ratio=4.42x, Gap=-4.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.034, Ratio=4.29x, Gap=-4.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.090, Ratio=4.65x, Gap=-4.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.067, Ratio=4.42x, Gap=-4.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.021, Ratio=4.28x, Gap=-4.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.042, Ratio=4.40x, Gap=-4.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.049, Ratio=4.46x, Gap=-4.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.031, Ratio=4.15x, Gap=-4.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.065, Ratio=4.67x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.047, Ratio=4.33x, Gap=-4.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.057, Ratio=4.47x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.026, Ratio=4.18x, Gap=-4.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.053, Ratio=4.54x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.058, Ratio=4.57x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.054, Ratio=4.23x, Gap=-4.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=2.040, Ratio=3.99x, Gap=-4.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.043, Ratio=4.19x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.056, Ratio=4.33x, Gap=-4.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.052, Ratio=4.41x, Gap=-4.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.068, Ratio=4.41x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.033, Ratio=4.10x, Gap=-4.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.020, Ratio=4.19x, Gap=-4.359
Batch 325/537: Loss=0.8671 (C:0.8671, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.077, Ratio=4.63x, Gap=-4.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.041, Ratio=4.21x, Gap=-4.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.042, Ratio=4.32x, Gap=-4.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.038, Ratio=4.23x, Gap=-4.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.066, Ratio=4.56x, Gap=-4.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.068, Ratio=4.55x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.046, Ratio=4.19x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.019, Ratio=4.28x, Gap=-4.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.041, Ratio=4.24x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.029, Ratio=4.13x, Gap=-4.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.040, Ratio=4.22x, Gap=-4.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.040, Ratio=4.08x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.058, Ratio=4.48x, Gap=-5.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.067, Ratio=4.52x, Gap=-4.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.060, Ratio=4.43x, Gap=-4.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.036, Ratio=4.15x, Gap=-4.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.054, Ratio=4.40x, Gap=-4.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.045, Ratio=4.19x, Gap=-4.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.057, Ratio=4.36x, Gap=-4.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.040, Ratio=4.15x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.032, Ratio=4.30x, Gap=-4.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.065, Ratio=4.51x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.032, Ratio=4.23x, Gap=-4.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.058, Ratio=4.31x, Gap=-4.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.039, Ratio=4.32x, Gap=-4.220
Batch 350/537: Loss=0.8489 (C:0.8489, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.059, Ratio=4.33x, Gap=-4.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.036, Ratio=4.34x, Gap=-4.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.044, Ratio=4.37x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.058, Ratio=4.19x, Gap=-5.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.013, Ratio=3.97x, Gap=-4.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.038, Ratio=4.20x, Gap=-4.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.066, Ratio=4.58x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.062, Ratio=4.49x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.025, Ratio=4.16x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.055, Ratio=4.52x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.047, Ratio=4.35x, Gap=-4.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.065, Ratio=4.35x, Gap=-5.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.042, Ratio=4.35x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.059, Ratio=4.37x, Gap=-4.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.039, Ratio=4.10x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.049, Ratio=4.27x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.047, Ratio=4.38x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.063, Ratio=4.25x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.060, Ratio=4.27x, Gap=-4.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=2.021, Ratio=3.90x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.061, Ratio=4.30x, Gap=-4.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.067, Ratio=4.14x, Gap=-4.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.020, Ratio=4.08x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.059, Ratio=4.50x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.043, Ratio=4.26x, Gap=-4.221
Batch 375/537: Loss=0.8583 (C:0.8583, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.061, Ratio=4.46x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.056, Ratio=4.67x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.042, Ratio=4.08x, Gap=-4.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.042, Ratio=4.38x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.028, Ratio=4.18x, Gap=-4.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.059, Ratio=4.35x, Gap=-4.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.040, Ratio=4.27x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.050, Ratio=4.31x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.039, Ratio=4.17x, Gap=-4.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.045, Ratio=4.18x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.038, Ratio=4.27x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.030, Ratio=4.36x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.064, Ratio=4.67x, Gap=-4.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.026, Ratio=4.14x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.055, Ratio=4.32x, Gap=-4.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.045, Ratio=4.39x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.028, Ratio=4.12x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.025, Ratio=4.02x, Gap=-4.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.070, Ratio=4.62x, Gap=-4.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.059, Ratio=4.50x, Gap=-4.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.015, Ratio=4.28x, Gap=-4.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.038, Ratio=4.37x, Gap=-4.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.053, Ratio=4.40x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.062, Ratio=4.34x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.040, Ratio=4.25x, Gap=-4.635
Batch 400/537: Loss=0.8588 (C:0.8588, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.027, Ratio=4.18x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.056, Ratio=4.15x, Gap=-4.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.059, Ratio=4.27x, Gap=-4.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.051, Ratio=4.22x, Gap=-4.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.071, Ratio=4.49x, Gap=-4.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.062, Ratio=4.37x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.052, Ratio=4.35x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.050, Ratio=4.38x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.060, Ratio=4.66x, Gap=-4.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.054, Ratio=4.36x, Gap=-5.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.066, Ratio=4.51x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.046, Ratio=4.33x, Gap=-4.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.043, Ratio=4.31x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.063, Ratio=4.25x, Gap=-4.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.019, Ratio=4.18x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.037, Ratio=4.15x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=2.034, Ratio=3.96x, Gap=-4.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.053, Ratio=4.52x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.038, Ratio=4.44x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.029, Ratio=4.16x, Gap=-4.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.036, Ratio=4.14x, Gap=-4.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.033, Ratio=4.18x, Gap=-4.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.047, Ratio=4.07x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.053, Ratio=4.34x, Gap=-4.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.065, Ratio=4.50x, Gap=-4.231
Batch 425/537: Loss=0.8259 (C:0.8259, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.049, Ratio=4.40x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.048, Ratio=4.48x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.072, Ratio=4.36x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.063, Ratio=4.45x, Gap=-4.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.059, Ratio=4.34x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.059, Ratio=4.50x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.042, Ratio=4.34x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.028, Ratio=4.16x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.041, Ratio=4.38x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.027, Ratio=4.13x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.049, Ratio=4.43x, Gap=-4.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.046, Ratio=4.33x, Gap=-4.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.063, Ratio=4.73x, Gap=-4.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.028, Ratio=4.20x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.037, Ratio=4.22x, Gap=-4.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.067, Ratio=4.42x, Gap=-4.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.027, Ratio=4.20x, Gap=-4.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.037, Ratio=4.29x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.020, Ratio=4.05x, Gap=-5.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.054, Ratio=4.30x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.041, Ratio=4.10x, Gap=-4.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.050, Ratio=4.36x, Gap=-4.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.037, Ratio=4.27x, Gap=-4.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.018, Ratio=4.15x, Gap=-4.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.046, Ratio=4.22x, Gap=-4.458
Batch 450/537: Loss=0.8628 (C:0.8628, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.034, Ratio=4.19x, Gap=-4.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.037, Ratio=4.03x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.046, Ratio=4.08x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.059, Ratio=4.39x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.058, Ratio=4.52x, Gap=-4.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.056, Ratio=4.21x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.047, Ratio=4.30x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.026, Ratio=4.18x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.045, Ratio=4.21x, Gap=-4.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.039, Ratio=4.39x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.043, Ratio=4.21x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.048, Ratio=4.11x, Gap=-4.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.039, Ratio=4.30x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.047, Ratio=4.39x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.037, Ratio=4.15x, Gap=-4.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.056, Ratio=4.35x, Gap=-5.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.073, Ratio=4.51x, Gap=-4.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.042, Ratio=4.18x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.037, Ratio=4.09x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.055, Ratio=4.37x, Gap=-4.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.048, Ratio=4.48x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.055, Ratio=4.28x, Gap=-4.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.032, Ratio=4.25x, Gap=-4.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.037, Ratio=4.10x, Gap=-4.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.049, Ratio=4.21x, Gap=-4.119
Batch 475/537: Loss=0.8678 (C:0.8678, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.055, Ratio=4.46x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.064, Ratio=4.51x, Gap=-4.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.064, Ratio=4.48x, Gap=-4.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.052, Ratio=4.42x, Gap=-4.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.045, Ratio=4.44x, Gap=-4.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.043, Ratio=4.36x, Gap=-4.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.055, Ratio=4.38x, Gap=-4.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.051, Ratio=4.15x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.032, Ratio=4.12x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.045, Ratio=4.35x, Gap=-5.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.051, Ratio=4.22x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.038, Ratio=4.27x, Gap=-4.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.050, Ratio=4.36x, Gap=-4.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.047, Ratio=4.38x, Gap=-4.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.030, Ratio=4.33x, Gap=-4.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.052, Ratio=4.59x, Gap=-4.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.021, Ratio=4.18x, Gap=-4.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.063, Ratio=4.47x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.058, Ratio=4.54x, Gap=-4.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.048, Ratio=4.32x, Gap=-4.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.042, Ratio=4.24x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.064, Ratio=4.23x, Gap=-4.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.046, Ratio=4.26x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.045, Ratio=4.31x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.049, Ratio=4.43x, Gap=-4.620
Batch 500/537: Loss=0.8310 (C:0.8310, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.046, Ratio=4.30x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.052, Ratio=4.17x, Gap=-4.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.031, Ratio=4.35x, Gap=-4.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.034, Ratio=4.19x, Gap=-4.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.051, Ratio=4.27x, Gap=-5.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.061, Ratio=4.38x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.061, Ratio=4.28x, Gap=-4.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.051, Ratio=4.26x, Gap=-4.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.030, Ratio=4.25x, Gap=-4.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.041, Ratio=4.37x, Gap=-4.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.059, Ratio=4.32x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.048, Ratio=4.13x, Gap=-5.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.065, Ratio=4.36x, Gap=-4.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.044, Ratio=4.23x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.036, Ratio=4.12x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.019, Ratio=4.13x, Gap=-4.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.059, Ratio=4.34x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.077, Ratio=4.45x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.067, Ratio=4.41x, Gap=-4.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.064, Ratio=4.32x, Gap=-4.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.059, Ratio=4.42x, Gap=-4.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.067, Ratio=4.56x, Gap=-4.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.021, Ratio=4.07x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.062, Ratio=4.39x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.050, Ratio=4.32x, Gap=-4.365
Batch 525/537: Loss=0.8544 (C:0.8544, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.042, Ratio=4.39x, Gap=-4.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.026, Ratio=4.14x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.046, Ratio=4.32x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.051, Ratio=4.40x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.042, Ratio=4.21x, Gap=-4.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.057, Ratio=4.38x, Gap=-4.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.048, Ratio=4.51x, Gap=-4.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.043, Ratio=4.29x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.043, Ratio=4.35x, Gap=-4.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.047, Ratio=4.27x, Gap=-4.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.047, Ratio=4.21x, Gap=-4.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.075, Ratio=4.90x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.062, Ratio=4.72x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.092, Ratio=5.11x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.106, Ratio=5.12x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.071, Ratio=5.06x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.083, Ratio=4.91x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.088, Ratio=5.05x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.100, Ratio=4.94x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.089, Ratio=5.17x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.082, Ratio=4.96x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.070, Ratio=4.63x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.079, Ratio=4.81x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.066, Ratio=4.82x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.060, Ratio=4.46x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.094, Ratio=5.07x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.065, Ratio=4.83x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.058, Ratio=4.90x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.038, Ratio=4.49x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.078, Ratio=4.77x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.080, Ratio=4.89x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.077, Ratio=4.87x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.092, Ratio=5.04x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.084, Ratio=4.95x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.063, Ratio=4.92x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.084, Ratio=4.73x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.038, Ratio=4.59x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.094, Ratio=5.02x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.032, Ratio=4.52x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.071, Ratio=4.92x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.065, Ratio=4.66x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.071, Ratio=4.75x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.069, Ratio=4.84x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.059, Ratio=4.76x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.107, Ratio=5.08x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.089, Ratio=5.12x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.082, Ratio=5.00x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.060, Ratio=4.65x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.087, Ratio=5.05x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.066, Ratio=4.74x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.084, Ratio=4.92x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.075, Ratio=5.02x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.095, Ratio=5.13x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.072, Ratio=4.84x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.088, Ratio=4.90x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.086, Ratio=5.19x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.090, Ratio=4.98x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.087, Ratio=5.08x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.060, Ratio=4.63x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.050, Ratio=4.56x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.078, Ratio=5.02x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.068, Ratio=4.89x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.066, Ratio=4.67x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.072, Ratio=4.96x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.075, Ratio=4.86x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.054, Ratio=4.72x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.062, Ratio=4.92x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.097, Ratio=4.84x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.077, Ratio=5.04x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.072, Ratio=4.79x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.061, Ratio=4.69x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.044, Ratio=4.64x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.055, Ratio=4.60x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.068, Ratio=4.69x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.089, Ratio=5.05x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.086, Ratio=4.86x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.075, Ratio=5.03x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.065, Ratio=4.85x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.095, Ratio=5.10x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.065, Ratio=4.74x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.085, Ratio=5.09x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.051, Ratio=4.67x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.056, Ratio=4.82x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.059, Ratio=4.69x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.053, Ratio=4.60x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.071, Ratio=4.73x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.101, Ratio=5.00x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.081, Ratio=4.96x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.078, Ratio=4.89x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.092, Ratio=5.02x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.087, Ratio=4.91x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.085, Ratio=5.04x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.082, Ratio=5.10x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.062, Ratio=4.71x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.090, Ratio=4.83x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.071, Ratio=4.84x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.056, Ratio=4.79x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.056, Ratio=4.70x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.073, Ratio=4.89x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.067, Ratio=4.83x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.092, Ratio=5.21x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.070, Ratio=4.62x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.092, Ratio=4.88x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.070, Ratio=4.65x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.061, Ratio=4.83x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.062, Ratio=4.82x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.077, Ratio=4.93x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.081, Ratio=5.02x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.081, Ratio=4.90x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.067, Ratio=4.68x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.066, Ratio=4.77x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.083, Ratio=5.01x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.065, Ratio=4.64x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.089, Ratio=4.94x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.059, Ratio=4.67x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.074, Ratio=4.87x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.067, Ratio=4.85x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.072, Ratio=4.92x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.080, Ratio=4.87x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.081, Ratio=4.81x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.082, Ratio=4.86x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.085, Ratio=4.98x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.072, Ratio=4.97x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.086, Ratio=4.95x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.070, Ratio=4.73x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.061, Ratio=4.89x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.087, Ratio=5.09x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.058, Ratio=4.70x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.068, Ratio=4.70x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.061, Ratio=4.74x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.047, Ratio=4.63x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.080, Ratio=4.79x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.068, Ratio=4.87x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.093, Ratio=5.03x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.079, Ratio=4.96x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.079, Ratio=4.70x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.092, Ratio=4.97x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.051, Ratio=4.75x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.065, Ratio=4.84x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.082, Ratio=4.90x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.096, Ratio=5.15x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.077, Ratio=4.90x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.077, Ratio=5.00x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.108, Ratio=5.09x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.086, Ratio=5.11x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.065, Ratio=4.82x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.058, Ratio=4.44x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.077, Ratio=5.00x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.076, Ratio=4.89x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.096, Ratio=4.86x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.089, Ratio=5.11x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.080, Ratio=4.81x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.093, Ratio=5.08x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=2.092, Ratio=5.23x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.064, Ratio=4.90x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.060, Ratio=4.69x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.049, Ratio=4.67x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.068, Ratio=4.70x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.075, Ratio=4.99x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.084, Ratio=4.98x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.093, Ratio=4.86x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.101, Ratio=5.14x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.071, Ratio=5.07x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.072, Ratio=4.73x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.062, Ratio=4.82x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.057, Ratio=4.64x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.071, Ratio=4.91x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.068, Ratio=4.80x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.060, Ratio=4.78x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.083, Ratio=5.01x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.091, Ratio=4.83x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.083, Ratio=5.07x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.101, Ratio=4.95x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.098, Ratio=4.93x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.068, Ratio=4.78x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.087, Ratio=5.12x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.069, Ratio=4.83x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.081, Ratio=4.92x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.078, Ratio=4.96x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.084, Ratio=4.87x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.053, Ratio=4.65x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.071, Ratio=4.91x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.073, Ratio=4.98x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.072, Ratio=4.79x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.074, Ratio=4.77x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.055, Ratio=4.67x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.075, Ratio=4.77x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.056, Ratio=4.66x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.088, Ratio=4.86x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.062, Ratio=4.65x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.057, Ratio=4.68x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.056, Ratio=4.54x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.074, Ratio=4.91x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.076, Ratio=4.94x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.070, Ratio=4.62x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.071, Ratio=4.88x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.075, Ratio=4.89x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.076, Ratio=4.91x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.078, Ratio=4.82x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.054, Ratio=4.59x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.078, Ratio=4.85x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.071, Ratio=4.94x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.070, Ratio=4.88x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.085, Ratio=5.04x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.063, Ratio=4.72x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.066, Ratio=4.83x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.056, Ratio=4.62x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.064, Ratio=4.60x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.076, Ratio=4.92x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.071, Ratio=4.94x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.071, Ratio=4.95x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.066, Ratio=4.47x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.072, Ratio=4.73x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.076, Ratio=4.98x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.088, Ratio=5.07x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.089, Ratio=5.02x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.077, Ratio=4.75x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.074, Ratio=4.96x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.082, Ratio=4.98x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.065, Ratio=4.84x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.062, Ratio=4.78x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.073, Ratio=4.79x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.075, Ratio=4.90x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.069, Ratio=4.89x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.082, Ratio=4.97x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=2.085, Ratio=5.24x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.083, Ratio=5.11x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.073, Ratio=5.06x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.091, Ratio=4.90x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.051, Ratio=4.54x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.071, Ratio=4.67x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.051, Ratio=4.50x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.080, Ratio=5.06x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.094, Ratio=5.02x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.095, Ratio=5.14x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.097, Ratio=5.09x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.069, Ratio=4.79x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.086, Ratio=5.04x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.071, Ratio=4.79x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.051, Ratio=4.79x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.075, Ratio=4.80x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.072, Ratio=4.80x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.053, Ratio=4.60x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.064, Ratio=4.61x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.067, Ratio=4.89x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.071, Ratio=4.90x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.061, Ratio=4.82x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.054, Ratio=4.64x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.069, Ratio=4.86x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.071, Ratio=4.74x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.083, Ratio=4.89x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.088, Ratio=4.92x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.062, Ratio=4.75x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.081, Ratio=4.89x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.106, Ratio=5.12x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.095, Ratio=4.92x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.086, Ratio=4.89x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.081, Ratio=4.88x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.053, Ratio=4.75x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.070, Ratio=4.62x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.097, Ratio=5.11x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.056, Ratio=4.76x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.077, Ratio=4.69x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.067, Ratio=4.89x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.090, Ratio=5.20x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.063, Ratio=4.93x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.084, Ratio=4.84x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.072, Ratio=4.71x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.086, Ratio=4.90x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.053, Ratio=4.61x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.082, Ratio=4.89x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.076, Ratio=4.96x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.067, Ratio=4.68x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.081, Ratio=5.13x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.090, Ratio=5.02x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.060, Ratio=4.61x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.078, Ratio=4.96x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.072, Ratio=4.90x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.063, Ratio=4.79x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.063, Ratio=4.57x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.069, Ratio=4.89x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.076, Ratio=4.96x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.081, Ratio=4.96x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.094, Ratio=5.15x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.074, Ratio=4.82x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.050, Ratio=4.64x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.081, Ratio=5.02x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.078, Ratio=4.90x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.080, Ratio=4.89x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.084, Ratio=4.74x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.087, Ratio=4.79x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.054, Ratio=4.58x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.077, Ratio=4.69x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.080, Ratio=4.82x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.102, Ratio=5.20x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.092, Ratio=5.02x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.056, Ratio=4.65x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.069, Ratio=5.05x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.064, Ratio=4.83x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.073, Ratio=4.89x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.089, Ratio=5.15x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.064, Ratio=4.77x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.080, Ratio=5.13x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.079, Ratio=4.92x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.078, Ratio=4.79x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.083, Ratio=5.08x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.057, Ratio=4.53x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.058, Ratio=4.67x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.059, Ratio=4.66x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.056, Ratio=4.83x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.052, Ratio=4.73x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.106, Ratio=5.24x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.063, Ratio=4.95x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.090, Ratio=4.93x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.094, Ratio=4.86x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.078, Ratio=4.94x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.077, Ratio=4.91x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.089, Ratio=5.09x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.090, Ratio=5.06x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.063, Ratio=4.84x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.081, Ratio=4.88x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.086, Ratio=4.99x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.085, Ratio=5.12x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.072, Ratio=4.89x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.076, Ratio=4.72x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.076, Ratio=5.01x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.056, Ratio=4.74x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.080, Ratio=4.92x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=2.101, Ratio=5.26x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.097, Ratio=5.12x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.085, Ratio=5.08x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.078, Ratio=4.83x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.076, Ratio=4.84x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.077, Ratio=4.89x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.085, Ratio=5.18x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.087, Ratio=5.15x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.093, Ratio=5.09x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.067, Ratio=4.68x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.081, Ratio=4.94x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.092, Ratio=4.94x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.058, Ratio=4.46x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.058, Ratio=4.54x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.080, Ratio=4.97x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.066, Ratio=4.68x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.075, Ratio=4.85x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.070, Ratio=4.80x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.094, Ratio=5.20x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.038, Ratio=4.51x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.054, Ratio=4.78x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.060, Ratio=4.83x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.056, Ratio=4.56x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.083, Ratio=4.97x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.073, Ratio=4.82x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.051, Ratio=4.59x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.072, Ratio=5.05x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.083, Ratio=5.05x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.069, Ratio=4.83x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.081, Ratio=4.95x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.083, Ratio=4.70x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.086, Ratio=4.88x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.056, Ratio=4.95x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.077, Ratio=5.01x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.069, Ratio=4.84x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.092, Ratio=4.98x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.083, Ratio=5.04x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.082, Ratio=5.12x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.098, Ratio=4.96x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.087, Ratio=4.85x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.064, Ratio=4.66x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.058, Ratio=4.91x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.109, Ratio=5.07x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.095, Ratio=5.08x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.082, Ratio=5.04x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.090, Ratio=5.14x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.082, Ratio=4.82x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.068, Ratio=4.60x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.071, Ratio=4.92x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.092, Ratio=5.01x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.077, Ratio=4.81x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.048, Ratio=4.52x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.069, Ratio=4.76x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.087, Ratio=4.93x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.059, Ratio=4.69x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.063, Ratio=4.85x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.079, Ratio=4.93x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.080, Ratio=4.87x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.072, Ratio=4.69x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.073, Ratio=5.05x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.056, Ratio=4.78x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.063, Ratio=4.87x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.049, Ratio=4.63x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.089, Ratio=5.01x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.075, Ratio=5.02x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.078, Ratio=5.06x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.094, Ratio=5.04x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.069, Ratio=4.89x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.055, Ratio=4.77x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.089, Ratio=5.13x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.060, Ratio=4.66x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.064, Ratio=4.78x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.078, Ratio=4.92x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.071, Ratio=4.98x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.067, Ratio=4.81x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.080, Ratio=4.95x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.087, Ratio=5.02x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.046, Ratio=4.67x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.081, Ratio=4.74x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.072, Ratio=4.91x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.382, Neg=2.116, Ratio=5.55x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.095, Ratio=5.15x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.110, Ratio=5.18x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.068, Ratio=4.86x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.097, Ratio=5.21x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.082, Ratio=4.84x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.057, Ratio=4.86x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.057, Ratio=4.66x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.048, Ratio=4.59x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.093, Ratio=4.92x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.045, Ratio=4.53x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.074, Ratio=4.89x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.095, Ratio=4.91x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=2.099, Ratio=5.25x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.077, Ratio=4.81x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.075, Ratio=4.92x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.045, Ratio=4.47x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.046, Ratio=4.52x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.078, Ratio=4.88x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.068, Ratio=5.02x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.066, Ratio=4.78x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.062, Ratio=4.60x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.063, Ratio=4.86x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.098, Ratio=5.12x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.085, Ratio=5.12x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.063, Ratio=4.79x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.081, Ratio=4.92x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.076, Ratio=4.86x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.074, Ratio=4.84x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.095, Ratio=5.08x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.069, Ratio=4.67x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.071, Ratio=4.80x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.092, Ratio=4.88x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.099, Ratio=5.02x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.061, Ratio=4.80x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.057, Ratio=4.72x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.075, Ratio=4.82x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.067, Ratio=4.74x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.069, Ratio=4.82x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.079, Ratio=4.90x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.093, Ratio=5.03x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.060, Ratio=4.78x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.070, Ratio=4.81x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.100, Ratio=5.21x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.061, Ratio=4.76x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.080, Ratio=4.79x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.065, Ratio=4.79x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.078, Ratio=5.00x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.073, Ratio=4.79x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.086, Ratio=5.01x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.052, Ratio=4.77x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.089, Ratio=5.09x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.097, Ratio=5.06x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.077, Ratio=5.04x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.064, Ratio=4.74x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.068, Ratio=5.01x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.073, Ratio=4.69x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=2.108, Ratio=5.33x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.054, Ratio=4.62x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.050, Ratio=4.65x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.085, Ratio=4.88x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.052, Ratio=4.67x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.078, Ratio=5.01x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.072, Ratio=4.78x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.066, Ratio=4.88x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.076, Ratio=4.78x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.076, Ratio=4.71x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.087, Ratio=4.97x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.087, Ratio=4.80x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.078, Ratio=4.94x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.061, Ratio=4.82x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.082, Ratio=4.91x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.070, Ratio=4.77x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.090, Ratio=5.08x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.085, Ratio=5.00x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.061, Ratio=4.68x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.073, Ratio=4.80x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.075, Ratio=4.90x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.083, Ratio=4.81x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.069, Ratio=4.87x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.080, Ratio=4.98x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.075, Ratio=4.68x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.076, Ratio=5.07x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.082, Ratio=4.83x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.080, Ratio=4.86x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.066, Ratio=4.86x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.070, Ratio=4.81x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.072, Ratio=4.93x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.068, Ratio=4.79x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.094, Ratio=4.95x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.089, Ratio=5.16x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.070, Ratio=4.90x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.091, Ratio=5.05x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.060, Ratio=4.86x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.062, Ratio=4.73x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.075, Ratio=4.81x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.070, Ratio=4.81x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=2.097, Ratio=5.31x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.088, Ratio=4.74x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.079, Ratio=5.09x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.088, Ratio=5.16x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.092, Ratio=4.96x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.094, Ratio=5.17x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.088, Ratio=4.94x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.073, Ratio=4.85x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.084, Ratio=5.08x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.079, Ratio=5.01x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.061, Ratio=4.63x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.081, Ratio=5.03x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=2.086, Ratio=5.29x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.060, Ratio=4.63x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.074, Ratio=4.92x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.088, Ratio=4.77x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.072, Ratio=4.80x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.063, Ratio=4.83x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.072, Ratio=4.92x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.067, Ratio=4.69x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.071, Ratio=4.80x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.068, Ratio=4.87x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.074, Ratio=4.83x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.058, Ratio=4.74x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.069, Ratio=4.78x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.054, Ratio=4.54x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.080, Ratio=5.05x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.075, Ratio=4.92x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.098, Ratio=5.00x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.070, Ratio=4.74x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.076, Ratio=4.88x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.096, Ratio=5.00x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.046, Ratio=4.64x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.077, Ratio=4.86x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.088, Ratio=4.97x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.094, Ratio=4.95x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.085, Ratio=4.92x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.058, Ratio=4.79x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.075, Ratio=4.97x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.082, Ratio=5.06x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.082, Ratio=4.89x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.054, Ratio=4.71x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.066, Ratio=4.75x, Gap=-3.651

============================================================
Epoch 20/20 completed in 33.3s
Train: Loss=0.8482 (C:0.8482, R:0.0000) Ratio=3.81x
Val:   Loss=0.7827 (C:0.7827, R:0.0000) Ratio=4.95x
‚úÖ New best model saved (Val Loss: 0.7827)
Checkpoint saved at epoch 20
============================================================

Global Dataset Training Completed!
Best epoch: 20
Best validation loss: 0.7827
Final separation ratios: Train=3.81x, Val=4.95x
Training completed!
Loading best model from experiments/global_concat_test_20250712_120843/checkpoints/best_model.pt
Starting model evaluation...
========================================
GlobalContrastiveEvaluator initialized on cuda
Starting comprehensive evaluation...
============================================================
Extracting latent representations...
  Processed 1/539 batches
  Processed 51/539 batches
  Processed 101/539 batches
  Processed 151/539 batches
  Processed 201/539 batches
  Processed 251/539 batches
  Processed 301/539 batches
  Processed 351/539 batches
  Processed 401/539 batches
  Processed 451/539 batches
  Processed 501/539 batches
Extracted representations: torch.Size([549367, 75])
Evaluating clustering performance...
