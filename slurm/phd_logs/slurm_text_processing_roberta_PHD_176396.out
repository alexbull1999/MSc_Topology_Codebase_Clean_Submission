Starting text processing test job...
Job ID: 176396
Node: gpuvm10
Time: Fri 20 Jun 18:04:56 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Conda info:

# conda environments:
#
base                   /homes/ahb24/miniconda3
                     * /vol/bitbucket/ahb24/tda_entailment_new

Checking GPU availability...
Fri Jun 20 18:04:59 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.120                Driver Version: 550.120        CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A30                     Off |   00000000:01:00.0 Off |                    0 |
| N/A   35C    P0             30W /  165W |       1MiB /  24576MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Running text_processing.py...
Loading roberta-base on cuda...
Text processing pipeline ready
Single pair test - Premise shape: torch.Size([768]), Hypothesis shape: torch.Size([768])
Processing dataset: data/raw/snli/train/snli_10k_subset_balanced.json...
Dataset contains 9990 premise-hypothesis pairs
Generating premise embeddings...
Generating hypothesis embeddings...
Concatenating premise and hypothesis embeddings...
Concatenated embeddings shape: torch.Size([9990, 1536])
Class 'contradiction': 3330 samples, embedding dim: 1536
Class 'entailment': 3330 samples, embedding dim: 1536
Class 'neutral': 3330 samples, embedding dim: 1536
Dataset processing complete
Premise embeddings shape: torch.Size([9990, 768])
Hypothesis embeddings shape: torch.Size([9990, 768])
Concatenated embeddings shape: torch.Size([9990, 1536])
Concatenated embedding dimension: 1536
Premise embedding range: [-0.761, 12.388]
Hypothesis embedding range: [-0.852, 12.444]
Concatenated embedding range: [-0.852, 12.444]

Class embedding validation:
  contradiction: 3330 samples, dim 1536
  entailment: 3330 samples, dim 1536
  neutral: 3330 samples, dim 1536

Class organization summary:
  contradiction: 3330 samples with 1536D embeddings
  entailment: 3330 samples with 1536D embeddings
  neutral: 3330 samples with 1536D embeddings
Saved processed data to phd_method/phd_data/processed/snli_10k_subset_balanced_phd_roberta.pt
Text processing pipeline test completed successfully

Text processing completed!
Time: Fri 20 Jun 18:06:48 BST 2025
Files created in data/processed:
total 122696
drwxr-xr-x 2 ahb24 mcs       96 Jun 20 09:43 .
drwxr-xr-x 5 ahb24 mcs      127 Jun 18 12:07 ..
-rw-r--r-- 1 ahb24 mcs 62817406 Jun 18 12:12 snli_10k_subset_balanced.pt
-rw-r--r-- 1 ahb24 mcs 62817454 Jun 20 09:43 snli_10k_subset_balanced_roberta.pt
Job finished.
